<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Get top 1 row of each group | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I have a table which I want to get the latest entry for each group. Here&#x27;s the table:

DocumentStatusLogs Table

|ID| DocumentID | Status | DateCreated |
| 2| 1          | S1     | 7/29/2011   |
| 3| 1          | S2     | 7/30/2011   |
| 6| 1          | S1     | 8/02/2011   |
| 1| 2          | S1     | 7/28/2011   |
| 4| 2          | S2     | 7/30/2011   |
| 5| 2          | S3     | 8/01/2011   |
| 6| 3          | S1     | 8/02/2011   |


The table will be grouped by DocumentID and sorted by DateCreated in descending order. For each DocumentID, I want to get the latest status. 

My preferred output:

| DocumentID | Status | DateCreated |
| 1          | S1     | 8/02/2011   |
| 2          | S3     | 8/01/2011   |
| 3          | S1     | 8/02/2011   |



Is there any aggregate function to get only the top from each group? See pseudo-code GetOnlyTheTop below:

SELECT
  DocumentID,
  GetOnlyTheTop(Status),
  GetOnlyTheTop(DateCreated)
FROM DocumentStatusLogs
GROUP BY DocumentID
ORDER BY DateCreated DESC

If such function doesn&#x27;t exist, is there any way I can achieve the output I want?
Or at the first place, could this be caused by unnormalized database? I&#x27;m thinking, since what I&#x27;m looking for is just one row, should that status also be located in the parent table?


Please see the parent table for more information:

Current Documents Table

| DocumentID | Title  | Content  | DateCreated |
| 1          | TitleA | ...      | ...         |
| 2          | TitleB | ...      | ...         |
| 3          | TitleC | ...      | ...         |


Should the parent table be like this so that I can easily access its status?

| DocumentID | Title  | Content  | DateCreated | CurrentStatus |
| 1          | TitleA | ...      | ...         | s1            |
| 2          | TitleB | ...      | ...         | s3            |
| 3          | TitleC | ...      | ...         | s1            |


UPDATE
I just learned how to use &quot;apply&quot; which makes it easier to address such problems.
    "/><meta property="og:title" content="Get top 1 row of each group | Solutions Checker"/><meta property="og:description" content="I have a table which I want to get the latest entry for each group. Here&#x27;s the table:

DocumentStatusLogs Table

|ID| DocumentID | Status | DateCreated |
| 2| 1          | S1     | 7/29/2011   |
| 3| 1          | S2     | 7/30/2011   |
| 6| 1          | S1     | 8/02/2011   |
| 1| 2          | S1     | 7/28/2011   |
| 4| 2          | S2     | 7/30/2011   |
| 5| 2          | S3     | 8/01/2011   |
| 6| 3          | S1     | 8/02/2011   |


The table will be grouped by DocumentID and sorted by DateCreated in descending order. For each DocumentID, I want to get the latest status. 

My preferred output:

| DocumentID | Status | DateCreated |
| 1          | S1     | 8/02/2011   |
| 2          | S3     | 8/01/2011   |
| 3          | S1     | 8/02/2011   |



Is there any aggregate function to get only the top from each group? See pseudo-code GetOnlyTheTop below:

SELECT
  DocumentID,
  GetOnlyTheTop(Status),
  GetOnlyTheTop(DateCreated)
FROM DocumentStatusLogs
GROUP BY DocumentID
ORDER BY DateCreated DESC

If such function doesn&#x27;t exist, is there any way I can achieve the output I want?
Or at the first place, could this be caused by unnormalized database? I&#x27;m thinking, since what I&#x27;m looking for is just one row, should that status also be located in the parent table?


Please see the parent table for more information:

Current Documents Table

| DocumentID | Title  | Content  | DateCreated |
| 1          | TitleA | ...      | ...         |
| 2          | TitleB | ...      | ...         |
| 3          | TitleC | ...      | ...         |


Should the parent table be like this so that I can easily access its status?

| DocumentID | Title  | Content  | DateCreated | CurrentStatus |
| 1          | TitleA | ...      | ...         | s1            |
| 2          | TitleB | ...      | ...         | s3            |
| 3          | TitleC | ...      | ...         | s1            |


UPDATE
I just learned how to use &quot;apply&quot; which makes it easier to address such problems.
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Get top 1 row of each group","text":"I have a table which I want to get the latest entry for each group. Here&apos;s the table:\n\nDocumentStatusLogs Table\n\n|ID| DocumentID | Status | DateCreated |\n| 2| 1          | S1     | 7/29/2011   |\n| 3| 1          | S2     | 7/30/2011   |\n| 6| 1          | S1     | 8/02/2011   |\n| 1| 2          | S1     | 7/28/2011   |\n| 4| 2          | S2     | 7/30/2011   |\n| 5| 2          | S3     | 8/01/2011   |\n| 6| 3          | S1     | 8/02/2011   |\n\n\nThe table will be grouped by DocumentID and sorted by DateCreated in descending order. For each DocumentID, I want to get the latest status. \n\nMy preferred output:\n\n| DocumentID | Status | DateCreated |\n| 1          | S1     | 8/02/2011   |\n| 2          | S3     | 8/01/2011   |\n| 3          | S1     | 8/02/2011   |\n\n\n\nIs there any aggregate function to get only the top from each group? See pseudo-code GetOnlyTheTop below:\n\nSELECT\n  DocumentID,\n  GetOnlyTheTop(Status),\n  GetOnlyTheTop(DateCreated)\nFROM DocumentStatusLogs\nGROUP BY DocumentID\nORDER BY DateCreated DESC\n\nIf such function doesn&apos;t exist, is there any way I can achieve the output I want?\nOr at the first place, could this be caused by unnormalized database? I&apos;m thinking, since what I&apos;m looking for is just one row, should that status also be located in the parent table?\n\n\nPlease see the parent table for more information:\n\nCurrent Documents Table\n\n| DocumentID | Title  | Content  | DateCreated |\n| 1          | TitleA | ...      | ...         |\n| 2          | TitleB | ...      | ...         |\n| 3          | TitleC | ...      | ...         |\n\n\nShould the parent table be like this so that I can easily access its status?\n\n| DocumentID | Title  | Content  | DateCreated | CurrentStatus |\n| 1          | TitleA | ...      | ...         | s1            |\n| 2          | TitleB | ...      | ...         | s3            |\n| 3          | TitleC | ...      | ...         | s1            |\n\n\nUPDATE\nI just learned how to use &quot;apply&quot; which makes it easier to address such problems.\n    ","answerCount":23,"upVoteCount":500,"suggestedAnswer":[{"text":";WITH cte AS\n(\n   SELECT *,\n         ROW_NUMBER() OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC) AS rn\n   FROM DocumentStatusLogs\n)\nSELECT *\nFROM cte\nWHERE rn = 1\n\n\nIf you expect 2 entries per day, then this will arbitrarily pick one. To get both entries for a day, use DENSE_RANK instead\n\nAs for normalised or not, it depends if you want to:\n\n\nmaintain status in 2 places\npreserve status history\n...\n\n\nAs it stands, you preserve status history. If you want latest status in the parent table too (which is denormalisation) you&apos;d need a trigger to maintain &quot;status&quot; in the parent. or drop this status history table.\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"I just learned how to use cross apply. Here&apos;s how to use it in this scenario:\n\n select d.DocumentID, ds.Status, ds.DateCreated \n from Documents as d \n cross apply \n     (select top 1 Status, DateCreated\n      from DocumentStatusLogs \n      where DocumentID = d.DocumentId\n      order by DateCreated desc) as ds\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"I know this is an old thread but the TOP 1 WITH TIES solutions is quite nice and might be helpful to some reading through the solutions.\nselect top 1 with ties\n   DocumentID\n  ,Status\n  ,DateCreated\nfrom DocumentStatusLogs\norder by row_number() over (partition by DocumentID order by DateCreated desc)\n\nThe select top 1 with ties clause tells SQL Server that you want to return the first row per group. But how does SQL Server know how to group up the data? This is where the order by row_number() over (partition by DocumentID order by DateCreated desc comes in. The column/columns after partition by defines how SQL Server groups up the data. Within each group, the rows will be sorted based on the order by columns. Once sorted, the top row in each group will be returned in the query.\nMore about the TOP clause can be found here.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"I&apos;ve done some timings over the various recommendations here, and the results really depend on the size of the table involved, but the most consistent solution is using the CROSS APPLY  These tests were run against SQL Server 2008-R2, using a table with 6,500 records, and another (identical schema) with 137 million records.  The columns being queried are part of the primary key on the table, and the table width is very small (about 30 bytes).  The times are reported by SQL Server from the actual execution plan.\n\nQuery                                  Time for 6500 (ms)    Time for 137M(ms)\n\nCROSS APPLY                                    17.9                17.9\nSELECT WHERE col = (SELECT MAX(COL))           6.6               854.4\nDENSE_RANK() OVER PARTITION                     6.6               907.1\n\n\nI think the really amazing thing was how consistent the time was for the CROSS APPLY regardless of the number of rows involved.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"If you&apos;re worried about performance, you can also do this with MAX():\n\nSELECT *\nFROM DocumentStatusLogs D\nWHERE DateCreated = (SELECT MAX(DateCreated) FROM DocumentStatusLogs WHERE ID = D.ID)\n\n\nROW_NUMBER() requires a sort of all the rows in your SELECT statement, whereas MAX does not. Should drastically speed up your query.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"SELECT * FROM\nDocumentStatusLogs JOIN (\n  SELECT DocumentID, MAX(DateCreated) DateCreated\n  FROM DocumentStatusLogs\n  GROUP BY DocumentID\n  ) max_date USING (DocumentID, DateCreated)\n\n\nWhat database server? This code doesn&apos;t work on all of them.\n\nRegarding the second half of your question, it seems reasonable to me to include the status as a column. You can leave DocumentStatusLogs as a log, but still store the latest info in the main table.\n\nBTW, if you already have the DateCreated column in the Documents table you can just join DocumentStatusLogs using that (as long as DateCreated is unique in DocumentStatusLogs).\n\nEdit: MsSQL does not support USING, so change it to:\n\nON DocumentStatusLogs.DocumentID = max_date.DocumentID AND DocumentStatusLogs.DateCreated = max_date.DateCreated\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"This is one of the most easily found question on the topic, so I wanted to give a modern answer to the it (both for my reference and to help others out). By using first_value and over you can make short work of the above query:\n\nSelect distinct DocumentID\n  , first_value(status) over (partition by DocumentID order by DateCreated Desc) as Status\n  , first_value(DateCreated) over (partition by DocumentID order by DateCreated Desc) as DateCreated\nFrom DocumentStatusLogs\n\n\nThis should work in Sql Server 2008 and up. First_value can be thought of as a way to accomplish Select Top 1 when using an over clause. Over allows grouping in the select list so instead of writing nested subqueries (like many of the existing answers do), this does it in a more readable fashion. Hope this helps.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Here are 3 separate approaches to the problem in hand along with the best choices of indexing for each of those queries (please try out the indexes yourselves and see the logical read, elapsed time, execution plan. I have provided the suggestions from my experience on such queries without executing for this specific problem).\n\nApproach 1: Using ROW_NUMBER(). If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.\n\n;WITH CTE AS\n    (\n       SELECT   *,\n                RN = ROW_NUMBER() OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC)\n       FROM     DocumentStatusLogs\n    )\n    SELECT  ID      \n        ,DocumentID \n        ,Status     \n        ,DateCreated\n    FROM    CTE\n    WHERE   RN = 1;\n\n\nApproach 2: Using FIRST_VALUE. If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.\n\nSELECT  DISTINCT\n    ID      = FIRST_VALUE(ID) OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC)\n    ,DocumentID\n    ,Status     = FIRST_VALUE(Status) OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC)\n    ,DateCreated    = FIRST_VALUE(DateCreated) OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC)\nFROM    DocumentStatusLogs;\n\n\nApproach 3: Using CROSS APPLY. Creating rowstore index on DocumentStatusLogs table covering the columns used in the query should be enough to cover the query without need of a columnstore index.\n\nSELECT  DISTINCT\n    ID      = CA.ID\n    ,DocumentID = D.DocumentID\n    ,Status     = CA.Status \n    ,DateCreated    = CA.DateCreated\nFROM    DocumentStatusLogs D\n    CROSS APPLY (\n            SELECT  TOP 1 I.*\n            FROM    DocumentStatusLogs I\n            WHERE   I.DocumentID = D.DocumentID\n            ORDER   BY I.DateCreated DESC\n            ) CA;\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"This is quite an old thread, but I thought I&apos;d throw my two cents in just the same as the accepted answer didn&apos;t work particularly well for me.  I tried gbn&apos;s solution on a large dataset and found it to be terribly slow (&gt;45 seconds on 5 million plus records in SQL Server 2012).  Looking at the execution plan it&apos;s obvious that the issue is that it requires a SORT operation which slows things down significantly.\n\nHere&apos;s an alternative that I lifted from the entity framework that needs no SORT operation and does a NON-Clustered Index search.  This reduces the execution time down to &lt; 2 seconds on the aforementioned record set.\n\nSELECT \n[Limit1].[DocumentID] AS [DocumentID], \n[Limit1].[Status] AS [Status], \n[Limit1].[DateCreated] AS [DateCreated]\nFROM   (SELECT DISTINCT [Extent1].[DocumentID] AS [DocumentID] FROM [dbo].[DocumentStatusLogs] AS [Extent1]) AS [Distinct1]\nOUTER APPLY  (SELECT TOP (1) [Project2].[ID] AS [ID], [Project2].[DocumentID] AS [DocumentID], [Project2].[Status] AS [Status], [Project2].[DateCreated] AS [DateCreated]\n    FROM (SELECT \n        [Extent2].[ID] AS [ID], \n        [Extent2].[DocumentID] AS [DocumentID], \n        [Extent2].[Status] AS [Status], \n        [Extent2].[DateCreated] AS [DateCreated]\n        FROM [dbo].[DocumentStatusLogs] AS [Extent2]\n        WHERE ([Distinct1].[DocumentID] = [Extent2].[DocumentID])\n    )  AS [Project2]\n    ORDER BY [Project2].[ID] DESC) AS [Limit1]\n\n\nNow I&apos;m assuming something that isn&apos;t entirely specified in the original question, but if your table design is such that your ID column is an auto-increment ID, and the DateCreated is set to the current date with each insert, then even without running with my query above you could actually get a sizable performance boost to gbn&apos;s solution (about half the execution time) just from ordering on ID instead of ordering on DateCreated as this will provide an identical sort order and it&apos;s a faster sort.\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"My code to select top 1 from each group\n\nselect a.* from #DocumentStatusLogs a where \n datecreated in( select top 1 datecreated from #DocumentStatusLogs b\nwhere \na.documentid = b.documentid\norder by datecreated desc\n)\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"This solution can be used to get the TOP N most recent rows for each partition (in the example, N is 1 in the WHERE statement and partition is doc_id):\nSELECT T.doc_id, T.status, T.date_created FROM \n(\n    SELECT a.*, ROW_NUMBER() OVER (PARTITION BY doc_id ORDER BY date_created DESC) AS rnk FROM doc a\n) T\nWHERE T.rnk = 1;\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"CROSS APPLY was the method I used for my solution, as it worked for me, and for my clients needs. And from what I&apos;ve read, should provide the best overall performance should their database grow substantially.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"Verifying Clint&apos;s awesome and correct answer from above:\nThe performance between the two queries below is interesting. 52% being the top one. And 48% being the second one. A 4% improvement in performance using DISTINCT instead of ORDER BY. But ORDER BY has the advantage to sort by multiple columns.\nIF (OBJECT_ID(&apos;tempdb..#DocumentStatusLogs&apos;) IS NOT NULL) BEGIN DROP TABLE #DocumentStatusLogs END\n\nCREATE TABLE #DocumentStatusLogs (\n    [ID] int NOT NULL,\n    [DocumentID] int NOT NULL,\n    [Status] varchar(20),\n    [DateCreated] datetime\n)\n\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (2, 1, &apos;S1&apos;, &apos;7/29/2011 1:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (3, 1, &apos;S2&apos;, &apos;7/30/2011 2:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (6, 1, &apos;S1&apos;, &apos;8/02/2011 3:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (1, 2, &apos;S1&apos;, &apos;7/28/2011 4:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (4, 2, &apos;S2&apos;, &apos;7/30/2011 5:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (5, 2, &apos;S3&apos;, &apos;8/01/2011 6:00:00&apos;)\nINSERT INTO #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) VALUES (6, 3, &apos;S1&apos;, &apos;8/02/2011 7:00:00&apos;)\n\nOption 1:\n    SELECT\n    [Extent1].[ID], \n    [Extent1].[DocumentID],\n    [Extent1].[Status], \n    [Extent1].[DateCreated]\nFROM #DocumentStatusLogs AS [Extent1]\n    OUTER APPLY (\n        SELECT TOP 1\n            [Extent2].[ID], \n            [Extent2].[DocumentID],\n            [Extent2].[Status], \n            [Extent2].[DateCreated]\n        FROM #DocumentStatusLogs AS [Extent2]\n        WHERE [Extent1].[DocumentID] = [Extent2].[DocumentID]\n        ORDER BY [Extent2].[DateCreated] DESC, [Extent2].[ID] DESC\n    ) AS [Project2]\nWHERE ([Project2].[ID] IS NULL OR [Project2].[ID] = [Extent1].[ID])\n\nOption 2:\nSELECT \n    [Limit1].[DocumentID] AS [ID], \n    [Limit1].[DocumentID] AS [DocumentID], \n    [Limit1].[Status] AS [Status], \n    [Limit1].[DateCreated] AS [DateCreated]\nFROM (\n    SELECT DISTINCT [Extent1].[DocumentID] AS [DocumentID] FROM #DocumentStatusLogs AS [Extent1]\n) AS [Distinct1]\n    OUTER APPLY  (\n        SELECT TOP (1) [Project2].[ID] AS [ID], [Project2].[DocumentID] AS [DocumentID], [Project2].[Status] AS [Status], [Project2].[DateCreated] AS [DateCreated]\n        FROM (\n            SELECT \n                [Extent2].[ID] AS [ID], \n                [Extent2].[DocumentID] AS [DocumentID], \n                [Extent2].[Status] AS [Status], \n                [Extent2].[DateCreated] AS [DateCreated]\n            FROM #DocumentStatusLogs AS [Extent2]\n            WHERE [Distinct1].[DocumentID] = [Extent2].[DocumentID]\n        )  AS [Project2]\n        ORDER BY [Project2].[ID] DESC\n    ) AS [Limit1]\n\nIn Microsoft SQL Server Management Studio: after highlighting and running the first block, highlight both Option 1 and Option 2, right click -&gt; [Display Estimated Execution Plan]. Then run the entire thing to see the results.\nOption 1 Results:\nID  DocumentID  Status  DateCreated\n6   1   S1  8/2/11 3:00\n5   2   S3  8/1/11 6:00\n6   3   S1  8/2/11 7:00\n\nOption 2 Results:\nID  DocumentID  Status  DateCreated\n6   1   S1  8/2/11 3:00\n5   2   S3  8/1/11 6:00\n6   3   S1  8/2/11 7:00\n\nNote:\n\nI tend to use APPLY when I want a join to be 1-to-(1 of many).\nI use a JOIN if I want the join to be 1-to-many, or many-to-many.\nI avoid CTE with ROW_NUMBER() unless I need to do something advanced and am ok with the windowing performance penalty.\n\nI also avoid EXISTS / IN subqueries in the WHERE or ON clause, as I have experienced this causing some terrible execution plans. But mileage varies. Review the execution plan and profile performance where and when needed!\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"SELECT o.*\nFROM `DocumentStatusLogs` o                   \n  LEFT JOIN `DocumentStatusLogs` b                   \n  ON o.DocumentID = b.DocumentID AND o.DateCreated &lt; b.DateCreated\n WHERE b.DocumentID is NULL ;\n\n\nIf you want to return only recent document order by DateCreated, it will return only top 1 document by DocumentID\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"I believe this can be done just like this. This might need some tweaking but you can just select the max from the group.\nThese answers are overkill..\nSELECT\n  d.DocumentID,\n  MAX(d.Status),\n  MAX(d1.DateCreated)\nFROM DocumentStatusLogs d, DocumentStatusLogs d1\nUSING DocumentID\nGROUP BY 1\nORDER BY 3 DESC\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"In scenarios where you want to avoid using row_count(), you can also use a left join:\n\nselect ds.DocumentID, ds.Status, ds.DateCreated \nfrom DocumentStatusLogs ds\nleft join DocumentStatusLogs filter \n    ON ds.DocumentID = filter.DocumentID\n    -- Match any row that has another row that was created after it.\n    AND ds.DateCreated &lt; filter.DateCreated\n-- then filter out any rows that matched \nwhere filter.DocumentID is null \n\n\nFor the example schema, you could also use a &quot;not in subquery&quot;, which generally compiles to the same output as the left join: \n\nselect ds.DocumentID, ds.Status, ds.DateCreated \nfrom DocumentStatusLogs ds\nWHERE ds.ID NOT IN (\n    SELECT filter.ID \n    FROM DocumentStatusLogs filter\n    WHERE ds.DocumentID = filter.DocumentID\n        AND ds.DateCreated &lt; filter.DateCreated)\n\n\nNote, the subquery pattern wouldn&apos;t work if the table didn&apos;t have at least one single-column unique key/constraint/index, in this case the primary key &quot;Id&quot;.\n\nBoth of these queries tend to be more &quot;expensive&quot; than the row_count() query (as measured by Query Analyzer).  However, you might encounter scenarios where they return results faster or enable other optimizations.\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"SELECT documentid, \n       status, \n       datecreated \nFROM   documentstatuslogs dlogs \nWHERE  status = (SELECT status \n                 FROM   documentstatuslogs \n                 WHERE  documentid = dlogs.documentid \n                 ORDER  BY datecreated DESC \n                 LIMIT  1) \n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"Try this:\n\nSELECT [DocumentID]\n    ,[tmpRez].value(&apos;/x[2]&apos;, &apos;varchar(20)&apos;) AS [Status]\n    ,[tmpRez].value(&apos;/x[3]&apos;, &apos;datetime&apos;) AS [DateCreated]\nFROM (\n    SELECT [DocumentID]\n        ,cast(&apos;&lt;x&gt;&apos; + max(cast([ID] AS VARCHAR(10)) + &apos;&lt;/x&gt;&lt;x&gt;&apos; + [Status] + &apos;&lt;/x&gt;&lt;x&gt;&apos; + cast([DateCreated] AS VARCHAR(20))) + &apos;&lt;/x&gt;&apos; AS XML) AS [tmpRez]\n    FROM DocumentStatusLogs\n    GROUP BY DocumentID\n    ) AS [tmpQry]\n\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"Some database engines* are starting to support the QUALIFY clause that allows to filter the result of window functions (which the accepted answer uses).\nSo the accepted answer can become\nSELECT *, ROW_NUMBER() OVER (PARTITION BY DocumentID ORDER BY DateCreated DESC) AS rn\nFROM DocumentStatusLogs\nQUALIFY rn = 1\n\nSee this article for an in depth explanation: https://jrandrews.net/the-joy-of-qualify\nYou can use this tool to see  which database support this clause: https://www.jooq.org/translate/\nThere is an option to transform the qualify clause when the target dialect does not support it.\n*Teradata, BigQuery, H2, Snowflake...\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"This is the most vanilla TSQL I can come up with\n\n    SELECT * FROM DocumentStatusLogs D1 JOIN\n    (\n      SELECT\n        DocumentID,MAX(DateCreated) AS MaxDate\n      FROM\n        DocumentStatusLogs\n      GROUP BY\n        DocumentID\n    ) D2\n    ON\n      D2.DocumentID=D1.DocumentID\n    AND\n      D2.MaxDate=D1.DateCreated\n\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"My SQL Server Version: 15.x (2019)\nSELECT  TOP 1 WITH TIES\n        DocumentID,\n        GetOnlyTheTop(Status),\n        GetOnlyTheTop(DateCreated)\nFROM DocumentStatusLogs\nGROUP BY DocumentID\nORDER BY ROW_NUMBER() OVER(PARTITION BY DateCreated ORDER BY DateCreated DESC)\n\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"hopefully this will work.. just change the columns as per your db.\nselect\nr2.id,\nr2.name,\nr2.e_date,\nr2.roomcode,\nr2.roomname,\nr2.bedn\nfrom \n(   \n select \n    id,\n    max(e_date) e_date\n    from rooms\n    group by id\n) r1\ninner join rooms r2 on r2.id = r1.id and r2.e_date = r1.e_date;\n\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0},{"text":"It is checked in SQLite that you can use the following simple query with GROUP BY\n\nSELECT MAX(DateCreated), *\nFROM DocumentStatusLogs\nGROUP BY DocumentID\n\n\nHere MAX help to get the maximum DateCreated FROM each group.\n\nBut it seems that MYSQL doesn&apos;t associate *-columns with the value of max DateCreated :(\n    ","url":"/questions/[slug]#solution23","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/08bcc42a26fe5c92.css" as="style"/><link rel="stylesheet" href="/_next/static/css/08bcc42a26fe5c92.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-42cdea76c8170223.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-08d1a634dea6705e.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/150-12e9794e898cd5f3.js" defer=""></script><script src="/_next/static/chunks/490-7f0418bb4354ac73.js" defer=""></script><script src="/_next/static/chunks/108-87de33c23337ff53.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-928c5d1eb8fb0bba.js" defer=""></script><script src="/_next/static/BnkbnjkWYxefPXjTJLVVv/_buildManifest.js" defer=""></script><script src="/_next/static/BnkbnjkWYxefPXjTJLVVv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="wrapper"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/get-top-1-row-of-each-group-1657387438304#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="question my-5"><div class="flex question-header items-center m-auto justify-center"><div class="rounded-xl w-full border p-5 shadow-md bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/get-top-1-row-of-each-group-1657387438304"><h1>Get top 1 row of each group</h1></a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/tsql">tsql</a></div></div><div class="question-content mt-5">
                
<p>I have a table which I want to get the latest entry for each group. Here's the table:</p>

<p><code>DocumentStatusLogs</code> Table</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">|</span>ID<span class="hljs-operator">|</span> DocumentID <span class="hljs-operator">|</span> Status <span class="hljs-operator">|</span> DateCreated <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">2</span><span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">29</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">3</span><span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> S2     <span class="hljs-operator">|</span> <span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">30</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">6</span><span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">02</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">1</span><span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">28</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">4</span><span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> S2     <span class="hljs-operator">|</span> <span class="hljs-number">7</span><span class="hljs-operator">/</span><span class="hljs-number">30</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">5</span><span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> S3     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">01</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">6</span><span class="hljs-operator">|</span> <span class="hljs-number">3</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">02</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
</code></pre>

<p>The table will be grouped by <code>DocumentID</code> and sorted by <code>DateCreated</code> in descending order. For each <code>DocumentID</code>, I want to get the latest status. </p>

<p>My preferred output:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">|</span> DocumentID <span class="hljs-operator">|</span> Status <span class="hljs-operator">|</span> DateCreated <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">02</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> S3     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">01</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">3</span>          <span class="hljs-operator">|</span> S1     <span class="hljs-operator">|</span> <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">02</span><span class="hljs-operator">/</span><span class="hljs-number">2011</span>   <span class="hljs-operator">|</span>
</code></pre>

<ul>
<li><p>Is there any aggregate function to get only the top from each group? See pseudo-code <code>GetOnlyTheTop</code> below:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>
  DocumentID,
  GetOnlyTheTop(Status),
  GetOnlyTheTop(DateCreated)
<span class="hljs-keyword">FROM</span> DocumentStatusLogs
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DocumentID
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>
</code></pre></li>
<li><p>If such function doesn't exist, is there any way I can achieve the output I want?</p></li>
<li>Or at the first place, could this be caused by unnormalized database? I'm thinking, since what I'm looking for is just one row, should that <code>status</code> also be located in the parent table?</li>
</ul>

<p>Please see the parent table for more information:</p>

<p>Current <code>Documents</code> Table</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">|</span> DocumentID <span class="hljs-operator">|</span> Title  <span class="hljs-operator">|</span> Content  <span class="hljs-operator">|</span> DateCreated <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> TitleA <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> TitleB <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">3</span>          <span class="hljs-operator">|</span> TitleC <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span>
</code></pre>

<p>Should the parent table be like this so that I can easily access its status?</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-operator">|</span> DocumentID <span class="hljs-operator">|</span> Title  <span class="hljs-operator">|</span> Content  <span class="hljs-operator">|</span> DateCreated <span class="hljs-operator">|</span> CurrentStatus <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">1</span>          <span class="hljs-operator">|</span> TitleA <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span> s1            <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">2</span>          <span class="hljs-operator">|</span> TitleB <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span> s3            <span class="hljs-operator">|</span>
<span class="hljs-operator">|</span> <span class="hljs-number">3</span>          <span class="hljs-operator">|</span> TitleC <span class="hljs-operator">|</span> ...      <span class="hljs-operator">|</span> ...         <span class="hljs-operator">|</span> s1            <span class="hljs-operator">|</span>
</code></pre>

<p><strong>UPDATE</strong>
I just learned how to use "apply" which makes it easier to address such problems.</p>
    </div></div></div><div class="solution-section"><nav class="flex pagination-solution flex-col justify-end"><ul class="inline-flex -space-x-px overflow-auto"><li class="pagination-solution-item"><span data-id="#solution1" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">1</span></li><li class="pagination-solution-item"><span data-id="#solution2" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">2</span></li><li class="pagination-solution-item"><span data-id="#solution3" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">3</span></li><li class="pagination-solution-item"><span data-id="#solution4" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">4</span></li><li class="pagination-solution-item"><span data-id="#solution5" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">5</span></li><li class="pagination-solution-item"><span data-id="#solution6" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">6</span></li><li class="pagination-solution-item"><span data-id="#solution7" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">7</span></li><li class="pagination-solution-item"><span data-id="#solution8" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">8</span></li><li class="pagination-solution-item"><span data-id="#solution9" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">9</span></li><li class="pagination-solution-item"><span data-id="#solution10" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">10</span></li><li class="pagination-solution-item"><span data-id="#solution11" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">11</span></li><li class="pagination-solution-item"><span data-id="#solution12" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">12</span></li><li class="pagination-solution-item"><span data-id="#solution13" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">13</span></li><li class="pagination-solution-item"><span data-id="#solution14" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">14</span></li><li class="pagination-solution-item"><span data-id="#solution15" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">15</span></li><li class="pagination-solution-item"><span data-id="#solution16" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">16</span></li><li class="pagination-solution-item"><span data-id="#solution17" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">17</span></li><li class="pagination-solution-item"><span data-id="#solution18" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">18</span></li><li class="pagination-solution-item"><span data-id="#solution19" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">19</span></li><li class="pagination-solution-item"><span data-id="#solution20" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">20</span></li><li class="pagination-solution-item"><span data-id="#solution21" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">21</span></li><li class="pagination-solution-item"><span data-id="#solution22" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">22</span></li><li class="pagination-solution-item"><span data-id="#solution23" class="cursor-pointer py-2 px-3 leading-tight text-gray-500 bg-white border border-gray-300 hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">23</span></li></ul></nav><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql">;<span class="hljs-keyword">WITH</span> cte <span class="hljs-keyword">AS</span>
(
   <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>,
         <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
   <span class="hljs-keyword">FROM</span> DocumentStatusLogs
)
<span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> cte
<span class="hljs-keyword">WHERE</span> rn <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
</code></pre>

<p>If you expect 2 entries per day, then this will arbitrarily pick one. To get both entries for a day, use DENSE_RANK instead</p>

<p>As for normalised or not, it depends if you want to:</p>

<ul>
<li>maintain status in 2 places</li>
<li>preserve status history</li>
<li>...</li>
</ul>

<p>As it stands, you preserve status history. If you want latest status in the parent table too (which is denormalisation) you'd need a trigger to maintain "status" in the parent. or drop this status history table.</p>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I just learned how to use <code>cross apply</code>. Here's how to use it in this scenario:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"> <span class="hljs-keyword">select</span> d.DocumentID, ds.Status, ds.DateCreated 
 <span class="hljs-keyword">from</span> Documents <span class="hljs-keyword">as</span> d 
 <span class="hljs-keyword">cross</span> apply 
     (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> Status, DateCreated
      <span class="hljs-keyword">from</span> DocumentStatusLogs 
      <span class="hljs-keyword">where</span> DocumentID <span class="hljs-operator">=</span> d.DocumentId
      <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> DateCreated <span class="hljs-keyword">desc</span>) <span class="hljs-keyword">as</span> ds
</code></pre>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I know this is an old thread but the <code>TOP 1 WITH TIES</code> solutions is quite nice and might be helpful to some reading through the solutions.</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> <span class="hljs-keyword">with</span> ties
   DocumentID
  ,Status
  ,DateCreated
<span class="hljs-keyword">from</span> DocumentStatusLogs
<span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-built_in">row_number</span>() <span class="hljs-keyword">over</span> (<span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> DocumentID <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> DateCreated <span class="hljs-keyword">desc</span>)
</code></pre>
<p>The <code>select top 1 with ties</code> clause tells SQL Server that you want to return the first row per group. But how does SQL Server know how to group up the data? This is where the <code>order by row_number() over (partition by DocumentID order by DateCreated desc</code> comes in. The column/columns after <code>partition by</code> defines how SQL Server groups up the data. Within each group, the rows will be sorted based on the <code>order by</code> columns. Once sorted, the top row in each group will be returned in the query.</p>
<p>More about the TOP clause can be found <a href="https://docs.microsoft.com/en-us/sql/t-sql/queries/top-transact-sql" rel="noreferrer">here</a>.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've done some timings over the various recommendations here, and the results really depend on the size of the table involved, but the most consistent solution is using the CROSS APPLY  These tests were run against SQL Server 2008-R2, using a table with 6,500 records, and another (identical schema) with 137 million records.  The columns being queried are part of the primary key on the table, and the table width is very small (about 30 bytes).  The times are reported by SQL Server from the actual execution plan.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">Query                                  <span class="hljs-type">Time</span> <span class="hljs-keyword">for</span> <span class="hljs-number">6500</span> (ms)    <span class="hljs-type">Time</span> <span class="hljs-keyword">for</span> <span class="hljs-number">137</span>M(ms)

<span class="hljs-keyword">CROSS</span> APPLY                                    <span class="hljs-number">17.9</span>                <span class="hljs-number">17.9</span>
<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">WHERE</span> col <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(COL))           <span class="hljs-number">6.6</span>               <span class="hljs-number">854.4</span>
<span class="hljs-built_in">DENSE_RANK</span>() <span class="hljs-keyword">OVER</span> <span class="hljs-keyword">PARTITION</span>                     <span class="hljs-number">6.6</span>               <span class="hljs-number">907.1</span>
</code></pre>

<p>I think the really amazing thing was how consistent the time was for the CROSS APPLY regardless of the number of rows involved.</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you're worried about performance, you can also do this with MAX():</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> DocumentStatusLogs D
<span class="hljs-keyword">WHERE</span> DateCreated <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(DateCreated) <span class="hljs-keyword">FROM</span> DocumentStatusLogs <span class="hljs-keyword">WHERE</span> ID <span class="hljs-operator">=</span> D.ID)
</code></pre>

<p>ROW_NUMBER() requires a sort of all the rows in your SELECT statement, whereas MAX does not. Should drastically speed up your query.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span>
DocumentStatusLogs <span class="hljs-keyword">JOIN</span> (
  <span class="hljs-keyword">SELECT</span> DocumentID, <span class="hljs-built_in">MAX</span>(DateCreated) DateCreated
  <span class="hljs-keyword">FROM</span> DocumentStatusLogs
  <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DocumentID
  ) max_date <span class="hljs-keyword">USING</span> (DocumentID, DateCreated)
</code></pre>

<p>What database server? This code doesn't work on all of them.</p>

<p>Regarding the second half of your question, it seems reasonable to me to include the status as a column. You can leave <code>DocumentStatusLogs</code> as a log, but still store the latest info in the main table.</p>

<p>BTW, if you already have the <code>DateCreated</code> column in the Documents table you can just join <code>DocumentStatusLogs</code> using that (as long as <code>DateCreated</code> is unique in <code>DocumentStatusLogs</code>).</p>

<p>Edit: MsSQL does not support USING, so change it to:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">ON</span> DocumentStatusLogs.DocumentID <span class="hljs-operator">=</span> max_date.DocumentID <span class="hljs-keyword">AND</span> DocumentStatusLogs.DateCreated <span class="hljs-operator">=</span> max_date.DateCreated
</code></pre>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is one of the most easily found question on the topic, so I wanted to give a modern answer to the it (both for my reference and to help others out). By using <code>first_value</code> and <code>over</code> you can make short work of the above query:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">Select</span> <span class="hljs-keyword">distinct</span> DocumentID
  , <span class="hljs-built_in">first_value</span>(status) <span class="hljs-keyword">over</span> (<span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> DocumentID <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> DateCreated <span class="hljs-keyword">Desc</span>) <span class="hljs-keyword">as</span> Status
  , <span class="hljs-built_in">first_value</span>(DateCreated) <span class="hljs-keyword">over</span> (<span class="hljs-keyword">partition</span> <span class="hljs-keyword">by</span> DocumentID <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> DateCreated <span class="hljs-keyword">Desc</span>) <span class="hljs-keyword">as</span> DateCreated
<span class="hljs-keyword">From</span> DocumentStatusLogs
</code></pre>

<p>This should work in Sql Server 2008 and up. <code>First_value</code> can be thought of as a way to accomplish <code>Select Top 1</code> when using an <code>over</code> clause. <code>Over</code> allows grouping in the select list so instead of writing nested subqueries (like many of the existing answers do), this does it in a more readable fashion. Hope this helps.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here are 3 separate approaches to the problem in hand along with the best choices of indexing for each of those queries (please try out the indexes yourselves and see the logical read, elapsed time, execution plan. I have provided the suggestions from my experience on such queries without executing for this specific problem).</p>

<p><strong>Approach 1</strong>: Using ROW_NUMBER(). If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">;<span class="hljs-keyword">WITH</span> CTE <span class="hljs-keyword">AS</span>
    (
       <span class="hljs-keyword">SELECT</span>   <span class="hljs-operator">*</span>,
                RN <span class="hljs-operator">=</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>)
       <span class="hljs-keyword">FROM</span>     DocumentStatusLogs
    )
    <span class="hljs-keyword">SELECT</span>  ID      
        ,DocumentID 
        ,Status     
        ,DateCreated
    <span class="hljs-keyword">FROM</span>    CTE
    <span class="hljs-keyword">WHERE</span>   RN <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>

<p><strong>Approach 2</strong>: Using FIRST_VALUE. If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>  <span class="hljs-keyword">DISTINCT</span>
    ID      <span class="hljs-operator">=</span> <span class="hljs-built_in">FIRST_VALUE</span>(ID) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>)
    ,DocumentID
    ,Status     <span class="hljs-operator">=</span> <span class="hljs-built_in">FIRST_VALUE</span>(Status) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>)
    ,DateCreated    <span class="hljs-operator">=</span> <span class="hljs-built_in">FIRST_VALUE</span>(DateCreated) <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>)
<span class="hljs-keyword">FROM</span>    DocumentStatusLogs;
</code></pre>

<p><strong>Approach 3</strong>: Using CROSS APPLY. Creating rowstore index on DocumentStatusLogs table covering the columns used in the query should be enough to cover the query without need of a columnstore index.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>  <span class="hljs-keyword">DISTINCT</span>
    ID      <span class="hljs-operator">=</span> CA.ID
    ,DocumentID <span class="hljs-operator">=</span> D.DocumentID
    ,Status     <span class="hljs-operator">=</span> CA.Status 
    ,DateCreated    <span class="hljs-operator">=</span> CA.DateCreated
<span class="hljs-keyword">FROM</span>    DocumentStatusLogs D
    <span class="hljs-keyword">CROSS</span> APPLY (
            <span class="hljs-keyword">SELECT</span>  TOP <span class="hljs-number">1</span> I.<span class="hljs-operator">*</span>
            <span class="hljs-keyword">FROM</span>    DocumentStatusLogs I
            <span class="hljs-keyword">WHERE</span>   I.DocumentID <span class="hljs-operator">=</span> D.DocumentID
            <span class="hljs-keyword">ORDER</span>   <span class="hljs-keyword">BY</span> I.DateCreated <span class="hljs-keyword">DESC</span>
            ) CA;
</code></pre>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is quite an old thread, but I thought I'd throw my two cents in just the same as the accepted answer didn't work particularly well for me.  I tried gbn's solution on a large dataset and found it to be terribly slow (&gt;45 seconds on 5 million plus records in SQL Server 2012).  Looking at the execution plan it's obvious that the issue is that it requires a SORT operation which slows things down significantly.</p>

<p>Here's an alternative that I lifted from the entity framework that needs no SORT operation and does a NON-Clustered Index search.  This reduces the execution time down to &lt; 2 seconds on the aforementioned record set.</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
[Limit1].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], 
[Limit1].[Status] <span class="hljs-keyword">AS</span> [Status], 
[Limit1].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
<span class="hljs-keyword">FROM</span>   (<span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> [Extent1].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID] <span class="hljs-keyword">FROM</span> [dbo].[DocumentStatusLogs] <span class="hljs-keyword">AS</span> [Extent1]) <span class="hljs-keyword">AS</span> [Distinct1]
<span class="hljs-keyword">OUTER</span> APPLY  (<span class="hljs-keyword">SELECT</span> TOP (<span class="hljs-number">1</span>) [Project2].[ID] <span class="hljs-keyword">AS</span> [ID], [Project2].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], [Project2].[Status] <span class="hljs-keyword">AS</span> [Status], [Project2].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
    <span class="hljs-keyword">FROM</span> (<span class="hljs-keyword">SELECT</span> 
        [Extent2].[ID] <span class="hljs-keyword">AS</span> [ID], 
        [Extent2].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], 
        [Extent2].[Status] <span class="hljs-keyword">AS</span> [Status], 
        [Extent2].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
        <span class="hljs-keyword">FROM</span> [dbo].[DocumentStatusLogs] <span class="hljs-keyword">AS</span> [Extent2]
        <span class="hljs-keyword">WHERE</span> ([Distinct1].[DocumentID] <span class="hljs-operator">=</span> [Extent2].[DocumentID])
    )  <span class="hljs-keyword">AS</span> [Project2]
    <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [Project2].[ID] <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> [Limit1]
</code></pre>

<p>Now I'm assuming something that isn't entirely specified in the original question, but if your table design is such that your ID column is an auto-increment ID, and the DateCreated is set to the current date with each insert, then even without running with my query above you could actually get a sizable performance boost to gbn's solution (about half the execution time) just from <strong>ordering on ID instead of ordering on DateCreated</strong> as this will provide an identical sort order and it's a faster sort.</p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My code to select top 1 from each group</p>

<pre>select a.* from #DocumentStatusLogs a where 
 datecreated in( select top 1 datecreated from #DocumentStatusLogs b
where 
a.documentid = b.documentid
order by datecreated desc
)
</pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This solution can be used to get the TOP N most recent rows for each partition (in the example, N is 1 in the WHERE statement and partition is doc_id):</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> T.doc_id, T.status, T.date_created <span class="hljs-keyword">FROM</span> 
(
    <span class="hljs-keyword">SELECT</span> a.<span class="hljs-operator">*</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> doc_id <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> date_created <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rnk <span class="hljs-keyword">FROM</span> doc a
) T
<span class="hljs-keyword">WHERE</span> T.rnk <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>CROSS APPLY</code> was the method I used for my solution, as it worked for me, and for my clients needs. And from what I've read, should provide the best overall performance should their database grow substantially.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Verifying Clint's awesome and correct answer from above:</p>
<p>The performance between the two queries below is interesting. 52% being the top one. And 48% being the second one. A 4% improvement in performance using DISTINCT instead of ORDER BY. But ORDER BY has the advantage to sort by multiple columns.</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql">IF (OBJECT_ID(<span class="hljs-string">'tempdb..#DocumentStatusLogs'</span>) <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>) <span class="hljs-keyword">BEGIN</span> <span class="hljs-keyword">DROP</span> <span class="hljs-keyword">TABLE</span> #DocumentStatusLogs <span class="hljs-keyword">END</span>

<span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> #DocumentStatusLogs (
    [ID] <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    [DocumentID] <span class="hljs-type">int</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>,
    [Status] <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>),
    [DateCreated] datetime
)

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'7/29/2011 1:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'7/30/2011 2:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">6</span>, <span class="hljs-number">1</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'8/02/2011 3:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'7/28/2011 4:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'7/30/2011 5:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'8/01/2011 6:00:00'</span>)
<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'8/02/2011 7:00:00'</span>)
</code></pre>
<p>Option 1:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">SELECT</span>
    [Extent1].[ID], 
    [Extent1].[DocumentID],
    [Extent1].[Status], 
    [Extent1].[DateCreated]
<span class="hljs-keyword">FROM</span> #DocumentStatusLogs <span class="hljs-keyword">AS</span> [Extent1]
    <span class="hljs-keyword">OUTER</span> APPLY (
        <span class="hljs-keyword">SELECT</span> TOP <span class="hljs-number">1</span>
            [Extent2].[ID], 
            [Extent2].[DocumentID],
            [Extent2].[Status], 
            [Extent2].[DateCreated]
        <span class="hljs-keyword">FROM</span> #DocumentStatusLogs <span class="hljs-keyword">AS</span> [Extent2]
        <span class="hljs-keyword">WHERE</span> [Extent1].[DocumentID] <span class="hljs-operator">=</span> [Extent2].[DocumentID]
        <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [Extent2].[DateCreated] <span class="hljs-keyword">DESC</span>, [Extent2].[ID] <span class="hljs-keyword">DESC</span>
    ) <span class="hljs-keyword">AS</span> [Project2]
<span class="hljs-keyword">WHERE</span> ([Project2].[ID] <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NULL</span> <span class="hljs-keyword">OR</span> [Project2].[ID] <span class="hljs-operator">=</span> [Extent1].[ID])
</code></pre>
<p>Option 2:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> 
    [Limit1].[DocumentID] <span class="hljs-keyword">AS</span> [ID], 
    [Limit1].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], 
    [Limit1].[Status] <span class="hljs-keyword">AS</span> [Status], 
    [Limit1].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">DISTINCT</span> [Extent1].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID] <span class="hljs-keyword">FROM</span> #DocumentStatusLogs <span class="hljs-keyword">AS</span> [Extent1]
) <span class="hljs-keyword">AS</span> [Distinct1]
    <span class="hljs-keyword">OUTER</span> APPLY  (
        <span class="hljs-keyword">SELECT</span> TOP (<span class="hljs-number">1</span>) [Project2].[ID] <span class="hljs-keyword">AS</span> [ID], [Project2].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], [Project2].[Status] <span class="hljs-keyword">AS</span> [Status], [Project2].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
        <span class="hljs-keyword">FROM</span> (
            <span class="hljs-keyword">SELECT</span> 
                [Extent2].[ID] <span class="hljs-keyword">AS</span> [ID], 
                [Extent2].[DocumentID] <span class="hljs-keyword">AS</span> [DocumentID], 
                [Extent2].[Status] <span class="hljs-keyword">AS</span> [Status], 
                [Extent2].[DateCreated] <span class="hljs-keyword">AS</span> [DateCreated]
            <span class="hljs-keyword">FROM</span> #DocumentStatusLogs <span class="hljs-keyword">AS</span> [Extent2]
            <span class="hljs-keyword">WHERE</span> [Distinct1].[DocumentID] <span class="hljs-operator">=</span> [Extent2].[DocumentID]
        )  <span class="hljs-keyword">AS</span> [Project2]
        <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> [Project2].[ID] <span class="hljs-keyword">DESC</span>
    ) <span class="hljs-keyword">AS</span> [Limit1]
</code></pre>
<p>In Microsoft SQL Server Management Studio: after highlighting and running the first block, highlight both Option 1 and Option 2, right click -&gt; [Display Estimated Execution Plan]. Then run the entire thing to see the results.</p>
<p>Option 1 Results:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql">ID  DocumentID  Status  DateCreated
<span class="hljs-number">6</span>   <span class="hljs-number">1</span>   S1  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">3</span>:<span class="hljs-number">00</span>
<span class="hljs-number">5</span>   <span class="hljs-number">2</span>   S3  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">6</span>:<span class="hljs-number">00</span>
<span class="hljs-number">6</span>   <span class="hljs-number">3</span>   S1  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">7</span>:<span class="hljs-number">00</span>
</code></pre>
<p>Option 2 Results:</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql">ID  DocumentID  Status  DateCreated
<span class="hljs-number">6</span>   <span class="hljs-number">1</span>   S1  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">3</span>:<span class="hljs-number">00</span>
<span class="hljs-number">5</span>   <span class="hljs-number">2</span>   S3  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">1</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">6</span>:<span class="hljs-number">00</span>
<span class="hljs-number">6</span>   <span class="hljs-number">3</span>   S1  <span class="hljs-number">8</span><span class="hljs-operator">/</span><span class="hljs-number">2</span><span class="hljs-operator">/</span><span class="hljs-number">11</span> <span class="hljs-number">7</span>:<span class="hljs-number">00</span>
</code></pre>
<p>Note:</p>
<blockquote>
<p>I tend to use APPLY when I want a join to be 1-to-(1 of many).</p>
<p>I use a JOIN if I want the join to be 1-to-many, or many-to-many.</p>
<p>I avoid CTE with ROW_NUMBER() unless I need to do something advanced and am ok with the windowing performance penalty.</p>
</blockquote>
<p>I also avoid EXISTS / IN subqueries in the WHERE or ON clause, as I have experienced this causing some terrible execution plans. But mileage varies. Review the execution plan and profile performance where and when needed!</p>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> o.<span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> `DocumentStatusLogs` o                   
  <span class="hljs-keyword">LEFT</span> <span class="hljs-keyword">JOIN</span> `DocumentStatusLogs` b                   
  <span class="hljs-keyword">ON</span> o.DocumentID <span class="hljs-operator">=</span> b.DocumentID <span class="hljs-keyword">AND</span> o.DateCreated <span class="hljs-operator">&lt;</span> b.DateCreated
 <span class="hljs-keyword">WHERE</span> b.DocumentID <span class="hljs-keyword">is</span> <span class="hljs-keyword">NULL</span> ;
</code></pre>

<p>If you want to return only recent document order by DateCreated, it will return only top 1 document by DocumentID</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I believe this can be done just like this. This might need some tweaking but you can just select the max from the group.</p>
<p>These answers are overkill..</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>
  d.DocumentID,
  <span class="hljs-built_in">MAX</span>(d.Status),
  <span class="hljs-built_in">MAX</span>(d1.DateCreated)
<span class="hljs-keyword">FROM</span> DocumentStatusLogs d, DocumentStatusLogs d1
<span class="hljs-keyword">USING</span> DocumentID
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">1</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-number">3</span> <span class="hljs-keyword">DESC</span>
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In scenarios where you want to avoid using row_count(), you can also use a left join:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> ds.DocumentID, ds.Status, ds.DateCreated 
<span class="hljs-keyword">from</span> DocumentStatusLogs ds
<span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> DocumentStatusLogs <span class="hljs-keyword">filter</span> 
    <span class="hljs-keyword">ON</span> ds.DocumentID <span class="hljs-operator">=</span> filter.DocumentID
    <span class="hljs-comment">-- Match any row that has another row that was created after it.</span>
    <span class="hljs-keyword">AND</span> ds.DateCreated <span class="hljs-operator">&lt;</span> filter.DateCreated
<span class="hljs-comment">-- then filter out any rows that matched </span>
<span class="hljs-keyword">where</span> filter.DocumentID <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span> 
</code></pre>

<p>For the example schema, you could also use a "not in subquery", which generally compiles to the same output as the left join: </p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span> ds.DocumentID, ds.Status, ds.DateCreated 
<span class="hljs-keyword">from</span> DocumentStatusLogs ds
<span class="hljs-keyword">WHERE</span> ds.ID <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">IN</span> (
    <span class="hljs-keyword">SELECT</span> filter.ID 
    <span class="hljs-keyword">FROM</span> DocumentStatusLogs <span class="hljs-keyword">filter</span>
    <span class="hljs-keyword">WHERE</span> ds.DocumentID <span class="hljs-operator">=</span> filter.DocumentID
        <span class="hljs-keyword">AND</span> ds.DateCreated <span class="hljs-operator">&lt;</span> filter.DateCreated)
</code></pre>

<p>Note, the subquery pattern wouldn't work if the table didn't have at least one single-column unique key/constraint/index, in this case the primary key "Id".</p>

<p>Both of these queries tend to be more "expensive" than the row_count() query (as measured by Query Analyzer).  However, you might encounter scenarios where they return results faster or enable other optimizations.</p>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> documentid, 
       status, 
       datecreated 
<span class="hljs-keyword">FROM</span>   documentstatuslogs dlogs 
<span class="hljs-keyword">WHERE</span>  status <span class="hljs-operator">=</span> (<span class="hljs-keyword">SELECT</span> status 
                 <span class="hljs-keyword">FROM</span>   documentstatuslogs 
                 <span class="hljs-keyword">WHERE</span>  documentid <span class="hljs-operator">=</span> dlogs.documentid 
                 <span class="hljs-keyword">ORDER</span>  <span class="hljs-keyword">BY</span> datecreated <span class="hljs-keyword">DESC</span> 
                 LIMIT  <span class="hljs-number">1</span>) 
</code></pre>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try this:</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> [DocumentID]
    ,[tmpRez].<span class="hljs-keyword">value</span>(<span class="hljs-string">'/x[2]'</span>, <span class="hljs-string">'varchar(20)'</span>) <span class="hljs-keyword">AS</span> [Status]
    ,[tmpRez].<span class="hljs-keyword">value</span>(<span class="hljs-string">'/x[3]'</span>, <span class="hljs-string">'datetime'</span>) <span class="hljs-keyword">AS</span> [DateCreated]
<span class="hljs-keyword">FROM</span> (
    <span class="hljs-keyword">SELECT</span> [DocumentID]
        ,<span class="hljs-built_in">cast</span>(<span class="hljs-string">'&lt;x&gt;'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">max</span>(<span class="hljs-built_in">cast</span>([ID] <span class="hljs-keyword">AS</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">10</span>)) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/x&gt;&lt;x&gt;'</span> <span class="hljs-operator">+</span> [Status] <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/x&gt;&lt;x&gt;'</span> <span class="hljs-operator">+</span> <span class="hljs-built_in">cast</span>([DateCreated] <span class="hljs-keyword">AS</span> <span class="hljs-type">VARCHAR</span>(<span class="hljs-number">20</span>))) <span class="hljs-operator">+</span> <span class="hljs-string">'&lt;/x&gt;'</span> <span class="hljs-keyword">AS</span> XML) <span class="hljs-keyword">AS</span> [tmpRez]
    <span class="hljs-keyword">FROM</span> DocumentStatusLogs
    <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DocumentID
    ) <span class="hljs-keyword">AS</span> [tmpQry]
</code></pre>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Some database engines* are starting to support the <code>QUALIFY</code> clause that allows to filter the result of window functions (which the accepted answer uses).</p>
<p>So the accepted answer can become</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>, <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span> (<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DocumentID <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>) <span class="hljs-keyword">AS</span> rn
<span class="hljs-keyword">FROM</span> DocumentStatusLogs
QUALIFY rn <span class="hljs-operator">=</span> <span class="hljs-number">1</span>
</code></pre>
<p>See this article for an in depth explanation: <a href="https://jrandrews.net/the-joy-of-qualify" rel="nofollow noreferrer">https://jrandrews.net/the-joy-of-qualify</a></p>
<p>You can use this tool to see  which database support this clause: <a href="https://www.jooq.org/translate/" rel="nofollow noreferrer">https://www.jooq.org/translate/</a>
There is an option to transform the qualify clause when the target dialect does not support it.</p>
<p>*Teradata, BigQuery, H2, Snowflake...</p>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is the most vanilla TSQL I can come up with</p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql">    <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> DocumentStatusLogs D1 <span class="hljs-keyword">JOIN</span>
    (
      <span class="hljs-keyword">SELECT</span>
        DocumentID,<span class="hljs-built_in">MAX</span>(DateCreated) <span class="hljs-keyword">AS</span> MaxDate
      <span class="hljs-keyword">FROM</span>
        DocumentStatusLogs
      <span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span>
        DocumentID
    ) D2
    <span class="hljs-keyword">ON</span>
      D2.DocumentID<span class="hljs-operator">=</span>D1.DocumentID
    <span class="hljs-keyword">AND</span>
      D2.MaxDate<span class="hljs-operator">=</span>D1.DateCreated
</code></pre>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>My SQL Server Version: 15.x (2019)</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span>  TOP <span class="hljs-number">1</span> <span class="hljs-keyword">WITH</span> TIES
        DocumentID,
        GetOnlyTheTop(Status),
        GetOnlyTheTop(DateCreated)
<span class="hljs-keyword">FROM</span> DocumentStatusLogs
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DocumentID
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> <span class="hljs-built_in">ROW_NUMBER</span>() <span class="hljs-keyword">OVER</span>(<span class="hljs-keyword">PARTITION</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> DateCreated <span class="hljs-keyword">DESC</span>)
</code></pre>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>hopefully this will work.. just change the columns as per your db.</p>
<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">select</span>
r2.id,
r2.name,
r2.e_date,
r2.roomcode,
r2.roomname,
r2.bedn
<span class="hljs-keyword">from</span> 
(   
 <span class="hljs-keyword">select</span> 
    id,
    <span class="hljs-built_in">max</span>(e_date) e_date
    <span class="hljs-keyword">from</span> rooms
    <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> id
) r1
<span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> rooms r2 <span class="hljs-keyword">on</span> r2.id <span class="hljs-operator">=</span> r1.id <span class="hljs-keyword">and</span> r2.e_date <span class="hljs-operator">=</span> r1.e_date;
</code></pre>
    </div></div></div></div><div id="solution23" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl solution-inner border md:px-10 md:py-10 px-2 py-10 shadow-md bg-white"><div style="display:flex;justify-content:space-between"><h4 class="text-4xl font-semibold mb-5">Solution 23</h4><div class="tags-wrap h-max space-x-8"><div class="tags"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold whitespace-nowrap" href="/questions/tag/tsql">tsql</a></div></div></div><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It is checked in SQLite that you can use the following simple query with <em>GROUP BY</em></p>

<pre class="lang-sql s-code-block"><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> <span class="hljs-built_in">MAX</span>(DateCreated), <span class="hljs-operator">*</span>
<span class="hljs-keyword">FROM</span> DocumentStatusLogs
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> DocumentID
</code></pre>

<p>Here <em>MAX</em> help to get the maximum <em>DateCreated</em> FROM each group.</p>

<p>But it seems that MYSQL doesn't associate *-columns with the value of max DateCreated :(</p>
    </div></div></div></div></div></div><div class="widget"><a href="/questions/how-do-i-set-clear-and-toggle-a-single-bit-1657388227052">How do I set, clear, and toggle a single bit?</a><a href="/questions/how-to-create-a-guid-uuid-1657387749530">How to create a GUID / UUID</a><a href="/questions/how-to-deal-with-floating-point-number-precision-in-javascript-1657387293762">How to deal with floating point number precision in JavaScript?</a><a href="/questions/does-javascript-guarantee-object-property-order-1657384822587">Does JavaScript guarantee object property order?</a><a href="/questions/safely-turning-a-json-string-into-an-object-1657388194824">Safely turning a JSON string into an object</a><a href="/questions/how-do-i-return-the-response-from-an-asynchronous-call-1657384208012">How do I return the response from an asynchronous call?</a><a href="/questions/why-does-std::getline()-skip-input-after-a-formatted-extraction-1657384756118">Why does std::getline() skip input after a formatted extraction?</a><a href="/questions/what-is-object-slicing-1657384506425">What is object slicing?</a><a href="/questions/post-an-html-table-to-ado.net-datatable-1657387462723">Post an HTML Table to ADO.NET DataTable</a><a href="/questions/example-images-for-code-and-mark-up-qandas-closed-1657387690222">Example images for code and mark-up Q&amp;As [closed]</a><a href="/questions/how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-.gitignore-1657387328843">How do I make Git forget about a file that was tracked, but is now in .gitignore?</a><a href="/questions/how-to-check-if-element-is-visible-after-scrolling-1657387987960">How to check if element is visible after scrolling?</a><a href="/questions/why-not-use-tables-for-layout-in-html-closed-1657387752327">Why not use tables for layout in HTML? [closed]</a><a href="/questions/convert-columns-into-rows-with-pandas-1657388374964">Convert columns into rows with Pandas</a><a href="/questions/why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233">Why does Tkinter image not show up if created in a function?</a><a href="/questions/remove-duplicate-values-from-js-array-duplicate-1657387801931">Remove duplicate values from JS array [duplicate]</a><a href="/questions/how-does-access-control-allow-origin-header-work-1657384881723">How does Access-Control-Allow-Origin header work?</a><a href="/questions/object-comparison-in-javascript-duplicate-1657387675463">Object comparison in JavaScript [duplicate]</a><a href="/questions/convert-rows-to-columns-using-&#x27;pivot&#x27;-in-sql-server-1657388372528">Convert Rows to columns using &#x27;Pivot&#x27; in SQL Server</a><a href="/questions/mysql-pivot-row-into-dynamic-number-of-columns-1657387981930">MySQL pivot row into dynamic number of columns</a></div></div><span class="cursor-pointer text-lg p-2" style="position:fixed;bottom:20px;left:20px;background:#000;z-index:2000;color:white">Go go top</span></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; cte \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n(\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;,\n         \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rn\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; cte\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you expect 2 entries per day, then this will arbitrarily pick one. To get both entries for a day, use DENSE_RANK instead\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;As for normalised or not, it depends if you want to:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;maintain status in 2 places\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;preserve status history\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;...\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;As it stands, you preserve status history. If you want latest status in the parent table too (which is denormalisation) you\u0026apos;d need a trigger to maintain \u0026quot;status\u0026quot; in the parent. or drop this status history table.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I just learned how to use \u0026lt;code\u0026gt;cross apply\u0026lt;/code\u0026gt;. Here\u0026apos;s how to use it in this scenario:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; d.DocumentID, ds.Status, ds.DateCreated \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; Documents \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; d \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;cross\u0026lt;/span\u0026gt; apply \n     (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; top \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; Status, DateCreated\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; DocumentStatusLogs \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; d.DocumentId\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;desc\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ds\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I know this is an old thread but the \u0026lt;code\u0026gt;TOP 1 WITH TIES\u0026lt;/code\u0026gt; solutions is quite nice and might be helpful to some reading through the solutions.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; top \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;with\u0026lt;/span\u0026gt; ties\n   DocumentID\n  ,Status\n  ,DateCreated\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; DocumentStatusLogs\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;row_number\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partition\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;desc\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;select top 1 with ties\u0026lt;/code\u0026gt; clause tells SQL Server that you want to return the first row per group. But how does SQL Server know how to group up the data? This is where the \u0026lt;code\u0026gt;order by row_number() over (partition by DocumentID order by DateCreated desc\u0026lt;/code\u0026gt; comes in. The column/columns after \u0026lt;code\u0026gt;partition by\u0026lt;/code\u0026gt; defines how SQL Server groups up the data. Within each group, the rows will be sorted based on the \u0026lt;code\u0026gt;order by\u0026lt;/code\u0026gt; columns. Once sorted, the top row in each group will be returned in the query.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;More about the TOP clause can be found \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/sql/t-sql/queries/top-transact-sql\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve done some timings over the various recommendations here, and the results really depend on the size of the table involved, but the most consistent solution is using the CROSS APPLY  These tests were run against SQL Server 2008-R2, using a table with 6,500 records, and another (identical schema) with 137 million records.  The columns being queried are part of the primary key on the table, and the table width is very small (about 30 bytes).  The times are reported by SQL Server from the actual execution plan.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;Query                                  \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Time\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6500\u0026lt;/span\u0026gt; (ms)    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Time\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;137\u0026lt;/span\u0026gt;M(ms)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY                                    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17.9\u0026lt;/span\u0026gt;                \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17.9\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; col \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(COL))           \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.6\u0026lt;/span\u0026gt;               \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;854.4\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;DENSE_RANK\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt;                     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6.6\u0026lt;/span\u0026gt;               \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;907.1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I think the really amazing thing was how consistent the time was for the CROSS APPLY regardless of the number of rows involved.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you\u0026apos;re worried about performance, you can also do this with MAX():\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs D\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(DateCreated) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; D.ID)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;ROW_NUMBER() requires a sort of all the rows in your SELECT statement, whereas MAX does not. Should drastically speed up your query.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\nDocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; (\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; DocumentID, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(DateCreated) DateCreated\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID\n  ) max_date \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;USING\u0026lt;/span\u0026gt; (DocumentID, DateCreated)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What database server? This code doesn\u0026apos;t work on all of them.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Regarding the second half of your question, it seems reasonable to me to include the status as a column. You can leave \u0026lt;code\u0026gt;DocumentStatusLogs\u0026lt;/code\u0026gt; as a log, but still store the latest info in the main table.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;BTW, if you already have the \u0026lt;code\u0026gt;DateCreated\u0026lt;/code\u0026gt; column in the Documents table you can just join \u0026lt;code\u0026gt;DocumentStatusLogs\u0026lt;/code\u0026gt; using that (as long as \u0026lt;code\u0026gt;DateCreated\u0026lt;/code\u0026gt; is unique in \u0026lt;code\u0026gt;DocumentStatusLogs\u0026lt;/code\u0026gt;).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Edit: MsSQL does not support USING, so change it to:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; DocumentStatusLogs.DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; max_date.DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; DocumentStatusLogs.DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; max_date.DateCreated\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is one of the most easily found question on the topic, so I wanted to give a modern answer to the it (both for my reference and to help others out). By using \u0026lt;code\u0026gt;first_value\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;over\u0026lt;/code\u0026gt; you can make short work of the above query:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Select\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;distinct\u0026lt;/span\u0026gt; DocumentID\n  , \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;first_value\u0026lt;/span\u0026gt;(status) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partition\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Desc\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Status\n  , \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;first_value\u0026lt;/span\u0026gt;(DateCreated) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;over\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partition\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;order\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Desc\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; DateCreated\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;From\u0026lt;/span\u0026gt; DocumentStatusLogs\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This should work in Sql Server 2008 and up. \u0026lt;code\u0026gt;First_value\u0026lt;/code\u0026gt; can be thought of as a way to accomplish \u0026lt;code\u0026gt;Select Top 1\u0026lt;/code\u0026gt; when using an \u0026lt;code\u0026gt;over\u0026lt;/code\u0026gt; clause. \u0026lt;code\u0026gt;Over\u0026lt;/code\u0026gt; allows grouping in the select list so instead of writing nested subqueries (like many of the existing answers do), this does it in a more readable fashion. Hope this helps.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here are 3 separate approaches to the problem in hand along with the best choices of indexing for each of those queries (please try out the indexes yourselves and see the logical read, elapsed time, execution plan. I have provided the suggestions from my experience on such queries without executing for this specific problem).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Approach 1\u0026lt;/strong\u0026gt;: Using ROW_NUMBER(). If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; CTE \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt;\n    (\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;,\n                RN \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;)\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;     DocumentStatusLogs\n    )\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  ID      \n        ,DocumentID \n        ,Status     \n        ,DateCreated\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;    CTE\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;   RN \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Approach 2\u0026lt;/strong\u0026gt;: Using FIRST_VALUE. If rowstore index is not being able to enhance the performance, you can try out nonclustered/clustered columnstore index as for queries with aggregation and grouping and for tables which are ordered by in different columns all the times, columnstore index usually is the best choice.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt;\n    ID      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;FIRST_VALUE\u0026lt;/span\u0026gt;(ID) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;)\n    ,DocumentID\n    ,Status     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;FIRST_VALUE\u0026lt;/span\u0026gt;(Status) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;)\n    ,DateCreated    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;FIRST_VALUE\u0026lt;/span\u0026gt;(DateCreated) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;    DocumentStatusLogs;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Approach 3\u0026lt;/strong\u0026gt;: Using CROSS APPLY. Creating rowstore index on DocumentStatusLogs table covering the columns used in the query should be enough to cover the query without need of a columnstore index.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt;\n    ID      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CA.ID\n    ,DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; D.DocumentID\n    ,Status     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CA.Status \n    ,DateCreated    \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; CA.DateCreated\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;    DocumentStatusLogs D\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CROSS\u0026lt;/span\u0026gt; APPLY (\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  TOP \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; I.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;    DocumentStatusLogs I\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;   I.DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; D.DocumentID\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; I.DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n            ) CA;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is quite an old thread, but I thought I\u0026apos;d throw my two cents in just the same as the accepted answer didn\u0026apos;t work particularly well for me.  I tried gbn\u0026apos;s solution on a large dataset and found it to be terribly slow (\u0026amp;gt;45 seconds on 5 million plus records in SQL Server 2012).  Looking at the execution plan it\u0026apos;s obvious that the issue is that it requires a SORT operation which slows things down significantly.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here\u0026apos;s an alternative that I lifted from the entity framework that needs no SORT operation and does a NON-Clustered Index search.  This reduces the execution time down to \u0026amp;lt; 2 seconds on the aforementioned record set.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n[Limit1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], \n[Limit1].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], \n[Limit1].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt; [Extent1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; [dbo].[DocumentStatusLogs] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent1]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Distinct1]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OUTER\u0026lt;/span\u0026gt; APPLY  (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; TOP (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) [Project2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [ID], [Project2].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], [Project2].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], [Project2].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n        [Extent2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [ID], \n        [Extent2].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], \n        [Extent2].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], \n        [Extent2].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; [dbo].[DocumentStatusLogs] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent2]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ([Distinct1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [Extent2].[DocumentID])\n    )  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Project2]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [Project2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Limit1]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Now I\u0026apos;m assuming something that isn\u0026apos;t entirely specified in the original question, but if your table design is such that your ID column is an auto-increment ID, and the DateCreated is set to the current date with each insert, then even without running with my query above you could actually get a sizable performance boost to gbn\u0026apos;s solution (about half the execution time) just from \u0026lt;strong\u0026gt;ordering on ID instead of ordering on DateCreated\u0026lt;/strong\u0026gt; as this will provide an identical sort order and it\u0026apos;s a faster sort.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My code to select top 1 from each group\u0026lt;/p\u0026gt;\n\n\u0026lt;pre\u0026gt;select a.* from #DocumentStatusLogs a where \n datecreated in( select top 1 datecreated from #DocumentStatusLogs b\nwhere \na.documentid = b.documentid\norder by datecreated desc\n)\n\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This solution can be used to get the TOP N most recent rows for each partition (in the example, N is 1 in the WHERE statement and partition is doc_id):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; T.doc_id, T.status, T.date_created \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; \n(\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; doc_id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; date_created \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rnk \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; doc a\n) T\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; T.rnk \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;CROSS APPLY\u0026lt;/code\u0026gt; was the method I used for my solution, as it worked for me, and for my clients needs. And from what I\u0026apos;ve read, should provide the best overall performance should their database grow substantially.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Verifying Clint\u0026apos;s awesome and correct answer from above:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The performance between the two queries below is interesting. 52% being the top one. And 48% being the second one. A 4% improvement in performance using DISTINCT instead of ORDER BY. But ORDER BY has the advantage to sort by multiple columns.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;IF (OBJECT_ID(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;tempdb..#DocumentStatusLogs\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BEGIN\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DROP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; #DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;END\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;CREATE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;TABLE\u0026lt;/span\u0026gt; #DocumentStatusLogs (\n    [ID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n    [DocumentID] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt;,\n    [Status] \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;varchar\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;),\n    [DateCreated] datetime\n)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;7/29/2011 1:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;7/30/2011 2:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;8/02/2011 3:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;7/28/2011 4:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;7/30/2011 5:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;8/01/2011 6:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INSERT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;INTO\u0026lt;/span\u0026gt; #DocumentStatusLogs([ID], [DocumentID], [Status], [DateCreated]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;VALUES\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;8/02/2011 7:00:00\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Option 1:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n    [Extent1].[ID], \n    [Extent1].[DocumentID],\n    [Extent1].[Status], \n    [Extent1].[DateCreated]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent1]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OUTER\u0026lt;/span\u0026gt; APPLY (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; TOP \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n            [Extent2].[ID], \n            [Extent2].[DocumentID],\n            [Extent2].[Status], \n            [Extent2].[DateCreated]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent2]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Extent1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [Extent2].[DocumentID]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [Extent2].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;, [Extent2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Project2]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ([Project2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OR\u0026lt;/span\u0026gt; [Project2].[ID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [Extent1].[ID])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Option 2:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n    [Limit1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [ID], \n    [Limit1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], \n    [Limit1].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], \n    [Limit1].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DISTINCT\u0026lt;/span\u0026gt; [Extent1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent1]\n) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Distinct1]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OUTER\u0026lt;/span\u0026gt; APPLY  (\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; TOP (\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) [Project2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [ID], [Project2].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], [Project2].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], [Project2].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \n                [Extent2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [ID], \n                [Extent2].[DocumentID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DocumentID], \n                [Extent2].[Status] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status], \n                [Extent2].[DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; #DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Extent2]\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; [Distinct1].[DocumentID] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; [Extent2].[DocumentID]\n        )  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Project2]\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; [Project2].[ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Limit1]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In Microsoft SQL Server Management Studio: after highlighting and running the first block, highlight both Option 1 and Option 2, right click -\u0026amp;gt; [Display Estimated Execution Plan]. Then run the entire thing to see the results.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Option 1 Results:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;ID  DocumentID  Status  DateCreated\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   S1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   S3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   S1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Option 2 Results:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;ID  DocumentID  Status  DateCreated\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   S1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   S3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   S1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;I tend to use APPLY when I want a join to be 1-to-(1 of many).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I use a JOIN if I want the join to be 1-to-many, or many-to-many.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I avoid CTE with ROW_NUMBER() unless I need to do something advanced and am ok with the windowing performance penalty.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;I also avoid EXISTS / IN subqueries in the WHERE or ON clause, as I have experienced this causing some terrible execution plans. But mileage varies. Review the execution plan and profile performance where and when needed!\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; o.\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; `DocumentStatusLogs` o                   \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;LEFT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt; `DocumentStatusLogs` b                   \n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; o.DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; b.DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; o.DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; b.DateCreated\n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; b.DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NULL\u0026lt;/span\u0026gt; ;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you want to return only recent document order by DateCreated, it will return only top 1 document by DocumentID\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I believe this can be done just like this. This might need some tweaking but you can just select the max from the group.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;These answers are overkill..\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  d.DocumentID,\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(d.Status),\n  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(d1.DateCreated)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs d, DocumentStatusLogs d1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;USING\u0026lt;/span\u0026gt; DocumentID\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In scenarios where you want to avoid using row_count(), you can also use a left join:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; ds.DocumentID, ds.Status, ds.DateCreated \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; DocumentStatusLogs ds\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;left\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;filter\u0026lt;/span\u0026gt; \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt; ds.DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; filter.DocumentID\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- Match any row that has another row that was created after it.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; ds.DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; filter.DateCreated\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;-- then filter out any rows that matched \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; filter.DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt; \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For the example schema, you could also use a \u0026quot;not in subquery\u0026quot;, which generally compiles to the same output as the left join: \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; ds.DocumentID, ds.Status, ds.DateCreated \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; DocumentStatusLogs ds\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ds.ID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IN\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; filter.ID \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;filter\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt; ds.DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; filter.DocumentID\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt; ds.DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;/span\u0026gt; filter.DateCreated)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note, the subquery pattern wouldn\u0026apos;t work if the table didn\u0026apos;t have at least one single-column unique key/constraint/index, in this case the primary key \u0026quot;Id\u0026quot;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Both of these queries tend to be more \u0026quot;expensive\u0026quot; than the row_count() query (as measured by Query Analyzer).  However, you might encounter scenarios where they return results faster or enable other optimizations.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; documentid, \n       status, \n       datecreated \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   documentstatuslogs dlogs \n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;  status \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; status \n                 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;   documentstatuslogs \n                 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WHERE\u0026lt;/span\u0026gt;  documentid \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; dlogs.documentid \n                 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; datecreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt; \n                 LIMIT  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [DocumentID]\n    ,[tmpRez].\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/x[2]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;varchar(20)\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [Status]\n    ,[tmpRez].\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;/x[3]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;datetime\u0026apos;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [DateCreated]\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; (\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; [DocumentID]\n        ,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;([ID] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;)) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; [Status] \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026amp;lt;x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cast\u0026lt;/span\u0026gt;([DateCreated] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;VARCHAR\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;))) \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;+\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026amp;lt;/x\u0026amp;gt;\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; XML) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [tmpRez]\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID\n    ) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; [tmpQry]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Some database engines* are starting to support the \u0026lt;code\u0026gt;QUALIFY\u0026lt;/code\u0026gt; clause that allows to filter the result of window functions (which the accepted answer uses).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So the accepted answer can become\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; rn\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\nQUALIFY rn \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See this article for an in depth explanation: \u0026lt;a href=\u0026quot;https://jrandrews.net/the-joy-of-qualify\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://jrandrews.net/the-joy-of-qualify\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;You can use this tool to see  which database support this clause: \u0026lt;a href=\u0026quot;https://www.jooq.org/translate/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;https://www.jooq.org/translate/\u0026lt;/a\u0026gt;\nThere is an option to transform the qualify clause when the target dialect does not support it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;*Teradata, BigQuery, H2, Snowflake...\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is the most vanilla TSQL I can come up with\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs D1 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;JOIN\u0026lt;/span\u0026gt;\n    (\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n        DocumentID,\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(DateCreated) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AS\u0026lt;/span\u0026gt; MaxDate\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt;\n        DocumentStatusLogs\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt;\n        DocumentID\n    ) D2\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ON\u0026lt;/span\u0026gt;\n      D2.DocumentID\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;D1.DocumentID\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;AND\u0026lt;/span\u0026gt;\n      D2.MaxDate\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt;D1.DateCreated\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;My SQL Server Version: 15.x (2019)\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;  TOP \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;WITH\u0026lt;/span\u0026gt; TIES\n        DocumentID,\n        GetOnlyTheTop(Status),\n        GetOnlyTheTop(DateCreated)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ROW_NUMBER\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;OVER\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;PARTITION\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;hopefully this will work.. just change the columns as per your db.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\nr2.id,\nr2.name,\nr2.e_date,\nr2.roomcode,\nr2.roomname,\nr2.bedn\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; \n(   \n \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt; \n    id,\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;(e_date) e_date\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; rooms\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;group\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;by\u0026lt;/span\u0026gt; id\n) r1\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;inner\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;join\u0026lt;/span\u0026gt; rooms r2 \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;on\u0026lt;/span\u0026gt; r2.id \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; r1.id \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; r2.e_date \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; r1.e_date;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It is checked in SQLite that you can use the following simple query with \u0026lt;em\u0026gt;GROUP BY\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;MAX\u0026lt;/span\u0026gt;(DateCreated), \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;*\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here \u0026lt;em\u0026gt;MAX\u0026lt;/em\u0026gt; help to get the maximum \u0026lt;em\u0026gt;DateCreated\u0026lt;/em\u0026gt; FROM each group.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;But it seems that MYSQL doesn\u0026apos;t associate *-columns with the value of max DateCreated :(\u0026lt;/p\u0026gt;\n    "],"id":259,"title":"Get top 1 row of each group","content":"\n                \n\u0026lt;p\u0026gt;I have a table which I want to get the latest entry for each group. Here\u0026apos;s the table:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;DocumentStatusLogs\u0026lt;/code\u0026gt; Table\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;ID\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Status \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;29\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S2     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;02\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S2     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S3     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;02\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The table will be grouped by \u0026lt;code\u0026gt;DocumentID\u0026lt;/code\u0026gt; and sorted by \u0026lt;code\u0026gt;DateCreated\u0026lt;/code\u0026gt; in descending order. For each \u0026lt;code\u0026gt;DocumentID\u0026lt;/code\u0026gt;, I want to get the latest status. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;My preferred output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Status \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;02\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S3     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;01\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; S1     \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;02\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;/\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2011\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Is there any aggregate function to get only the top from each group? See pseudo-code \u0026lt;code\u0026gt;GetOnlyTheTop\u0026lt;/code\u0026gt; below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;SELECT\u0026lt;/span\u0026gt;\n  DocumentID,\n  GetOnlyTheTop(Status),\n  GetOnlyTheTop(DateCreated)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;FROM\u0026lt;/span\u0026gt; DocumentStatusLogs\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;GROUP\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DocumentID\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ORDER\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;BY\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;DESC\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If such function doesn\u0026apos;t exist, is there any way I can achieve the output I want?\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Or at the first place, could this be caused by unnormalized database? I\u0026apos;m thinking, since what I\u0026apos;m looking for is just one row, should that \u0026lt;code\u0026gt;status\u0026lt;/code\u0026gt; also be located in the parent table?\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;Please see the parent table for more information:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Current \u0026lt;code\u0026gt;Documents\u0026lt;/code\u0026gt; Table\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Title  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Content  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleA \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleB \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleC \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Should the parent table be like this so that I can easily access its status?\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-sql s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-sql\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DocumentID \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Title  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; Content  \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; DateCreated \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; CurrentStatus \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleA \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; s1            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleB \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; s3            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; TitleC \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...      \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; ...         \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt; s1            \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;|\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;UPDATE\u0026lt;/strong\u0026gt;\nI just learned how to use \u0026quot;apply\u0026quot; which makes it easier to address such problems.\u0026lt;/p\u0026gt;\n    ","slug":"get-top-1-row-of-each-group-1657387438304","postType":"QUESTION","createdAt":"2022-07-09T17:23:58.000Z","updatedAt":"2022-07-09T17:23:58.000Z","tags":[{"id":1658,"name":"tsql","slug":"tsql","createdAt":"2022-07-09T17:23:58.000Z","updatedAt":"2022-07-09T17:23:58.000Z","Questions_Tags":{"questionId":259,"tagId":1658}}],"relatedQuestions":[{"title":"Get top 1 row of each group","slug":"get-top-1-row-of-each-group-1657387438304","tags":[{"name":"tsql","Questions_Tags":{"questionId":259,"tagId":1658}}]}]},"randomQuestions":[{"title":"How do I set, clear, and toggle a single bit?","slug":"how-do-i-set-clear-and-toggle-a-single-bit-1657388227052"},{"title":"How to create a GUID / UUID","slug":"how-to-create-a-guid-uuid-1657387749530"},{"title":"How to deal with floating point number precision in JavaScript?","slug":"how-to-deal-with-floating-point-number-precision-in-javascript-1657387293762"},{"title":"Does JavaScript guarantee object property order?","slug":"does-javascript-guarantee-object-property-order-1657384822587"},{"title":"Safely turning a JSON string into an object","slug":"safely-turning-a-json-string-into-an-object-1657388194824"},{"title":"How do I return the response from an asynchronous call?","slug":"how-do-i-return-the-response-from-an-asynchronous-call-1657384208012"},{"title":"Why does std::getline() skip input after a formatted extraction?","slug":"why-does-std::getline()-skip-input-after-a-formatted-extraction-1657384756118"},{"title":"What is object slicing?","slug":"what-is-object-slicing-1657384506425"},{"title":"Post an HTML Table to ADO.NET DataTable","slug":"post-an-html-table-to-ado.net-datatable-1657387462723"},{"title":"Example images for code and mark-up Q\u0026As [closed]","slug":"example-images-for-code-and-mark-up-qandas-closed-1657387690222"},{"title":"How do I make Git forget about a file that was tracked, but is now in .gitignore?","slug":"how-do-i-make-git-forget-about-a-file-that-was-tracked-but-is-now-in-.gitignore-1657387328843"},{"title":"How to check if element is visible after scrolling?","slug":"how-to-check-if-element-is-visible-after-scrolling-1657387987960"},{"title":"Why not use tables for layout in HTML? [closed]","slug":"why-not-use-tables-for-layout-in-html-closed-1657387752327"},{"title":"Convert columns into rows with Pandas","slug":"convert-columns-into-rows-with-pandas-1657388374964"},{"title":"Why does Tkinter image not show up if created in a function?","slug":"why-does-tkinter-image-not-show-up-if-created-in-a-function-1657387388233"},{"title":"Remove duplicate values from JS array [duplicate]","slug":"remove-duplicate-values-from-js-array-duplicate-1657387801931"},{"title":"How does Access-Control-Allow-Origin header work?","slug":"how-does-access-control-allow-origin-header-work-1657384881723"},{"title":"Object comparison in JavaScript [duplicate]","slug":"object-comparison-in-javascript-duplicate-1657387675463"},{"title":"Convert Rows to columns using 'Pivot' in SQL Server","slug":"convert-rows-to-columns-using-'pivot'-in-sql-server-1657388372528"},{"title":"MySQL pivot row into dynamic number of columns","slug":"mysql-pivot-row-into-dynamic-number-of-columns-1657387981930"}]},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"get-top-1-row-of-each-group-1657387438304"},"buildId":"BnkbnjkWYxefPXjTJLVVv","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>