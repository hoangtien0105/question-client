<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-do-i-use-shell-variables-in-an-awk-script-1657387754261">How do I use shell variables in an awk script?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/awk">awk</a></div></div><div class="question-content mt-5">
                
<p>I found some ways to pass external shell variables to an <code>awk</code> script, but I'm confused about <code>'</code> and <code>"</code>.</p>

<p>First, I tried with a shell script:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ v=123test
$ <span class="hljs-built_in">echo</span> <span class="hljs-variable">$v</span>
123test
$ <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
123test
</code></pre>

<p>Then tried awk:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ awk <span class="hljs-string">'BEGIN{print "'</span><span class="hljs-variable">$v</span><span class="hljs-string">'"}'</span>
$ 123test
$ awk <span class="hljs-string">'BEGIN{print '</span><span class="hljs-string">"<span class="hljs-variable">$v</span>"</span><span class="hljs-string">'}'</span>
$ 123
</code></pre>

<p>Why is the difference?</p>

<p>Lastly I tried this:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ awk <span class="hljs-string">'BEGIN{print " '</span><span class="hljs-variable">$v</span><span class="hljs-string">' "}'</span>
$  123test
$ awk <span class="hljs-string">'BEGIN{print '</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span> <span class="hljs-string">'}'</span>
awk: cmd. line:1: BEGIN{<span class="hljs-built_in">print</span>
awk: cmd. line:1:             ^ unexpected newline or end of string 
</code></pre>

<p>I'm confused about this.</p>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">I like the -v as shown below, but this is really a great exercise in thinking about how to protect things from the shell. Working through this, my first cut use backslashes on spaces and dollar signs. Needless to say the examples here were well worth my time.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/757479/chris" title="820 reputation" class="comment-user">Chris</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment69702796_19075671"><span title="2016-12-20 21:00:23Z, License: CC BY-SA 3.0" class="relativetime-clean">Dec 20, 2016 at 21:00</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">Related: <a href="https://stackoverflow.com/q/44445852/6862601">Difference between single and double quotes in awk</a>.</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/6862601/codeforester" title="34,560 reputation" class="comment-user">codeforester</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment87613723_19075671"><span title="2018-05-11 18:45:14Z, License: CC BY-SA 4.0" class="relativetime-clean">May 11, 2018 at 18:45</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">If your awk search needs <b>regular expression</b>, you can't put <code>/var/</code>. Instead, use tilde: <code>awk -v var="$var" '$0 ~ var'</code></span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/658497/noam-manos" title="12,992 reputation" class="comment-user">Noam Manos</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment109057896_19075671"><span title="2020-05-07 09:29:13Z, License: CC BY-SA 4.0" class="relativetime-clean">May 7, 2020 at 9:29</span></a></span>
                        <span title="this comment was edited 2 times">
                            <svg aria-hidden="true" class="va-text-bottom o50 svg-icon iconPencilSm" width="14" height="14" viewBox="0 0 14 14"><path d="m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z"></path></svg>
                        </span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p>#Getting shell variables into <code>awk</code>
may be done in several ways. Some are better than others. This should cover most of them.  If you have a comment, please leave below.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;v1.5</p>
</blockquote>
<hr>
<h2>Using <code>-v</code>  (The best way, most portable)</h2>
<p>Use the <code>-v</code> option: (P.S. use a space after <code>-v</code> or it will be less portable. E.g., <code>awk -v var=</code> not <code>awk -vvar=</code>)</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk -v var=<span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> <span class="hljs-string">'BEGIN {print var}'</span>
line one
line two
</code></pre>
<p>This should be compatible with most <code>awk</code>, and the variable is available in the <code>BEGIN</code> block as well:</p>
<p>If you have multiple variables:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v a=<span class="hljs-string">"<span class="hljs-variable">$var1</span>"</span> -v b=<span class="hljs-string">"<span class="hljs-variable">$var2</span>"</span> <span class="hljs-string">'BEGIN {print a,b}'</span>
</code></pre>
<p><strong>Warning</strong>.  As Ed Morton writes, escape sequences will be interpreted so <code>\t</code> becomes a real <code>tab</code> and not <code>\t</code> if that is what you search for. Can be solved by using <code>ENVIRON[]</code> or access it via <code>ARGV[]</code></p>
<p><strong>PS</strong> If you like three vertical bar as separator <code>|||</code>, it can't be escaped, so use <code>-F"[|][|][|]"</code></p>
<blockquote>
<p>Example on getting data from a program/function inn to <code>awk</code> (here date is used)</p>
</blockquote>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v time=<span class="hljs-string">"<span class="hljs-subst">$(date +<span class="hljs-string">"%F %H:%M"</span> -d '-1 minute')</span>"</span> <span class="hljs-string">'BEGIN {print time}'</span>
</code></pre>
<blockquote>
<p>Example of testing the contents of a shell variable as a regexp:</p>
</blockquote>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v var=<span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> <span class="hljs-string">'$0 ~ var{print "found it"}'</span>
</code></pre>
<hr>
<h2>Variable after code block</h2>
<p>Here we get the variable after the <code>awk</code> code. This will work fine as long as you do not need the variable in the <code>BEGIN</code> block:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"input data"</span> | awk <span class="hljs-string">'{print var}'</span> var=<span class="hljs-string">"<span class="hljs-variable">${variable}</span>"</span>
or
awk <span class="hljs-string">'{print var}'</span> var=<span class="hljs-string">"<span class="hljs-variable">${variable}</span>"</span> file
</code></pre>
<ul>
<li>Adding multiple variables:</li>
</ul>
<p><code>awk '{print a,b,$0}' a="$var1" b="$var2" file</code></p>
<ul>
<li>In this way we can also set different Field Separator <code>FS</code> for each file.</li>
</ul>
<p><code>awk 'some code' FS=',' file1.txt FS=';' file2.ext</code></p>
<ul>
<li>Variable after the code block will not work for the <code>BEGIN</code> block:</li>
</ul>
<p><code>echo "input data" | awk 'BEGIN {print var}' var="${variable}"</code></p>
<hr>
<h2>Here-string</h2>
<p>Variable can also be added to <code>awk</code> using a <a href="http://en.wikipedia.org/wiki/Here_document" rel="noreferrer">here-string</a> from shells that support them (including Bash):</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk <span class="hljs-string">'{print $0}'</span> &lt;&lt;&lt; <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span>
<span class="hljs-built_in">test</span>
</code></pre>
<p>This is the same as:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">printf</span> <span class="hljs-string">'%s'</span> <span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span> | awk <span class="hljs-string">'{print $0}'</span>
</code></pre>
<p>P.S. this treats the variable as a file input.</p>
<hr>
<h2><code>ENVIRON</code> input</h2>
<p>As TrueY writes, you can use the <code>ENVIRON</code> to print <strong>Environment Variables</strong>.
Setting a variable before running AWK, you can print it out like this:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">X=MyVar
awk <span class="hljs-string">'BEGIN{print ENVIRON["X"],ENVIRON["SHELL"]}'</span>
MyVar /bin/bash
</code></pre>
<hr>
<h2><code>ARGV</code> input</h2>
<p>As Steven Penny writes, you can use <code>ARGV</code> to get the data into awk:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=<span class="hljs-string">"my data"</span>
awk <span class="hljs-string">'BEGIN {print ARGV[1]}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
my data
</code></pre>
<p>To get the data into the code itself, not just the BEGIN:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=<span class="hljs-string">"my data"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"test"</span> | awk <span class="hljs-string">'BEGIN{var=ARGV[1];ARGV[1]=""} {print var, $0}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
my data <span class="hljs-built_in">test</span>
</code></pre>
<hr>
<h2>Variable within the code: USE WITH CAUTION</h2>
<p>You can use a variable within the <code>awk</code> code, but it's messy and hard to read, and as <code>Charles Duffy</code> points out, this version may also be a victim of code injection.  If someone adds bad stuff to the variable, it will be executed as part of the <code>awk</code> code.</p>
<p>This works by extracting the variable within the code, so it becomes a part of it.</p>
<p>If you want to make an <code>awk</code> that changes dynamically with use of variables, you can do it this way, but DO NOT use it for normal variables.</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk <span class="hljs-string">'BEGIN {print "'</span><span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span><span class="hljs-string">'"}'</span>
line one
line two
</code></pre>
<p>Here is an example of code injection:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">'line one\nline two" ; for (i=1;i&lt;=1000;++i) print i"'</span>
awk <span class="hljs-string">'BEGIN {print "'</span><span class="hljs-string">"<span class="hljs-variable">$variable</span>"</span><span class="hljs-string">'"}'</span>
line one
line two
1
2
3
.
.
1000
</code></pre>
<p>You can add lots of commands to <code>awk</code> this way.  Even make it crash with non valid commands.</p>
<p>One valid use of this approach, though, is when you want to pass a symbol to awk to be applied to some input, e.g. a simple calculator:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ <span class="hljs-function"><span class="hljs-title">calc</span></span>() { awk -v x=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> -v z=<span class="hljs-string">"<span class="hljs-variable">$3</span>"</span> <span class="hljs-string">'BEGIN{ print x '</span><span class="hljs-string">"<span class="hljs-variable">$2</span>"</span><span class="hljs-string">' z }'</span>; }

$ calc 2.7 <span class="hljs-string">'+'</span> 3.4
6.1

$ calc 2.7 <span class="hljs-string">'*'</span> 3.4
9.18
</code></pre>
<p>There is no way to do that using an awk variable populated with the value of a shell variable, you NEED the shell variable to expand to become part of the text of the awk script before awk interprets it.</p>
<hr>
<h2>Extra info:</h2>
<h3>Use of double quote</h3>
<p>It's always good to double quote variable <code>"$variable"</code><br>
If not, multiple lines will be added as a long single line.</p>
<p>Example:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=<span class="hljs-string">"Line one
This is line two"</span>

<span class="hljs-built_in">echo</span> <span class="hljs-variable">$var</span>
Line one This is line two

<span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$var</span>"</span>
Line one
This is line two
</code></pre>
<p>Other errors you can get without double quote:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">variable=<span class="hljs-string">"line one\nline two"</span>
awk -v var=<span class="hljs-variable">$variable</span> <span class="hljs-string">'BEGIN {print var}'</span>
awk: cmd. line:1: one\nline
awk: cmd. line:1:    ^ backslash not last character on line
awk: cmd. line:1: one\nline
awk: cmd. line:1:    ^ syntax error
</code></pre>
<p>And with single quote, it does not expand the value of the variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v var=<span class="hljs-string">'$variable'</span> <span class="hljs-string">'BEGIN {print var}'</span>
<span class="hljs-variable">$variable</span>
</code></pre>
<h3>More info about AWK and variables</h3>
<p><a href="http://cfajohnson.com/shell/cus-faq-2.html#Q24" rel="noreferrer">Read this faq</a>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It seems that the good-old <code>ENVIRON</code> <a href="/questions/tagged/awk" class="post-tag" title="show questions tagged 'awk'" rel="tag">awk</a> built-in hash is not mentioned at all. An example of its usage:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">$ X=Solaris awk <span class="hljs-string">'BEGIN{print ENVIRON["X"], ENVIRON["TERM"]}'</span>
Solaris rxvt
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use either of these depending how you want backslashes in the shell variables handled (<code>avar</code> is an awk variable, <code>svar</code> is a shell variable):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk -v avar=<span class="hljs-string">"<span class="hljs-variable">$svar</span>"</span> <span class="hljs-string">'... avar ...'</span> file
awk <span class="hljs-string">'BEGIN{avar=ARGV[1];ARGV[1]=""}... avar ...'</span> <span class="hljs-string">"<span class="hljs-variable">$svar</span>"</span> file
</code></pre>

<p>See <a href="http://cfajohnson.com/shell/cus-faq-2.html#Q24">http://cfajohnson.com/shell/cus-faq-2.html#Q24</a> for details and other options. The first method above is almost always your best option and has the most obvious semantics.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You could pass in the <a href="http://www.gnu.org/software/gawk/manual/gawk.html#Options" rel="noreferrer">command-line option</a> <code>-v</code> with a variable name (<code>v</code>) and a value (<code>=</code>) of the environment variable (<code>"${v}"</code>):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">% awk -vv=<span class="hljs-string">"<span class="hljs-variable">${v}</span>"</span> <span class="hljs-string">'BEGIN { print v }'</span>
123test
</code></pre>

<p>Or to make it clearer (with far fewer <code>v</code>s):</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">% environment_variable=123test
% awk -vawk_variable=<span class="hljs-string">"<span class="hljs-variable">${environment_variable}</span>"</span> <span class="hljs-string">'BEGIN { print awk_variable }'</span>
123test
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can utilize ARGV:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">v=123test
awk <span class="hljs-string">'BEGIN {print ARGV[1]}'</span> <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
</code></pre>

<p>Note that if you are going to continue into the body, you will need to adjust
ARGC:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">awk <span class="hljs-string">'BEGIN {ARGC--} {print ARGV[2], $0}'</span> file <span class="hljs-string">"<span class="hljs-variable">$v</span>"</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I just changed @Jotne's answer for "for loop". </p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `<span class="hljs-built_in">seq</span> 11 20`; <span class="hljs-keyword">do</span> host myserver-<span class="hljs-variable">$i</span> | awk -v i=<span class="hljs-string">"<span class="hljs-variable">$i</span>"</span> <span class="hljs-string">'{print "myserver-"i" " $4}'</span>; <span class="hljs-keyword">done</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I had to insert date at the beginning of the lines of a log file and it's done like below:</p>

<pre class="lang-bash s-code-block"><code class="hljs language-bash">DATE=$(<span class="hljs-built_in">date</span> +<span class="hljs-string">"%Y-%m-%d"</span>)
awk <span class="hljs-string">'{ print "'</span><span class="hljs-string">"<span class="hljs-variable">$DATE</span>"</span><span class="hljs-string">'", $0; }'</span> /path_to_log_file/log_file.log
</code></pre>

<p>It can be redirect to another file to save</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>Pro Tip</h2>
<p>It could come handy to create a function that handles this so you dont have to type everything every time. Using the selected solution we get...</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-function"><span class="hljs-title">awk_switch_columns</span></span>() {
     <span class="hljs-built_in">cat</span> &lt; /dev/stdin | awk -v a=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span> -v b=<span class="hljs-string">"<span class="hljs-variable">$2</span>"</span> <span class="hljs-string">" { t = \$a; \$a = \$b; \$b = t; print; } "</span>
}
</code></pre>
<p>And use it as...</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">'a b c d'</span> | awk_switch_columns 2 4

Output:
a d c b
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>example:</p>
<p>in.txt:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk <span class="hljs-string">'{print $1}'</span> in.txt) 
</code></pre>
<p>command:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash"><span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">$var</span>"</span> &gt; out.txt
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>another:</p>
<p>in.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo,aaa
bar,bbb
</code></pre>
<p>variable:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk -F <span class="hljs-string">","</span> <span class="hljs-string">'{print $1}'</span> in.txt) 
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">foo
bar
</code></pre>
<p>or:</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">var=$(awk -F <span class="hljs-string">","</span> <span class="hljs-string">'{print $2}'</span> in.txt) 
</code></pre>
<p>out.txt</p>
<pre class="lang-bash s-code-block"><code class="hljs language-bash">aaa
bbb
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;#Getting shell variables into \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt;\nmay be done in several ways. Some are better than others. This should cover most of them.  If you have a comment, please leave below.\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;\u0026amp;nbsp;v1.5\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Using \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt;  (The best way, most portable)\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Use the \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; option: (P.S. use a space after \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; or it will be less portable. E.g., \u0026lt;code\u0026gt;awk -v var=\u0026lt;/code\u0026gt; not \u0026lt;code\u0026gt;awk -vvar=\u0026lt;/code\u0026gt;)\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This should be compatible with most \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt;, and the variable is available in the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block as well:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you have multiple variables:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v a=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v b=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print a,b}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Warning\u0026lt;/strong\u0026gt;.  As Ed Morton writes, escape sequences will be interpreted so \u0026lt;code\u0026gt;\\t\u0026lt;/code\u0026gt; becomes a real \u0026lt;code\u0026gt;tab\u0026lt;/code\u0026gt; and not \u0026lt;code\u0026gt;\\t\u0026lt;/code\u0026gt; if that is what you search for. Can be solved by using \u0026lt;code\u0026gt;ENVIRON[]\u0026lt;/code\u0026gt; or access it via \u0026lt;code\u0026gt;ARGV[]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;PS\u0026lt;/strong\u0026gt; If you like three vertical bar as separator \u0026lt;code\u0026gt;|||\u0026lt;/code\u0026gt;, it can\u0026apos;t be escaped, so use \u0026lt;code\u0026gt;-F\u0026quot;[|][|][|]\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Example on getting data from a program/function inn to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; (here date is used)\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v time=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-subst\u0026quot;\u0026gt;$(date +\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%F %H:%M\u0026quot;\u0026lt;/span\u0026gt; -d \u0026apos;-1 minute\u0026apos;)\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print time}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Example of testing the contents of a shell variable as a regexp:\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$0 ~ var{print \u0026quot;found it\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Variable after code block\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Here we get the variable after the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code. This will work fine as long as you do not need the variable in the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;input data\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print var}\u0026apos;\u0026lt;/span\u0026gt; var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nor\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print var}\u0026apos;\u0026lt;/span\u0026gt; var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; file\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Adding multiple variables:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;awk \u0026apos;{print a,b,$0}\u0026apos; a=\u0026quot;$var1\u0026quot; b=\u0026quot;$var2\u0026quot; file\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In this way we can also set different Field Separator \u0026lt;code\u0026gt;FS\u0026lt;/code\u0026gt; for each file.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;awk \u0026apos;some code\u0026apos; FS=\u0026apos;,\u0026apos; file1.txt FS=\u0026apos;;\u0026apos; file2.ext\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Variable after the code block will not work for the \u0026lt;code\u0026gt;BEGIN\u0026lt;/code\u0026gt; block:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;echo \u0026quot;input data\u0026quot; | awk \u0026apos;BEGIN {print var}\u0026apos; var=\u0026quot;${variable}\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Here-string\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Variable can also be added to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; using a \u0026lt;a href=\u0026quot;http://en.wikipedia.org/wiki/Here_document\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;here-string\u0026lt;/a\u0026gt; from shells that support them (including Bash):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $0}\u0026apos;\u0026lt;/span\u0026gt; \u0026amp;lt;\u0026amp;lt;\u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;test\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This is the same as:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%s\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $0}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;P.S. this treats the variable as a file input.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; input\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As TrueY writes, you can use the \u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; to print \u0026lt;strong\u0026gt;Environment Variables\u0026lt;/strong\u0026gt;.\nSetting a variable before running AWK, you can print it out like this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;X=MyVar\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print ENVIRON[\u0026quot;X\u0026quot;],ENVIRON[\u0026quot;SHELL\u0026quot;]}\u0026apos;\u0026lt;/span\u0026gt;\nMyVar /bin/bash\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;code\u0026gt;ARGV\u0026lt;/code\u0026gt; input\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;As Steven Penny writes, you can use \u0026lt;code\u0026gt;ARGV\u0026lt;/code\u0026gt; to get the data into awk:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;my data\u0026quot;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print ARGV[1]}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nmy data\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To get the data into the code itself, not just the BEGIN:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;my data\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;test\u0026quot;\u0026lt;/span\u0026gt; | awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{var=ARGV[1];ARGV[1]=\u0026quot;\u0026quot;} {print var, $0}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nmy data \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;test\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Variable within the code: USE WITH CAUTION\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;You can use a variable within the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code, but it\u0026apos;s messy and hard to read, and as \u0026lt;code\u0026gt;Charles Duffy\u0026lt;/code\u0026gt; points out, this version may also be a victim of code injection.  If someone adds bad stuff to the variable, it will be executed as part of the \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; code.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This works by extracting the variable within the code, so it becomes a part of it.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If you want to make an \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; that changes dynamically with use of variables, you can do it this way, but DO NOT use it for normal variables.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here is an example of code injection:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;line one\\nline two\u0026quot; ; for (i=1;i\u0026amp;lt;=1000;++i) print i\u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\nline one\nline two\n1\n2\n3\n.\n.\n1000\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You can add lots of commands to \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; this way.  Even make it crash with non valid commands.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;One valid use of this approach, though, is when you want to pass a symbol to awk to be applied to some input, e.g. a simple calculator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;calc\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() { awk -v x=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v z=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$3\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{ print x \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; z }\u0026apos;\u0026lt;/span\u0026gt;; }\n\n$ calc 2.7 \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;+\u0026apos;\u0026lt;/span\u0026gt; 3.4\n6.1\n\n$ calc 2.7 \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;*\u0026apos;\u0026lt;/span\u0026gt; 3.4\n9.18\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There is no way to do that using an awk variable populated with the value of a shell variable, you NEED the shell variable to expand to become part of the text of the awk script before awk interprets it.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Extra info:\u0026lt;/h2\u0026gt;\n\u0026lt;h3\u0026gt;Use of double quote\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s always good to double quote variable \u0026lt;code\u0026gt;\u0026quot;$variable\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;br\u0026gt;\nIf not, multiple lines will be added as a long single line.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Line one\nThis is line two\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\nLine one This is line two\n\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\nLine one\nThis is line two\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Other errors you can get without double quote:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;line one\\nline two\u0026quot;\u0026lt;/span\u0026gt;\nawk -v var=\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ backslash not last character on line\nawk: cmd. line:1: one\\nline\nawk: cmd. line:1:    ^ syntax error\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And with single quote, it does not expand the value of the variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v var=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;$variable\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print var}\u0026apos;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$variable\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;More info about AWK and variables\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Read this faq\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It seems that the good-old \u0026lt;code\u0026gt;ENVIRON\u0026lt;/code\u0026gt; \u0026lt;a href=\u0026quot;/questions/tagged/awk\u0026quot; class=\u0026quot;post-tag\u0026quot; title=\u0026quot;show questions tagged \u0026apos;awk\u0026apos;\u0026quot; rel=\u0026quot;tag\u0026quot;\u0026gt;awk\u0026lt;/a\u0026gt; built-in hash is not mentioned at all. An example of its usage:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ X=Solaris awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print ENVIRON[\u0026quot;X\u0026quot;], ENVIRON[\u0026quot;TERM\u0026quot;]}\u0026apos;\u0026lt;/span\u0026gt;\nSolaris rxvt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use either of these depending how you want backslashes in the shell variables handled (\u0026lt;code\u0026gt;avar\u0026lt;/code\u0026gt; is an awk variable, \u0026lt;code\u0026gt;svar\u0026lt;/code\u0026gt; is a shell variable):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk -v avar=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$svar\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;... avar ...\u0026apos;\u0026lt;/span\u0026gt; file\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{avar=ARGV[1];ARGV[1]=\u0026quot;\u0026quot;}... avar ...\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$svar\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; file\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;See \u0026lt;a href=\u0026quot;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026quot;\u0026gt;http://cfajohnson.com/shell/cus-faq-2.html#Q24\u0026lt;/a\u0026gt; for details and other options. The first method above is almost always your best option and has the most obvious semantics.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You could pass in the \u0026lt;a href=\u0026quot;http://www.gnu.org/software/gawk/manual/gawk.html#Options\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;command-line option\u0026lt;/a\u0026gt; \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; with a variable name (\u0026lt;code\u0026gt;v\u0026lt;/code\u0026gt;) and a value (\u0026lt;code\u0026gt;=\u0026lt;/code\u0026gt;) of the environment variable (\u0026lt;code\u0026gt;\u0026quot;${v}\u0026quot;\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;% awk -vv=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${v}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN { print v }\u0026apos;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Or to make it clearer (with far fewer \u0026lt;code\u0026gt;v\u0026lt;/code\u0026gt;s):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;% environment_variable=123test\n% awk -vawk_variable=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;${environment_variable}\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN { print awk_variable }\u0026apos;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can utilize ARGV:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;v=123test\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {print ARGV[1]}\u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you are going to continue into the body, you will need to adjust\nARGC:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN {ARGC--} {print ARGV[2], $0}\u0026apos;\u0026lt;/span\u0026gt; file \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I just changed @Jotne\u0026apos;s answer for \u0026quot;for loop\u0026quot;. \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; `\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;seq\u0026lt;/span\u0026gt; 11 20`; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;do\u0026lt;/span\u0026gt; host myserver-\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt; | awk -v i=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$i\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print \u0026quot;myserver-\u0026quot;i\u0026quot; \u0026quot; $4}\u0026apos;\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;done\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I had to insert date at the beginning of the lines of a log file and it\u0026apos;s done like below:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;DATE=$(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;date\u0026lt;/span\u0026gt; +\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;%Y-%m-%d\u0026quot;\u0026lt;/span\u0026gt;)\nawk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{ print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$DATE\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;, $0; }\u0026apos;\u0026lt;/span\u0026gt; /path_to_log_file/log_file.log\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It can be redirect to another file to save\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;Pro Tip\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;It could come handy to create a function that handles this so you dont have to type everything every time. Using the selected solution we get...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;awk_switch_columns\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() {\n     \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;cat\u0026lt;/span\u0026gt; \u0026amp;lt; /dev/stdin | awk -v a=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$1\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; -v b=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$2\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; { t = \\$a; \\$a = \\$b; \\$b = t; print; } \u0026quot;\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And use it as...\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a b c d\u0026apos;\u0026lt;/span\u0026gt; | awk_switch_columns 2 4\n\nOutput:\na d c b\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;example:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;in.txt:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $1}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; -e \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$var\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;gt; out.txt\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;another:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;in.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo,aaa\nbar,bbb\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;variable:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk -F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;,\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $1}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;foo\nbar\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;var=$(awk -F \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;,\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{print $2}\u0026apos;\u0026lt;/span\u0026gt; in.txt) \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;out.txt\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;aaa\nbbb\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I like the -v as shown below, but this is really a great exercise in thinking about how to protect things from the shell. Working through this, my first cut use backslashes on spaces and dollar signs. Needless to say the examples here were well worth my time.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/757479/chris\u0026quot; title=\u0026quot;820 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Chris\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment69702796_19075671\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-12-20 21:00:23Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 20, 2016 at 21:00\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Related: \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/44445852/6862601\u0026quot;\u0026gt;Difference between single and double quotes in awk\u0026lt;/a\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6862601/codeforester\u0026quot; title=\u0026quot;34,560 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;codeforester\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment87613723_19075671\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-05-11 18:45:14Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 11, 2018 at 18:45\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;If your awk search needs \u0026lt;b\u0026gt;regular expression\u0026lt;/b\u0026gt;, you can\u0026apos;t put \u0026lt;code\u0026gt;/var/\u0026lt;/code\u0026gt;. Instead, use tilde: \u0026lt;code\u0026gt;awk -v var=\u0026quot;$var\u0026quot; \u0026apos;$0 ~ var\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/658497/noam-manos\u0026quot; title=\u0026quot;12,992 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Noam Manos\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment109057896_19075671\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-05-07 09:29:13Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 7, 2020 at 9:29\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 2 times\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026quot;messy and hard to read\u0026quot; ignores the more important security concern of code injection when directly substituting strings into awk code.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/14122/charles-duffy\u0026quot; title=\u0026quot;259,605 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Charles Duffy\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment58675989_19075707\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-02-18 20:21:36Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 18, 2016 at 20:21\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;reading the answer above I can run my script without errors but it doesn\u0026apos;t do the job: awk -v repo=\u0026quot;$1\u0026quot; -v tag=\u0026quot;$2\u0026quot; \u0026apos;{sub(/image: registryabx.azurecr.io\\/{print repo}:([a-z0-9]+)$/,\u0026quot;image: registryabc.azurecr. io/{print repo}:{print tag}\u0026quot;);}1\u0026apos; ./services/appscompose.yaml \u0026amp;gt;\u0026amp;gt; newcompose.yaml. Is because of the nested parenthesis {?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/603064/darion-badlydone\u0026quot; title=\u0026quot;857 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Darion Badlydone\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment103523410_19075707\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-29 11:10:07Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 29, 2019 at 11:10\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@DarionBadlydone Try this \u0026lt;code\u0026gt;awk -v repo=\u0026quot;$1\u0026quot; -v tag=\u0026quot;$2\u0026quot; \u0026apos;BEGIN {print \u0026quot;repo=\u0026quot;repo,\u0026quot;tag=\u0026quot;tag}\u0026apos;\u0026lt;/code\u0026gt;.  It will see if it prints the variable.  Post a own question if you can not figure the out.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2341847/jotne\u0026quot; title=\u0026quot;39,414 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jotne\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment103525242_19075707\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-29 12:13:00Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 29, 2019 at 12:13\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Jotne yes it print the values so i tried in this way: awk -v repo=\u0026quot;$1\u0026quot; -v tag=\u0026quot;$2\u0026quot; \u0026apos;{print \u0026quot;{sub(/image: registryabc.azurecr.io/\u0026quot;repo\u0026quot;:([a-z0-9]+)$/,\\\u0026quot;image: registryabc.azurecr.io/\u0026quot;repo\u0026quot;:\u0026quot;tag\u0026quot;\\\u0026quot;);}1\u0026quot;}\u0026apos; ./services/appscompose.yaml \u0026amp;gt;\u0026amp;gt; newcompose.yaml but is not working as aspected. It replace each line of the source file with the printed command\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/603064/darion-badlydone\u0026quot; title=\u0026quot;857 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Darion Badlydone\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment103527874_19075707\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-29 13:38:47Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 29, 2019 at 13:38\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I strongly disagree that \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; is the \u0026quot;best, most portable way\u0026quot;.  \u0026lt;code\u0026gt;awk -v a=b cmds path1 path2\u0026lt;/code\u0026gt; is (almost) equivalent to \u0026lt;code\u0026gt;awk cmds a=b path1 path2\u0026lt;/code\u0026gt;, but there is no good way to use \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; to emulate \u0026lt;code\u0026gt;awk cmds path1 a=b path2\u0026lt;/code\u0026gt;  Defining variables in the arguments is an extremely useful technique which is equally portable and which I will argue is \u0026quot;better\u0026quot;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/140750/william-pursell\u0026quot; title=\u0026quot;191,423 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;William Pursell\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment116881758_19075707\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-02-08 21:48:30Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 8, 2021 at 21:48\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is a good suggestion because it passes the data verbatim. \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; doesn\u0026apos;t work when the value contains backslashes.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1899640/that-other-guy\u0026quot; title=\u0026quot;110,463 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;that other guy\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment58863965_26779845\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-02-23 21:45:49Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 23, 2016 at 21:45\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@thatotherguy I did not know that! I thought that if I use \u0026lt;code\u0026gt;awk -v x=\u0026apos;\\c\\d\u0026apos; ...\u0026lt;/code\u0026gt; then it will be used it properly. But when \u0026lt;code\u0026gt;x\u0026lt;/code\u0026gt; is printed \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/tagged/awk\u0026quot;\u0026gt;awk\u0026lt;/a\u0026gt; drops the famous: \u0026lt;code\u0026gt;awk: warning: escape sequence \u0026apos;\\c\u0026apos; treated as plain \u0026apos;c\u0026apos;\u0026lt;/code\u0026gt; error message... Thanks!\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2156952/truey\u0026quot; title=\u0026quot;7,100 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;TrueY\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment58880375_26779845\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-02-24 09:11:31Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 24, 2016 at 9:11\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;It does work properly - properly in this context means expand escape sequences because that\u0026apos;s how \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; was designed to work so you can use \u0026lt;code\u0026gt;\\t\u0026lt;/code\u0026gt; in  the variable and have it match a literal tab in the data, for example. If that\u0026apos;s not the behavior you want then you don\u0026apos;t use \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; you use \u0026lt;code\u0026gt;ARGV[]\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;ENVIRON[]\u0026lt;/code\u0026gt;.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1745001/ed-morton\u0026quot; title=\u0026quot;173,449 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Ed Morton\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment100388785_26779845\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-07-07 15:02:44Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 7, 2019 at 15:02\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This merely seems to be another illustration of how to use Awk\u0026apos;s \u0026lt;code\u0026gt;-v\u0026lt;/code\u0026gt; option which was already mentioned in many of the existing answers. If you want to show how to run Awk in a loop, that\u0026apos;s a different question really.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/874188/tripleee\u0026quot; title=\u0026quot;159,777 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;tripleee\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment100385063_49747918\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-07-07 10:27:10Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 7, 2019 at 10:27\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The double quote - single quote - double quote was exactly what I needed to make mine work.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3926114/user53029\u0026quot; title=\u0026quot;625 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;user53029\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment64411972_35741606\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-07-21 14:24:03Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 21, 2016 at 14:24\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This was already mentioned in the accepted answer as a method you should not use due to code injection vulnerabilities. So the information here is redundant (already described in the accepted answer), and incomplete (does not mention the problems with this method).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/695671/jason-s\u0026quot; title=\u0026quot;1,199 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jason S\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment67260267_35741606\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2016-10-12 05:20:00Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 12, 2016 at 5:20\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":364,"title":"How do I use shell variables in an awk script?","content":"\n                \n\u0026lt;p\u0026gt;I found some ways to pass external shell variables to an \u0026lt;code\u0026gt;awk\u0026lt;/code\u0026gt; script, but I\u0026apos;m confused about \u0026lt;code\u0026gt;\u0026apos;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\u0026quot;\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;First, I tried with a shell script:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ v=123test\n$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\n123test\n$ \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;echo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n123test\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Then tried awk:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026quot;\u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n$ 123test\n$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt;\n$ 123\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Why is the difference?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Lastly I tried this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-bash s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026quot; \u0026apos;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos; \u0026quot;}\u0026apos;\u0026lt;/span\u0026gt;\n$  123test\n$ awk \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;BEGIN{print \u0026apos;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$v\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;}\u0026apos;\u0026lt;/span\u0026gt;\nawk: cmd. line:1: BEGIN{\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;\nawk: cmd. line:1:             ^ unexpected newline or end of string \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;m confused about this.\u0026lt;/p\u0026gt;\n    ","slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261","postType":"QUESTION","createdAt":"2022-07-09T17:29:14.000Z","updatedAt":"2022-07-09T17:29:14.000Z","tags":[{"id":2018,"name":"awk","slug":"awk","createdAt":"2022-07-09T17:29:14.000Z","updatedAt":"2022-07-09T17:29:14.000Z","Questions_Tags":{"questionId":364,"tagId":2018}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-do-i-use-shell-variables-in-an-awk-script-1657387754261"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>