{"pageProps":{"data":{"count":610,"rows":[{"id":555,"title":"When should static_cast, dynamic_cast, const_cast, and reinterpret_cast be used?","slug":"when-should-static_cast-dynamic_cast-const_cast-and-reinterpret_cast-be-used-1657388406205","postType":"QUESTION","createdAt":"2022-07-09T17:40:06.000Z","updatedAt":"2022-07-09T17:40:06.000Z","tags":[]},{"id":554,"title":"Ways to deal with #document under iframe","slug":"ways-to-deal-with-document-under-iframe-1657388403345","postType":"QUESTION","createdAt":"2022-07-09T17:40:03.000Z","updatedAt":"2022-07-09T17:40:03.000Z","tags":[{"id":2691,"name":"protractor","slug":"protractor","createdAt":"2022-07-09T17:40:03.000Z","updatedAt":"2022-07-09T17:40:03.000Z","Questions_Tags":{"questionId":554,"tagId":2691}}]},{"id":553,"title":"console.log() async or sync?","slug":"console.log()-async-or-sync-1657388401087","postType":"QUESTION","createdAt":"2022-07-09T17:40:01.000Z","updatedAt":"2022-07-09T17:40:01.000Z","tags":[]},{"id":552,"title":"How to format numbers as currency strings","slug":"how-to-format-numbers-as-currency-strings-1657388399166","postType":"QUESTION","createdAt":"2022-07-09T17:39:59.000Z","updatedAt":"2022-07-09T17:39:59.000Z","tags":[]},{"id":551,"title":"How should a model be structured in MVC? [closed]","slug":"how-should-a-model-be-structured-in-mvc-closed-1657388394807","postType":"QUESTION","createdAt":"2022-07-09T17:39:54.000Z","updatedAt":"2022-07-09T17:39:54.000Z","tags":[{"id":2680,"name":"architecture","slug":"architecture","createdAt":"2022-07-09T17:39:55.000Z","updatedAt":"2022-07-09T17:39:55.000Z","Questions_Tags":{"questionId":551,"tagId":2680}},{"id":2681,"name":"model","slug":"model","createdAt":"2022-07-09T17:39:55.000Z","updatedAt":"2022-07-09T17:39:55.000Z","Questions_Tags":{"questionId":551,"tagId":2681}}]}]},"answers":{"551":["\n&lt;blockquote&gt;\n  &lt;p&gt;&lt;sub&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; the following is a description of how I understand MVC-like patterns in the context of PHP-based web applications. All the external links that are used in the content are there to explain terms and concepts, and &lt;strong&gt;not&lt;/strong&gt; to imply my own credibility on the subject.&lt;/sub&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;The first thing that I must clear up is: &lt;strong&gt;the model is a layer&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;Second: there is a difference between &lt;em&gt;classical MVC&lt;/em&gt; and what we use in web development. &lt;a href=&quot;https://stackoverflow.com/a/7622038/727208&quot;&gt;Here&apos;s&lt;/a&gt; a bit of an older answer I wrote, which briefly describes how they are different.&lt;/p&gt;\n\n&lt;h3&gt;What a model is NOT:&lt;/h3&gt;\n\n&lt;p&gt;The model is not a class or any single object. It is a very common mistake to make &lt;em&gt;(I did too, though the original answer was written when I began to learn otherwise)&lt;/em&gt;, because most frameworks perpetuate this misconception.&lt;/p&gt;\n\n&lt;p&gt;Neither is it an Object-Relational Mapping technique (ORM) nor an abstraction of database tables. Anyone who tells you otherwise is most likely trying to &lt;em&gt;&apos;sell&apos;&lt;/em&gt; another brand-new ORM or a whole framework.&lt;/p&gt;\n\n&lt;h3&gt;What a model is:&lt;/h3&gt;\n\n&lt;p&gt;In proper MVC adaptation, the M contains all the domain business logic and the &lt;em&gt;Model Layer&lt;/em&gt; is &lt;strong&gt;mostly&lt;/strong&gt; made from three types of structures:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://c2.com/cgi/wiki?DomainObject&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;Domain Objects&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;A domain object is a logical container of purely domain information; it usually represents a logical entity in the problem domain space. Commonly referred to as &lt;em&gt;business logic&lt;/em&gt;.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;This would be where you define how to validate data before sending an invoice, or to compute the total cost of an order. At the same time, &lt;em&gt;Domain Objects&lt;/em&gt; are completely unaware of storage - neither from &lt;em&gt;where&lt;/em&gt; (SQL database, REST API, text file, etc.) nor even &lt;em&gt;if&lt;/em&gt; they get saved or retrieved.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://martinfowler.com/eaaCatalog/dataMapper.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;Data Mappers&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;These objects are only responsible for the storage. If you store information in a database, this would be where the SQL lives. Or maybe you use an XML file to store data, and your &lt;em&gt;Data Mappers&lt;/em&gt; are parsing from and to XML files.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;a href=&quot;http://martinfowler.com/eaaCatalog/serviceLayer.html&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;Services&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;You can think of them as &quot;higher level Domain Objects&quot;, but instead of business logic, &lt;em&gt;Services&lt;/em&gt; are responsible for interaction between &lt;em&gt;Domain Objects&lt;/em&gt; and &lt;em&gt;Mappers&lt;/em&gt;. These structures end up creating a &quot;public&quot; interface for interacting with the domain business logic. You can avoid them, but at the penalty of leaking some domain logic into &lt;em&gt;Controllers&lt;/em&gt;.&lt;/p&gt;\n\n&lt;p&gt;There is a related answer to this subject in the &lt;a href=&quot;https://stackoverflow.com/a/9685039/727208&quot;&gt;ACL implementation&lt;/a&gt; question - it might be useful.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;The communication between the model layer and other parts of the MVC triad should happen only through &lt;em&gt;Services&lt;/em&gt;. The clear separation has a few additional benefits:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;it helps to enforce the &lt;a href=&quot;https://en.wikipedia.org/wiki/Single_responsibility_principle&quot; rel=&quot;noreferrer&quot;&gt;single responsibility principle&lt;/a&gt; (SRP)&lt;/li&gt;\n&lt;li&gt;provides additional &apos;wiggle room&apos; in case the logic changes&lt;/li&gt;\n&lt;li&gt;keeps the controller as simple as possible&lt;/li&gt;\n&lt;li&gt;gives a clear blueprint, if you ever need an external API&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&amp;nbsp;&lt;/p&gt;\n\n&lt;h1&gt;How to interact with a model?&lt;/h1&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;&lt;sub&gt;&lt;em&gt;&lt;strong&gt;Prerequisites:&lt;/strong&gt; watch lectures &lt;a href=&quot;http://www.youtube.com/watch?v=-FRm3VPhseI&quot; rel=&quot;noreferrer&quot;&gt;&quot;Global State and Singletons&quot;&lt;/a&gt; and &lt;a href=&quot;http://www.youtube.com/watch?v=RlfLCWKxHJ0&quot; rel=&quot;noreferrer&quot;&gt;&quot;Don&apos;t Look For Things!&quot;&lt;/a&gt; from the Clean Code Talks.&lt;/em&gt;&lt;/sub&gt;&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;h3&gt;Gaining access to service instances&lt;/h3&gt;\n\n&lt;p&gt;For both the &lt;em&gt;View&lt;/em&gt; and &lt;em&gt;Controller&lt;/em&gt; instances (what you could call: &quot;UI layer&quot;) to have access these services,  there are two general approaches: &lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;You can inject the required services in the constructors of your views and controllers directly, preferably using a DI container. &lt;/li&gt;\n&lt;li&gt;Using a factory for services as a mandatory dependency for all of your views and controllers. &lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;As you might suspect, the DI container is a lot more elegant solution (while not being the easiest for a beginner). The two libraries, that I recommend considering for this functionality would be Syfmony&apos;s standalone &lt;a href=&quot;http://symfony.com/doc/master/components/dependency_injection.html&quot; rel=&quot;noreferrer&quot;&gt;DependencyInjection component&lt;/a&gt; or &lt;a href=&quot;https://github.com/rdlowrey/auryn&quot; rel=&quot;noreferrer&quot;&gt;Auryn&lt;/a&gt;. &lt;/p&gt;\n\n&lt;p&gt;Both the solutions using a factory and a DI container would let you also share the instances of various servers to be shared between the selected controller and view for a given request-response cycle.&lt;/p&gt;\n\n&lt;h3&gt;Alteration of model&apos;s state&lt;/h3&gt;\n\n&lt;p&gt;Now that you can access to the model layer in the controllers, you need to start actually using them: &lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;postLogin&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Request &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;&lt;/span&gt;)\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$email&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;email&apos;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;identification-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;findIdentityByEmailAddress&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$email&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;identification-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loginWithPassword&lt;/span&gt;(\n        &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;,\n        &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;)\n    );\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Your controllers have a very clear task: take the user input and, based on this input, change the current state of business logic. In this example the states that are changed between are &quot;anonymous user&quot; and &quot;logged in user&quot;. &lt;/p&gt;\n\n&lt;p&gt;Controller is not responsible for validating user&apos;s input, because that is part of business rules and controller is definitely not calling SQL queries, like what you would see &lt;a href=&quot;https://stackoverflow.com/questions/44535565/codeigniniter-insert-data-through-models-and-controller&quot;&gt;here&lt;/a&gt; or &lt;a href=&quot;https://stackoverflow.com/questions/27025412/loading-multiple-select-options-into-array&quot;&gt;here&lt;/a&gt; (please don&apos;t hate on them, they are misguided, not evil).&lt;/p&gt;\n\n&lt;h3&gt;Showing user the state-change.&lt;/h3&gt;\n\n&lt;p&gt;Ok, user has logged in (or failed). &lt;a href=&quot;http://i0.kym-cdn.com/photos/images/original/001/142/233/897.gif&quot; rel=&quot;noreferrer&quot;&gt;Now what?&lt;/a&gt; Said user is still unaware of it. So you need to actually produce a response and that is the responsibility of a view. &lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;postLogin&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;)\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$path&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;/login&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;identification-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;isUserLoggedIn&lt;/span&gt;()) {\n        &lt;span class=&quot;hljs-variable&quot;&gt;$path&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;/dashboard&apos;&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RedirectResponse&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$path&lt;/span&gt;); \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;In this case, the view produced one of two possible responses, based on the current state of model layer. For a different use-case you would have the view picking different templates to render, based on something like &quot;current selected of article&quot; .&lt;/p&gt;\n\n&lt;p&gt;The presentation layer can actually get quite elaborate, as described here: &lt;a href=&quot;https://stackoverflow.com/a/16596704/727208&quot;&gt;Understanding MVC Views in PHP&lt;/a&gt;.&lt;/p&gt;\n\n&lt;h3&gt;But I am just making a REST API!&lt;/h3&gt;\n\n&lt;p&gt;Of course, there are situations, when this is a overkill.&lt;/p&gt;\n\n&lt;p&gt;MVC is just a concrete solution for &lt;a href=&quot;https://en.wikipedia.org/wiki/Separation_of_concerns&quot; rel=&quot;noreferrer&quot;&gt;Separation of Concerns&lt;/a&gt; principle. &lt;em&gt;MVC separates user interface from the business logic, and it in the UI it separated handling of user input and the presentation.&lt;/em&gt; This is crucial. While often people describe it as a &quot;triad&quot;, it&apos;s not actually made up from three independent parts. The structure is more like this: &lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/iEn76.png&quot; alt=&quot;MVC separation&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;It means, that, when your presentation layer&apos;s logic is close to none-existent, the pragmatic approach is to keep them as single layer. It also can substantially simplify some aspects of model layer. &lt;/p&gt;\n\n&lt;p&gt;Using this approach the login example (for an API) can be written as:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;postLogin&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Request &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;&lt;/span&gt;)\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$email&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;email&apos;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$data&lt;/span&gt; = [\n        &lt;span class=&quot;hljs-string&quot;&gt;&apos;status&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;ok&apos;&lt;/span&gt;,\n    ];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n        &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;identification-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;findIdentityByEmailAddress&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$email&lt;/span&gt;);\n        &lt;span class=&quot;hljs-variable&quot;&gt;$token&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;identification-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;loginWithPassword&lt;/span&gt;(\n            &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;,\n            &lt;span class=&quot;hljs-variable&quot;&gt;$request&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;get&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;password&apos;&lt;/span&gt;)\n        );\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (FailedIdentification &lt;span class=&quot;hljs-variable&quot;&gt;$exception&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable&quot;&gt;$data&lt;/span&gt; = [\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;status&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;error&apos;&lt;/span&gt;,\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;message&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos;Login failed!&apos;&lt;/span&gt;,\n        ]\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;JsonResponse&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$data&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;While this is not sustainable, when you have complicate logic for rendering a response body, this simplification is very useful for more trivial scenarios. But &lt;strong&gt;be warned&lt;/strong&gt;, this approach will become a nightmare, when attempting to use in large codebases with complex presentation logic.&lt;/p&gt;\n\n&lt;p&gt;&amp;nbsp;&lt;/p&gt;\n\n&lt;h1&gt;How to build the model?&lt;/h1&gt;\n\n&lt;p&gt;Since there is not a single &quot;Model&quot; class (as explained above), you really do not &quot;build the model&quot;. Instead you start from making &lt;em&gt;Services&lt;/em&gt;, which are able to perform certain methods. And then implement &lt;em&gt;Domain Objects&lt;/em&gt; and &lt;em&gt;Mappers&lt;/em&gt;.&lt;/p&gt;\n\n&lt;h3&gt;An example of a service method:&lt;/h3&gt;\n\n&lt;p&gt;In the both approaches above there was this login method for the identification service. What would it actually look like. I am using a slightly modified version of the same functionality from &lt;a href=&quot;https://github.com/teresko/palladium&quot; rel=&quot;noreferrer&quot;&gt;a library&lt;/a&gt;, that I wrote .. because I am lazy:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;loginWithPassword&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Identity &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;&lt;/span&gt;): &lt;span class=&quot;hljs-title&quot;&gt;string&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;matchPassword&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;) === &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;logWrongPasswordNotice&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;, [\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;email&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getEmailAddress&lt;/span&gt;(),\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;key&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;, // this is the wrong password\n        ]);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;PasswordMismatch&lt;/span&gt;;\n    }\n\n    &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;setPassword&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$password&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;updateIdentityOnUse&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$cookie&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;createCookieIdentity&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;logger-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;login successful&apos;&lt;/span&gt;, [\n        &lt;span class=&quot;hljs-string&quot;&gt;&apos;input&apos;&lt;/span&gt; =&amp;gt; [\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;email&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getEmailAddress&lt;/span&gt;(),\n        ],\n        &lt;span class=&quot;hljs-string&quot;&gt;&apos;user&apos;&lt;/span&gt; =&amp;gt; [\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;account&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getAccountId&lt;/span&gt;(),\n            &lt;span class=&quot;hljs-string&quot;&gt;&apos;identity&apos;&lt;/span&gt; =&amp;gt; &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getId&lt;/span&gt;(),\n        ],\n    ]);\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$cookie&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;getToken&lt;/span&gt;();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;As you can see, at this level of abstraction, there is no indication of where the data was fetched from. It might be a database, but it also might be just a mock object for testing purposes. Even the data mappers, that are actually used for it, are hidden away in the &lt;code&gt;private&lt;/code&gt; methods of this service.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;changeIdentityStatus&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Entity\\Identity &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$status&lt;/span&gt;&lt;/span&gt;)\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;setStatus&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$status&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;setLastUsed&lt;/span&gt;(&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;time&lt;/span&gt;());\n    &lt;span class=&quot;hljs-variable&quot;&gt;$mapper&lt;/span&gt; = &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;mapperFactory-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;create&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Mapper\\Identity&lt;/span&gt;::&lt;span class=&quot;hljs-variable language_&quot;&gt;class&lt;/span&gt;);\n    &lt;span class=&quot;hljs-variable&quot;&gt;$mapper&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;store&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$identity&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;h3&gt;Ways of creating mappers&lt;/h3&gt;\n\n&lt;p&gt;To implement an abstraction of persistence, on the most flexible approaches is to create custom &lt;a href=&quot;http://martinfowler.com/eaaCatalog/dataMapper.html&quot; rel=&quot;noreferrer&quot;&gt;data mappers&lt;/a&gt;. &lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://ptgmedia.pearsoncmg.com/images/chap3_0321127420/elementLinks/03fig04.gif&quot; alt=&quot;Mapper diagram&quot;&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;sub&gt;From: &lt;a href=&quot;https://martinfowler.com/books/eaa.html&quot; rel=&quot;noreferrer&quot;&gt;PoEAA&lt;/a&gt; book&lt;/sub&gt;&lt;/p&gt;\n\n&lt;p&gt;In practice they are implemented for interaction with specific classes or superclasses. Lets say you have &lt;code&gt;Customer&lt;/code&gt; and &lt;code&gt;Admin&lt;/code&gt; in your code (both inheriting from a &lt;code&gt;User&lt;/code&gt; superclass). Both would probably end up having a separate matching mapper, since they contain different fields. But you will also end up with shared and commonly used operations. For example: updating the &lt;em&gt;&quot;last seen online&quot;&lt;/em&gt; time. And instead of making the existing mappers more convoluted, the more pragmatic approach is to have a general &quot;User Mapper&quot;, which only update that timestamp.&lt;/p&gt;\n\n&lt;h2&gt;Some additional comments:&lt;/h2&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;Database tables and model&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;While sometimes there is a direct 1:1:1 relationship between a database table, &lt;em&gt;Domain Object&lt;/em&gt;, and &lt;em&gt;Mapper&lt;/em&gt;, in larger projects it might be less common than you expect:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Information used by a single &lt;em&gt;Domain Object&lt;/em&gt; might be mapped from different tables, while the object itself has no persistence in the database.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Example:&lt;/em&gt; if you are generating a monthly report. This would collect information from different of tables, but there is no magical &lt;code&gt;MonthlyReport&lt;/code&gt; table in the database.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;A single &lt;em&gt;Mapper&lt;/em&gt; can affect multiple tables.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Example:&lt;/em&gt; when you are storing data from the &lt;code&gt;User&lt;/code&gt; object, this &lt;em&gt;Domain Object&lt;/em&gt; could contain collection of other domain objects - &lt;code&gt;Group&lt;/code&gt; instances. If you alter them and store the &lt;code&gt;User&lt;/code&gt;, the &lt;em&gt;Data Mapper&lt;/em&gt; will have to update and/or insert entries in multiple tables.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Data from a single &lt;em&gt;Domain Object&lt;/em&gt; is stored in more than one table.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Example:&lt;/em&gt; in large systems (think: a medium-sized social network), it might be pragmatic to store user authentication data and often-accessed data separately from larger chunks of content, which is rarely required. In that case you might still have a single &lt;code&gt;User&lt;/code&gt; class, but the information it contains would depend of whether full details were fetched.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;For every &lt;em&gt;Domain Object&lt;/em&gt; there can be more than one mapper&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Example:&lt;/em&gt; you have a news site with a shared codebased for both public-facing and the management software. But, while both interfaces use the same &lt;code&gt;Article&lt;/code&gt; class, the management needs a lot more info populated in it. In this case you would have two separate mappers: &quot;internal&quot; and &quot;external&quot;. Each performing different queries, or even use different databases (as in master or slave).&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;A view is not a template&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;View&lt;/em&gt; instances in MVC (if you are not using the MVP variation of the pattern) are responsible for the presentational logic. This means that each &lt;em&gt;View&lt;/em&gt; will usually juggle at least a few templates. It acquires data from the &lt;em&gt;Model Layer&lt;/em&gt; and then, based on the received information, chooses a template and sets values.&lt;/p&gt;\n\n&lt;p&gt;One of the benefits you gain from this is re-usability. If you create a &lt;code&gt;ListView&lt;/code&gt; class, then, with well-written code, you can have the same class handing the presentation of user-list and comments below an article. Because they both have the same presentation logic. You just switch templates.&lt;/p&gt;\n\n&lt;p&gt;You can use either &lt;a href=&quot;http://codeangel.org/articles/simple-php-template-engine.html&quot; rel=&quot;noreferrer&quot;&gt;native PHP templates&lt;/a&gt; or use some third-party templating engine. There also might be some third-party libraries, which are able to fully replace &lt;em&gt;View&lt;/em&gt; instances.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;What about the old version of the answer?&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;The only major change is that, what is called &lt;em&gt;Model&lt;/em&gt; in the old version, is actually a &lt;em&gt;Service&lt;/em&gt;. The rest of the &quot;library analogy&quot; keeps up pretty well.&lt;/p&gt;\n\n&lt;p&gt;The only flaw that I see is that this would be a really strange library, because it would return you information from the book, but not let you touch the book itself, because otherwise the abstraction would start to &quot;leak&quot;. I might have to think of a more fitting analogy.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;strong&gt;What is the relationship between &lt;em&gt;View&lt;/em&gt; and &lt;em&gt;Controller&lt;/em&gt; instances?&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;The MVC structure is composed of two layers: ui and model. The main structures in the &lt;em&gt;UI layer&lt;/em&gt; are views and controller. &lt;/p&gt;\n\n&lt;p&gt;When you are dealing with websites that use MVC design pattern, the best way is to have 1:1 relation between views and controllers. Each view represents a whole page in your website and it has a dedicated controller to handle all the incoming requests for that particular view.&lt;/p&gt;\n\n&lt;p&gt;For example, to represent an opened article, you would have &lt;code&gt;\\Application\\Controller\\Document&lt;/code&gt; and &lt;code&gt;\\Application\\View\\Document&lt;/code&gt;. This would contain all the main functionality for UI layer, when it comes to dealing with articles &lt;em&gt;(of course you might have some &lt;a href=&quot;https://developer.mozilla.org/en/xmlhttprequest&quot; rel=&quot;noreferrer&quot;&gt;XHR&lt;/a&gt; components that are not directly related to articles)&lt;/em&gt;.&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;Everything that is &lt;strong&gt;business logic&lt;/strong&gt; belongs in a model, whether it is a database query, calculations, a REST call, etc.&lt;/p&gt;\n\n&lt;p&gt;You can have the data access in the model itself, the MVC pattern doesn&apos;t restrict you from doing that. You can sugar coat it with services, mappers and what not, but the actual definition of a model is a layer that handles business logic, nothing more, nothing less. It can be a class, a function, or a complete module with a gazillion objects if that&apos;s what you want.&lt;/p&gt;\n\n&lt;p&gt;It&apos;s always easier to have a separate object that actually executes the database queries instead of having them being executed in the model directly: this will especially come in handy when unit testing (because of the easiness of injecting a mock database dependency in your model):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Database&lt;/span&gt; &lt;/span&gt;{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$_conn&lt;/span&gt;;\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;__construct&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$connection&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n       &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;_conn = &lt;span class=&quot;hljs-variable&quot;&gt;$connection&lt;/span&gt;;\n   }\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ExecuteObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$data&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n       &lt;span class=&quot;hljs-comment&quot;&gt;// stuff&lt;/span&gt;\n   }\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Model&lt;/span&gt; &lt;/span&gt;{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$_db&lt;/span&gt;;\n\n   &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;__construct&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Database &lt;span class=&quot;hljs-variable&quot;&gt;$db&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n       &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;_db = &lt;span class=&quot;hljs-variable&quot;&gt;$db&lt;/span&gt;;\n   }\n}\n\n&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Model&lt;/span&gt; &lt;/span&gt;{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CheckUsername&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$username&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n       &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n       &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT Username FROM&quot;&lt;/span&gt; . &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;usersTableName . &lt;span class=&quot;hljs-string&quot;&gt;&quot; WHERE ...&quot;&lt;/span&gt;;\n       &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;$this&lt;/span&gt;-&amp;gt;_db-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;ExecuteObject&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;, &lt;span class=&quot;hljs-variable&quot;&gt;$data&lt;/span&gt;);\n   }\n}\n\n&lt;span class=&quot;hljs-variable&quot;&gt;$db&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Database&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$conn&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable&quot;&gt;$model&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;User&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$db&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable&quot;&gt;$model&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;CheckUsername&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;foo&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Also, in PHP, you rarely need to catch/rethrow exceptions because the backtrace is preserved, especially in a case like your example. Just let the exception be thrown and catch it in the controller instead.&lt;/p&gt;\n    ","\n&lt;p&gt;In Web-&quot;MVC&quot; you can do whatever you please.&lt;/p&gt;\n\n&lt;p&gt;The original concept &lt;sup&gt;&lt;a href=&quot;https://stackoverflow.com/questions/1549857/simple-php-mvc-framework/1549970#1549970&quot;&gt;(1)&lt;/a&gt;&lt;/sup&gt; described the model as the business logic. It should represent the application state and enforce some data consistency. That approach is often described as &quot;fat model&quot;.&lt;/p&gt;\n\n&lt;p&gt;Most PHP frameworks follow a more shallow approach, where the model is just a database interface. But at the very least these models should still validate the incoming data and relations.&lt;/p&gt;\n\n&lt;p&gt;Either way, you&apos;re not very far off if you separate the SQL stuff or database calls into another layer. This way you only need to concern yourself with the real data/behaviour, not with the actual storage API. (It&apos;s however unreasonable to overdo it. You&apos;ll e.g. never be able to replace a database backend with a filestorage if that wasn&apos;t designed ahead.)&lt;/p&gt;\n    ","\n&lt;p&gt;More oftenly most of the applications will have data,display and processing part and we just put all  those in the letters &lt;code&gt;M&lt;/code&gt;,&lt;code&gt;V&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt;.  &lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Model(&lt;code&gt;M&lt;/code&gt;)&lt;/em&gt;--&amp;gt;Has the attributes that holds state of application and it dont know any thing about &lt;code&gt;V&lt;/code&gt; and &lt;code&gt;C&lt;/code&gt;.  &lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;View(&lt;code&gt;V&lt;/code&gt;)&lt;/em&gt;--&amp;gt;Has displaying format for the application and and only knows about how-to-digest model on it and does not bother about &lt;code&gt;C&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;em&gt;Controller(&lt;code&gt;C&lt;/code&gt;)&lt;/em&gt;----&amp;gt;Has processing part of application and acts as wiring between M and V and it depends on both &lt;code&gt;M&lt;/code&gt;,&lt;code&gt;V&lt;/code&gt; unlike &lt;code&gt;M&lt;/code&gt; and &lt;code&gt;V&lt;/code&gt;.  &lt;/p&gt;\n\n&lt;p&gt;Altogether there is separation of concern between each.\nIn future any change or enhancements can be added very easily.&lt;/p&gt;\n    ","\n&lt;p&gt;In my case I have a database class that handle all the direct database interaction such as querying, fetching, and such. So if I had to change my database from &lt;a href=&quot;http://en.wikipedia.org/wiki/MySQL&quot; rel=&quot;nofollow noreferrer&quot;&gt;MySQL&lt;/a&gt; to &lt;a href=&quot;http://en.wikipedia.org/wiki/PostgreSQL&quot; rel=&quot;nofollow noreferrer&quot;&gt;PostgreSQL&lt;/a&gt; there won&apos;t be any problem. So adding that extra layer can be useful.&lt;/p&gt;\n&lt;p&gt;Each table can have its own class and have its specific methods, but to actually get the data, it lets the database class handle it:&lt;/p&gt;\n&lt;h3&gt;File &lt;code&gt;Database.php&lt;/code&gt;&lt;/h3&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Database&lt;/span&gt; &lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$connection&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$current_query&lt;/span&gt;;\n    ...\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;query&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;&lt;/span&gt;) &lt;/span&gt;{\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-variable&quot;&gt;$connection&lt;/span&gt;){\n            &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;open_connection&lt;/span&gt;();\n        }\n        &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-variable&quot;&gt;$current_query&lt;/span&gt; = &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$result&lt;/span&gt; = &lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;mysql_query&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;,&lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-variable&quot;&gt;$connection&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-variable&quot;&gt;$result&lt;/span&gt;){\n            &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;close_connection&lt;/span&gt;();\n            &lt;span class=&quot;hljs-comment&quot;&gt;// throw custom error&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// The query failed for some reason. here is query :: self::$current_query&lt;/span&gt;\n            &lt;span class=&quot;hljs-variable&quot;&gt;$error&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Error&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;There is an Error in the query.\\n&amp;lt;b&amp;gt;Query:&amp;lt;/b&amp;gt;\\n&lt;span class=&quot;hljs-subst&quot;&gt;{$sql}&lt;/span&gt;\\n&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-variable&quot;&gt;$error&lt;/span&gt;-&amp;gt;&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;handleError&lt;/span&gt;();\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$result&lt;/span&gt;;\n    }\n ....\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;find_by_sql&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;{\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;is_string&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;))\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-variable&quot;&gt;$result_set&lt;/span&gt; = &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;query&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;);\n        &lt;span class=&quot;hljs-variable&quot;&gt;$obj_arr&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;array&lt;/span&gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (&lt;span class=&quot;hljs-variable&quot;&gt;$row&lt;/span&gt; = &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;fetch_array&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$result_set&lt;/span&gt;))\n        {\n            &lt;span class=&quot;hljs-variable&quot;&gt;$obj_arr&lt;/span&gt;[] = &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;instantiate&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$row&lt;/span&gt;);\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;$obj_arr&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Table object classL&lt;/p&gt;\n&lt;pre class=&quot;lang-php s-code-block&quot;&gt;&lt;code class=&quot;hljs language-php&quot;&gt;&lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DomainPeer&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Database&lt;/span&gt; &lt;/span&gt;{\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;getDomainInfoList&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) &lt;/span&gt;{\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&apos;SELECT &apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;d.`id`,&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;d.`name`,&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;d.`shortName`,&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;d.`created_at`,&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;d.`updated_at`,&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;count(q.id) as queries &apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;FROM `domains` d &apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;LEFT JOIN queries q on q.domainId = d.id &apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt; .=&lt;span class=&quot;hljs-string&quot;&gt;&apos;GROUP BY d.id&apos;&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;self&lt;/span&gt;::&lt;span class=&quot;hljs-title function_ invoke__&quot;&gt;find_by_sql&lt;/span&gt;(&lt;span class=&quot;hljs-variable&quot;&gt;$sql&lt;/span&gt;);\n    }\n\n    ....\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I hope this example helps you create a good structure.&lt;/p&gt;\n    "],"552":["\n&lt;h1&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/NumberFormat&quot; rel=&quot;noreferrer&quot;&gt;Intl.NumberFormat&lt;/a&gt;&lt;/h1&gt;\n&lt;p&gt;JavaScript has a number formatter (part of the Internationalization API).&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Create our number formatter.&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; formatter = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intl&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;NumberFormat&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;en-US&apos;&lt;/span&gt;, {\n  &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;currency&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;USD&apos;&lt;/span&gt;,\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// These options are needed to round to whole numbers if that&apos;s what you want.&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//minimumFractionDigits: 0, // (this suffices for whole numbers, but will print 2500.10 as $2,500.1)&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//maximumFractionDigits: 0, // (causes 2500.99 to be printed as $2,501)&lt;/span&gt;\n});\n\nformatter.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2500&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;/* $2,500.00 */&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Use &lt;code&gt;undefined&lt;/code&gt; in place of the first argument (&lt;code&gt;&apos;en-US&apos;&lt;/code&gt; in the example) to use the system locale (the user locale in case the code is running in a browser). &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl#Locale_identification_and_negotiation&quot; rel=&quot;noreferrer&quot;&gt;Further explanation of the locale code&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Here&apos;s a &lt;a href=&quot;https://www.iban.com/currency-codes&quot; rel=&quot;noreferrer&quot;&gt;list of the currency codes&lt;/a&gt;.&lt;/p&gt;\n&lt;h2&gt;Intl.NumberFormat vs Number.prototype.toLocaleString&lt;/h2&gt;\n&lt;p&gt;A final note comparing this to the older .&lt;code&gt;toLocaleString&lt;/code&gt;. They both offer essentially the same functionality. However, toLocaleString in its older incarnations (pre-Intl) &lt;a href=&quot;http://www.ecma-international.org/ecma-262/5.1/#sec-15.7.4.3&quot; rel=&quot;noreferrer&quot;&gt;does not actually support locales&lt;/a&gt;: it uses the system locale. So when debugging old browsers, be sure that you&apos;re using the correct version (&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Checking_for_support_for_locales_and_options_arguments&quot; rel=&quot;noreferrer&quot;&gt;MDN suggests to check for the existence of &lt;code&gt;Intl&lt;/code&gt;&lt;/a&gt;). There isn&apos;t any need to worry about this at all if you don&apos;t care about old browsers or just use the &lt;a href=&quot;https://github.com/andyearnshaw/Intl.js&quot; rel=&quot;noreferrer&quot;&gt;shim&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Also, the performance of both is the same for a &lt;em&gt;single&lt;/em&gt; item, but if you have a lot of numbers to format, using &lt;code&gt;Intl.NumberFormat&lt;/code&gt; is ~70 times faster. Therefore, it&apos;s usually best to use &lt;code&gt;Intl.NumberFormat&lt;/code&gt; and instantiate only once per page load. Anyway, here&apos;s the equivalent usage of &lt;code&gt;toLocaleString&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2500&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;en-US&apos;&lt;/span&gt;, {\n  &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;currency&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;USD&apos;&lt;/span&gt;,\n}); &lt;span class=&quot;hljs-comment&quot;&gt;/* $2,500.00 */&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Some notes on browser support and Node.js&lt;/h3&gt;\n&lt;ul&gt;\n&lt;li&gt;Browser support is no longer an issue nowadays with 98% support globally, 99% in the US and 99+% in the EU&lt;/li&gt;\n&lt;li&gt;There is a &lt;a href=&quot;https://github.com/andyearnshaw/Intl.js&quot; rel=&quot;noreferrer&quot;&gt;shim&lt;/a&gt; to support it on fossilized browsers (like &lt;a href=&quot;https://en.wikipedia.org/wiki/Internet_Explorer_8&quot; rel=&quot;noreferrer&quot;&gt;Internet&amp;nbsp;Explorer&amp;nbsp;8&lt;/a&gt;), should you really need to&lt;/li&gt;\n&lt;li&gt;Node.js before v13 only supports &lt;code&gt;en-US&lt;/code&gt; out of the box. One solution is to install &lt;a href=&quot;https://github.com/icu-project/full-icu-npm&quot; rel=&quot;noreferrer&quot;&gt;full-icu&lt;/a&gt;, see &lt;a href=&quot;https://stackoverflow.com/a/39626602/1000608&quot;&gt;here&lt;/a&gt; for more information&lt;/li&gt;\n&lt;li&gt;Have a look at &lt;a href=&quot;https://caniuse.com/#feat=internationalization&quot; rel=&quot;noreferrer&quot;&gt;CanIUse&lt;/a&gt; for more information&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;h2&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toFixed&quot; rel=&quot;noreferrer&quot;&gt;Number.prototype.toFixed&lt;/a&gt;&lt;/h2&gt;\n&lt;p&gt;This solution is compatible with every single major browser:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; profits = &lt;span class=&quot;hljs-number&quot;&gt;2489.8237&lt;/span&gt;;\n\n  profits.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// Returns 2489.824 (rounds up)&lt;/span&gt;\n  profits.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// Returns 2489.82&lt;/span&gt;\n  profits.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// Returns 2489.8237000 (pads the decimals)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;All you need is to add the currency symbol (e.g. &lt;code&gt;&quot;$&quot; + profits.toFixed(2)&lt;/code&gt;) and you will have your amount in dollars.&lt;/p&gt;\n&lt;h2&gt;Custom function&lt;/h2&gt;\n&lt;p&gt;If you require the use of &lt;code&gt;,&lt;/code&gt; between each digit, you can use this function:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;false&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;number, decPlaces, decSep, thouSep&lt;/span&gt;) {\n    decPlaces = &lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(decPlaces = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(decPlaces)) ? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : decPlaces,\n    decSep = &lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; decSep === &lt;span class=&quot;hljs-string&quot;&gt;&quot;undefined&quot;&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; : decSep;\n    thouSep = &lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; thouSep === &lt;span class=&quot;hljs-string&quot;&gt;&quot;undefined&quot;&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt; : thouSep;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; sign = number &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(number = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(number) || &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces)));\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; j = (j = i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; ? j % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sign +\n        (j ? i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, j) + thouSep : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) +\n        i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\decSep{3})(?=\\decSep)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt; + thouSep) +\n        (decPlaces ? decSep + &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(number - i).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces).&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;addEventListener&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;click&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;event&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;innerText&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Result was: &quot;&lt;/span&gt; + &lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;value&lt;/span&gt;);\n});&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;snippet-code-html lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;Insert your amount: &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Cash amount&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;br&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Get Output&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;(press button to get output)&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif1&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Use it like so:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789.12345&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If you&apos;re always going to use &apos;.&apos; and &apos;,&apos;, you can leave them off your method call, and the method will default them for you.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789.12345&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If your culture has the two symbols flipped (i.e., Europeans) and you would like to use the defaults, just paste over the following two lines in the &lt;code&gt;formatMoney&lt;/code&gt; method:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;    d = d == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt; : d,\n    t = t == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; : t,\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h2&gt;Custom function (ES6)&lt;/h2&gt;\n&lt;p&gt;If you can use modern ECMAScript syntax (i.e., through Babel), you can use this simpler function instead:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;amount, decimalCount = &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, decimal = &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;, thousands = &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt;&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n    decimalCount = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(decimalCount);\n    decimalCount = &lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(decimalCount) ? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : decimalCount;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; negativeSign = amount &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(amount = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(amount) || &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decimalCount)).&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; j = (i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) ? i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;\n      negativeSign +\n      (j ? i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, j) + thousands : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;) +\n      i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})(?=\\d)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt; + thousands) +\n      (decimalCount ? decimal + &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(amount - i).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decimalCount).&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n  } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (e) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(e)\n  }\n};\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;addEventListener&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;click&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;event&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n  &lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;innerText&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Result was: &quot;&lt;/span&gt; + &lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;getElementById&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-property&quot;&gt;value&lt;/span&gt;);\n});&lt;/code&gt;&lt;/pre&gt;\n&lt;pre class=&quot;snippet-code-html lang-html s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;Insert your amount: &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;input&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;d&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;placeholder&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Cash amount&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;label&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;br&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;b&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;Get Output&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;x&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;(press button to get output)&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif2&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;h2&gt;Short and fast solution (works everywhere!)&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12345.67&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\d(?=(\\d{3})+\\.)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;,&apos;&lt;/span&gt;);  &lt;span class=&quot;hljs-comment&quot;&gt;// 12,345.67&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The idea behind this solution is replacing matched sections with first match and comma, i.e. &lt;code&gt;&apos;$&amp;amp;,&apos;&lt;/code&gt;. The matching is done using &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions#special-lookahead&quot; rel=&quot;noreferrer&quot;&gt;lookahead approach&lt;/a&gt;. You may read the expression as &lt;em&gt;&quot;match a number if it is followed by a sequence of three number sets (one or more) and a dot&quot;&lt;/em&gt;.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;TESTS:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;        --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;1.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;       --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;12.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;123&lt;/span&gt;      --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;123.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1234&lt;/span&gt;     --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;1,234.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12345&lt;/span&gt;    --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;12,345.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;123456&lt;/span&gt;   --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;123,456.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;1234567&lt;/span&gt;  --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;1,234,567.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12345.67&lt;/span&gt; --&amp;gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;12,345.67&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;DEMO:&lt;/strong&gt; &lt;a href=&quot;http://jsfiddle.net/hAfMM/9571/&quot; rel=&quot;noreferrer&quot;&gt;http://jsfiddle.net/hAfMM/9571/&lt;/a&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Extended short solution&lt;/h2&gt;\n\n&lt;p&gt;You can also extend the prototype of &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Number&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;Number&lt;/code&gt;&lt;/a&gt; object to add additional support of any number of decimals &lt;code&gt;[0 .. n]&lt;/code&gt; and the size of number groups &lt;code&gt;[0 .. x]&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Number.prototype.format(n, x)\n * \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; integer n: length of decimal\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; integer x: length of sections\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;n, x&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; re = &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\d(?=(\\\\d{&apos;&lt;/span&gt; + (x || &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;})+&apos;&lt;/span&gt; + (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\.&apos;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, ~~n)).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RegExp&lt;/span&gt;(re, &lt;span class=&quot;hljs-string&quot;&gt;&apos;g&apos;&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;,&apos;&lt;/span&gt;);\n};\n\n&lt;span class=&quot;hljs-number&quot;&gt;1234.&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;();           &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;1,234&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12345.&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);         &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12,345.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;123456.7&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);    &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12,34,56.700&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;123456.789&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;);  &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12,3456.79&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;DEMO / TESTS:&lt;/strong&gt; &lt;a href=&quot;http://jsfiddle.net/hAfMM/435/&quot; rel=&quot;noreferrer&quot;&gt;http://jsfiddle.net/hAfMM/435/&lt;/a&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Super extended short solution&lt;/h2&gt;\n\n&lt;p&gt;In this &lt;a href=&quot;https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript/14428340#comment34151293_14428340&quot;&gt;super extended version&lt;/a&gt; you may set different delimiter types:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Number.prototype.format(n, x, s, c)\n * \n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; integer n: length of decimal\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; integer x: length of whole part\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; mixed   s: sections delimiter\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; mixed   c: decimal delimiter\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;n, x, s, c&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; re = &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\d(?=(\\\\d{&apos;&lt;/span&gt; + (x || &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;})+&apos;&lt;/span&gt; + (n &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\D&apos;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;)&apos;&lt;/span&gt;,\n        num = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;max&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, ~~n));\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (c ? num.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, c) : num).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RegExp&lt;/span&gt;(re, &lt;span class=&quot;hljs-string&quot;&gt;&apos;g&apos;&lt;/span&gt;), &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;&apos;&lt;/span&gt; + (s || &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;));\n};\n\n&lt;span class=&quot;hljs-number&quot;&gt;12345678.9&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;);  &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12.345.678,90&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;123456.789&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos; &apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;:&apos;&lt;/span&gt;);  &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12 3456:7890&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-number&quot;&gt;12345678.9&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;-&apos;&lt;/span&gt;);       &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;12-345-679&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;DEMO / TESTS:&lt;/strong&gt; &lt;a href=&quot;http://jsfiddle.net/hAfMM/612/&quot; rel=&quot;noreferrer&quot;&gt;http://jsfiddle.net/hAfMM/612/&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Take a look at the JavaScript &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number&quot; rel=&quot;noreferrer&quot;&gt;Number&lt;/a&gt; object and see if it can help you.&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;toLocaleString()&lt;/code&gt; will format a number using location specific thousands separator.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;toFixed()&lt;/code&gt; will round the number to a specific number of decimal places.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;To use these at the same time the value must have its type changed back to a number because they both output a string.&lt;/p&gt;\n&lt;p&gt;Example:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;((someNumber).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;()\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;One can just use toLocaleString directly and its not necessary to recast to a number:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;someNumber.&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt;, {&lt;span class=&quot;hljs-attr&quot;&gt;minimumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;maximumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h4&gt;Multiple numbers&lt;/h4&gt;\n&lt;p&gt;If you need to frequently format numbers similarly you can create a specific object for reuse. Like for German (Switzerland):&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; money = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intl&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;NumberFormat&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;de-CH&apos;&lt;/span&gt;,\n  { &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;currency&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;CHF&apos;&lt;/span&gt; });\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; percent = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intl&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;NumberFormat&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;de-CH&apos;&lt;/span&gt;,\n  { &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;:&lt;span class=&quot;hljs-string&quot;&gt;&apos;percent&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;maximumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;signDisplay&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;always&quot;&lt;/span&gt;});\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;which than can be used as:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;money.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1234.50&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// output CHF 1&apos;234.50&lt;/span&gt;\npercent.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0.083&lt;/span&gt;);  &lt;span class=&quot;hljs-comment&quot;&gt;// output +8.3%&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Pretty nifty.&lt;/p&gt;\n    ","\n&lt;p&gt;Below is the &lt;a href=&quot;https://stackoverflow.com/questions/149055/how-can-i-format-numbers-as-money-in-javascript/149099#149099&quot;&gt;Patrick Desjardins (alias Daok)&lt;/a&gt; code with a bit of comments added and some minor changes:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/*\ndecimal_sep: character used as decimal separator, it defaults to &apos;.&apos; when omitted\nthousands_sep: char used as thousands separator, it defaults to &apos;,&apos; when omitted\n*/&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;toMoney&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;decimals, decimal_sep, thousands_sep&lt;/span&gt;)\n{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;,\n   c = &lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(decimals) ? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(decimals), &lt;span class=&quot;hljs-comment&quot;&gt;// If decimal is zero we must take it. It means the user does not want to show any decimal&lt;/span&gt;\n   d = decimal_sep || &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-comment&quot;&gt;// If no decimal separator is passed, we use the dot as default decimal separator (we MUST use a decimal separator)&lt;/span&gt;\n\n   &lt;span class=&quot;hljs-comment&quot;&gt;/*\n   According to [https://stackoverflow.com/questions/411352/how-best-to-determine-if-an-argument-is-not-sent-to-the-javascript-function]\n   the fastest way to check for not defined parameter is to use typeof value === &apos;undefined&apos;\n   rather than doing value === undefined.\n   */&lt;/span&gt;\n   t = (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; thousands_sep === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt; : thousands_sep, &lt;span class=&quot;hljs-comment&quot;&gt;// If you don&apos;t want to use a thousands separator you can pass empty string as thousands_sep value&lt;/span&gt;\n\n   sign = (n &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;-&apos;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;,\n\n   &lt;span class=&quot;hljs-comment&quot;&gt;// Extracting the absolute value of the integer part of the number and converting to string&lt;/span&gt;\n   i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(n = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(n).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(c)) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;,\n\n   j = ((j = i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) ? j % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sign + (j ? i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, j) + t : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;) + i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})(?=\\d)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt; + t) + (c ? d + &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(n - i).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(c).&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And here some tests:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Some tests (do not forget parenthesis when using negative numbers and number with no decimals)&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789.67392&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;() + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-number&quot;&gt;123456789.67392&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-number&quot;&gt;123456789.67392&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + (&lt;span class=&quot;hljs-number&quot;&gt;123456&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;() + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + (&lt;span class=&quot;hljs-number&quot;&gt;123456&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + &lt;span class=&quot;hljs-number&quot;&gt;89.67392&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;() + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + (&lt;span class=&quot;hljs-number&quot;&gt;89&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;());\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Some tests (do not forget parenthesis when using negative numbers and number with no decimals)&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;((-&lt;span class=&quot;hljs-number&quot;&gt;123456789.67392&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;() + &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\n&apos;&lt;/span&gt; + (-&lt;span class=&quot;hljs-number&quot;&gt;123456789.67392&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toMoney&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;));\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The minor changes are:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;moved a bit the &lt;code&gt;Math.abs(decimals)&lt;/code&gt; to be done only when is not &lt;code&gt;NaN&lt;/code&gt;.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;decimal_sep&lt;/code&gt; can not be empty string any more (a some sort of decimal separator is a &lt;em&gt;must&lt;/em&gt;)&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;we use &lt;code&gt;typeof thousands_sep === &apos;undefined&apos;&lt;/code&gt; as suggested in &lt;a href=&quot;https://stackoverflow.com/questions/411352/how-best-to-determine-if-an-argument-is-not-sent-to-the-javascript-function&quot;&gt;How best to determine if an argument is not sent to the JavaScript function&lt;/a&gt;&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;(+n || 0)&lt;/code&gt; is not needed because &lt;code&gt;this&lt;/code&gt; is a &lt;code&gt;Number&lt;/code&gt; object&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;&lt;a href=&quot;https://jsfiddle.net/9kvrndfu/&quot; rel=&quot;nofollow noreferrer&quot;&gt;JSFiddle&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;If amount is a number, say &lt;code&gt;-123&lt;/code&gt;, then&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;amount.&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;en-US&apos;&lt;/span&gt;, { &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;currency&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;USD&apos;&lt;/span&gt; });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;will produce the string &lt;code&gt;&quot;-$123.00&quot;&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;Here&apos;s a complete working &lt;a href=&quot;http://jsfiddle.net/1h29dguy/&quot; rel=&quot;noreferrer&quot;&gt;example&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;http://openexchangerates.github.io/accounting.js/&quot; rel=&quot;noreferrer&quot;&gt;accounting.js&lt;/a&gt; is a tiny JavaScript library for number, money and currency formatting.&lt;/p&gt;\n    ","\n&lt;p&gt;Here&apos;s the best JavaScript money formatter I&apos;ve seen:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;formatMoney&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;decPlaces, thouSeparator, decSeparator&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;,\n        decPlaces = &lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(decPlaces = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(decPlaces)) ? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : decPlaces,\n        decSeparator = decSeparator == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; : decSeparator,\n        thouSeparator = thouSeparator == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt; : thouSeparator,\n        sign = n &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,\n        i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(n = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(+n || &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces)) + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,\n        j = (j = i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; ? j % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sign + (j ? i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, j) + thouSeparator : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) + i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})(?=\\d)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt; + thouSeparator) + (decPlaces ? decSeparator + &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(n - i).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces).&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;It was reformatted and borrowed from here: &lt;em&gt;&lt;a href=&quot;https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings/149099#149099&quot;&gt;How to format numbers as currency strings&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;You&apos;ll have to supply your own currency designator (you used &lt;code&gt;$&lt;/code&gt; above).&lt;/p&gt;\n&lt;p&gt;Call it like this (although note that the arguments default to 2, comma, and period, so you don&apos;t need to supply any arguments if that&apos;s your preference):&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myMoney = &lt;span class=&quot;hljs-number&quot;&gt;3543.75873&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; formattedMoney = &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt; + myMoney.&lt;span class=&quot;hljs-title function_&quot;&gt;formatMoney&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$3,543.76&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Here&apos;s another attempt, just for fun:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;num&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; p = num.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; + p[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;reduce&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;acc, num, i, orig&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; num + (num != &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; &amp;amp;&amp;amp; i &amp;amp;&amp;amp; !(i % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) + acc;\n    }, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; + p[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;And some tests:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;45664544.23423&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$45,664,544.23&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$45.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$123.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;7824&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$7,824.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$1.00&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1345&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$-1,345.00&lt;/span&gt;\n&lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &quot;$-3.00&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/toLocaleString#Browser_Compatibility&quot; rel=&quot;nofollow noreferrer&quot;&gt;Works for all current browsers&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Use &lt;code&gt;toLocaleString&lt;/code&gt; to format a currency in its language-sensitive representation (using &lt;a href=&quot;https://www.currency-iso.org/en/home/tables/table-a1.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;ISO 4217&lt;/a&gt; currency codes).&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2500&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;en-GB&quot;&lt;/span&gt;, {&lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;currency&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;GBP&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;minimumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;})\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;em&gt;&lt;strong&gt;Example South African Rand code snippets &lt;a href=&quot;https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings/14735423#comment101585127_18994850&quot;&gt;for avenmore&lt;/a&gt;&lt;/strong&gt;&lt;/em&gt;:&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;((&lt;span class=&quot;hljs-number&quot;&gt;2500&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;en-ZA&quot;&lt;/span&gt;, {&lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;currency&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ZAR&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;minimumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}))\n&lt;span class=&quot;hljs-comment&quot;&gt;// -&amp;gt; R 2 500,00&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;((&lt;span class=&quot;hljs-number&quot;&gt;2500&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;en-GB&quot;&lt;/span&gt;, {&lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;currency&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&quot;ZAR&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;minimumFractionDigits&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;}))\n&lt;span class=&quot;hljs-comment&quot;&gt;// -&amp;gt; ZAR 2,500.00&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif3&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I think you want:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;f.&lt;span class=&quot;hljs-property&quot;&gt;nettotal&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;value&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; + showValue.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Ok, based on what you said, I&apos;m using this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DecimalSeparator&lt;/span&gt; = &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;1.2&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;AmountWithCommas&lt;/span&gt; = &lt;span class=&quot;hljs-title class_&quot;&gt;Amount&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;();\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; arParts = &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;AmountWithCommas&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;DecimalSeparator&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; intPart = arParts[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; decPart = (arParts.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; ? arParts[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\ndecPart = (decPart + &lt;span class=&quot;hljs-string&quot;&gt;&apos;00&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&apos; &apos;&lt;/span&gt; + intPart + &lt;span class=&quot;hljs-title class_&quot;&gt;DecimalSeparator&lt;/span&gt; + decPart;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;I&apos;m open to improvement suggestions (I&apos;d prefer not to include &lt;a href=&quot;https://en.wikipedia.org/wiki/Yahoo!_UI_Library&quot; rel=&quot;nofollow noreferrer&quot;&gt;YUI&lt;/a&gt; just to do this :-) )&lt;/p&gt;\n&lt;p&gt;I already know I should be detecting the &quot;.&quot; instead of just using it as the decimal separator...&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;http://numeraljs.com/&quot; rel=&quot;nofollow noreferrer&quot;&gt;Numeral.js&lt;/a&gt; - a JavaScript library for easy number formatting by @adamwdraper&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title function_&quot;&gt;numeral&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;23456.789&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;$0,0.00&apos;&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// = &quot;$23,456.79&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The following is concise, easy to understand, and doesn&apos;t rely on any overly complicated regular expressions.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;moneyFormat&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;price, sign = &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; pieces = &lt;span class=&quot;hljs-built_in&quot;&gt;parseFloat&lt;/span&gt;(price).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n  &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; ii = pieces.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; ((ii-=&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n    pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(ii, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;)\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sign + pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n}\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(\n  &lt;span class=&quot;hljs-title function_&quot;&gt;moneyFormat&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;moneyFormat&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;moneyFormat&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10000.00&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;moneyFormat&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1000000000000000000&lt;/span&gt;)\n)&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif4&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;Here is a version with more options in the final output to allow formatting different currencies in different locality formats.&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// higher order function that takes options then a price and will return the formatted price&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;makeMoneyFormatter&lt;/span&gt; = (&lt;span class=&quot;hljs-params&quot;&gt;{\n  sign = &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;,\n  delimiter = &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;,\n  decimal = &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;,\n  append = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;,\n  precision = &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n  round = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;,\n  custom\n} = {}&lt;/span&gt;) =&amp;gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;value&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; e = [&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10000&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1000000&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10000000&lt;/span&gt;]\n\n  value = round\n    ? (&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;round&lt;/span&gt;(value * e[precision]) / e[precision])\n    : &lt;span class=&quot;hljs-built_in&quot;&gt;parseFloat&lt;/span&gt;(value)\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; pieces = value\n    .&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(precision)\n    .&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, decimal)\n    .&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; ii = pieces.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - (precision ? precision + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; ((ii-=&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) {\n    pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(ii, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, delimiter)\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; custom === &lt;span class=&quot;hljs-string&quot;&gt;&apos;function&apos;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;custom&lt;/span&gt;({\n      sign,\n      &lt;span class=&quot;hljs-attr&quot;&gt;float&lt;/span&gt;: value,\n      &lt;span class=&quot;hljs-attr&quot;&gt;value&lt;/span&gt;: pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n    })\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; append\n    ? pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;) + sign\n    : sign + pieces.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// create currency converters with the correct formatting options&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; formatDollar = &lt;span class=&quot;hljs-title function_&quot;&gt;makeMoneyFormatter&lt;/span&gt;()\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; formatPound = &lt;span class=&quot;hljs-title function_&quot;&gt;makeMoneyFormatter&lt;/span&gt;({\n  &lt;span class=&quot;hljs-attr&quot;&gt;sign&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;precision&lt;/span&gt;: &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n})\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; formatEuro = &lt;span class=&quot;hljs-title function_&quot;&gt;makeMoneyFormatter&lt;/span&gt;({\n  &lt;span class=&quot;hljs-attr&quot;&gt;sign&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;delimiter&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;decimal&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;append&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;\n})\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; customFormat = &lt;span class=&quot;hljs-title function_&quot;&gt;makeMoneyFormatter&lt;/span&gt;({\n  &lt;span class=&quot;hljs-attr&quot;&gt;round&lt;/span&gt;: &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;,\n  &lt;span class=&quot;hljs-attr&quot;&gt;custom&lt;/span&gt;: &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;{ value, float, sign }&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;`SALE:$&lt;span class=&quot;hljs-subst&quot;&gt;${value}&lt;/span&gt;USD`&lt;/span&gt;\n})\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(\n  &lt;span class=&quot;hljs-title function_&quot;&gt;formatPound&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10000.0066&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;formatEuro&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;100000.001&lt;/span&gt;),\n  &lt;span class=&quot;hljs-title function_&quot;&gt;customFormat&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;999999.555&lt;/span&gt;)\n)&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif5&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I use the library &lt;a href=&quot;https://github.com/jquery/globalize&quot; rel=&quot;nofollow noreferrer&quot;&gt;Globalize&lt;/a&gt; (from Microsoft): &lt;/p&gt;\n\n&lt;p&gt;It&apos;s a great project to localize numbers, currencies and dates and to have them automatically formatted the right way according to the user locale! ...and despite it should be a jQuery extension, it&apos;s currently a 100% independent library. I suggest you all to try it out! :)&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;https://github.com/Mottie/javascript-number-formatter&quot; rel=&quot;nofollow noreferrer&quot;&gt;javascript-number-formatter&lt;/a&gt; (formerly &lt;a href=&quot;https://code.google.com/archive/p/javascript-number-formatter/&quot; rel=&quot;nofollow noreferrer&quot;&gt;at Google Code&lt;/a&gt;)&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Short, fast, flexible yet stand-alone.&lt;/li&gt;\n&lt;li&gt;Accept standard number formatting like &lt;code&gt;#,##0.00&lt;/code&gt; or with negation &lt;code&gt;-000.####&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Accept any country format like &lt;code&gt;# ##0,00&lt;/code&gt;, &lt;code&gt;#,###.##&lt;/code&gt;, &lt;code&gt;#&apos;###.##&lt;/code&gt; or any type of non-numbering symbol.&lt;/li&gt;\n&lt;li&gt;Accept any numbers of digit grouping. &lt;code&gt;#,##,#0.000&lt;/code&gt; or &lt;code&gt;#,###0.##&lt;/code&gt; are all valid.&lt;/li&gt;\n&lt;li&gt;Accept any redundant/foolproof formatting. &lt;code&gt;##,###,##.#&lt;/code&gt; or &lt;code&gt;0#,#00#.###0#&lt;/code&gt; are all OK.&lt;/li&gt;\n&lt;li&gt;Auto number rounding.&lt;/li&gt;\n&lt;li&gt;Simple interface, just supply mask &amp;amp; value like this: &lt;code&gt;format( &quot;0.0000&quot;, 3.141592)&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;Include a prefix &amp;amp; suffix with the mask&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;(excerpt from its README)&lt;/p&gt;\n    ","\n&lt;p&gt;A shorter method (for inserting space, comma or point) with a regular expression:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;    &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;toCurrencyString&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d)(?=(\\d{3})+\\b)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$1 &apos;&lt;/span&gt;);\n    }\n\n    n = &lt;span class=&quot;hljs-number&quot;&gt;12345678.9&lt;/span&gt;;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(n.&lt;span class=&quot;hljs-title function_&quot;&gt;toCurrencyString&lt;/span&gt;());\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;+1 to &lt;a href=&quot;https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings/9318724#9318724&quot;&gt;Jonathan M for providing the original method&lt;/a&gt;. Since this is explicitly a currency formatter, I went ahead and added the currency symbol (defaults to &apos;$&apos;) to the output, and added a default comma as the thousands separator. If you don&apos;t actually want a currency symbol (or thousands separator), just use &quot;&quot; (empty string) as your argument for it.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;formatMoney&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;decPlaces, thouSeparator, decSeparator, currencySymbol&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// check the args and supply defaults:&lt;/span&gt;\n    decPlaces = &lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(decPlaces = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(decPlaces)) ? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : decPlaces;\n    decSeparator = decSeparator == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; : decSeparator;\n    thouSeparator = thouSeparator == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt; : thouSeparator;\n    currencySymbol = currencySymbol == &lt;span class=&quot;hljs-literal&quot;&gt;undefined&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; : currencySymbol;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;,\n        sign = n &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? &lt;span class=&quot;hljs-string&quot;&gt;&quot;-&quot;&lt;/span&gt; : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,\n        i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;(n = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(+n || &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces)) + &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;,\n        j = (j = i.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; ? j % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; : &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; sign + currencySymbol + (j ? i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, j) + thouSeparator : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;) + i.&lt;span class=&quot;hljs-title function_&quot;&gt;substr&lt;/span&gt;(j).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})(?=\\d)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1&quot;&lt;/span&gt; + thouSeparator) + (decPlaces ? decSeparator + &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(n - i).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(decPlaces).&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;) : &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n};\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The main part is inserting the thousand-separators, and that could be done like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&amp;lt;script type=&lt;span class=&quot;hljs-string&quot;&gt;&quot;text/javascript&quot;&lt;/span&gt;&amp;gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;ins1000Sep&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;val&lt;/span&gt;) {\n    val = val.&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n    val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n    val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1,&quot;&lt;/span&gt;);\n    val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n    val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;,&quot;&lt;/span&gt;) == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;substring&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) : val[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; val.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;rem1000Sep&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;val&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; val.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/,/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;);\n  }\n\n  &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;formatNum&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;val&lt;/span&gt;) {\n    val = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;round&lt;/span&gt;(val*&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;)/&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;;\n    val = (&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt; + val).&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;) &amp;gt; -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; ? val + &lt;span class=&quot;hljs-string&quot;&gt;&quot;00&quot;&lt;/span&gt; : val + &lt;span class=&quot;hljs-string&quot;&gt;&quot;.00&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; dec = val.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; dec == val.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;-&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; || dec == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; ? val : val.&lt;span class=&quot;hljs-title function_&quot;&gt;substring&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, dec+&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;);\n  }\n&amp;lt;/script&amp;gt;\n\n&lt;span class=&quot;language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;button&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;onclick&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;alert(ins1000Sep(formatNum(12313231)));&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There is a JavaScript port of the PHP function &quot;number_format&quot;.&lt;/p&gt;\n&lt;p&gt;I find it very useful as it is easy to use and recognisable for PHP developers.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;number_format&lt;/span&gt; (number, decimals, dec_point, thousands_sep) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = number, prec = decimals;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; toFixedFix = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;n,prec&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; k = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;pow&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;,prec);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; (&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;round&lt;/span&gt;(n*k)/k).&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n    };\n\n    n = !&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(+n) ? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; : +n;\n    prec = !&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(+prec) ? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; : &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(prec);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; sep = (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; thousands_sep === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt; : thousands_sep;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; dec = (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; dec_point === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) ? &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt; : dec_point;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; s = (prec &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) ? &lt;span class=&quot;hljs-title function_&quot;&gt;toFixedFix&lt;/span&gt;(n, prec) : &lt;span class=&quot;hljs-title function_&quot;&gt;toFixedFix&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;round&lt;/span&gt;(n), prec);\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Fix for Internet Explorer parseFloat(0.55).toFixed(0) = 0;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; abs = &lt;span class=&quot;hljs-title function_&quot;&gt;toFixedFix&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(n), prec);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; _, i;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (abs &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;) {\n        _ = abs.&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\D/&lt;/span&gt;);\n        i = _[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; || &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;\n\n        _[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = s.&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;,i + (n &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)) +\n               _[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(i).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d{3})/g&lt;/span&gt;, sep+&lt;span class=&quot;hljs-string&quot;&gt;&apos;$1&apos;&lt;/span&gt;);\n        s = _.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(dec);\n    } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n        s = s.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, dec);\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; decPos = s.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(dec);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (prec &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; decPos !== -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; (s.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;-decPos-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) &amp;lt; prec) {\n        s += &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;(prec-(s.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt;-decPos-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)).&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)+&lt;span class=&quot;hljs-string&quot;&gt;&apos;0&apos;&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (prec &amp;gt;= &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; decPos === -&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n        s += dec+&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Array&lt;/span&gt;(prec).&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)+&lt;span class=&quot;hljs-string&quot;&gt;&apos;0&apos;&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; s;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(Comment block from &lt;a href=&quot;http://kevin.vanzonneveld.net/techblog/article/javascript_equivalent_for_phps_number_format/&quot; rel=&quot;nofollow noreferrer&quot;&gt;the original&lt;/a&gt;, included below for examples &amp;amp; credit where due)&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Formats a number with grouped thousands&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;//&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// version: 906.1806&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// discuss at: http://phpjs.org/functions/number_format&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +   original by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Michael White (http://getsprink.com)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Benjamin Lupton&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Allan Jensen (http://www.winternet.no)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +    revised by: Jonas Raoni Soares Silva (http://www.jsfromhell.com)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Howard Yeend&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +    revised by: Luke Smith (http://lucassmith.name)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Diogo Resende&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Rival&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     input by: Kheang Hok Chin (http://www.distantia.ca/)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     improved by: davook&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     improved by: Brett Zamir (http://brett-zamir.me)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     input by: Jay Klehr&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     improved by: Brett Zamir (http://brett-zamir.me)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     input by: Amir Habibi (http://www.residence-mixte.com/)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// +     bugfix by: Brett Zamir (http://brett-zamir.me)&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 1: number_format(1234.56);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 1: &apos;1,235&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 2: number_format(1234.56, 2, &apos;,&apos;, &apos; &apos;);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 2: &apos;1 234,56&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 3: number_format(1234.5678, 2, &apos;.&apos;, &apos;&apos;);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 3: &apos;1234.57&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 4: number_format(67, 2, &apos;,&apos;, &apos;.&apos;);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 4: &apos;67,00&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 5: number_format(1000);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 5: &apos;1,000&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 6: number_format(67.311, 2);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 6: &apos;67.31&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 7: number_format(1000.55, 1);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 7: &apos;1,000.6&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 8: number_format(67000, 5, &apos;,&apos;, &apos;.&apos;);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 8: &apos;67.000,00000&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 9: number_format(0.9, 0);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 9: &apos;1&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 10: number_format(&apos;1.20&apos;, 2);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 10: &apos;1.20&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 11: number_format(&apos;1.20&apos;, 4);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 11: &apos;1.2000&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     example 12: number_format(&apos;1.2000&apos;, 3);&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// *     returns 12: &apos;1.200&apos;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;h3 id=&quot;just-use-the-native-javascript-inlt-4lo1&quot;&gt;just use the native javascript Inlt&lt;/h3&gt;\n&lt;p&gt;you just use the options to format its value&lt;/p&gt;\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; number = &lt;span class=&quot;hljs-number&quot;&gt;1233445.5678&lt;/span&gt;\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Intl&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;NumberFormat&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;en-US&apos;&lt;/span&gt;, { &lt;span class=&quot;hljs-attr&quot;&gt;style&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;currency&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-attr&quot;&gt;currency&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;USD&apos;&lt;/span&gt; }).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(number));&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif6&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Intl/NumberFormat&quot; rel=&quot;noreferrer&quot;&gt;mozilla documentation link&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Please try the below code&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-string&quot;&gt;&quot;250000&quot;&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d)(?=(\\d{3})+(?!\\d))/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$1,&apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Ans&lt;/strong&gt;: 250,000&lt;/p&gt;\n&lt;p&gt;&lt;a href=&quot;https://i.stack.imgur.com/nkmZ3.png&quot; rel=&quot;noreferrer&quot;&gt;&lt;img src=&quot;https://i.stack.imgur.com/nkmZ3.png&quot; alt=&quot;Enter image description here&quot;&gt;&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/149099/155987&quot;&gt;Patrick Desjardins&lt;/a&gt;&apos; answer looks good, but I prefer my JavaScript code simple. Here&apos;s a function I just wrote to take a number in and return it in currency format (minus the dollar sign):&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Format numbers to two decimals with commas&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;formatDollar&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;num&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; p = num.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; chars = p[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; newstr = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; count = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (x &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; chars) {\n        count++;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(count%&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; == &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &amp;amp;&amp;amp; count != &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) {\n            newstr = chars[x] + &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt; + newstr;\n        } &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; {\n            newstr = chars[x] + newstr;\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; newstr + &lt;span class=&quot;hljs-string&quot;&gt;&quot;.&quot;&lt;/span&gt; + p[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;There is a built-in function, &lt;a href=&quot;http://www.w3schools.com/jsref/jsref_tofixed.asp&quot; rel=&quot;nofollow noreferrer&quot;&gt;toFixed&lt;/a&gt;, in JavaScript:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; num = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;349&lt;/span&gt;);\n&lt;span class=&quot;hljs-variable language_&quot;&gt;document&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;write&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt; + num.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;));\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;CurrencyFormatted&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;amount&lt;/span&gt;)\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseFloat&lt;/span&gt;(amount);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;isNaN&lt;/span&gt;(i)) { i = &lt;span class=&quot;hljs-number&quot;&gt;0.00&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; minus = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(i &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) { minus = &lt;span class=&quot;hljs-string&quot;&gt;&apos;-&apos;&lt;/span&gt;; }\n    i = &lt;span class=&quot;hljs-title class_&quot;&gt;Math&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;abs&lt;/span&gt;(i);\n    i = &lt;span class=&quot;hljs-built_in&quot;&gt;parseInt&lt;/span&gt;((i + &lt;span class=&quot;hljs-number&quot;&gt;.005&lt;/span&gt;) * &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;);\n    i = i / &lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;;\n    s = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;String&lt;/span&gt;(i);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(s.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;) &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) { s += &lt;span class=&quot;hljs-string&quot;&gt;&apos;.00&apos;&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(s.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;) == (s.&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)) { s += &lt;span class=&quot;hljs-string&quot;&gt;&apos;0&apos;&lt;/span&gt;; }\n    s = minus + s;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; s;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;From &lt;a href=&quot;http://www.willmaster.com/library/tutorials/currency-formatting-and-putting-commas-in-numbers-with-javascript-and-perl.php&quot; rel=&quot;noreferrer&quot;&gt;WillMaster&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;I suggest the NumberFormat class from &lt;a href=&quot;https://developers.google.com/chart/interactive/docs/reference#numberformatter&quot; rel=&quot;nofollow noreferrer&quot;&gt;Google Visualization API&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;You can do something like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; formatter = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; google.&lt;span class=&quot;hljs-property&quot;&gt;visualization&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;NumberFormat&lt;/span&gt;({\n    &lt;span class=&quot;hljs-attr&quot;&gt;prefix&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;,\n    &lt;span class=&quot;hljs-attr&quot;&gt;pattern&lt;/span&gt;: &lt;span class=&quot;hljs-string&quot;&gt;&apos;#,###,###.##&apos;&lt;/span&gt;\n});\n\nformatter.&lt;span class=&quot;hljs-title function_&quot;&gt;formatValue&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1000000&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// $ 1,000,000&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;As usually, there are multiple ways of doing the same thing, but I would avoid using &lt;code&gt;Number.prototype.toLocaleString&lt;/code&gt; since it can return different values based on the user settings.&lt;/p&gt;\n&lt;p&gt;I also don&apos;t recommend extending the &lt;code&gt;Number.prototype&lt;/code&gt; - extending native objects prototypes is a bad practice since it can cause conflicts with other people code (e.g. libraries/frameworks/plugins) and may not be compatible with future JavaScript implementations/versions.&lt;/p&gt;\n&lt;p&gt;I believe that regular expressions are the best approach for the problem, here is my implementation:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * Converts number into currency format\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; {&lt;span class=&quot;hljs-type&quot;&gt;number&lt;/span&gt;} number    Number that should be converted.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; {&lt;span class=&quot;hljs-type&quot;&gt;string&lt;/span&gt;} [decimalSeparator]    Decimal separator, defaults to &apos;.&apos;.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; {&lt;span class=&quot;hljs-type&quot;&gt;string&lt;/span&gt;} [thousandsSeparator]    Thousands separator, defaults to &apos;,&apos;.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param&lt;/span&gt; {&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;} [nDecimalDigits]    Number of decimal digits, defaults to `2`.\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@return&lt;/span&gt; {&lt;span class=&quot;hljs-type&quot;&gt;string&lt;/span&gt;} Formatted string (e.g. numberToCurrency(12345.67) returns &apos;12,345.67&apos;)\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;numberToCurrency&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;number, decimalSeparator, thousandsSeparator, nDecimalDigits&lt;/span&gt;){\n    &lt;span class=&quot;hljs-comment&quot;&gt;//default values&lt;/span&gt;\n    decimalSeparator = decimalSeparator || &lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;;\n    thousandsSeparator = thousandsSeparator || &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;;\n    nDecimalDigits = nDecimalDigits == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;? &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt; : nDecimalDigits;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; fixed = number.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(nDecimalDigits), &lt;span class=&quot;hljs-comment&quot;&gt;//limit/add decimal digits&lt;/span&gt;\n        parts = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RegExp&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;^(-?\\\\d{1,3})((?:\\\\d{3})+)(\\\\.(\\\\d{&apos;&lt;/span&gt;+ nDecimalDigits +&lt;span class=&quot;hljs-string&quot;&gt;&apos;}))?$&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;exec&lt;/span&gt;( fixed ); &lt;span class=&quot;hljs-comment&quot;&gt;//separate begin [$1], middle [$2] and decimal digits [$4]&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(parts){ &lt;span class=&quot;hljs-comment&quot;&gt;//number &amp;gt;= 1000 || number &amp;lt;= -1000&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; parts[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] + parts[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\d{3}/g&lt;/span&gt;, thousandsSeparator + &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;&apos;&lt;/span&gt;) + (parts[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;] ? decimalSeparator + parts[&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;] : &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\n    }&lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;{\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; fixed.&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, decimalSeparator);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This might be a little late, but here&apos;s a method I just worked up for a coworker to add a locale-aware &lt;code&gt;.toCurrencyString()&lt;/code&gt; function to all numbers.  The internalization is for number grouping only, &lt;em&gt;not&lt;/em&gt; the currency sign - if you&apos;re outputting dollars, use &lt;code&gt;&quot;$&quot;&lt;/code&gt; as supplied, because &lt;code&gt;$123 4567&lt;/code&gt; in Japan or China is the same number of USD as &lt;code&gt;$1,234,567&lt;/code&gt; is in the US.  If you&apos;re outputting euro, etc., then change the currency sign from &lt;code&gt;&quot;$&quot;&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;Declare this anywhere in your HTML &amp;lt;head&amp;gt; section or wherever necessary, just before you need to use it:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;  &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;toCurrencyString&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;prefix, suffix&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; prefix === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) { prefix = &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&apos;&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; suffix === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) { suffix = &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; _localeBug = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;RegExp&lt;/span&gt;((&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/^1/&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\./&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;\\\\.&apos;&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&quot;$&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; prefix + (~~&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(_localeBug, &lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;) + (&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt; % &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;toLocaleString&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/^[+-]?0+/&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;) + suffix;\n  }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Then you&apos;re done!  Use &lt;code&gt;(number).toCurrencyString()&lt;/code&gt; anywhere you need to output the number as currency.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyNumber&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;123456789.125&lt;/span&gt;;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;MyNumber&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toCurrencyString&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// alerts &quot;$123,456,789.13&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-title class_&quot;&gt;MyNumber&lt;/span&gt; = -&lt;span class=&quot;hljs-number&quot;&gt;123.567&lt;/span&gt;;\n&lt;span class=&quot;hljs-title function_&quot;&gt;alert&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;MyNumber&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toCurrencyString&lt;/span&gt;()); &lt;span class=&quot;hljs-comment&quot;&gt;// alerts &quot;$-123.57&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;/p&gt;&lt;div class=&quot;snippet&quot; data-lang=&quot;js&quot; data-hide=&quot;false&quot; data-console=&quot;true&quot; data-babel=&quot;false&quot;&gt;\n&lt;div class=&quot;snippet-code&quot;&gt;\n&lt;pre class=&quot;snippet-code-js lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(value)\n        .&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)\n        .&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/(\\d)(?=(\\d{3})+(?!\\d))/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;$1,&quot;&lt;/span&gt;)&lt;/code&gt;&lt;/pre&gt;\n&lt;div class=&quot;snippet-result&quot;&gt;&lt;div class=&quot;snippet-ctas&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn s-btn__primary&quot;&gt;&lt;span class=&quot;icon-play-white _hover&quot;&gt;&lt;/span&gt;&lt;span&gt; Run code snippet&lt;/span&gt;&lt;/button&gt;&lt;input class=&quot;copySnippet s-btn s-btn__filled&quot; type=&quot;button&quot; value=&quot;Copy snippet to answer&quot; style=&quot;display: none;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;s-btn hideResults&quot; style=&quot;display: none;&quot;&gt;Hide results&lt;/button&gt;&lt;div class=&quot;popout-code&quot;&gt;&lt;a class=&quot;snippet-expand-link&quot;&gt;Expand snippet&lt;/a&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;snippet-result-code&quot; style=&quot;display: none;&quot;&gt;&lt;iframe name=&quot;sif7&quot; sandbox=&quot;allow-forms allow-modals allow-scripts&quot; class=&quot;snippet-box-edit snippet-box-result&quot; frameborder=&quot;0&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;\n&lt;/div&gt;\n&lt;p&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Here are some solutions and all pass the test suite. The test suite and benchmark are included. If you want copy and paste to test, try &lt;a href=&quot;https://gist.github.com/steelywing/85fdcbe084c332596179&quot; rel=&quot;nofollow noreferrer&quot;&gt;this gist&lt;/a&gt;.&lt;/p&gt;\n&lt;h3&gt;Method 0 (RegExp)&lt;/h3&gt;\n&lt;p&gt;It is based on &lt;a href=&quot;https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings/14428340#14428340&quot;&gt;VisioN&apos;s answer&lt;/a&gt;, but it fixes if there isn&apos;t a decimal point.&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;precision&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(precision).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n        a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\d(?=(\\d{3})+$)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;,&apos;&lt;/span&gt;);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Method 1&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;precision&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(precision).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;),\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Skip the &apos;-&apos; sign&lt;/span&gt;\n            head = &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt; &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Skip the digits that&apos;s before the first thousands separator&lt;/span&gt;\n        head += (a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-property&quot;&gt;length&lt;/span&gt; - head) % &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt; || &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;\n\n        a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, head) + a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].&lt;span class=&quot;hljs-title function_&quot;&gt;slice&lt;/span&gt;(head).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\d{3}/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,$&amp;amp;&apos;&lt;/span&gt;);\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n    };\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Method 2 (Split to Array)&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;precision&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(precision).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n\n        a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = a[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]\n            .&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;)\n            .&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-regexp&quot;&gt;/\\d{3}(?=\\d)/g&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;$&amp;amp;,&apos;&lt;/span&gt;)\n            .&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;reverse&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n    };\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Method 3 (Loop)&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; === &lt;span class=&quot;hljs-string&quot;&gt;&apos;undefined&apos;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;precision&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!&lt;span class=&quot;hljs-built_in&quot;&gt;isFinite&lt;/span&gt;(&lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;)) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toString&lt;/span&gt;();\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; a = &lt;span class=&quot;hljs-variable language_&quot;&gt;this&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;toFixed&lt;/span&gt;(precision).&lt;span class=&quot;hljs-title function_&quot;&gt;split&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\n        a.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = a.&lt;span class=&quot;hljs-title function_&quot;&gt;indexOf&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;) - &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (i &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &amp;amp;&amp;amp; a[i-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] !== &lt;span class=&quot;hljs-string&quot;&gt;&apos;-&apos;&lt;/span&gt;) {\n            a.&lt;span class=&quot;hljs-title function_&quot;&gt;splice&lt;/span&gt;(i, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;);\n            i -= &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;;\n        }\n\n        a.&lt;span class=&quot;hljs-title function_&quot;&gt;pop&lt;/span&gt;();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; a.&lt;span class=&quot;hljs-title function_&quot;&gt;join&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;&apos;&lt;/span&gt;);\n    };\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Usage Example&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;======== Demo ========&apos;&lt;/span&gt;)\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(\n    (&lt;span class=&quot;hljs-number&quot;&gt;1234567&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;),\n    (&lt;span class=&quot;hljs-number&quot;&gt;1234.56&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;),\n    (-&lt;span class=&quot;hljs-number&quot;&gt;1234.56&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; n = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; i&amp;lt;&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;; i++) {\n    n = (n * &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;) + (i % &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;)/&lt;span class=&quot;hljs-number&quot;&gt;100&lt;/span&gt;;\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(n.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;), (-n).&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;));\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Separator&lt;/h3&gt;\n&lt;p&gt;If we want custom a thousands separator or decimal separator, use &lt;code&gt;replace()&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;123456.78&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;,&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos; &apos;&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;replace&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;.&apos;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&apos; &apos;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Test suite&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;a, b&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (a !== b) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; a + &lt;span class=&quot;hljs-string&quot;&gt;&apos; !== &apos;&lt;/span&gt; + b;\n    }\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;format_function&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(format_function);\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;NaN&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;NaN&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Infinity&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Infinity&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-Infinity&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-title class_&quot;&gt;Infinity&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;0&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;0.00&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Decimal padding&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1.00&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1.00&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Decimal rounding&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;0.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;0.1235&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-0.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;0.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-0.1235&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;0.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;))\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Thousands separator&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1,234&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1234.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;12,345&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12345.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;123,456&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1,234,567&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1234567.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;12,345,678&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12345678.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;123,456,789&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1,234&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1234.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-12,345&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;12345.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-123,456&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;123456.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1,234,567&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1234567.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-12,345,678&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;12345678.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-123,456,789&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;123456789.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;))\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Thousands separator and decimal&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1,234.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1234.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;12,345.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12345.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;123,456.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;1,234,567.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1234567.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;12,345,678.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;12345678.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;123,456,789.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1,234.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1234.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-12,345.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;12345.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-123,456.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;123456.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-1,234,567.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;1234567.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-12,345,678.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;12345678.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n    &lt;span class=&quot;hljs-title function_&quot;&gt;assertEqual&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;-123,456,789.12&apos;&lt;/span&gt;, format_function.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(-&lt;span class=&quot;hljs-number&quot;&gt;123456789.123456&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;))\n}\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;======== Testing ========&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format1&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format2&lt;/span&gt;);\n&lt;span class=&quot;hljs-title function_&quot;&gt;test&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format3&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Benchmark&lt;/h3&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;benchmark&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;f&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; start = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Date&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;getTime&lt;/span&gt;();\n    &lt;span class=&quot;hljs-title function_&quot;&gt;f&lt;/span&gt;();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Date&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;getTime&lt;/span&gt;() - start;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;benchmark_format&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;f&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(f);\n    time = &lt;span class=&quot;hljs-title function_&quot;&gt;benchmark&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; &lt;span class=&quot;hljs-number&quot;&gt;100000&lt;/span&gt;; i++) {\n            f.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n            f.&lt;span class=&quot;hljs-title function_&quot;&gt;call&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;123456789&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n        }\n    });\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(time.&lt;span class=&quot;hljs-title function_&quot;&gt;format&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) + &lt;span class=&quot;hljs-string&quot;&gt;&apos;ms&apos;&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// If not using async, the browser will stop responding while running.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// This will create a new thread to benchmark&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt; = [];\n&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;next&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n        f = &lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;shift&lt;/span&gt;();\n        f &amp;amp;&amp;amp; &lt;span class=&quot;hljs-title function_&quot;&gt;f&lt;/span&gt;();\n        &lt;span class=&quot;hljs-title function_&quot;&gt;next&lt;/span&gt;();\n    }, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;);\n}\n\n&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;======== Benchmark ========&apos;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;push&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) { &lt;span class=&quot;hljs-title function_&quot;&gt;benchmark_format&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;Number&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;prototype&lt;/span&gt;&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;format&lt;/span&gt;); });\n&lt;span class=&quot;hljs-title function_&quot;&gt;next&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n    "],"553":["\n&lt;p&gt;&lt;code&gt;console.log&lt;/code&gt; is not standardized, so the behavior is rather undefined, and can be changed easily from release to release of the developer tools. Your book is likely to be outdated, as might my answer soon.&lt;/p&gt;\n\n&lt;p&gt;To our code, it does not make any difference whether &lt;code&gt;console.log&lt;/code&gt; is async or not, it does not provide any kind of callback or so; and the values you pass are always referenced and computed at the time you call the function.&lt;/p&gt;\n\n&lt;p&gt;We don&apos;t really know what happens then (OK, we could, since Firebug, Chrome Devtools and Opera Dragonfly are all open source). The console will need to store the logged values somewhere, and it will display them on the screen. The rendering will happen asynchronously for sure (being throttled to rate-limit updates), as will future interactions with the logged objects in the console (like expanding object properties).&lt;/p&gt;\n\n&lt;p&gt;So the console might either clone (serialize) the mutable objects that you did log, or it will store references to them. The first one doesn&apos;t work well with deep/large objects. Also, at least the initial rendering in the console will probably show the &quot;current&quot; state of the object, i.e. the one when it got logged - in your example you see &lt;code&gt;Object {}&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;However, when you expand the object to inspect its properties further, it is likely that the console will have only stored a reference to your object and its properties, and displaying them now will then show their current (already mutated) state. If you click on the &lt;code&gt;+&lt;/code&gt;, you should be able to see the &lt;code&gt;bar&lt;/code&gt; property in your example.&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s a screenshot that was posted in the &lt;a href=&quot;http://code.google.com/p/chromium/issues/detail?id=50316&quot; rel=&quot;noreferrer&quot;&gt;bug report&lt;/a&gt; to explain their &quot;fix&quot;:&lt;/p&gt;\n\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/UEMqd.png&quot; alt=&quot;&quot;&gt;\n&lt;/p&gt;\n\n&lt;p&gt;So, some values might be referenced long after they have been logged, and the evaluation of these is rather &lt;em&gt;lazy&lt;/em&gt; (&quot;when needed&quot;). The most famous example of this discrepancy is handled in the question &lt;a href=&quot;https://stackoverflow.com/questions/4057440/is-chromes-javascript-console-lazy-about-evaluating-arrays&quot;&gt;Is Chrome&apos;s JavaScript console lazy about evaluating arrays?&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;A workaround is to make sure to log serialized snapshots of your objects always, e.g. by doing &lt;code&gt;console.log(JSON.stringify(obj))&lt;/code&gt;. This will work for non-circular and rather small objects only, though. See also &lt;a href=&quot;https://stackoverflow.com/q/7389069/1048572&quot;&gt;How can I change the default behavior of console.log in Safari?&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;The better solution is to use breakpoints for debugging, where the execution completely stops and you can inspect the current values at each point. Use logging only with serialisable and immutable data.&lt;/p&gt;\n    ","\n&lt;p&gt;This isn&apos;t really an answer to the question, but it might be handy to someone who stumbled on this post, and it was too long to put in a comment:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-variable language_&quot;&gt;window&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;logSync&lt;/span&gt; = &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;...args&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; {\n    args = args.&lt;span class=&quot;hljs-title function_&quot;&gt;map&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;arg&lt;/span&gt;) =&amp;gt;&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;parse&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;JSON&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;stringify&lt;/span&gt;(arg)));\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(...args);\n  } &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (error) {\n    &lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&apos;Error trying to console.logSync()&apos;&lt;/span&gt;, ...args);\n  }\n};\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This creates a pseudo-synchronous version of &lt;code&gt;console.log&lt;/code&gt;, but with the same caveats as mentioned in the accepted answer.&lt;/p&gt;\n\n&lt;p&gt;Since it seems like, at the moment, most browsers&apos; &lt;code&gt;console.log&lt;/code&gt;&apos;s are asynchronous in some manner, you may want to use a function like this in certain scenarios.&lt;/p&gt;\n    ","\n&lt;p&gt;When using console.log:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;a = {}; a.&lt;span class=&quot;hljs-property&quot;&gt;a&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(a);a.&lt;span class=&quot;hljs-property&quot;&gt;b&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){};\n&lt;span class=&quot;hljs-comment&quot;&gt;// without b&lt;/span&gt;\na = {}; a.&lt;span class=&quot;hljs-property&quot;&gt;a&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a1&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a2&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a3&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a4&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a5&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a6&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a7&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;a.&lt;span class=&quot;hljs-property&quot;&gt;a8&lt;/span&gt;=&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(a);a.&lt;span class=&quot;hljs-property&quot;&gt;b&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){};\n&lt;span class=&quot;hljs-comment&quot;&gt;// with b, maybe&lt;/span&gt;\na = {}; a.&lt;span class=&quot;hljs-property&quot;&gt;a&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){};&lt;span class=&quot;hljs-variable language_&quot;&gt;console&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;log&lt;/span&gt;(a);a.&lt;span class=&quot;hljs-property&quot;&gt;b&lt;/span&gt;=&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;){};\n&lt;span class=&quot;hljs-comment&quot;&gt;// with b&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;in the first situation the object is simple enough, so console can &apos;stringify&apos; it then present to you; but in the other situations, a is too &apos;complicated&apos; to &apos;stringify&apos; so console will show you the in memory object instead, and yes, when you look at it b has already be attached to a.&lt;/p&gt;\n    "],"554":["\n&lt;p&gt;To work with elements inside &lt;code&gt;iframe&lt;/code&gt; you must switch to this specific &lt;code&gt;iframe&lt;/code&gt;. &lt;/p&gt;\n\n&lt;p&gt;Your solution &lt;code&gt;.switchTo().frame(&quot;FRAMENAME&quot;);&lt;/code&gt; is correct. Selenium does not have any other ways to work with &lt;code&gt;iframe&lt;/code&gt; wrappers.&lt;/p&gt;\n    ","\n&lt;h2&gt;inline frames&lt;/h2&gt;\n\n&lt;p&gt;As per the documentation in &lt;a href=&quot;http://jkorpela.fi/html/iframe.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;Using inline frames&lt;/a&gt;, an inline frame is a construct which embeds a document into an HTML document so that &lt;strong&gt;embedded data is displayed inside a subwindow&lt;/strong&gt; of the browser&apos;s window. This does not mean full inclusion and the two documents are independent, and both them are treated as complete documents, instead of treating one as part of the other. &lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;iframe structure and details&lt;/h2&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Generally, an iframe element is in the form of:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&amp;lt;iframe src=&lt;span class=&quot;hljs-string&quot;&gt;&quot;URL&quot;&lt;/span&gt; more attributes&amp;gt;\nalternative content &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; browsers which &lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt; not\nsupport iframe\n&amp;lt;/iframe&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Browsers which support iframe display the document referred to by the URL in a subwindow, typically with vertical and/or horizontal scroll bars. Such browsers ignore the content of the iframe element (i.e. everything between the start tag &lt;code&gt;&amp;lt;iframe...&amp;gt;&lt;/code&gt; and the end tag &lt;code&gt;&amp;lt;/iframe&amp;gt;&lt;/code&gt;). Browsers which do not support iframe (or have such support disabled) does the opposite, i.e. process the content as if the &lt;code&gt;&amp;lt;iframe...&amp;gt;&lt;/code&gt; and &lt;code&gt;&amp;lt;/iframe&amp;gt;&lt;/code&gt; tags were not there. Thus, the content matters, despite being ignored by some browsers. &lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;So to summarize, inline frames do not mean an &lt;strong&gt;include feature&lt;/strong&gt;, although it might sometimes serve similar purposes. &lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Note that, when inline frames are used, the browser (if it supports them) sends a request to the server referred to by the &lt;code&gt;URL&lt;/code&gt; in the iframe element, and after getting the requested document displays it inside an inline frame. In this sense inline frames are a joint browser-server issue, but only the browser needs to be specifically iframe-aware; from the server&apos;s point of view, there&apos;s just a normal HTTP request for a document, and it sends the document without having (or needing) any idea on what the browser is going to do with it.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Something Smarter&lt;/h2&gt;\n\n&lt;p&gt;As per the &lt;em&gt;best practices&lt;/em&gt; while switching to an &lt;em&gt;iframe&lt;/em&gt; you need to induce &lt;em&gt;WebDriverWait&lt;/em&gt; as follows:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Switch through &lt;strong&gt;Frame Name&lt;/strong&gt; (Java Sample Code):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;WebDriverWait&lt;/span&gt;(driver, &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;until&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;ExpectedConditions&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;frameToBeAvailableAndSwitchToIt&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;By&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;name&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;frame_name&quot;&lt;/span&gt;)));\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Switch through &lt;strong&gt;iframe&lt;/strong&gt; &lt;em&gt;XPath&lt;/em&gt; (Python Sample Code):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-title class_&quot;&gt;WebDriverWait&lt;/span&gt;(driver, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;).&lt;span class=&quot;hljs-title function_&quot;&gt;until&lt;/span&gt;(&lt;span class=&quot;hljs-variable constant_&quot;&gt;EC&lt;/span&gt;.&lt;span class=&quot;hljs-title function_&quot;&gt;frame_to_be_available_and_switch_to_it&lt;/span&gt;((&lt;span class=&quot;hljs-title class_&quot;&gt;By&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;XPATH&lt;/span&gt;,&lt;span class=&quot;hljs-string&quot;&gt;&quot;//iframe[@id=&apos;ptifrmtgtframe&apos; and @name=&apos;TargetContent&apos;]&quot;&lt;/span&gt;)))\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Switch through &lt;strong&gt;iframe&lt;/strong&gt; &lt;em&gt;CssSelector&lt;/em&gt; (C# Sample Code):&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;WebDriverWait&lt;/span&gt;(driver, &lt;span class=&quot;hljs-title class_&quot;&gt;TimeSpan&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;FromSeconds&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;)).&lt;span class=&quot;hljs-title class_&quot;&gt;Until&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;ExpectedConditions&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;FrameToBeAvailableAndSwitchToIt&lt;/span&gt;(&lt;span class=&quot;hljs-title class_&quot;&gt;By&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;CssSelector&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;iframe#twitter-widget-0&quot;&lt;/span&gt;)));\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;Reference&lt;/h2&gt;\n\n&lt;p&gt;You can find a couple of relevant discussions in:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;em&gt;Python&lt;/em&gt;: &lt;a href=&quot;https://stackoverflow.com/questions/47770144/how-can-i-select-a-html-element-no-matter-what-frame-it-is-in-in-selenium/47771879#47771879&quot;&gt;How can I select a html element no matter what frame it is in in selenium?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;em&gt;Java&lt;/em&gt;: &lt;a href=&quot;https://stackoverflow.com/questions/47467518/is-it-possible-to-switch-to-an-element-in-a-frame-without-using-driver-switchto/47472200#47472200&quot;&gt;Is it possible to switch to an element in a frame without using driver.switchTo().frame(frameName) in Selenium Webdriver Java?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;em&gt;C#&lt;/em&gt;: &lt;a href=&quot;https://stackoverflow.com/questions/49677267/how-to-wait-for-a-frame-to-load-before-locating-an-element/49686113#49686113&quot;&gt;How to wait for a frame to load before locating an element?&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;hr&gt;\n\n&lt;h2&gt;tl; dr&lt;/h2&gt;\n\n&lt;p&gt;&lt;a href=&quot;http://jkorpela.fi/html/iframe.html#frames&quot; rel=&quot;nofollow noreferrer&quot;&gt;Inline frames vs. normal frames&lt;/a&gt;&lt;/p&gt;\n    "],"555":["\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;static_cast&lt;/code&gt;&lt;/strong&gt; is the first cast you should attempt to use. It does things like implicit conversions between types (such as &lt;code&gt;int&lt;/code&gt; to &lt;code&gt;float&lt;/code&gt;, or pointer to &lt;code&gt;void*&lt;/code&gt;), and it can also call explicit conversion functions (or implicit ones). In many cases, explicitly stating &lt;code&gt;static_cast&lt;/code&gt; isn&apos;t necessary, but it&apos;s important to note that the &lt;code&gt;T(something)&lt;/code&gt; syntax is equivalent to &lt;code&gt;(T)something&lt;/code&gt; and should be avoided (more on that later). A &lt;code&gt;T(something, something_else)&lt;/code&gt; is safe, however, and guaranteed to call the constructor.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;static_cast&lt;/code&gt; can also cast through inheritance hierarchies. It is unnecessary when casting upwards (towards a base class), but when casting downwards it can be used as long as it doesn&apos;t cast through &lt;code&gt;virtual&lt;/code&gt; inheritance. It does not do checking, however, and it is undefined behavior to &lt;code&gt;static_cast&lt;/code&gt; down a hierarchy to a type that isn&apos;t actually the type of the object.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;const_cast&lt;/code&gt;&lt;/strong&gt; can be used to remove or add &lt;code&gt;const&lt;/code&gt; to a variable; no other C++ cast is capable of removing it (not even &lt;code&gt;reinterpret_cast&lt;/code&gt;). It is important to note that modifying a formerly &lt;code&gt;const&lt;/code&gt; value is only undefined if the original variable is &lt;code&gt;const&lt;/code&gt;; if you use it to take the &lt;code&gt;const&lt;/code&gt; off a reference to something that wasn&apos;t declared with &lt;code&gt;const&lt;/code&gt;, it is safe. This can be useful when overloading member functions based on &lt;code&gt;const&lt;/code&gt;, for instance. It can also be used to add &lt;code&gt;const&lt;/code&gt; to an object, such as to call a member function overload.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;const_cast&lt;/code&gt; also works similarly on &lt;code&gt;volatile&lt;/code&gt;, though that&apos;s less common.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;dynamic_cast&lt;/code&gt;&lt;/strong&gt; is exclusively used for handling polymorphism. You can cast a pointer or reference to any polymorphic type to any other class type (a polymorphic type has at least one virtual function, declared or inherited). You can use it for more than just casting downwards  you can cast sideways or even up another chain. The &lt;code&gt;dynamic_cast&lt;/code&gt; will seek out the desired object and return it if possible. If it can&apos;t, it will return &lt;code&gt;nullptr&lt;/code&gt; in the case of a pointer, or throw &lt;code&gt;std::bad_cast&lt;/code&gt; in the case of a reference.&lt;/p&gt;\n\n&lt;p&gt;&lt;code&gt;dynamic_cast&lt;/code&gt; has some limitations, though. It doesn&apos;t work if there are multiple objects of the same type in the inheritance hierarchy (the so-called &apos;dreaded diamond&apos;) and you aren&apos;t using &lt;code&gt;virtual&lt;/code&gt; inheritance. It also can only go through public inheritance - it will always fail to travel through &lt;code&gt;protected&lt;/code&gt; or &lt;code&gt;private&lt;/code&gt; inheritance. This is rarely an issue, however, as such forms of inheritance are rare.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;reinterpret_cast&lt;/code&gt;&lt;/strong&gt; is the most dangerous cast, and should be used very sparingly. It turns one type directly into another  such as casting the value from one pointer to another, or storing a pointer in an &lt;code&gt;int&lt;/code&gt;, or all sorts of other nasty things. Largely, the only guarantee you get with &lt;code&gt;reinterpret_cast&lt;/code&gt; is that normally if you cast the result back to the original type, you will get the exact same value (but &lt;strong&gt;&lt;em&gt;not&lt;/em&gt;&lt;/strong&gt; if the intermediate type is smaller than the original type). There are a number of conversions that &lt;strong&gt;&lt;code&gt;reinterpret_cast&lt;/code&gt;&lt;/strong&gt; cannot do, too. It&apos;s used primarily for particularly weird conversions and bit manipulations, like turning a raw data stream into actual data, or storing data in the low bits of a pointer to aligned data.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;strong&gt;C-style cast&lt;/strong&gt; and &lt;strong&gt;function-style cast&lt;/strong&gt; are casts using &lt;code&gt;(type)object&lt;/code&gt; or &lt;code&gt;type(object)&lt;/code&gt;, respectively, and are functionally equivalent. They are defined as the first of the following which succeeds:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;const_cast&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;static_cast&lt;/code&gt; (though ignoring access restrictions)&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;static_cast&lt;/code&gt; (see above), then &lt;code&gt;const_cast&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;reinterpret_cast&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;reinterpret_cast&lt;/code&gt;, then &lt;code&gt;const_cast&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;It can therefore be used as a replacement for other casts in some instances, but can be extremely dangerous because of the ability to devolve into a &lt;code&gt;reinterpret_cast&lt;/code&gt;, and the latter should be preferred when explicit casting is needed, unless you are sure &lt;code&gt;static_cast&lt;/code&gt; will succeed or &lt;code&gt;reinterpret_cast&lt;/code&gt; will fail. Even then, consider the longer, more explicit option.&lt;/p&gt;\n\n&lt;p&gt;C-style casts also ignore access control when performing a &lt;code&gt;static_cast&lt;/code&gt;, which means that they have the ability to perform an operation that no other cast can. This is mostly a kludge, though, and in my mind is just another reason to avoid C-style casts.&lt;/p&gt;\n    ","\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Use &lt;code&gt;dynamic_cast&lt;/code&gt; for converting pointers/references within an inheritance hierarchy.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Use &lt;code&gt;static_cast&lt;/code&gt; for ordinary type conversions.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Use &lt;code&gt;reinterpret_cast&lt;/code&gt; for low-level reinterpreting of bit patterns.  Use with extreme caution.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Use &lt;code&gt;const_cast&lt;/code&gt; for casting away &lt;code&gt;const/volatile&lt;/code&gt;.  Avoid this unless you are stuck using a const-incorrect API.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;&lt;em&gt;(A lot of theoretical and conceptual explanation has been given above)&lt;/em&gt; &lt;/p&gt;\n\n&lt;p&gt;Below are some of the &lt;strong&gt;practical examples&lt;/strong&gt; when I used &lt;strong&gt;static_cast&lt;/strong&gt;, &lt;strong&gt;dynamic_cast&lt;/strong&gt;, &lt;strong&gt;const_cast&lt;/strong&gt;, &lt;strong&gt;reinterpret_cast&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;(Also referes this to understand the explaination : &lt;a href=&quot;http://www.cplusplus.com/doc/tutorial/typecasting/&quot; rel=&quot;noreferrer&quot;&gt;http://www.cplusplus.com/doc/tutorial/typecasting/&lt;/a&gt;)&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;static_cast :&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;OnEventData&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;* pData)\n\n{\n  ......\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  pData is a void* pData, &lt;/span&gt;\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  EventData is a structure e.g. &lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  typedef struct _EventData {&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  std::string id;&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  std:: string remote_id;&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;//  } EventData;&lt;/span&gt;\n\n  &lt;span class=&quot;hljs-comment&quot;&gt;// On Some Situation a void pointer *pData&lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// has been static_casted as &lt;/span&gt;\n  &lt;span class=&quot;hljs-comment&quot;&gt;// EventData* pointer &lt;/span&gt;\n\n  EventData *evtdata = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;EventData*&amp;gt;(pData);\n  .....\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;dynamic_cast :&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DebugLog::OnMessage&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(Message *msg)&lt;/span&gt;\n&lt;/span&gt;{\n    &lt;span class=&quot;hljs-type&quot;&gt;static&lt;/span&gt; DebugMsgData *debug;\n    &lt;span class=&quot;hljs-type&quot;&gt;static&lt;/span&gt; XYZMsgData *xyz;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(debug = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;DebugMsgData*&amp;gt;(msg-&amp;gt;pdata)){\n        &lt;span class=&quot;hljs-comment&quot;&gt;// debug message&lt;/span&gt;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(xyz = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;XYZMsgData*&amp;gt;(msg-&amp;gt;pdata)){\n        &lt;span class=&quot;hljs-comment&quot;&gt;// xyz message&lt;/span&gt;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;hljs-comment&quot;&gt;/* if( ... )*/&lt;/span&gt;{\n        &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;const_cast :&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// *Passwd declared as a const&lt;/span&gt;\n\n&lt;span class=&quot;hljs-type&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt; *Passwd\n\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// on some situation it require to remove its constness&lt;/span&gt;\n\n&lt;span class=&quot;hljs-built_in&quot;&gt;const_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt;*&amp;gt;(Passwd)\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;reinterpret_cast :&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;typedef&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;unsigned&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;short&lt;/span&gt; uint16;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Read Bytes returns that 2 bytes got read. &lt;/span&gt;\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ByteBuffer::ReadUInt16&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(uint16&amp;amp; val)&lt;/span&gt; &lt;/span&gt;{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;ReadBytes&lt;/span&gt;(&lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt;*&amp;gt;(&amp;amp;val), &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;It might help if you know little bit of internals...&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;static_cast&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;C++ compiler already knows how to convert between scaler types such as &lt;code&gt;float&lt;/code&gt; to &lt;code&gt;int&lt;/code&gt;. Use &lt;code&gt;static_cast&lt;/code&gt; for them.&lt;/li&gt;\n&lt;li&gt;When you ask compiler to convert from type &lt;code&gt;A&lt;/code&gt; to &lt;code&gt;B&lt;/code&gt;, &lt;code&gt;static_cast&lt;/code&gt; calls &lt;code&gt;B&lt;/code&gt;&apos;s constructor passing &lt;code&gt;A&lt;/code&gt; as param. Alternatively, &lt;code&gt;A&lt;/code&gt; could have a conversion operator (i.e. &lt;code&gt;A::operator B()&lt;/code&gt;).  If &lt;code&gt;B&lt;/code&gt; doesn&apos;t have such constructor, or &lt;code&gt;A&lt;/code&gt; doesn&apos;t have a conversion operator, then you get compile time error.&lt;/li&gt;\n&lt;li&gt;Cast from &lt;code&gt;A*&lt;/code&gt; to &lt;code&gt;B*&lt;/code&gt; always succeeds if A and B are in inheritance hierarchy (or void) otherwise you get compile error.&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Gotcha&lt;/strong&gt;: If you cast base pointer to derived pointer but if actual object is not really derived type then you &lt;em&gt;don&apos;t&lt;/em&gt; get error. You get bad pointer and  very likely a segfault at runtime. Same goes for &lt;code&gt;A&amp;amp;&lt;/code&gt; to &lt;code&gt;B&amp;amp;&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;&lt;strong&gt;Gotcha&lt;/strong&gt;: Cast from Derived to Base or viceversa creates &lt;em&gt;new&lt;/em&gt; copy! For people coming from C#/Java, this can be a huge surprise because the result is basically a chopped off object created from Derived.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;dynamic_cast&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;dynamic_cast uses runtime type information to figure out if cast is valid. For example, &lt;code&gt;(Base*)&lt;/code&gt; to &lt;code&gt;(Derived*)&lt;/code&gt; may fail if pointer is not actually of derived type.&lt;/li&gt;\n&lt;li&gt;This means, dynamic_cast is very expensive compared to static_cast!&lt;/li&gt;\n&lt;li&gt;For &lt;code&gt;A*&lt;/code&gt; to &lt;code&gt;B*&lt;/code&gt;, if cast is invalid then dynamic_cast will return nullptr.&lt;/li&gt;\n&lt;li&gt;For &lt;code&gt;A&amp;amp;&lt;/code&gt; to &lt;code&gt;B&amp;amp;&lt;/code&gt; if cast is invalid then dynamic_cast will throw bad_cast exception.&lt;/li&gt;\n&lt;li&gt;Unlike other casts, there is runtime overhead.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;const_cast&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;While static_cast can do non-const to const it can&apos;t go other way around. The const_cast can do both ways.&lt;/li&gt;\n&lt;li&gt;One example where this comes handy is iterating through some container like &lt;code&gt;set&amp;lt;T&amp;gt;&lt;/code&gt; which only returns its elements as const to make sure you don&apos;t change its key. However if your intent is to modify object&apos;s non-key members then it should be ok. You can use const_cast to remove constness.&lt;/li&gt;\n&lt;li&gt;Another example is when you want to implement &lt;code&gt;T&amp;amp; SomeClass::foo()&lt;/code&gt; as well as &lt;code&gt;const T&amp;amp; SomeClass::foo() const&lt;/code&gt;. To avoid code duplication, you can apply const_cast to return value of one function from another.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;reinterpret_cast&lt;/strong&gt;&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;This basically says that take these bytes at this memory location and think of it as given object.&lt;/li&gt;\n&lt;li&gt;For example, you can load 4 bytes of &lt;code&gt;float&lt;/code&gt; to 4 bytes of &lt;code&gt;int&lt;/code&gt; to see how bits in &lt;code&gt;float&lt;/code&gt; looks like.&lt;/li&gt;\n&lt;li&gt;Obviously, if data is not correct for the type, you may get segfault.&lt;/li&gt;\n&lt;li&gt;There is no runtime overhead for this cast.&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;Does &lt;a href=&quot;http://www.cppreference.com/wiki/keywords/casting_comparison&quot; rel=&quot;noreferrer&quot;&gt;this&lt;/a&gt; answer your question?&lt;/p&gt;\n\n&lt;p&gt;I have never used &lt;code&gt;reinterpret_cast&lt;/code&gt;, and wonder whether running into a case that needs it isn&apos;t a smell of bad design. In the code base I work on &lt;code&gt;dynamic_cast&lt;/code&gt; is used a lot. The difference with  &lt;code&gt;static_cast&lt;/code&gt; is that a &lt;code&gt;dynamic_cast&lt;/code&gt; does runtime checking which may (safer) or may not (more overhead) be what you want (see &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/c36yw7x9(VS.80).aspx&quot; rel=&quot;noreferrer&quot;&gt;msdn&lt;/a&gt;).&lt;/p&gt;\n    ","\n&lt;p&gt;In addition to the other answers so far, here is unobvious example where &lt;code&gt;static_cast&lt;/code&gt; is not sufficient so that &lt;code&gt;reinterpret_cast&lt;/code&gt; is needed. Suppose there is a function which in an output parameter returns pointers to objects of different classes (which do not share a common base class). A real example of such function is &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/windows/desktop/ms686615%28v=vs.85%29.aspx&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;CoCreateInstance()&lt;/code&gt;&lt;/a&gt; (see the last parameter, which is in fact &lt;code&gt;void**&lt;/code&gt;). Suppose you request particular class of object from this function, so you know in advance the type for the pointer (which you often do for COM objects). In this case you cannot cast pointer to your pointer into &lt;code&gt;void**&lt;/code&gt; with &lt;code&gt;static_cast&lt;/code&gt;: you need &lt;code&gt;reinterpret_cast&amp;lt;void**&amp;gt;(&amp;amp;yourPointer)&lt;/code&gt;. &lt;/p&gt;\n\n&lt;p&gt;In code:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;netfw.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n.....\nINetFwPolicy2* pNetFwPolicy2 = &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;;\nHRESULT hr = &lt;span class=&quot;hljs-built_in&quot;&gt;CoCreateInstance&lt;/span&gt;(__uuidof(NetFwPolicy2), &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;,\n    CLSCTX_INPROC_SERVER, __uuidof(INetFwPolicy2),\n    &lt;span class=&quot;hljs-comment&quot;&gt;//static_cast&amp;lt;void**&amp;gt;(&amp;amp;pNetFwPolicy2) would give a compile error&lt;/span&gt;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;**&amp;gt;(&amp;amp;pNetFwPolicy2) );\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;However, &lt;code&gt;static_cast&lt;/code&gt; works for simple pointers (not pointers to pointers), so the above code can be rewritten to avoid &lt;code&gt;reinterpret_cast&lt;/code&gt; (at a price of an extra variable) in the following way:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;windows.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;netfw.h&amp;gt;&lt;/span&gt;&lt;/span&gt;\n.....\nINetFwPolicy2* pNetFwPolicy2 = &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;;\n&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt;* tmp = &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;;\nHRESULT hr = &lt;span class=&quot;hljs-built_in&quot;&gt;CoCreateInstance&lt;/span&gt;(__uuidof(NetFwPolicy2), &lt;span class=&quot;hljs-literal&quot;&gt;nullptr&lt;/span&gt;,\n    CLSCTX_INPROC_SERVER, __uuidof(INetFwPolicy2),\n    &amp;amp;tmp );\npNetFwPolicy2 = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;INetFwPolicy2*&amp;gt;(tmp);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;&lt;code&gt;static_cast&lt;/code&gt; vs &lt;code&gt;dynamic_cast&lt;/code&gt; vs &lt;code&gt;reinterpret_cast&lt;/code&gt; internals view on a downcast/upcast&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;In this answer, I want to compare these three mechanisms on a concrete upcast/downcast example and analyze what happens to the underlying pointers/memory/assembly to give a concrete understanding of how they compare.&lt;/p&gt;\n&lt;p&gt;I believe that this will give a good intuition on how those casts are different:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;static_cast&lt;/code&gt;: does one address offset at runtime (low runtime impact) and no safety checks that a downcast is correct.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;dyanamic_cast&lt;/code&gt;: does the same address offset at runtime like &lt;code&gt;static_cast&lt;/code&gt;, but also and an expensive safety check that a downcast is correct using RTTI.&lt;/p&gt;\n&lt;p&gt;This safety check allows you to query if a base class pointer is of a given type at runtime by checking a return of &lt;code&gt;nullptr&lt;/code&gt; which indicates an invalid downcast.&lt;/p&gt;\n&lt;p&gt;Therefore, if your code is not able to check for that &lt;code&gt;nullptr&lt;/code&gt; and take a valid non-abort action, you should just use &lt;code&gt;static_cast&lt;/code&gt; instead of dynamic cast.&lt;/p&gt;\n&lt;p&gt;If an abort is the only action your code can take, maybe you only want to enable the &lt;code&gt;dynamic_cast&lt;/code&gt; in debug builds (&lt;code&gt;-NDEBUG&lt;/code&gt;), and use &lt;code&gt;static_cast&lt;/code&gt; otherwise, e.g. &lt;a href=&quot;https://github.com/gem5/gem5/blob/9fc9c67b4242c03f165951775be5cd0812f2a705/src/base/cast.hh#L40&quot; rel=&quot;noreferrer&quot;&gt;as done here&lt;/a&gt;, to not slow down your fast runs.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;reinterpret_cast&lt;/code&gt;: does nothing at runtime, not even the address offset. The pointer must point exactly to the correct type, not even a base class works. You generally don&apos;t want this unless raw byte streams are involved.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Consider the following code example:&lt;/p&gt;\n&lt;p&gt;main.cpp&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;B1&lt;/span&gt; {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;B1&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b1) : &lt;span class=&quot;hljs-built_in&quot;&gt;int_in_b1&lt;/span&gt;(int_in_b1) {}\n    &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; ~&lt;span class=&quot;hljs-built_in&quot;&gt;B1&lt;/span&gt;() {}\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;f0&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{}\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b1;\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;B2&lt;/span&gt; {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;B2&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b2) : &lt;span class=&quot;hljs-built_in&quot;&gt;int_in_b2&lt;/span&gt;(int_in_b2) {}\n    &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; ~&lt;span class=&quot;hljs-built_in&quot;&gt;B2&lt;/span&gt;() {}\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b2;\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;D&lt;/span&gt; : &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; B1, &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; B2 {\n    &lt;span class=&quot;hljs-built_in&quot;&gt;D&lt;/span&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b1, &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_b2, &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_d)\n        : &lt;span class=&quot;hljs-built_in&quot;&gt;B1&lt;/span&gt;(int_in_b1), &lt;span class=&quot;hljs-built_in&quot;&gt;B2&lt;/span&gt;(int_in_b2), &lt;span class=&quot;hljs-built_in&quot;&gt;int_in_d&lt;/span&gt;(int_in_d) {}\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{}\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{ &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;; }\n    &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; int_in_d;\n};\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; &lt;/span&gt;{\n    B2 *b2s[&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;];\n    B2 b2{&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;};\n    D *dp;\n    D d{&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;};\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// The memory layout must support the virtual method call use case.&lt;/span&gt;\n    b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = &amp;amp;b2;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// An upcast is an implicit static_cast&amp;lt;&amp;gt;().&lt;/span&gt;\n    b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] = &amp;amp;d;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;amp;d           &quot;&lt;/span&gt; &amp;lt;&amp;lt; &amp;amp;d           &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;b2s[0]       &quot;&lt;/span&gt; &amp;lt;&amp;lt; b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]       &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;b2s[1]       &quot;&lt;/span&gt; &amp;lt;&amp;lt; b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]       &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;b2s[0]-&amp;gt;f2() &quot;&lt;/span&gt; &amp;lt;&amp;lt; b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;f2&lt;/span&gt;() &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;b2s[1]-&amp;gt;f2() &quot;&lt;/span&gt; &amp;lt;&amp;lt; b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;f2&lt;/span&gt;() &amp;lt;&amp;lt; std::endl;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Now for some downcasts.&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Cannot be done implicitly&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// error: invalid conversion from B2* to D* [-fpermissive]&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// dp = (b2s[0]);&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Undefined behaviour to an unrelated memory address because this is a B2, not D.&lt;/span&gt;\n    dp = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;static_cast&amp;lt;D*&amp;gt;(b2s[0])            &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp           &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;static_cast&amp;lt;D*&amp;gt;(b2s[0])-&amp;gt;int_in_d  &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp-&amp;gt;int_in_d &amp;lt;&amp;lt; std::endl;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// OK&lt;/span&gt;\n    dp = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;static_cast&amp;lt;D*&amp;gt;(b2s[1])            &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp           &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;static_cast&amp;lt;D*&amp;gt;(b2s[1])-&amp;gt;int_in_d  &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp-&amp;gt;int_in_d &amp;lt;&amp;lt; std::endl;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Segfault because dp is nullptr.&lt;/span&gt;\n    dp = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;dynamic_cast&amp;lt;D*&amp;gt;(b2s[0])           &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp           &amp;lt;&amp;lt; std::endl;\n    &lt;span class=&quot;hljs-comment&quot;&gt;//std::cout &amp;lt;&amp;lt; &quot;dynamic_cast&amp;lt;D*&amp;gt;(b2s[0])-&amp;gt;int_in_d &quot; &amp;lt;&amp;lt; dp-&amp;gt;int_in_d &amp;lt;&amp;lt; std::endl;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// OK&lt;/span&gt;\n    dp = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;dynamic_cast&amp;lt;D*&amp;gt;(b2s[1])           &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp           &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;dynamic_cast&amp;lt;D*&amp;gt;(b2s[1])-&amp;gt;int_in_d &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp-&amp;gt;int_in_d &amp;lt;&amp;lt; std::endl;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Undefined behaviour to an unrelated memory address because this&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// did not calculate the offset to get from B2* to D*.&lt;/span&gt;\n    dp = &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;reinterpret_cast&amp;lt;D*&amp;gt;(b2s[1])           &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp           &amp;lt;&amp;lt; std::endl;\n    std::cout &amp;lt;&amp;lt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;reinterpret_cast&amp;lt;D*&amp;gt;(b2s[1])-&amp;gt;int_in_d &quot;&lt;/span&gt; &amp;lt;&amp;lt; dp-&amp;gt;int_in_d &amp;lt;&amp;lt; std::endl;\n}\n\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Compile, run and disassemble with:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;g++ -ggdb3 -O0 -std=c++&lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt; -Wall -Wextra -pedantic -o main.out main.cpp\nsetarch `uname -m` -R ./main.out\ngdb -batch -ex &lt;span class=&quot;hljs-string&quot;&gt;&quot;disassemble/rs main&quot;&lt;/span&gt; main.out\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;where &lt;code&gt;setarch&lt;/code&gt; is &lt;a href=&quot;https://stackoverflow.com/questions/11238457/disable-and-re-enable-address-space-layout-randomization-only-for-myself&quot;&gt;used to disable ASLR&lt;/a&gt; to make it easier to compare runs.&lt;/p&gt;\n&lt;p&gt;Possible output:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&amp;amp;d           &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc930&lt;/span&gt;\nb2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]       &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc920&lt;/span&gt;\nb2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]       &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc940&lt;/span&gt;\nb2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;f2&lt;/span&gt;() &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;\nb2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]-&amp;gt;&lt;span class=&quot;hljs-built_in&quot;&gt;f2&lt;/span&gt;() &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])            &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc910&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])-&amp;gt;int_in_d  &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])            &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc930&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])-&amp;gt;int_in_d  &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;])           &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])           &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc930&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])-&amp;gt;int_in_d &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])           &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc940&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;])-&amp;gt;int_in_d &lt;span class=&quot;hljs-number&quot;&gt;32767&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now, as mentioned at: &lt;a href=&quot;https://en.wikipedia.org/wiki/Virtual_method_table&quot; rel=&quot;noreferrer&quot;&gt;https://en.wikipedia.org/wiki/Virtual_method_table&lt;/a&gt; in order to support the virtual method calls efficiently, supposing that the memory data structures of B1 is of form:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;B1:\n  +&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: pointer to &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; method table of B1\n  +&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: value of int_in_b1\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;and &lt;code&gt;B2&lt;/code&gt; is of form:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;B2:\n  +&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: pointer to &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; method table of B2\n  +&lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;: value of int_in_b2\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;then memory data structure of &lt;code&gt;D&lt;/code&gt; has to look something like:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;D:\n  +&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;: &lt;span class=&quot;hljs-function&quot;&gt;pointer to &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; method table of &lt;span class=&quot;hljs-title&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; B1)&lt;/span&gt;\n  +4: value of int_in_b1\n  +&lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;: pointer to virtual method table of D (for B2)\n +&lt;span class=&quot;hljs-number&quot;&gt;12&lt;/span&gt;: value of int_in_b2\n +&lt;span class=&quot;hljs-number&quot;&gt;16&lt;/span&gt;: value of int_in_d\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The key fact is that the memory data structure of &lt;code&gt;D&lt;/code&gt; contains inside it memory structure identical to that of &lt;code&gt;B1&lt;/code&gt; and &lt;code&gt;B2&lt;/code&gt;, i.e.:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;+0 looks exactly like a B1, with the B1 vtable for D followed by &lt;code&gt;int_in_b1&lt;/code&gt;&lt;/li&gt;\n&lt;li&gt;+8 looks exactly like a B2, with the B2 vtable for D followed by &lt;code&gt;int_in_b2&lt;/code&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Therefore we reach the critical conclusion:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;an upcast or downcast only needs to shift the pointer value by a value known at compile time&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;This way, when &lt;code&gt;D&lt;/code&gt; gets passed to the base type array, the type cast actually calculates that offset and points something that looks exactly like a valid &lt;code&gt;B2&lt;/code&gt; in memory, except that this one has the vtable for &lt;code&gt;D&lt;/code&gt; instead of &lt;code&gt;B2&lt;/code&gt;, and therefore all virtual calls work transparently.&lt;/p&gt;\n&lt;p&gt;E.g.:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;] = &amp;amp;d;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;simply needs to get the address of &lt;code&gt;d&lt;/code&gt; + 8 to reach the corresponding B2-like data structure.&lt;/p&gt;\n&lt;p&gt;Now, we can finally get back to type casting and the analysis of our concrete example.&lt;/p&gt;\n&lt;p&gt;From the stdout output we see:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&amp;amp;d           &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc930&lt;/span&gt;\nb2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]       &lt;span class=&quot;hljs-number&quot;&gt;0x7fffffffc940&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Therefore, the implicit &lt;code&gt;static_cast&lt;/code&gt; done there did correctly calculate the offset from the full &lt;code&gt;D&lt;/code&gt; data structure at 0x7fffffffc930 to the &lt;code&gt;B2&lt;/code&gt; like one which is at 0x7fffffffc940. We also infer that what lies between 0x7fffffffc930 and 0x7fffffffc940 is likely be the &lt;code&gt;B1&lt;/code&gt; data and vtable.&lt;/p&gt;\n&lt;p&gt;Then, on the downcast sections, it is now easy to understand how the invalid ones fail and why:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;static_cast&amp;lt;D*&amp;gt;(b2s[0])            0x7fffffffc910&lt;/code&gt;: the compiler just went up 0x10 at compile time bytes to try and go from a &lt;code&gt;B2&lt;/code&gt; to the containing &lt;code&gt;D&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;But because &lt;code&gt;b2s[0]&lt;/code&gt; was not a &lt;code&gt;D&lt;/code&gt;, it now points to an undefined memory region.&lt;/p&gt;\n&lt;p&gt;The disassembly is:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;49&lt;/span&gt;          dp = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fc8&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;414&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8b&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; d0     mov    &lt;span class=&quot;hljs-number&quot;&gt;-0x30&lt;/span&gt;(%rbp),%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fcc&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;418&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;85&lt;/span&gt; c0        test   %rax,%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fcf&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;421&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;74&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;a   je     &lt;span class=&quot;hljs-number&quot;&gt;0xfdb&lt;/span&gt; &amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;main&lt;/span&gt;()+&lt;span class=&quot;hljs-number&quot;&gt;433&lt;/span&gt;&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fd1&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;423&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8b&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; d0     mov    &lt;span class=&quot;hljs-number&quot;&gt;-0x30&lt;/span&gt;(%rbp),%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fd5&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;427&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;83&lt;/span&gt; e8 &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;     sub    $&lt;span class=&quot;hljs-number&quot;&gt;0x10&lt;/span&gt;,%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fd9&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;431&lt;/span&gt;&amp;gt;:   eb &lt;span class=&quot;hljs-number&quot;&gt;05&lt;/span&gt;   jmp    &lt;span class=&quot;hljs-number&quot;&gt;0xfe0&lt;/span&gt; &amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;main&lt;/span&gt;()+&lt;span class=&quot;hljs-number&quot;&gt;438&lt;/span&gt;&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fdb&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;433&lt;/span&gt;&amp;gt;:   b8 &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;  mov    $&lt;span class=&quot;hljs-number&quot;&gt;0x0&lt;/span&gt;,%eax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000000fe0&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;438&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;89&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;98&lt;/span&gt;     mov    %rax,&lt;span class=&quot;hljs-number&quot;&gt;-0x68&lt;/span&gt;(%rbp)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;so we see that GCC does:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;check if pointer is NULL, and if yes return NULL&lt;/li&gt;\n&lt;li&gt;otherwise, subtract 0x10 from it to reach the &lt;code&gt;D&lt;/code&gt; which does not exist&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;dynamic_cast&amp;lt;D*&amp;gt;(b2s[0])           0&lt;/code&gt;: C++ actually found that the cast was invalid and returned &lt;code&gt;nullptr&lt;/code&gt;!&lt;/p&gt;\n&lt;p&gt;There is no way this can be done at compile time, and we will confirm that from the disassembly:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;59&lt;/span&gt;          dp = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]);\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000010ec&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;706&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8b&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; d0     mov    &lt;span class=&quot;hljs-number&quot;&gt;-0x30&lt;/span&gt;(%rbp),%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000010f0&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;710&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;85&lt;/span&gt; c0        test   %rax,%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000010f3&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;713&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;74&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;d   je     &lt;span class=&quot;hljs-number&quot;&gt;0x1112&lt;/span&gt; &amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;main&lt;/span&gt;()+&lt;span class=&quot;hljs-number&quot;&gt;744&lt;/span&gt;&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000010f5&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;715&lt;/span&gt;&amp;gt;:   b9 &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;  mov    $&lt;span class=&quot;hljs-number&quot;&gt;0x10&lt;/span&gt;,%ecx\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000010fa&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;720&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;d &lt;span class=&quot;hljs-number&quot;&gt;15&lt;/span&gt; f7 &lt;span class=&quot;hljs-number&quot;&gt;0b&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;    lea    &lt;span class=&quot;hljs-number&quot;&gt;0x200bf7&lt;/span&gt;(%rip),%rdx        # &lt;span class=&quot;hljs-number&quot;&gt;0x201cf8&lt;/span&gt; &amp;lt;_ZTI1D&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000001101&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;727&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8&lt;/span&gt;d &lt;span class=&quot;hljs-number&quot;&gt;35&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;28&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;c &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;    lea    &lt;span class=&quot;hljs-number&quot;&gt;0x200c28&lt;/span&gt;(%rip),%rsi        # &lt;span class=&quot;hljs-number&quot;&gt;0x201d30&lt;/span&gt; &amp;lt;_ZTI2B2&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000001108&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;734&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;89&lt;/span&gt; c7        mov    %rax,%rdi\n   &lt;span class=&quot;hljs-number&quot;&gt;0x000000000000110b&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;737&lt;/span&gt;&amp;gt;:   e8 c0 fb ff ff  callq  &lt;span class=&quot;hljs-number&quot;&gt;0xcd0&lt;/span&gt; &amp;lt;__dynamic_cast@plt&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000001110&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;742&lt;/span&gt;&amp;gt;:   eb &lt;span class=&quot;hljs-number&quot;&gt;05&lt;/span&gt;   jmp    &lt;span class=&quot;hljs-number&quot;&gt;0x1117&lt;/span&gt; &amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;main&lt;/span&gt;()+&lt;span class=&quot;hljs-number&quot;&gt;749&lt;/span&gt;&amp;gt;\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000001112&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;744&lt;/span&gt;&amp;gt;:   b8 &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;00&lt;/span&gt;  mov    $&lt;span class=&quot;hljs-number&quot;&gt;0x0&lt;/span&gt;,%eax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x0000000000001117&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;749&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;89&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;98&lt;/span&gt;     mov    %rax,&lt;span class=&quot;hljs-number&quot;&gt;-0x68&lt;/span&gt;(%rbp)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;First there is a NULL check, and it returns NULL if th einput is NULL.&lt;/p&gt;\n&lt;p&gt;Otherwise, it sets up some arguments in the RDX, RSI and RDI and calls &lt;code&gt;__dynamic_cast&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;I don&apos;t have the patience to analyze this further now, but as others said, the only way for this to work is for &lt;code&gt;__dynamic_cast&lt;/code&gt; to access some extra RTTI in-memory data structures that represent the class hierarchy.&lt;/p&gt;\n&lt;p&gt;It must therefore start from the &lt;code&gt;B2&lt;/code&gt; entry for that table, then walk this class hierarchy until it finds that the vtable for a &lt;code&gt;D&lt;/code&gt; typecast from &lt;code&gt;b2s[0]&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;This is why dynamic cast is potentially expensive! Here is &lt;a href=&quot;https://gem5-review.googlesource.com/c/public/gem5/+/25964&quot; rel=&quot;noreferrer&quot;&gt;an example where a one liner patch converting a &lt;code&gt;dynamic_cast&lt;/code&gt; to a &lt;code&gt;static_cast&lt;/code&gt; in a complex project reduced runtime by 33%!&lt;/a&gt;.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;&lt;code&gt;reinterpret_cast&amp;lt;D*&amp;gt;(b2s[1])           0x7fffffffc940&lt;/code&gt; this one just believes us blindly: we said there is a &lt;code&gt;D&lt;/code&gt; at address &lt;code&gt;b2s[1]&lt;/code&gt;, and the compiler does no offset calculations.&lt;/p&gt;\n&lt;p&gt;But this is wrong, because D is actually at 0x7fffffffc930, what is at 0x7fffffffc940 is the B2-like structure inside D! So trash gets accessed.&lt;/p&gt;\n&lt;p&gt;We can confirm this from the horrendous &lt;code&gt;-O0&lt;/code&gt; assembly that just moves the value around:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-number&quot;&gt;70&lt;/span&gt;          dp = &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;D*&amp;gt;(b2s[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;]);\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000011fa&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;976&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;8b&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; d8     mov    &lt;span class=&quot;hljs-number&quot;&gt;-0x28&lt;/span&gt;(%rbp),%rax\n   &lt;span class=&quot;hljs-number&quot;&gt;0x00000000000011fe&lt;/span&gt; &amp;lt;+&lt;span class=&quot;hljs-number&quot;&gt;980&lt;/span&gt;&amp;gt;:   &lt;span class=&quot;hljs-number&quot;&gt;48&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;89&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;98&lt;/span&gt;     mov    %rax,&lt;span class=&quot;hljs-number&quot;&gt;-0x68&lt;/span&gt;(%rbp)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Related questions:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/332030/when-should-static-cast-dynamic-cast-const-cast-and-reinterpret-cast-be-used&quot;&gt;When should static_cast, dynamic_cast, const_cast and reinterpret_cast be used?&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/18359780/how-is-dynamic-cast-implemented&quot;&gt;How is dynamic_cast implemented&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/6322949/downcasting-using-the-static-cast-in-c&quot;&gt;Downcasting using the &apos;static_cast&apos; in C++&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Tested on Ubuntu 18.04 amd64, GCC 7.4.0.&lt;/p&gt;\n    ","\n&lt;p&gt;While other answers nicely described all differences between C++ casts, I would like to add a short note why you should not use C-style casts &lt;code&gt;(Type) var&lt;/code&gt; and &lt;code&gt;Type(var)&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;For C++ beginners C-style casts look like being the superset operation over C++ casts (static_cast&amp;lt;&amp;gt;(), dynamic_cast&amp;lt;&amp;gt;(), const_cast&amp;lt;&amp;gt;(), reinterpret_cast&amp;lt;&amp;gt;()) and someone could prefer them over the C++ casts. In fact C-style cast is the superset and shorter to write.&lt;/p&gt;\n\n&lt;p&gt;The main problem of C-style casts is that they hide developer real intention of the cast. The C-style casts can do virtually all types of casting from normally safe casts done by static_cast&amp;lt;&amp;gt;() and dynamic_cast&amp;lt;&amp;gt;() to potentially dangerous casts like const_cast&amp;lt;&amp;gt;(), where const modifier can be removed so the const variables can be modified and reinterpret_cast&amp;lt;&amp;gt;() that can even reinterpret integer values to pointers.&lt;/p&gt;\n\n&lt;p&gt;Here is the sample.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; a=&lt;span class=&quot;hljs-built_in&quot;&gt;rand&lt;/span&gt;(); &lt;span class=&quot;hljs-comment&quot;&gt;// Random number.&lt;/span&gt;\n\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* pa1=&lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*&amp;gt;(a); &lt;span class=&quot;hljs-comment&quot;&gt;// OK. Here developer clearly expressed he wanted to do this potentially dangerous operation.&lt;/span&gt;\n\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* pa2=&lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*&amp;gt;(a); &lt;span class=&quot;hljs-comment&quot;&gt;// Compiler error.&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* pa3=&lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*&amp;gt;(a); &lt;span class=&quot;hljs-comment&quot;&gt;// Compiler error.&lt;/span&gt;\n\n&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;* pa4=(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*) a; &lt;span class=&quot;hljs-comment&quot;&gt;// OK. C-style cast can do such cast. The question is if it was intentional or developer just did some typo.&lt;/span&gt;\n\n*pa4=&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// Program crashes.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The main reason why C++ casts were added to the language was to allow a developer to clarify his intentions - why he is going to do that cast. By using C-style casts which are perfectly valid in C++ you are making your code less readable and more error prone especially for other developers who didn&apos;t create your code. So to make your code more readable and explicit you should always prefer C++ casts over C-style casts.&lt;/p&gt;\n\n&lt;p&gt;Here is a short quote from Bjarne Stroustrup&apos;s (the author of C++) book The C++ Programming Language 4th edition - page 302.&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;This C-style cast is far more dangerous than the named conversion operators\n  because the notation is harder to spot in a large program and the kind of conversion intended by the programmer is not explicit.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;To understand, let&apos;s consider below code snippet:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Foo&lt;/span&gt;{};\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Bar&lt;/span&gt;{};\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; argc, &lt;span class=&quot;hljs-type&quot;&gt;char&lt;/span&gt;** argv)&lt;/span&gt;\n&lt;/span&gt;{\n    Foo* f = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Foo;\n\n    Bar* b1 = f;                              &lt;span class=&quot;hljs-comment&quot;&gt;// (1)&lt;/span&gt;\n    Bar* b2 = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;Bar*&amp;gt;(f);           &lt;span class=&quot;hljs-comment&quot;&gt;// (2)&lt;/span&gt;\n    Bar* b3 = &lt;span class=&quot;hljs-built_in&quot;&gt;dynamic_cast&lt;/span&gt;&amp;lt;Bar*&amp;gt;(f);          &lt;span class=&quot;hljs-comment&quot;&gt;// (3)&lt;/span&gt;\n    Bar* b4 = &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;Bar*&amp;gt;(f);      &lt;span class=&quot;hljs-comment&quot;&gt;// (4)&lt;/span&gt;\n    Bar* b5 = &lt;span class=&quot;hljs-built_in&quot;&gt;const_cast&lt;/span&gt;&amp;lt;Bar*&amp;gt;(f);            &lt;span class=&quot;hljs-comment&quot;&gt;// (5)&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Only line (4) compiles without error. Only &lt;strong&gt;reinterpret_cast&lt;/strong&gt; can be used to convert a pointer to an object to a pointer to an any unrelated object type.&lt;/p&gt;\n\n&lt;p&gt;One this to be noted is: The &lt;strong&gt;dynamic_cast&lt;/strong&gt; would fail at run-time, however on most compilers it will also fail to compile because there are no virtual functions in the struct of the pointer being casted, meaning &lt;strong&gt;dynamic_cast&lt;/strong&gt; will work with only polymorphic class pointers.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;When to use C++ cast&lt;/strong&gt;:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Use &lt;strong&gt;static_cast&lt;/strong&gt; as the equivalent of a C-style cast that does value conversion, or when we need to explicitly up-cast a pointer from a class to its superclass.&lt;/li&gt;\n&lt;li&gt;Use &lt;strong&gt;const_cast&lt;/strong&gt; to remove the const qualifier.  &lt;/li&gt;\n&lt;li&gt;Use &lt;strong&gt;reinterpret_cast&lt;/strong&gt; to do unsafe conversions of pointer types to and from integer and other pointer types. Use this only if we know what we are doing and we understand the aliasing issues.&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;Nice feature of &lt;code&gt;reinterpret_cast&lt;/code&gt;, not mentioned in the other answers, is that it allows us to create a sort of &lt;code&gt;void*&lt;/code&gt; pointer for function types. Normally, for object types one uses &lt;code&gt;static_cast&lt;/code&gt; to retrieve the original type of a pointer stored in &lt;code&gt;void*&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;  &lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;13&lt;/span&gt;;\n  &lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; *p = &amp;amp;i;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;auto&lt;/span&gt; *pi = &lt;span class=&quot;hljs-built_in&quot;&gt;static_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;*&amp;gt;(p);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For functions, we must use &lt;code&gt;reinterpret_cast&lt;/code&gt; twice:&lt;/p&gt;\n&lt;pre class=&quot;lang-cpp s-code-block&quot;&gt;&lt;code class=&quot;hljs language-cpp&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;&amp;lt;iostream&amp;gt;&lt;/span&gt;&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;any_fcn_ptr_t&lt;/span&gt; = &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt;(*)();\n\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; i)&lt;/span&gt;\n&lt;/span&gt;{\n   std::cout &amp;lt;&amp;lt; i &amp;lt;&amp;lt;std::endl;\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt;\n&lt;/span&gt;{     \n  &lt;span class=&quot;hljs-comment&quot;&gt;//Create type-erased pointer to function:&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;auto&lt;/span&gt; any_ptr = &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;any_fcn_ptr_t&lt;/span&gt;&amp;gt;(&amp;amp;print);\n  \n  &lt;span class=&quot;hljs-comment&quot;&gt;//Retrieve the original pointer:&lt;/span&gt;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;auto&lt;/span&gt; ptr = &lt;span class=&quot;hljs-built_in&quot;&gt;reinterpret_cast&lt;/span&gt;&amp;lt; &lt;span class=&quot;hljs-built_in&quot;&gt;void&lt;/span&gt;(*)(&lt;span class=&quot;hljs-type&quot;&gt;int&lt;/span&gt;) &amp;gt;(any_ptr);\n  \n  &lt;span class=&quot;hljs-built_in&quot;&gt;ptr&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;);\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;With &lt;code&gt;reinterpret_cast&lt;/code&gt; we can even get a similar sort-of-void* pointer for pointers to member functions.&lt;/p&gt;\n&lt;p&gt;As with plain &lt;code&gt;void*&lt;/code&gt; and &lt;code&gt;static_cast&lt;/code&gt;, C++ guarantees that &lt;code&gt;ptr&lt;/code&gt; points to &lt;code&gt;print&lt;/code&gt; function (as long as we pass the correct type to &lt;code&gt;reinterpret_cast&lt;/code&gt;).&lt;/p&gt;\n    "]},"page":"12","randomQuestions":[{"title":"Is there a difference between \"==\" and \"is\"?","slug":"is-there-a-difference-between-\"\"-and-\"is\"-1657387902231"},{"title":"How do I vertically center text with CSS? [duplicate]","slug":"how-do-i-vertically-center-text-with-css-duplicate-1657387645821"},{"title":"Fetch the rows which have the Max value for a column for each distinct value of another column","slug":"fetch-the-rows-which-have-the-max-value-for-a-column-for-each-distinct-value-of-another-column-1657387423925"},{"title":"How can I read inputs as numbers?","slug":"how-can-i-read-inputs-as-numbers-1657384503324"},{"title":"How to choose the right bean scope?","slug":"how-to-choose-the-right-bean-scope-1657387596513"},{"title":"Syntax error due to using a reserved word as a table or column name in MySQL","slug":"syntax-error-due-to-using-a-reserved-word-as-a-table-or-column-name-in-mysql-1657384689274"},{"title":"How to reshape data from long to wide format","slug":"how-to-reshape-data-from-long-to-wide-format-1657384486421"},{"title":"Why does Date.parse give incorrect results?","slug":"why-does-date.parse-give-incorrect-results-1657384642821"},{"title":"How do I compose a rotation matrix with human readable angles from scratch?","slug":"how-do-i-compose-a-rotation-matrix-with-human-readable-angles-from-scratch-1657387963457"},{"title":"Add a property to a JavaScript object using a variable as the name?","slug":"add-a-property-to-a-javascript-object-using-a-variable-as-the-name-1657388425650"},{"title":"How does JavaScript .prototype work?","slug":"how-does-javascript-.prototype-work-1657388169270"},{"title":"How to center an element horizontally and vertically","slug":"how-to-center-an-element-horizontally-and-vertically-1657388132330"},{"title":"How to print without a newline or space","slug":"how-to-print-without-a-newline-or-space-1657387814213"},{"title":"How do I use arrays in C++?","slug":"how-do-i-use-arrays-in-c++-1657387456118"},{"title":"How to access a local variable from a different function using pointers?","slug":"how-to-access-a-local-variable-from-a-different-function-using-pointers-1657388159760"},{"title":"What is SQL injection? [duplicate]","slug":"what-is-sql-injection-duplicate-1657387944486"},{"title":"Use of 'prototype' vs. 'this' in JavaScript?","slug":"use-of-'prototype'-vs.-'this'-in-javascript-1657388117307"},{"title":"What is the \"N+1 selects problem\" in ORM (Object-Relational Mapping)?","slug":"what-is-the-\"n+1-selects-problem\"-in-orm-(object-relational-mapping)-1657388055597"},{"title":"I just assigned a variable, but echo $variable shows something else","slug":"i-just-assigned-a-variable-but-echo-dollarvariable-shows-something-else-1657387574561"},{"title":"Why does Spring MVC respond with a 404 and report \"No mapping found for HTTP request with URI [...] in DispatcherServlet\"?","slug":"why-does-spring-mvc-respond-with-a-404-and-report-\"no-mapping-found-for-http-request-with-uri-...-in-dispatcherservlet\"-1657387995250"}]},"__N_SSG":true}