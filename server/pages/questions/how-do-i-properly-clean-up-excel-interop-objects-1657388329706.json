{"pageProps":{"data":{"answer":["\n&lt;p&gt;Excel does not quit because your application is still holding references to COM objects.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;I guess you&apos;re invoking at least one member of a COM object without assigning it to a variable.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;For me it was the &lt;em&gt;excelApp.Worksheets&lt;/em&gt; object which I directly used without assigning it to a variable:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Worksheet sheet = excelApp.Worksheets.Open(...);\n...\nMarshal.ReleaseComObject(sheet);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;I didn&apos;t know that internally C# created a wrapper for the &lt;strong&gt;Worksheets&lt;/strong&gt; COM object which didn&apos;t get released by my code (because I wasn&apos;t aware of it) and was the cause why Excel was not unloaded.&lt;/p&gt;\n\n&lt;p&gt;I found the solution to my problem on &lt;a href=&quot;http://www.velocityreviews.com/forums/showpost.php?s=f87f0674feda4442dcbd40019cbca65b&amp;amp;p=528575&amp;amp;postcount=2&quot; rel=&quot;noreferrer&quot;&gt;this page&lt;/a&gt;, which also has a nice rule for the usage of COM objects in C#:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;Never use two dots with COM objects.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;So with this knowledge the right way of doing the above is:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Worksheets sheets = excelApp.Worksheets; &lt;span class=&quot;hljs-comment&quot;&gt;// &amp;lt;-- The important part&lt;/span&gt;\nWorksheet sheet = sheets.Open(...);\n...\nMarshal.ReleaseComObject(sheets);\nMarshal.ReleaseComObject(sheet);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;POST MORTEM UPDATE:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;I want every reader to read this answer by Hans Passant very carefully as it explains the trap I and lots of other developers stumbled into. When I wrote this answer years ago I didn&apos;t know about the effect the debugger has to the garbage collector and drew the wrong conclusions. I keep my answer unaltered for the sake of history but please read this link and &lt;strong&gt;don&apos;t&lt;/strong&gt; go the way of &quot;the two dots&quot;: &lt;a href=&quot;https://stackoverflow.com/questions/17130382/understanding-garbage-collection-in-net/17131389#17131389&quot;&gt;Understanding garbage collection in .NET&lt;/a&gt; and &lt;a href=&quot;https://stackoverflow.com/questions/25134024/clean-up-excel-interop-objects-with-idisposable/25135685#25135685&quot;&gt;Clean up Excel Interop Objects with IDisposable&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;You can actually release your Excel Application object cleanly, but you do have to take care. &lt;/p&gt;\n\n&lt;p&gt;The advice to maintain a named reference for absolutely every COM object you access and then explicitly release it via &lt;code&gt;Marshal.FinalReleaseComObject()&lt;/code&gt; is correct in theory, but, unfortunately, very difficult to manage in practice. If one ever slips anywhere and uses &quot;two dots&quot;, or iterates cells via a &lt;code&gt;for each&lt;/code&gt; loop, or any other similar kind of command, then you&apos;ll have unreferenced COM objects and risk a hang. In this case, there would be no way to find the cause in the code; you would have to review all your code by eye and hopefully find the cause, a task that could be nearly impossible for a large project.&lt;/p&gt;\n\n&lt;p&gt;The good news is that you do not actually have to maintain a named variable reference to every COM object you use. Instead, call &lt;code&gt;GC.Collect()&lt;/code&gt; and then &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; to release all the (usually minor) objects to which you do not hold a reference, and then explicitly release the objects to which you do hold a named variable reference. &lt;/p&gt;\n\n&lt;p&gt;You should also release your named references in reverse order of importance: range objects first, then worksheets, workbooks, and then finally your Excel Application object.&lt;/p&gt;\n\n&lt;p&gt;For example, assuming that you had a Range object variable named &lt;code&gt;xlRng&lt;/code&gt;, a Worksheet variable named &lt;code&gt;xlSheet&lt;/code&gt;, a Workbook variable named &lt;code&gt;xlBook&lt;/code&gt; and an Excel Application variable named &lt;code&gt;xlApp&lt;/code&gt;, then your cleanup code could look something like the following:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Cleanup&lt;/span&gt;\nGC.Collect();\nGC.WaitForPendingFinalizers();\n\nMarshal.FinalReleaseComObject(xlRng);\nMarshal.FinalReleaseComObject(xlSheet);\n\nxlBook.Close(Type.Missing, Type.Missing, Type.Missing);\nMarshal.FinalReleaseComObject(xlBook);\n\nxlApp.Quit();\nMarshal.FinalReleaseComObject(xlApp);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;In most code examples you&apos;ll see for cleaning up COM objects from .NET, the &lt;code&gt;GC.Collect()&lt;/code&gt; and &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; calls are made TWICE as in:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;GC.Collect();\nGC.WaitForPendingFinalizers();\nGC.Collect();\nGC.WaitForPendingFinalizers();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This should not be required, however, unless you are using Visual Studio Tools for Office (VSTO), which uses finalizers that cause an entire graph of objects to be promoted in the finalization queue. Such objects would not be released until the &lt;em&gt;next&lt;/em&gt; garbage collection. However, if you are not using VSTO, you should be able to call &lt;code&gt;GC.Collect()&lt;/code&gt; and &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; just once.&lt;/p&gt;\n\n&lt;p&gt;I know that explicitly calling &lt;code&gt;GC.Collect()&lt;/code&gt; is a no-no (and certainly doing it twice sounds very painful), but there is no way around it, to be honest. Through normal operations you will generate hidden objects to which you hold no reference that you, therefore, cannot release through any other means other than calling &lt;code&gt;GC.Collect()&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;This is a complex topic, but this really is all there is to it. Once you establish this template for your cleanup procedure you can code normally, without the need for wrappers, etc. :-)&lt;/p&gt;\n\n&lt;p&gt;I have a tutorial on this here:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;http://www.xtremevbtalk.com/showthread.php?t=160433&quot; rel=&quot;noreferrer&quot;&gt;Automating Office Programs with VB.Net / COM Interop&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;It&apos;s written for VB.NET, but don&apos;t be put off by that, the principles are exactly the same as when using C#.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Preface: my answer contains two solutions, so be careful when reading and don&apos;t miss anything.&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;There are different ways and advice of how to make Excel instance unload, such as:  &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;Releasing EVERY com object explicitly\nwith Marshal.FinalReleaseComObject()\n(not forgetting about implicitly\ncreated com-objects). To release\nevery created com object, you may use\nthe rule of 2 dots mentioned here:&lt;br&gt;\n&lt;a href=&quot;https://stackoverflow.com/questions/158706/how-to-properly-clean-up-excel-interop-objects-in-c/158752#158752&quot;&gt;How do I properly clean up Excel interop objects?&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Calling GC.Collect() and\nGC.WaitForPendingFinalizers() to make\nCLR release unused com-objects * (Actually, it works, see my second solution for details)&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Checking if com-server-application\nmaybe shows a message box waiting for\nthe user to answer (though I am not\nsure it can prevent Excel from\nclosing, but I heard about it a few\ntimes)&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Sending WM_CLOSE message to the main\nExcel window&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Executing the function that works\nwith Excel in a separate AppDomain.\nSome people believe Excel instance\nwill be shut, when AppDomain is\nunloaded.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Killing all excel instances which were instantiated after our excel-interoping code started.&lt;/p&gt;&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;BUT!&lt;/strong&gt; Sometimes all these options just don&apos;t help or can&apos;t be appropriate!&lt;/p&gt;\n\n&lt;p&gt;For example, yesterday I found out that in one of my functions (which works with excel) Excel keeps running after the function ends. I tried everything! I thoroughly checked the whole function 10 times and added Marshal.FinalReleaseComObject() for everything! I also had GC.Collect() and GC.WaitForPendingFinalizers(). I checked for hidden message boxes. I tried to send WM_CLOSE message to the main Excel window. I executed my function in a separate AppDomain and unloaded that domain. Nothing helped! The option with closing all excel instances is inappropriate, because if the user starts another Excel instance manually, during execution of my function which works also with Excel, then that instance will also be closed by my function. I bet the user will not be happy! So, honestly, this is a lame option (no offence guys). So I spent a couple of hours before I found a good (in my humble opinion) &lt;strong&gt;solution&lt;/strong&gt;: &lt;strong&gt;Kill excel process by hWnd of its main window&lt;/strong&gt; (it&apos;s the first solution).&lt;/p&gt;\n\n&lt;p&gt;Here is the simple code:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;[&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user32.dll&quot;&lt;/span&gt;)&lt;/span&gt;]\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetWindowThreadProcessId&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IntPtr hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; lpdwProcessId&lt;/span&gt;)&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;summary&amp;gt;&lt;/span&gt; Tries to find and kill process by hWnd to the main window of the process.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;param name=&quot;hWnd&quot;&amp;gt;&lt;/span&gt;Handle to the main window of the process.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;returns&amp;gt;&lt;/span&gt;True if process was found and killed. False if process was not found by hWnd or if it could not be killed.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/returns&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;TryKillProcessByMainWindowHwnd&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; hWnd&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; processID;\n    GetWindowThreadProcessId((IntPtr)hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; processID);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(processID == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n    {\n        Process.GetProcessById((&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;)processID).Kill();\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (ArgumentException)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Win32Exception)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (NotSupportedException)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (InvalidOperationException)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;summary&amp;gt;&lt;/span&gt; Finds and kills process by hWnd to the main window of the process.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/summary&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;param name=&quot;hWnd&quot;&amp;gt;&lt;/span&gt;Handle to the main window of the process.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/param&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;exception cref=&quot;ArgumentException&quot;&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; Thrown when process is not found by the hWnd parameter (the process is not running). &lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; The identifier of the process might be expired.&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/exception&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;exception cref=&quot;Win32Exception&quot;&amp;gt;&lt;/span&gt;See Process.Kill() exceptions documentation.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/exception&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;exception cref=&quot;NotSupportedException&quot;&amp;gt;&lt;/span&gt;See Process.Kill() exceptions documentation.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/exception&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; &lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;exception cref=&quot;InvalidOperationException&quot;&amp;gt;&lt;/span&gt;See Process.Kill() exceptions documentation.&lt;span class=&quot;hljs-doctag&quot;&gt;&amp;lt;/exception&amp;gt;&lt;/span&gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;KillProcessByMainWindowHwnd&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; hWnd&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; processID;\n    GetWindowThreadProcessId((IntPtr)hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; processID);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (processID == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Process has not been found by the given main window handle.&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;hWnd&quot;&lt;/span&gt;);\n    Process.GetProcessById((&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;)processID).Kill();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;As you can see I provided two methods, according to Try-Parse pattern (I think it is appropriate here): one method doesn&apos;t throw the exception if the Process could not be killed (for example the process doesn&apos;t exist anymore), and another method throws the exception if the Process was not killed. The only weak place in this code is security permissions. Theoretically, the user may not have permissions to kill the process, but in 99.99% of all cases, user has such permissions. I also tested it with a guest account - it works perfectly.&lt;/p&gt;\n\n&lt;p&gt;So, your code, working with Excel, can look like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; hWnd = xl.Application.Hwnd;\n&lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// here we try to close Excel as usual, with xl.Quit(),&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// Marshal.FinalReleaseComObject(xl) and so on&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\nTryKillProcessByMainWindowHwnd(hWnd);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Voila! Excel is terminated! :)&lt;/p&gt;\n\n&lt;p&gt;Ok, let&apos;s go back to the second solution, as I promised in the beginning of the post.\n&lt;strong&gt;The second solution is to call GC.Collect() and GC.WaitForPendingFinalizers().&lt;/strong&gt; Yes, they actually work, but you need to be careful here!&lt;br&gt;\nMany people say (and I said) that calling GC.Collect() doesn&apos;t help. But the reason it wouldn&apos;t help is if there are still references to COM objects! One of the most popular reasons for GC.Collect() not being helpful is running the project in Debug-mode. In debug-mode objects that are not really referenced anymore will not be garbage collected until the end of the method.&lt;br&gt;\nSo, if you tried GC.Collect() and GC.WaitForPendingFinalizers() and it didn&apos;t help, try to do the following:  &lt;/p&gt;\n\n&lt;p&gt;1) Try to run your project in Release mode and check if Excel closed correctly  &lt;/p&gt;\n\n&lt;p&gt;2) Wrap the method of working with Excel in a separate method.\nSo, instead of something like this:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GenerateWorkbook&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;...&lt;/span&gt;)&lt;/span&gt;\n{\n  ApplicationClass xl;\n  Workbook xlWB;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n  {\n    xl = ...\n    xlWB = xl.Workbooks.Add(...);\n    ...\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n  {\n    ...\n    Marshal.ReleaseComObject(xlWB)\n    ...\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;you write:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GenerateWorkbook&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;...&lt;/span&gt;)&lt;/span&gt;\n{\n  &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n  {\n    GenerateWorkbookInternal(...);\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n  {\n    GC.Collect();\n    GC.WaitForPendingFinalizers();\n  }\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GenerateWorkbookInternal&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;...&lt;/span&gt;)&lt;/span&gt;\n{\n  ApplicationClass xl;\n  Workbook xlWB;\n  &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n  {\n    xl = ...\n    xlWB = xl.Workbooks.Add(...);\n    ...\n  }\n  &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n  {\n    ...\n    Marshal.ReleaseComObject(xlWB)\n    ...\n  }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now, Excel will close =)&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;UPDATE&lt;/strong&gt;: Added C# code, and link to Windows Jobs&lt;/p&gt;\n\n&lt;p&gt;I spent sometime trying to figure out this problem, and at the time XtremeVBTalk was the most active and responsive.  Here is a link to my original post, &lt;a href=&quot;http://www.xtremevbtalk.com/showpost.php?p=1335552&amp;amp;postcount=22&quot; rel=&quot;noreferrer&quot;&gt;Closing an Excel Interop process cleanly, even if your application crashes&lt;/a&gt;. Below is a summary of the post, and the code copied to this post. &lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Closing the Interop process with &lt;code&gt;Application.Quit()&lt;/code&gt; and &lt;code&gt;Process.Kill()&lt;/code&gt; works for the most part, but fails if the applications crashes catastrophically. I.e. if the app crashes, the Excel process will still be running loose.&lt;/li&gt;\n&lt;li&gt;The solution is to let the OS handle the cleanup of your processes through &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/ms682409(VS.85).aspx&quot; rel=&quot;noreferrer&quot;&gt;Windows Job Objects&lt;/a&gt; using Win32 calls.  When your main application dies, the associated processes (i.e. Excel) will get terminated as well.  &lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;I found this to be a clean solution because the OS is doing real work of cleaning up.  All you have to do is &lt;em&gt;register&lt;/em&gt; the Excel process.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Windows Job Code&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Wraps the Win32 API Calls to register Interop processes.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;enum&lt;/span&gt; JobObjectInfoType\n{\n    AssociateCompletionPortInformation = &lt;span class=&quot;hljs-number&quot;&gt;7&lt;/span&gt;,\n    BasicLimitInformation = &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;,\n    BasicUIRestrictions = &lt;span class=&quot;hljs-number&quot;&gt;4&lt;/span&gt;,\n    EndOfJobTimeInformation = &lt;span class=&quot;hljs-number&quot;&gt;6&lt;/span&gt;,\n    ExtendedLimitInformation = &lt;span class=&quot;hljs-number&quot;&gt;9&lt;/span&gt;,\n    SecurityLimitInformation = &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;,\n    GroupInformation = &lt;span class=&quot;hljs-number&quot;&gt;11&lt;/span&gt;\n}\n\n[&lt;span class=&quot;hljs-meta&quot;&gt;StructLayout(LayoutKind.Sequential)&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; SECURITY_ATTRIBUTES\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; nLength;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IntPtr lpSecurityDescriptor;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; bInheritHandle;\n}\n\n[&lt;span class=&quot;hljs-meta&quot;&gt;StructLayout(LayoutKind.Sequential)&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; JOBOBJECT_BASIC_LIMIT_INFORMATION\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int64 PerProcessUserTimeLimit;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int64 PerJobUserTimeLimit;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int16 LimitFlags;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 MinimumWorkingSetSize;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 MaximumWorkingSetSize;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int16 ActiveProcessLimit;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int64 Affinity;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int16 PriorityClass;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Int16 SchedulingClass;\n}\n\n[&lt;span class=&quot;hljs-meta&quot;&gt;StructLayout(LayoutKind.Sequential)&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; IO_COUNTERS\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 ReadOperationCount;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 WriteOperationCount;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 OtherOperationCount;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 ReadTransferCount;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 WriteTransferCount;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt64 OtherTransferCount;\n}\n\n[&lt;span class=&quot;hljs-meta&quot;&gt;StructLayout(LayoutKind.Sequential)&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; JOBOBJECT_EXTENDED_LIMIT_INFORMATION\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; JOBOBJECT_BASIC_LIMIT_INFORMATION BasicLimitInformation;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IO_COUNTERS IoInfo;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 ProcessMemoryLimit;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 JobMemoryLimit;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 PeakProcessMemoryUsed;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; UInt32 PeakJobMemoryUsed;\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Job&lt;/span&gt; : &lt;span class=&quot;hljs-title&quot;&gt;IDisposable&lt;/span&gt;\n{\n    [&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kernel32.dll&quot;&lt;/span&gt;, CharSet = CharSet.Unicode)&lt;/span&gt;]\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; IntPtr &lt;span class=&quot;hljs-title&quot;&gt;CreateJobObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; a, &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; lpName&lt;/span&gt;)&lt;/span&gt;;\n\n    [&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kernel32.dll&quot;&lt;/span&gt;)&lt;/span&gt;]\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;SetInformationJobObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IntPtr hJob, JobObjectInfoType infoType, IntPtr lpJobObjectInfo, &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; cbJobObjectInfoLength&lt;/span&gt;)&lt;/span&gt;;\n\n    [&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;kernel32.dll&quot;&lt;/span&gt;, SetLastError = true)&lt;/span&gt;]\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;AssignProcessToJobObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IntPtr job, IntPtr process&lt;/span&gt;)&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; IntPtr m_handle;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; m_disposed = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Job&lt;/span&gt;()&lt;/span&gt;\n    {\n        m_handle = CreateJobObject(&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n\n        JOBOBJECT_BASIC_LIMIT_INFORMATION info = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; JOBOBJECT_BASIC_LIMIT_INFORMATION();\n        info.LimitFlags = &lt;span class=&quot;hljs-number&quot;&gt;0x2000&lt;/span&gt;;\n\n        JOBOBJECT_EXTENDED_LIMIT_INFORMATION extendedInfo = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; JOBOBJECT_EXTENDED_LIMIT_INFORMATION();\n        extendedInfo.BasicLimitInformation = info;\n\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; length = Marshal.SizeOf(&lt;span class=&quot;hljs-keyword&quot;&gt;typeof&lt;/span&gt;(JOBOBJECT_EXTENDED_LIMIT_INFORMATION));\n        IntPtr extendedInfoPtr = Marshal.AllocHGlobal(length);\n        Marshal.StructureToPtr(extendedInfo, extendedInfoPtr, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!SetInformationJobObject(m_handle, JobObjectInfoType.ExtendedLimitInformation, extendedInfoPtr, (&lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt;)length))\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;.Format(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Unable to set information.  Error: {0}&quot;&lt;/span&gt;, Marshal.GetLastWin32Error()));\n    }\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;region&lt;/span&gt; IDisposable Members&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Dispose&lt;/span&gt;()&lt;/span&gt;\n    {\n        Dispose(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n        GC.SuppressFinalize(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;);\n    }\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;endregion&lt;/span&gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Dispose&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; disposing&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (m_disposed)\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (disposing) {}\n\n        Close();\n        m_disposed = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Close&lt;/span&gt;()&lt;/span&gt;\n    {\n        Win32.CloseHandle(m_handle);\n        m_handle = IntPtr.Zero;\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;AddProcess&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IntPtr handle&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; AssignProcessToJobObject(m_handle, handle);\n    }\n\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Note about Constructor code&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;In the constructor, the &lt;code&gt;info.LimitFlags = 0x2000;&lt;/code&gt; is called. &lt;code&gt;0x2000&lt;/code&gt; is the &lt;code&gt;JOB_OBJECT_LIMIT_KILL_ON_JOB_CLOSE&lt;/code&gt; enum value, and this value is defined by &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/windows/desktop/ms684147(v=vs.85).aspx&quot; rel=&quot;noreferrer&quot;&gt;MSDN&lt;/a&gt; as:&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;Causes all processes associated with the job to terminate when the\n  last handle to the job is closed.&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;&lt;strong&gt;Extra Win32 API Call to get the Process ID (PID)&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    [&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user32.dll&quot;&lt;/span&gt;, SetLastError = true)&lt;/span&gt;]\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetWindowThreadProcessId&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;IntPtr hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; lpdwProcessId&lt;/span&gt;)&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Using the code&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    Excel.Application app = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Excel.ApplicationClass();\n    Job job = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Job();\n    &lt;span class=&quot;hljs-built_in&quot;&gt;uint&lt;/span&gt; pid = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n    Win32.GetWindowThreadProcessId(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; IntPtr(app.Hwnd), &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; pid);\n    job.AddProcess(Process.GetProcessById((&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;)pid).Handle);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;This worked for a project I was working on:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;excelApp.Quit();\nMarshal.ReleaseComObject (excelWB);\nMarshal.ReleaseComObject (excelApp);\nexcelApp = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;We learned that it was important to set &lt;strong&gt;every&lt;/strong&gt; reference to an Excel COM object to null when you were done with it. This included Cells, Sheets, and everything.&lt;/p&gt;\n    ","\n&lt;p&gt;First - you &lt;em&gt;never&lt;/em&gt; have to call &lt;code&gt;Marshal.ReleaseComObject(...)&lt;/code&gt; or &lt;code&gt;Marshal.FinalReleaseComObject(...)&lt;/code&gt; when doing Excel interop. It is a confusing anti-pattern, but any information about this, including from Microsoft, that indicates you have to manually release COM references from .NET is incorrect. The fact is that the .NET runtime and garbage collector correctly keep track of and clean up COM references. For your code, this means you can remove the whole `while (...) loop at the top.&lt;/p&gt;\n\n&lt;p&gt;Second, if you want to ensure that the COM references to an out-of-process COM object are cleaned up when your process ends (so that the Excel process will close), you need to ensure that the garbage collector runs. You do this correctly with calls to &lt;code&gt;GC.Collect()&lt;/code&gt; and &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt;. Calling this twice is safe, and ensures that cycles are definitely cleaned up too (though I&apos;m not sure it&apos;s needed, and would appreciate an example that shows this).&lt;/p&gt;\n\n&lt;p&gt;Third, when running under the debugger, local references will be artificially kept alive until the end of the method (so that local variable inspection works). So  &lt;code&gt;GC.Collect()&lt;/code&gt; calls are not effective for cleaning object like &lt;code&gt;rng.Cells&lt;/code&gt; from the same method. You should split the code doing the COM interop from the GC cleanup into separate methods. (This was a key discovery for me, from one part of the answer posted here by @nightcoder.)&lt;/p&gt;\n\n&lt;p&gt;The general pattern would thus be:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;Sub &lt;span class=&quot;hljs-title&quot;&gt;WrapperThatCleansUp&lt;/span&gt;()\n\n    &apos; NOTE: Don&apos;t call Excel objects &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; here... \n    &apos;       Debugger would keep alive until end, preventing GC cleanup\n\n    &apos; Call a separate function that talks to Excel\n    &lt;span class=&quot;hljs-title&quot;&gt;DoTheWork&lt;/span&gt;()\n\n    &apos; Now &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; the GC clean &lt;span class=&quot;hljs-title&quot;&gt;up&lt;/span&gt; (&lt;span class=&quot;hljs-params&quot;&gt;twice, to clean up cycles too&lt;/span&gt;)\n    GC.&lt;span class=&quot;hljs-title&quot;&gt;Collect&lt;/span&gt;()    \n    GC.&lt;span class=&quot;hljs-title&quot;&gt;WaitForPendingFinalizers&lt;/span&gt;()\n    GC.&lt;span class=&quot;hljs-title&quot;&gt;Collect&lt;/span&gt;()    \n    GC.&lt;span class=&quot;hljs-title&quot;&gt;WaitForPendingFinalizers&lt;/span&gt;()\n\nEnd Sub\n\nSub &lt;span class=&quot;hljs-title&quot;&gt;DoTheWork&lt;/span&gt;()\n    Dim app As New Microsoft.Office.Interop.Excel.Application\n    Dim book As Microsoft.Office.Interop.Excel.Workbook&lt;/span&gt; = app.Workbooks.Add()\n    Dim worksheet As Microsoft.Office.Interop.Excel.Worksheet = book.Worksheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Sheet1&quot;&lt;/span&gt;)\n    app.Visible = True\n    For i As Integer = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; To &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n        worksheet.Cells.Range(&lt;span class=&quot;hljs-string&quot;&gt;&quot;A&quot;&lt;/span&gt; &amp;amp; i).Value = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Hello&quot;&lt;/span&gt;\n    Next\n    book.Save()\n    book.Close()\n    app.Quit()\n\n    &lt;span class=&quot;hljs-string&quot;&gt;&apos; NOTE: No calls the Marshal.ReleaseComObject() are ever needed\nEnd Sub\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;There is a lot of false information and confusion about this issue, including many posts on MSDN and on Stack Overflow (and especially this question!).&lt;/p&gt;\n\n&lt;p&gt;What finally convinced me to have a closer look and figure out the right advice was blog post &lt;em&gt;&lt;a href=&quot;https://blogs.msdn.microsoft.com/visualstudio/2010/03/01/marshal-releasecomobject-considered-dangerous/&quot; rel=&quot;noreferrer&quot;&gt;Marshal.ReleaseComObject Considered Dangerous&lt;/a&gt;&lt;/em&gt; together with finding the issue with references kept alive under the debugger that was confusing my earlier testing.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;Anything that is in the Excel namespace needs to be released. Period&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;You can&apos;t be doing:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Worksheet ws = excel.WorkBooks[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;].WorkSheets[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You have to be doing&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Workbooks books = excel.WorkBooks;\nWorkbook book = books[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\nSheets sheets = book.WorkSheets;\nWorksheet ws = sheets[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;followed by the releasing of the objects.&lt;/p&gt;\n    ","\n&lt;p&gt;I &lt;a href=&quot;http://www.deez.info/sengelha/2005/02/11/useful-idisposable-class-3-autoreleasecomobject/&quot; rel=&quot;noreferrer&quot;&gt;found&lt;/a&gt; a useful generic template that can help implement the correct disposal pattern for COM objects, that need Marshal.ReleaseComObject called when they go out of scope:&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Usage:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; (AutoReleaseComObject&amp;lt;Application&amp;gt; excelApplicationWrapper = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; AutoReleaseComObject&amp;lt;Application&amp;gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Application()))\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;using&lt;/span&gt; (AutoReleaseComObject&amp;lt;Workbook&amp;gt; workbookWrapper = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; AutoReleaseComObject&amp;lt;Workbook&amp;gt;(excelApplicationWrapper.ComObject.Workbooks.Open(namedRangeBase.FullName, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, missing, missing, missing, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, missing, missing, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, missing, missing, missing, missing, missing)))\n        {\n           &lt;span class=&quot;hljs-comment&quot;&gt;// do something with your workbook....&lt;/span&gt;\n        }\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n    {\n         excelApplicationWrapper.ComObject.Quit();\n    } \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Template:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;AutoReleaseComObject&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt; : &lt;span class=&quot;hljs-title&quot;&gt;IDisposable&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; T m_comObject;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; m_armed = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; m_disposed = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;AutoReleaseComObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;T comObject&lt;/span&gt;)&lt;/span&gt;\n    {\n        Debug.Assert(comObject != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n        m_comObject = comObject;\n    }\n\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; DEBUG&lt;/span&gt;\n    ~AutoReleaseComObject()\n    {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// We should have been disposed using Dispose().&lt;/span&gt;\n        Debug.WriteLine(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Finalize being called, should have been disposed&quot;&lt;/span&gt;);\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.ComObject != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n        {\n            Debug.WriteLine(&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;.Format(&lt;span class=&quot;hljs-string&quot;&gt;&quot;ComObject was not null:{0}, name:{1}.&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.ComObject, &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.ComObjectName));\n        }\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;//Debug.Assert(false);&lt;/span&gt;\n    }\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;endif&lt;/span&gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; T ComObject\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;\n        {\n            Debug.Assert(!m_disposed);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; m_comObject;\n        }\n    }\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; ComObjectName\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.ComObject &lt;span class=&quot;hljs-keyword&quot;&gt;is&lt;/span&gt; Microsoft.Office.Interop.Excel.Workbook)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; ((Microsoft.Office.Interop.Excel.Workbook)&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.ComObject).Name;\n            }\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        }\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Disarm&lt;/span&gt;()&lt;/span&gt;\n    {\n        Debug.Assert(!m_disposed);\n        m_armed = &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;;\n    }\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;region&lt;/span&gt; IDisposable Members&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Dispose&lt;/span&gt;()&lt;/span&gt;\n    {\n        Dispose(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; DEBUG&lt;/span&gt;\n        GC.SuppressFinalize(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;);\n&lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;endif&lt;/span&gt;&lt;/span&gt;\n    }\n\n    &lt;span class=&quot;hljs-meta&quot;&gt;#&lt;span class=&quot;hljs-keyword&quot;&gt;endregion&lt;/span&gt;&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Dispose&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;bool&lt;/span&gt; disposing&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!m_disposed)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (m_armed)\n            {\n                &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; refcnt = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt;\n                {\n                    refcnt = System.Runtime.InteropServices.Marshal.ReleaseComObject(m_comObject);\n                } &lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (refcnt &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n\n                m_comObject = &lt;span class=&quot;hljs-literal&quot;&gt;default&lt;/span&gt;(T);\n            }\n\n            m_disposed = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n        }\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Reference:&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;http://www.deez.info/sengelha/2005/02/11/useful-idisposable-class-3-autoreleasecomobject/&quot; rel=&quot;noreferrer&quot;&gt;http://www.deez.info/sengelha/2005/02/11/useful-idisposable-class-3-autoreleasecomobject/&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;I cant believe this problem has haunted the world for 5 years.... If you have created an application, you need to shut it down first before removing the link.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;objExcel = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Excel.Application();  \nobjBook = (Excel.Workbook)(objExcel.Workbooks.Add(Type.Missing)); \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;when closing&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;objBook.Close(&lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;, Type.Missing, Type.Missing); \nobjExcel.Application.Quit();\nobjExcel.Quit(); \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;When you new an excel application, it opens a excel program in the background. You need to command that excel program to quit before you release the link because that excel program is not part of your direct control. Therefore, it will stay open if the link is released!&lt;/p&gt;\n\n&lt;p&gt;Good programming everyone~~&lt;/p&gt;\n    ","\n&lt;p&gt;Common developers, none of your solutions worked for me, \nso I decide to implement a new &lt;strong&gt;trick&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;First let specify &quot;What is our goal?&quot; =&amp;gt; &quot;Not to see excel object after our job in task manager&quot; &lt;/p&gt;\n\n&lt;p&gt;Ok. Let no to challenge and start destroying it, but consider not to destroy other instance os Excel which are running in parallel.&lt;/p&gt;\n\n&lt;p&gt;So , get the list of current processors and fetch PID of EXCEL processes , then once your job is done, we have a new guest in processes list with a unique PID ,find and destroy just that one.&lt;/p&gt;\n\n&lt;p&gt;&amp;lt; keep in mind any new excel process during your excel job will be detected as new and destroyed &amp;gt;\n &amp;lt; A better solution is to capture PID of new created excel object and just destroy that&amp;gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Process[] prs = Process.GetProcesses();\nList&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt; excelPID = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt;();\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (Process p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; prs)\n   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (p.ProcessName == &lt;span class=&quot;hljs-string&quot;&gt;&quot;EXCEL&quot;&lt;/span&gt;)\n       excelPID.Add(p.Id);\n\n.... &lt;span class=&quot;hljs-comment&quot;&gt;// your job &lt;/span&gt;\n\nprs = Process.GetProcesses();\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (Process p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; prs)\n   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (p.ProcessName == &lt;span class=&quot;hljs-string&quot;&gt;&quot;EXCEL&quot;&lt;/span&gt; &amp;amp;&amp;amp; !excelPID.Contains(p.Id))\n       p.Kill();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This resolves my issue, hope yours too.&lt;/p&gt;\n    ","\n&lt;p&gt;This sure seems like it has been over-complicated. From my experience, there are just three key things to get Excel to close properly:&lt;/p&gt;\n\n&lt;p&gt;1: make sure there are no remaining references to the excel application you created (you should only have one anyway; set it to &lt;code&gt;null&lt;/code&gt;)&lt;/p&gt;\n\n&lt;p&gt;2: call &lt;code&gt;GC.Collect()&lt;/code&gt;&lt;/p&gt;\n\n&lt;p&gt;3: Excel has to be closed, either by the user manually closing the program, or by you calling &lt;code&gt;Quit&lt;/code&gt; on the Excel object. (Note that &lt;code&gt;Quit&lt;/code&gt; will function just as if the user tried to close the program, and will present a confirmation dialog if there are unsaved changes, even if Excel is not visible. The user could press cancel, and then Excel will not have been closed.)&lt;/p&gt;\n\n&lt;p&gt;1 needs to happen before 2, but 3 can happen anytime.&lt;/p&gt;\n\n&lt;p&gt;One way to implement this is to wrap the interop Excel object with your own class, create the interop instance in the constructor, and implement IDisposable with Dispose looking something like&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!mDisposed) {\n   mExcel = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n   GC.Collect();\n   mDisposed = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;That will clean up excel from your program&apos;s side of things. Once Excel is closed (manually by the user or by you calling &lt;code&gt;Quit&lt;/code&gt;) the process will go away. If the program has already been closed, then the process will disappear on the &lt;code&gt;GC.Collect()&lt;/code&gt; call.&lt;/p&gt;\n\n&lt;p&gt;(I&apos;m not sure how important it is, but you may want a &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; call after the &lt;code&gt;GC.Collect()&lt;/code&gt; call but it is not strictly necessary to get rid of the Excel process.)&lt;/p&gt;\n\n&lt;p&gt;This has worked for me without issue for years. Keep in mind though that while this works, you actually have to close gracefully for it to work. You will still get accumulating excel.exe processes if you interrupt your program before Excel is cleaned up (usually by hitting &quot;stop&quot; while your program is being debugged).&lt;/p&gt;\n    ","\n&lt;p&gt;I&apos;ve traditionally followed the advice found in &lt;a href=&quot;https://stackoverflow.com/a/158752/741988&quot;&gt;VVS&apos;s answer&lt;/a&gt;.  However, in an effort to keep this answer up-to-date with the latest options, I think all my future projects will use the &quot;NetOffice&quot; library.&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://osdn.net/projects/netoffice/&quot; rel=&quot;nofollow noreferrer&quot;&gt;NetOffice&lt;/a&gt; is a complete replacement for the Office PIAs and is completely version-agnostic. It&apos;s a collection of Managed COM wrappers that can handle the cleanup that often causes such headaches when working with Microsoft Office in .NET.&lt;/p&gt;\n\n&lt;p&gt;Some key features are:&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Mostly version-independent (and version-dependant features are documented)&lt;/li&gt;\n&lt;li&gt;No dependencies&lt;/li&gt;\n&lt;li&gt;No PIA&lt;/li&gt;\n&lt;li&gt;No registration&lt;/li&gt;\n&lt;li&gt;No VSTO&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;I am in no way affiliated with the project; I just genuinely appreciate the stark reduction in headaches.&lt;/p&gt;\n    ","\n&lt;p&gt;To add to reasons why Excel does not close, even when you create direct refrences to each object upon read, creation, is the &apos;For&apos; loop.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;For Each objWorkBook As WorkBook &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; objWorkBooks &lt;span class=&quot;hljs-string&quot;&gt;&apos;local ref, created from ExcelApp.WorkBooks to avoid the double-dot\n   objWorkBook.Close &apos;&lt;/span&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;or&lt;/span&gt; whatever\n   &lt;span class=&quot;hljs-title&quot;&gt;FinalReleaseComObject&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;objWorkBook&lt;/span&gt;)\n   objWorkBook&lt;/span&gt; = Nothing\nNext \n\n&lt;span class=&quot;hljs-string&quot;&gt;&apos;The above does not work, and this is the workaround:\n\nFor intCounter As Integer = 1 To mobjExcel_WorkBooks.Count\n   Dim objTempWorkBook As Workbook = mobjExcel_WorkBooks.Item(intCounter)\n   objTempWorkBook.Saved = True\n   objTempWorkBook.Close(False, Type.Missing, Type.Missing)\n   FinalReleaseComObject(objTempWorkBook)\n   objTempWorkBook = Nothing\nNext\n&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;The accepted answer here is correct, but also take note that not only &quot;two dot&quot; references need to be avoided, but also objects that are retrieved via the index.  You also do not need to wait until you are finished with the program to clean up these objects, it&apos;s best to create functions that will clean them up as soon as you&apos;re finished with them, when possible.  Here is a function I created that assigns some properties of a Style object called &lt;code&gt;xlStyleHeader&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Excel.Style xlStyleHeader = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CreateHeaderStyle&lt;/span&gt;()&lt;/span&gt;\n{\n    Excel.Styles xlStyles = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    Excel.Font xlFont = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    Excel.Interior xlInterior = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    Excel.Borders xlBorders = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    Excel.Border xlBorderBottom = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n    {\n        xlStyles = xlWorkbook.Styles;\n        xlStyleHeader = xlStyles.Add(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Header&quot;&lt;/span&gt;, Type.Missing);\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Text Format&lt;/span&gt;\n        xlStyleHeader.NumberFormat = &lt;span class=&quot;hljs-string&quot;&gt;&quot;@&quot;&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Bold&lt;/span&gt;\n        xlFont = xlStyleHeader.Font;\n        xlFont.Bold = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Light Gray Cell Color&lt;/span&gt;\n        xlInterior = xlStyleHeader.Interior;\n        xlInterior.Color = &lt;span class=&quot;hljs-number&quot;&gt;12632256&lt;/span&gt;;\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Medium Bottom border&lt;/span&gt;\n        xlBorders = xlStyleHeader.Borders;\n        xlBorderBottom = xlBorders[Excel.XlBordersIndex.xlEdgeBottom];\n        xlBorderBottom.Weight = Excel.XlBorderWeight.xlMedium;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex)\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; ex;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n    {\n        Release(xlBorderBottom);\n        Release(xlBorders);\n        Release(xlInterior);\n        Release(xlFont);\n        Release(xlStyles);\n    }\n}\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Release&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; obj&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Errors are ignored per Microsoft&apos;s suggestion for this type of function:&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// http://support.microsoft.com/default.aspx/kb/317109&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n    {\n        System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; { } \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Notice that I had to set &lt;code&gt;xlBorders[Excel.XlBordersIndex.xlEdgeBottom]&lt;/code&gt; to a variable in order to clean that up (Not because of the two dots, which refer to an enumeration which does not need to be released, but because the object I&apos;m referring to is actually a Border object that does need to be released).&lt;/p&gt;\n\n&lt;p&gt;This sort of thing is not really necessary in standard applications, which do a great job of cleaning up after themselves, but in ASP.NET applications, if you miss even one of these, no matter how often you call the garbage collector, Excel will still be running on your server.  &lt;/p&gt;\n\n&lt;p&gt;It requires a lot of attention to detail and many test executions while monitoring the Task Manager when writing this code, but doing so saves you the hassle of desperately searching through pages of code to find the one instance you missed.  This is especially important when working in loops, where you need to release EACH INSTANCE of an object, even though it uses the same variable name each time it loops.&lt;/p&gt;\n    ","\n&lt;p&gt;After trying&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;Release COM objects in reverse order&lt;/li&gt;\n&lt;li&gt;Add &lt;code&gt;GC.Collect()&lt;/code&gt; and &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; twice at the end&lt;/li&gt;\n&lt;li&gt;No more than two dots&lt;/li&gt;\n&lt;li&gt;Close workbook and quit application&lt;/li&gt;\n&lt;li&gt;Run in release mode&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;the final solution that works for me is to move one set of&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;GC.Collect();\nGC.WaitForPendingFinalizers();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;that we added to the end of the function to a wrapper, as follows:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;FunctionWrapper&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; sourcePath, &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; targetPath&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n    {\n        FunctionThatCallsExcel(sourcePath, targetPath);\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n    {\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I followed this exactly... But I still ran into issues 1 out of 1000 times. Who knows why. Time to bring out the hammer...&lt;/p&gt;\n\n&lt;p&gt;Right after the Excel Application class is instantiated I get a hold of the Excel process that was just created.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;excel = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Microsoft.Office.Interop.Excel.Application();\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; process = Process.GetProcessesByName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;EXCEL&quot;&lt;/span&gt;).OrderByDescending(p =&amp;gt; p.StartTime).First();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Then once I&apos;ve done all the above COM clean-up, I make sure that process isn&apos;t running. If it is still running, kill it!&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!process.HasExited)\n   process.Kill();\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;&lt;strong&gt; Shoot Excel proc and chew bubble gum &lt;/strong&gt;&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyExcelInteropClass&lt;/span&gt;\n{\n    Excel.Application xlApp;\n    Excel.Workbook xlBook;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;dothingswithExcel&lt;/span&gt;()&lt;/span&gt; \n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt; { &lt;span class=&quot;hljs-comment&quot;&gt;/* Do stuff manipulating cells sheets and workbooks ... */&lt;/span&gt; }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;catch&lt;/span&gt; {}\n        &lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt; {KillExcelProcess(xlApp);}\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;KillExcelProcess&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Excel.Application xlApp&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (xlApp != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; excelProcessId = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n            GetWindowThreadProcessId(xlApp.Hwnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; excelProcessId);\n            Process p = Process.GetProcessById(excelProcessId);\n            p.Kill();\n            xlApp = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        }\n    }\n\n    [&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user32.dll&quot;&lt;/span&gt;)&lt;/span&gt;]\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetWindowThreadProcessId&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; lpdwProcessId&lt;/span&gt;)&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You need to be aware that Excel is very sensitive to the culture you are running under as well.&lt;/p&gt;\n\n&lt;p&gt;You may find that you need to set the culture to EN-US before calling Excel functions.\nThis does not apply to all functions - but some of them.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    CultureInfo en_US = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; System.Globalization.CultureInfo(&lt;span class=&quot;hljs-string&quot;&gt;&quot;en-US&quot;&lt;/span&gt;); \n    System.Threading.Thread.CurrentThread.CurrentCulture = en_US;\n    &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; filePathLocal = _applicationObject.ActiveWorkbook.Path;\n    System.Threading.Thread.CurrentThread.CurrentCulture = orgCulture;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;This applies even if you are using VSTO.&lt;/p&gt;\n\n&lt;p&gt;For details: &lt;a href=&quot;http://support.microsoft.com/default.aspx?scid=kb;en-us;Q320369&quot; rel=&quot;noreferrer&quot;&gt;http://support.microsoft.com/default.aspx?scid=kb;en-us;Q320369&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;&quot;Never use two dots with COM objects&quot; is a great rule of thumb to avoid leakage of COM references, but Excel PIA can lead to leakage in more ways than apparent at first sight.&lt;/p&gt;\n&lt;p&gt;One of these ways is subscribing to any event exposed by any of the Excel object model&apos;s COM objects.&lt;/p&gt;\n&lt;p&gt;For example, subscribing to the Application class&apos;s WorkbookOpen event.&lt;/p&gt;\n&lt;h3&gt;Some theory on COM events&lt;/h3&gt;\n&lt;p&gt;COM classes expose a group of events through call-back interfaces. In order to subscribe to events, the client code can simply register an object implementing the call-back interface and the COM class will invoke its methods in response to specific events. Since the call-back interface is a COM interface, it is the duty of the implementing object to decrement the reference count of any COM object it receives (as a parameter) for any of the event handlers.&lt;/p&gt;\n&lt;h3&gt;How Excel PIA expose COM Events&lt;/h3&gt;\n&lt;p&gt;Excel PIA exposes COM events of Excel Application class as conventional .NET events. Whenever the client code subscribes to &lt;strong&gt;a .NET event&lt;/strong&gt; (emphasis on &apos;a&apos;), PIA creates &lt;strong&gt;an&lt;/strong&gt; instance of a class implementing the call-back interface and registers it with Excel.&lt;/p&gt;\n&lt;p&gt;Hence, a number of call-back objects get registered with Excel in response to different subscription requests from the .NET code. One call-back object per event subscription.&lt;/p&gt;\n&lt;p&gt;A call-back interface for event handling means that, PIA has to subscribe to all interface events for every .NET event subscription request. It cannot pick and choose. On receiving an event call-back, the call-back object checks if the associated .NET event handler is interested in the current event or not and then either invokes the handler or silently ignores the call-back.&lt;/p&gt;\n&lt;h3&gt;Effect on COM instance reference counts&lt;/h3&gt;\n&lt;p&gt;All these call-back objects do not decrement the reference count of any of the COM objects they receive (as parameters) for any of the call-back methods (even for the ones that are silently ignored). They rely solely on the &lt;a href=&quot;http://en.wikipedia.org/wiki/Common_Language_Runtime&quot; rel=&quot;nofollow noreferrer&quot;&gt;CLR&lt;/a&gt; garbage collector to free up the COM objects.&lt;/p&gt;\n&lt;p&gt;Since GC run is non-deterministic, this can lead to the holding off of Excel process for a longer duration than desired and create an impression of a &apos;memory leak&apos;.&lt;/p&gt;\n&lt;h3&gt;Solution&lt;/h3&gt;\n&lt;p&gt;The only solution as of now is to avoid the PIAs event provider for the COM class and write your own event provider which deterministically releases COM objects.&lt;/p&gt;\n&lt;p&gt;For the Application class, this can be done by implementing the AppEvents interface and then registering the implementation with Excel by using &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.comtypes.iconnectionpointcontainer.aspx&quot; rel=&quot;nofollow noreferrer&quot;&gt;IConnectionPointContainer interface&lt;/a&gt;. The Application class (and for that matter all COM objects exposing events using callback mechanism) implements the IConnectionPointContainer interface.&lt;/p&gt;\n    ","\n&lt;p&gt;As others have pointed out, you need to create an explicit reference for every Excel object you use, and call Marshal.ReleaseComObject on that reference, as described in &lt;a href=&quot;http://support.microsoft.com/default.aspx/kb/317109&quot; rel=&quot;nofollow noreferrer&quot;&gt;this KB article&lt;/a&gt;.  You also need to use try/finally to ensure ReleaseComObject is always called, even when an exception is thrown.  I.e. instead of:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Worksheet sheet = excelApp.Worksheets(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n... &lt;span class=&quot;hljs-keyword&quot;&gt;do&lt;/span&gt; something &lt;span class=&quot;hljs-keyword&quot;&gt;with&lt;/span&gt; sheet\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;you need to do something like:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Worksheets sheets = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\nWorksheet sheet = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n{ \n    sheets = excelApp.Worksheets;\n    sheet = sheets(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;);\n    ...\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (sheets != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) Marshal.ReleaseComObject(sheets);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (sheet != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) Marshal.ReleaseComObject(sheet);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You also need to call Application.Quit before releasing the Application object if you want Excel to close.&lt;/p&gt;\n\n&lt;p&gt;As you can see, this quickly becomes extremely unwieldy as soon as you try to do anything even moderately complex.  I have successfully developed .NET applications with a simple wrapper class that wraps a few simple manipulations of the Excel object model (open a workbook, write to a Range, save/close the workbook etc).  The wrapper class implements IDisposable, carefully implements Marshal.ReleaseComObject on every object it uses, and does not pubicly expose any Excel objects to the rest of the app.&lt;/p&gt;\n\n&lt;p&gt;But this approach doesn&apos;t scale well for more complex requirements.  &lt;/p&gt;\n\n&lt;p&gt;This is a big deficiency of .NET COM Interop.  For more complex scenarios, I would seriously consider writing an ActiveX DLL in VB6 or other unmanaged language to which you can delegate all interaction with out-proc COM objects such as Office.  You can then reference this ActiveX DLL from your .NET application, and things will be much easier as you will only need to release this one reference.&lt;/p&gt;\n    ","\n&lt;p&gt;When all the stuff above didn&apos;t work, try giving Excel some time to close its sheets:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;app.workbooks.Close();\nThread.Sleep(&lt;span class=&quot;hljs-number&quot;&gt;500&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// adjust, for me it works at around 300+&lt;/span&gt;\napp.Quit();\n\n...\nFinalReleaseComObject(app);\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;Make sure that you release all objects related to Excel!&lt;/p&gt;\n\n&lt;p&gt;I spent a few hours by trying several ways. All are great ideas but I finally found my mistake: &lt;strong&gt;If you don&apos;t release all objects, none of the ways above can help you&lt;/strong&gt; like in my case. Make sure you release all objects including range one!&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Excel.Range rng = (Excel.Range)worksheet.Cells[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;];\nworksheet.Paste(rng, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\nreleaseObject(rng);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The options are together &lt;a href=&quot;http://birvesifir.com/2012/08/08/how-to-properly-clean-up-excel-interop-objects-in-c/&quot; rel=&quot;nofollow&quot;&gt;here&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;A great article on releasing COM objects is &lt;em&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/office/aa679807(v=office.12).aspx#officeinteroperabilitych2_part2_rco&quot; rel=&quot;nofollow noreferrer&quot;&gt;2.5 Releasing COM Objects&lt;/a&gt;&lt;/em&gt; (MSDN).&lt;/p&gt;\n\n&lt;p&gt;The method that I would advocate is to null your Excel.Interop references if they are non-local variables, and then call &lt;code&gt;GC.Collect()&lt;/code&gt; and &lt;code&gt;GC.WaitForPendingFinalizers()&lt;/code&gt; twice. Locally scoped Interop variables will be taken care of automatically.&lt;/p&gt;\n\n&lt;p&gt;This removes the need to keep a named reference for &lt;strong&gt;every&lt;/strong&gt; COM object.&lt;/p&gt;\n\n&lt;p&gt;Here&apos;s an example taken from the article:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Test&lt;/span&gt; {\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// These instance variables must be nulled or Excel will not quit&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Excel.Application xl;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Excel.Workbook book;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DoSomething&lt;/span&gt;()&lt;/span&gt;\n    {\n        xl = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Excel.Application();\n        xl.Visible = &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;;\n        book = xl.Workbooks.Add(Type.Missing);\n\n        &lt;span class=&quot;hljs-comment&quot;&gt;// These variables are locally scoped, so we need not worry about them.&lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// Notice I don&apos;t care about using two dots.&lt;/span&gt;\n        Excel.Range rng = book.Worksheets[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;].UsedRange;\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;CleanUp&lt;/span&gt;()&lt;/span&gt;\n    {\n        book = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        xl.Quit();\n        xl = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n        GC.Collect();\n        GC.WaitForPendingFinalizers();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;These words are straight from the article:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;In almost all situations, nulling the RCW reference and forcing a garbage collection will clean up properly. If you also call GC.WaitForPendingFinalizers, garbage collection will be as deterministic as you can make it. That is, you&apos;ll be pretty sure exactly when the object has been cleaned upon the return from the second call to WaitForPendingFinalizers. As an alternative, you can use Marshal.ReleaseComObject. However, note that you are very unlikely to ever need to use this method.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;The two dots rule did not work for me. In my case I created a method to clean my resources as follows:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Clean&lt;/span&gt;()&lt;/span&gt;\n{\n    workBook.Close();\n    Marshall.ReleaseComObject(workBook);\n    excel.Quit();\n    CG.Collect();\n    CG.WaitForPendingFinalizers();\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;My solution&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;[&lt;span class=&quot;hljs-meta&quot;&gt;DllImport(&lt;span class=&quot;hljs-string&quot;&gt;&quot;user32.dll&quot;&lt;/span&gt;)&lt;/span&gt;]\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;extern&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetWindowThreadProcessId&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; hWnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; lpdwProcessId&lt;/span&gt;)&lt;/span&gt;;\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GenerateExcel&lt;/span&gt;()&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; excel = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Microsoft.Office.Interop.Excel.Application();\n    &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; id;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Find the Excel Process Id (ath the end, you kill him&lt;/span&gt;\n    GetWindowThreadProcessId(excel.Hwnd, &lt;span class=&quot;hljs-keyword&quot;&gt;out&lt;/span&gt; id);\n    Process excelProcess = Process.GetProcessById(id);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;try&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Your code&lt;/span&gt;\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;finally&lt;/span&gt;\n{\n    excel.Quit();\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Kill him !&lt;/span&gt;\n    excelProcess.Kill();\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You should be very careful using Word/Excel interop applications. After trying all the solutions we still had a lot of &quot;WinWord&quot; process left open on server (with more than 2000 users).&lt;/p&gt;\n\n&lt;p&gt;After working on the problem for hours, I realized that if I open more than a couple of documents using &lt;code&gt;Word.ApplicationClass.Document.Open()&lt;/code&gt; on different threads simultaneously, IIS worker process (w3wp.exe) would crash leaving all WinWord processes open!&lt;/p&gt;\n\n&lt;p&gt;So I guess there is no absolute solution to this problem, but switching to other methods such as &lt;a href=&quot;https://en.wikipedia.org/wiki/Office_Open_XML&quot; rel=&quot;nofollow noreferrer&quot;&gt;Office Open XML&lt;/a&gt; development.&lt;/p&gt;\n    ","\n&lt;p&gt;The accepted answer did not work for me. The following code in the destructor did the job.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (xlApp != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n{\n    xlApp.Workbooks.Close();\n    xlApp.Quit();\n}\n\nSystem.Diagnostics.Process[] processArray = System.Diagnostics.Process.GetProcessesByName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;EXCEL&quot;&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (System.Diagnostics.Process process &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; processArray)\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (process.MainWindowTitle.Length == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) { process.Kill(); }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I am currently working on Office automation and have stumbled across a solution for this that works every time for me. It is simple and does not involve killing any processes.&lt;/p&gt;\n\n&lt;p&gt;It seems that by merely looping through the current active processes, and in any way &apos;accessing&apos; an open Excel process, any stray hanging instance of Excel will be removed. The below code simply checks for processes where the name is &apos;Excel&apos;, then writes the MainWindowTitle property of the process to a string. This &apos;interaction&apos; with the process seems to make Windows catch up and abort the frozen instance of Excel. &lt;/p&gt;\n\n&lt;p&gt;I run the below method just before the add-in which I am developing quits, as it fires it unloading event. It removes any hanging instances of Excel every time. In all honesty I am not entirely sure why this works, but it works well for me and could be placed at the end of any Excel application without having to worry about double dots, Marshal.ReleaseComObject, nor killing processes. I would be very interested in any suggestions as to why this is effective.&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;SweepExcelProcesses&lt;/span&gt;()&lt;/span&gt;\n{           \n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (Process.GetProcessesByName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;EXCEL&quot;&lt;/span&gt;).Length != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;)\n            {\n                Process[] processes = Process.GetProcesses();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (Process process &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; processes)\n                {\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (process.ProcessName.ToString() == &lt;span class=&quot;hljs-string&quot;&gt;&quot;excel&quot;&lt;/span&gt;)\n                    {                           \n                        &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; title = process.MainWindowTitle;\n                    }\n                }\n            }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;I think that some of that is just the way that the framework handles Office applications, but I could be wrong. On some days, some applications clean up the processes immediately, and other days it seems to wait until the application closes. In general, I quit paying attention to the details and just make sure that there aren&apos;t any extra processes floating around at the end of the day.&lt;/p&gt;\n\n&lt;p&gt;Also, and maybe I&apos;m over simplifying things, but I think you can just...&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;objExcel = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Excel.Application();\nobjBook = (Excel.Workbook)(objExcel.Workbooks.Add(Type.Missing));\nDoSomeStuff(objBook);\nSaveTheBook(objBook);\nobjBook.Close(&lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;, Type.Missing, Type.Missing);\nobjExcel.Quit();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Like I said earlier, I don&apos;t tend to pay attention to the details of when the Excel process appears or disappears, but that usually works for me.  I also don&apos;t like to keep Excel processes around for anything other than the minimal amount of time, but I&apos;m probably just being paranoid on that.&lt;/p&gt;\n    ","\n&lt;p&gt;As some have probably already written, it&apos;s not just important how you &lt;em&gt;close&lt;/em&gt; the Excel (object); it&apos;s also important how you &lt;em&gt;open&lt;/em&gt; it and also by the type of the project.&lt;/p&gt;\n\n&lt;p&gt;In a WPF application, basically the same code is working without or with very few problems.&lt;/p&gt;\n\n&lt;p&gt;I have a project in which the same Excel file is being processed several times for different parameter value - e.g. parsing it based on values inside a generic list. &lt;/p&gt;\n\n&lt;p&gt;I put all Excel-related functions into the base class, and parser into a subclass (different parsers use common Excel functions). I didn&apos;t want that Excel is opened and closed again for each item in a generic list, so I&apos;ve opened it only once in the base class and close it in the subclass. I had problems when moving the code into a desktop application. I&apos;ve tried many of the above mentioned solutions. &lt;code&gt;GC.Collect()&lt;/code&gt; was already implemented before, twice as suggested.&lt;/p&gt;\n\n&lt;p&gt;Then I&apos;ve decided that I will move the code for opening Excel to a subclass. Instead of opening only once, now I create a new object (base class) and open Excel for every item and close it at the end. There is some performance penalty, but based on several tests Excel processes are closing without problems (in debug mode), so also temporary files are removed. I will continue with testing and write some more if I will get some updates.&lt;/p&gt;\n\n&lt;p&gt;The bottom line is: You must also check the initialize code, especially if you have many classes, etc.&lt;/p&gt;\n    "],"comment":["\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Are you trying to shut down the Excel.exe without closing your application? Not sure I fully understand your question.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10893/bryant&quot; title=&quot;8,680 reputation&quot; class=&quot;comment-user&quot;&gt;Bryant&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment48873_158706&quot;&gt;&lt;span title=&quot;2008-10-01 17:23:35Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 1, 2008 at 17:23&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I&apos;m trying to make sure the unmanaged interop objects are disposed of properly.  So that there are not Excel processes hanging around even when the user has finished with Excel spreadsheet we created from the app.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/11989/hades&quot; title=&quot;16,375 reputation&quot; class=&quot;comment-user owner&quot;&gt;HAdes&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment48885_158706&quot;&gt;&lt;span title=&quot;2008-10-01 17:29:03Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 1, 2008 at 17:29&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;If you can try to do it by producing XML Excel files, otherwise please consider VSTO un/managed Memory Management: &lt;a href=&quot;http://jake.ginnivan.net/vsto-com-interop&quot; rel=&quot;nofollow noreferrer&quot;&gt;jake.ginnivan.net/vsto-com-interop&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/495455/jeremy-thompson&quot; title=&quot;57,451 reputation&quot; class=&quot;comment-user&quot;&gt;Jeremy Thompson&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment13270984_158706&quot;&gt;&lt;span title=&quot;2012-04-25 06:35:48Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Apr 25, 2012 at 6:35&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Does this translate to Excel nicely?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/427684/coops&quot; title=&quot;4,531 reputation&quot; class=&quot;comment-user&quot;&gt;Coops&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment18587411_158706&quot;&gt;&lt;span title=&quot;2012-11-26 14:10:09Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 26, 2012 at 14:10&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;See (besides answers below) this support article from Microsoft, where they specifically give solutions to this problem: &lt;a href=&quot;http://support.microsoft.com/kb/317109/&quot; rel=&quot;nofollow noreferrer&quot;&gt;support.microsoft.com/kb/317109&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1766265/arjan&quot; title=&quot;15,161 reputation&quot; class=&quot;comment-user&quot;&gt;Arjan&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment45692812_158706&quot;&gt;&lt;span title=&quot;2015-02-24 16:43:35Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 24, 2015 at 16:43&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Then I suggest not using Excel from COM and save yourself all of the trouble. The Excel 2007 formats can be used without ever opening Excel, gorgeous.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/7116/user7116&quot; title=&quot;61,790 reputation&quot; class=&quot;comment-user&quot;&gt;user7116&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment1837765_158752&quot;&gt;&lt;span title=&quot;2009-12-18 17:35:40Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Dec 18, 2009 at 17:35&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I did not understand what &quot;two dots&quot; mean. Can you please explain?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/73535/a9s6&quot; title=&quot;6,425 reputation&quot; class=&quot;comment-user&quot;&gt;A9S6&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment2088869_158752&quot;&gt;&lt;span title=&quot;2010-01-27 13:18:03Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Jan 27, 2010 at 13:18&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;This means, you shouldn&apos;t use the pattern comObject.Property.PropertiesProperty (you see the two dots?). Instead assign comObject.Property to a variable and use and dispose that variable.  A more formal version of the above rule could be sth. like &quot;Assign com object to variables before you use them. This includes com objects that are properties of another com object.&quot;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/21038/vvs&quot; title=&quot;19,037 reputation&quot; class=&quot;comment-user&quot;&gt;VVS&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment2148701_158752&quot;&gt;&lt;span title=&quot;2010-02-04 10:37:03Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Feb 4, 2010 at 10:37&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@Nick: Actually, you don&apos;t need any kind of cleanup, since the garbage collector will do it for you. The only thing you need to do is to assign every COM object to its own variable so the GC knows of it.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/21038/vvs&quot; title=&quot;19,037 reputation&quot; class=&quot;comment-user&quot;&gt;VVS&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment4229139_158752&quot;&gt;&lt;span title=&quot;2010-10-18 07:42:34Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 18, 2010 at 7:42&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@VSS thats bollocks, the GC cleans up everything since the wrapper variables are made by the .net framework. It just might take forever for the GC to clean it up. Calling GC.Collect after heavy interop isn&apos;t a bad idear.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/67415/codingbarfield&quot; title=&quot;3,372 reputation&quot; class=&quot;comment-user&quot;&gt;CodingBarfield&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment8388483_158752&quot;&gt;&lt;span title=&quot;2011-08-11 08:28:46Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 11, 2011 at 8:28&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;A related discussion can be found on the ExtremeVBTalk .NET Office Automation forum, here: &lt;a href=&quot;http://www.xtremevbtalk.com/showthread.php?t=303928&quot; rel=&quot;nofollow noreferrer&quot;&gt;xtremevbtalk.com/showthread.php?t=303928&lt;/a&gt;.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment293435_159419&quot;&gt;&lt;span title=&quot;2009-01-24 15:15:38Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Jan 24, 2009 at 15:15&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;And if all else fails, then Process.Kill() can be used (as a last resort) as described here: &lt;a href=&quot;http://stackoverflow.com/questions/51462/killing-excelexe-on-server#312513&quot; title=&quot;killing excelexe on server%23312513&quot;&gt;stackoverflow.com/questions/51462/&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment337577_159419&quot;&gt;&lt;span title=&quot;2009-02-07 18:56:29Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Feb 7, 2009 at 18:56&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Glad it worked Richard. :-)  And here is a subtle example where simply avoiding &quot;two dots&quot; is not sufficient to prevent a problem: &lt;a href=&quot;http://stackoverflow.com/questions/4964663/why-does-this-code-cause-excel-to-not-close-properly&quot; title=&quot;why does this code cause excel to not close properly&quot;&gt;stackoverflow.com/questions/4964663/&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment5568748_159419&quot;&gt;&lt;span title=&quot;2011-02-13 17:22:34Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Feb 13, 2011 at 17:22&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Here&apos;s an opinion on this from Misha Shneerson of Microsoft on the topic, within the comment date Oct. 7, 2010. (&lt;a href=&quot;http://blogs.msdn.com/b/csharpfaq/archive/2010/09/28/converting-a-vba-macro-to-c-4-0.aspx&quot; rel=&quot;nofollow noreferrer&quot;&gt;blogs.msdn.com/b/csharpfaq/archive/2010/09/28/&lt;/a&gt;)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment6606950_159419&quot;&gt;&lt;span title=&quot;2011-04-24 02:00:00Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Apr 24, 2011 at 2:00&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I&apos;m hoping this helps a persistent problem we&apos;re having. Is it safe to do the garbage collection and release calls within a finally block?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1523794/brett-green&quot; title=&quot;3,287 reputation&quot; class=&quot;comment-user&quot;&gt;Brett Green&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment48760410_159419&quot;&gt;&lt;span title=&quot;2015-05-19 18:01:17Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;May 19, 2015 at 18:01&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;sad that the thread is already so old that your excellent answer appears that far below, which I think is the only reason for it not being upvoted more times...&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/55787/chiccodoro&quot; title=&quot;14,089 reputation&quot; class=&quot;comment-user&quot;&gt;chiccodoro&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment2799743_1893653&quot;&gt;&lt;span title=&quot;2010-05-04 16:32:12Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;May 4, 2010 at 16:32&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I have to admit, when I first read your answer, I thought it was a giant kludge.  After about 6 hours of wrestling with this (everything is released, I&apos;ve got no double dots, etc..), I now think your answer is genius.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/16363/mark&quot; title=&quot;104,309 reputation&quot; class=&quot;comment-user&quot;&gt;Mark&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment3761916_1893653&quot;&gt;&lt;span title=&quot;2010-08-27 15:53:52Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Aug 27, 2010 at 15:53&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Thanks for this.  Been wrestling with an Excel that wouldn&apos;t close no matter what for a couple of days before I found this.  Excellent.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/117575/bblake&quot; title=&quot;2,368 reputation&quot; class=&quot;comment-user&quot;&gt;BBlake&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment4244972_1893653&quot;&gt;&lt;span title=&quot;2010-10-19 15:27:40Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 19, 2010 at 15:27&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@nightcoder: awesome answer, really detailed. Your comments with respect to debug mode are very true and important that you pointed this out. The same code in release mode can often be fine. Process.Kill however, is only good when using automation, not when your program is running within Excel, e.g., as a managed COM add-in.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment10778358_1893653&quot;&gt;&lt;span title=&quot;2011-12-29 18:10:09Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Dec 29, 2011 at 18:10&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@DanM: Your approach is 100% correct and will never fail. By keeping all your variables local to the method, all references are effectively unreachable by .NET code. This means that when your finally section calls GC.Collect(), the finalizers for &lt;i&gt;all&lt;/i&gt; your COM objects will get called with certainty. Each finalizer then calls Marshal.FinalReleaseComObject on the object being finalized. Your approach is therefore simple and fool-proof. Have no fear using this. (Only caveat: if using VSTO, which I doubt that you are, you would need to call GC.Collect() &amp;amp; GC.WaitForPendingFinalizers TWICE.)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/10429/mike-rosenblum&quot; title=&quot;11,948 reputation&quot; class=&quot;comment-user&quot;&gt;Mike Rosenblum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment10778438_1893653&quot;&gt;&lt;span title=&quot;2011-12-29 18:14:25Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Dec 29, 2011 at 18:14&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 3 times&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Explicitly killing an out-of-process COM server (that might be serving other COM clients) is a dreadful idea. If you are resorting to this it&apos;s because your COM protocol is broken. COM servers should not be treated as a regular windowed-app&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/585968/mickyd&quot; title=&quot;14,531 reputation&quot; class=&quot;comment-user&quot;&gt;MickyD&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment46373646_1307180&quot;&gt;&lt;span title=&quot;2015-03-16 03:32:09Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Mar 16, 2015 at 3:32&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;releasing all com objects with this approach worked aptly for me. No more processes being stuck!&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2861663/sanrns&quot; title=&quot;131 reputation&quot; class=&quot;comment-user&quot;&gt;sanrns&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment120631204_158751&quot;&gt;&lt;span title=&quot;2021-07-05 11:16:57Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Jul 5, 2021 at 11:16&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Virtually ALL ANSWERS ON THIS PAGE ARE WRONG EXCEPT THIS ONE.  They work but are way too much work.  IGNORE the &quot;2 DOTS&quot; rule.  Let the GC do your work for you. Supplementary evidence from .Net GURU Hans Passant : &lt;a href=&quot;https://stackoverflow.com/a/25135685/3852958&quot;&gt;stackoverflow.com/a/25135685/3852958&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/971583/alan-baljeu&quot; title=&quot;2,238 reputation&quot; class=&quot;comment-user&quot;&gt;Alan Baljeu&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment92508793_38111294&quot;&gt;&lt;span title=&quot;2018-10-13 15:13:04Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Oct 13, 2018 at 15:13&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 2 times&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Govert, what a relief to find the correct way to do it. Thank you.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/7453065/dietrich-baumgarten&quot; title=&quot;544 reputation&quot; class=&quot;comment-user&quot;&gt;Dietrich Baumgarten&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment102680746_38111294&quot;&gt;&lt;span title=&quot;2019-09-28 16:34:59Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 28, 2019 at 16:34&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;How aobut xlRange.Interior.Color for example.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/11989/hades&quot; title=&quot;16,375 reputation&quot; class=&quot;comment-user owner&quot;&gt;HAdes&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment48937_158839&quot;&gt;&lt;span title=&quot;2008-10-01 17:48:57Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 1, 2008 at 17:48&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Interior needs to be release (its in the namespace)... Color on the other hand doesn&apos;t (cause its from System.Drawing.Color, iirc)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/8505/magickat&quot; title=&quot;9,429 reputation&quot; class=&quot;comment-user&quot;&gt;MagicKat&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment48953_158839&quot;&gt;&lt;span title=&quot;2008-10-01 17:56:49Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Oct 1, 2008 at 17:56&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;actually Color is a Excel color not a .Net color. you just pass a Long.  Also workbooks def. need to be released, worksheets... less so.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/141720/anonymous-type&quot; title=&quot;2,974 reputation&quot; class=&quot;comment-user&quot;&gt;Anonymous Type&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment2342407_158839&quot;&gt;&lt;span title=&quot;2010-03-02 21:16:51Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Mar 2, 2010 at 21:16&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;That is not true, the two-dot-bad, one-dot-good rule is nonsense. Also, you don&apos;t have to release Workbooks, Worksheets, Ranges, that is the job of the GC. The only thing that you must never forget is to call Quit on the one and only Excel.Application object. After calling Quit, null the Excel.Application object and call GC.Collect(); GC.WaitForPendingFinalizers(); twice.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/7453065/dietrich-baumgarten&quot; title=&quot;544 reputation&quot; class=&quot;comment-user&quot;&gt;Dietrich Baumgarten&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment102680690_158839&quot;&gt;&lt;span title=&quot;2019-09-28 16:30:53Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 28, 2019 at 16:30&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;yup this one is good. I think this code can be updated though now that FinalReleaseCOMObject is available.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/141720/anonymous-type&quot; title=&quot;2,974 reputation&quot; class=&quot;comment-user&quot;&gt;Anonymous Type&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment2342465_349202&quot;&gt;&lt;span title=&quot;2010-03-02 21:22:16Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Mar 2, 2010 at 21:22&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;It&apos;s still annoying to have a using block for each object. See here &lt;a href=&quot;http://stackoverflow.com/questions/2191489/releasing-temporary-com-objects&quot; title=&quot;releasing temporary com objects&quot;&gt;stackoverflow.com/questions/2191489/&lt;/a&gt; for an alternative.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/148897/henrik&quot; title=&quot;22,956 reputation&quot; class=&quot;comment-user&quot;&gt;Henrik&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment14748365_349202&quot;&gt;&lt;span title=&quot;2012-06-27 14:16:28Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Jun 27, 2012 at 14:16&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;No, you don&apos;t, especially if you want to allow user interaction with the COM application (Excel in this case--OP doesn&apos;t specify whether user interaction is intended, but makes no reference to shutting it down). You just have to get the caller to let go for the user to be able to quit Excel when closing, say, a single file.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/409856/downwitch&quot; title=&quot;1,342 reputation&quot; class=&quot;comment-user&quot;&gt;downwitch&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment46533022_4236321&quot;&gt;&lt;span title=&quot;2015-03-19 22:31:12Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Mar 19, 2015 at 22:31&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;this worked perfectly for me - crashed when I only had objExcel.Quit(), but when I also did objExcel.Application.Quit() beforehand, closed cleanly.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1191840/mcmillab&quot; title=&quot;2,772 reputation&quot; class=&quot;comment-user&quot;&gt;mcmillab&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55261782_4236321&quot;&gt;&lt;span title=&quot;2015-11-16 23:46:23Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 16, 2015 at 23:46&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;&lt;code&gt;objExcel.Application.Quit()&lt;/code&gt; and &lt;code&gt;objExcel.Quit()&lt;/code&gt; is the same call because &lt;code&gt;objExcel == objExcel.Application&lt;/code&gt;. Consequently, it doesn&apos;t matter which one you call. Just do it once. The second time you do it (regardless of which) it has already quit.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2149075/alexander-h%c3%b8st&quot; title=&quot;814 reputation&quot; class=&quot;comment-user&quot;&gt;Alexander Hst&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment125607080_4236321&quot;&gt;&lt;span title=&quot;2022-02-09 18:11:04Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 9 at 18:11&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;....this is a bit of a sledghammer approach? - it is similar to what I&apos;m also using :( but need to change. The problem with using this approach is that often when opening excel, on the machine where this ran, it has the alert in left hand bar, saying something like &quot;Excel was closed down incorrectly&quot; : not very elegant. I think one of the earlier suggestions in this thread is to be preferred.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1179880/whytheq&quot; title=&quot;33,121 reputation&quot; class=&quot;comment-user&quot;&gt;whytheq&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment62808228_1577441&quot;&gt;&lt;span title=&quot;2016-06-06 18:57:50Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Jun 6, 2016 at 18:57&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Downvoted because it is an ugly hack rather than a solution.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2862241/ant-222&quot; title=&quot;860 reputation&quot; class=&quot;comment-user&quot;&gt;Ant_222&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment115121132_1577441&quot;&gt;&lt;span title=&quot;2020-12-02 21:53:54Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Dec 2, 2020 at 21:53&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;This answer works and is infinitely more convenient than the accepted answer. No worries about &quot;two dots&quot; with COM objects, no use of &lt;code&gt;Marshal&lt;/code&gt;.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1529997/andrew-cuthbert&quot; title=&quot;985 reputation&quot; class=&quot;comment-user&quot;&gt;andrew.cuthbert&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment45756694_7263538&quot;&gt;&lt;span title=&quot;2015-02-26 06:51:02Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 26, 2015 at 6:51&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;This should be marked as the answer, really. NetOffice abstracts all this complexity away.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/211672/c-augusto-proiete&quot; title=&quot;20,603 reputation&quot; class=&quot;comment-user&quot;&gt;C. Augusto Proiete&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55867474_15684095&quot;&gt;&lt;span title=&quot;2015-12-03 02:20:46Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Dec 3, 2015 at 2:20&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I&apos;ve been using NetOffice for a considerable amount of time writing an excel add-in and it worked perfectly. The only thing to consider is that if you don&apos;t dispose used objects explicitly, it will do it when you exit the application (because it keeps track of them anyway). So the rule of thumb with NetOffice is always to use &quot;using&quot; pattern with every Excel object like cell, range or sheet etc.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/4393579/stas-ivanov&quot; title=&quot;1,103 reputation&quot; class=&quot;comment-user&quot;&gt;Stas Ivanov&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment71475271_15684095&quot;&gt;&lt;span title=&quot;2017-02-10 08:34:30Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 10, 2017 at 8:34&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;And another reason, re-using a reference without releasing the previous value first.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/532305/grimfort&quot; title=&quot;101 reputation&quot; class=&quot;comment-user&quot;&gt;Grimfort&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment4754770_4366693&quot;&gt;&lt;span title=&quot;2010-12-06 15:02:06Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Dec 6, 2010 at 15:02&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Thank you. I was also using a &quot;for each&quot; your solution worked for me.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/5458/chad-braun-duin&quot; title=&quot;2,178 reputation&quot; class=&quot;comment-user&quot;&gt;Chad Braun-Duin&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment5175112_4366693&quot;&gt;&lt;span title=&quot;2011-01-14 13:41:40Z, License: CC BY-SA 2.5&quot; class=&quot;relativetime-clean&quot;&gt;Jan 14, 2011 at 13:41&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;+1 Thanks. Plus, note that if you have an object for an Excel range, and you want to change the range during the lifetime of the object, I found that I had to ReleaseComObject before reassigning it, which makes the code a little untidy!&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2078245/ajv-jsy&quot; title=&quot;5,551 reputation&quot; class=&quot;comment-user&quot;&gt;AjV Jsy&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment41276122_4366693&quot;&gt;&lt;span title=&quot;2014-10-10 16:26:36Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Oct 10, 2014 at 16:26&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Inside Release, check for Null (Joe&apos;s answer). That will avoid unnecessary null exceptions. I have tested a LOT of methods. This is the only way to effectively release Excel.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/910087/gerhard-powell&quot; title=&quot;5,685 reputation&quot; class=&quot;comment-user&quot;&gt;Gerhard Powell&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment45780494_1924284&quot;&gt;&lt;span title=&quot;2015-02-26 17:49:27Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 26, 2015 at 17:49&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I found I did not need to nullify ComObjects, only Quit() - Close() and FinalReleaseComObject.  I can&apos;t believe this is all that was missing on my end to get it to work. Great!&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2763467/carol&quot; title=&quot;1,736 reputation&quot; class=&quot;comment-user&quot;&gt;Carol&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment59142088_20059771&quot;&gt;&lt;span title=&quot;2016-03-01 21:26:39Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Mar 1, 2016 at 21:26&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I hate arbitrary waits.  But +1 because you are right about needding to wait for the workbooks to close.  An alternative is to poll the workbooks collection in a loop and use the arbitrary wait as the loop timeout.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/456490/dflat&quot; title=&quot;819 reputation&quot; class=&quot;comment-user&quot;&gt;dFlat&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment7912669_6395865&quot;&gt;&lt;span title=&quot;2011-07-14 02:20:49Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Jul 14, 2011 at 2:20&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I highly doubt that &lt;code&gt;Close()&lt;/code&gt; is not blocking call, i.e. I don&apos;t think execution will continue until the workbooks are in fact closed. If the &lt;code&gt;Close()&lt;/code&gt; method returned and you could then enumerate the collection of workbooks and it was not empty, then that would be a serious bug in my view. I would rather loop over the workbooks and call &lt;code&gt;.Close(false)&lt;/code&gt; and then &lt;code&gt;Quit()&lt;/code&gt;.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2149075/alexander-h%c3%b8st&quot; title=&quot;814 reputation&quot; class=&quot;comment-user&quot;&gt;Alexander Hst&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment125607014_6395865&quot;&gt;&lt;span title=&quot;2022-02-09 18:08:38Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Feb 9 at 18:08&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Very good point! I think because I am using Office 2007 there is some clean-up done on my behalf. I have used the advise further up but have not stored variables as you have suggested here and EXCEL.EXE does exit but I could just be lucky and if I have any further problems I will definitely look at this part of my code =)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/427684/coops&quot; title=&quot;4,531 reputation&quot; class=&quot;comment-user&quot;&gt;Coops&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment18586554_11870990&quot;&gt;&lt;span title=&quot;2012-11-26 13:39:40Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 26, 2012 at 13:39&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;&lt;a href=&quot;http://social.msdn.microsoft.com/Forums/en-US/3cd1ac57-37ab-45e9-918b-7b253052c836/problem-in-closing-the-excelexe-which-is-opened-by-c?forum=csharplanguage&quot; rel=&quot;nofollow noreferrer&quot;&gt;social.msdn.microsoft.com/Forums/en-US/&lt;/a&gt;&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/559085/martin&quot; title=&quot;3,268 reputation&quot; class=&quot;comment-user&quot;&gt;Martin&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment40142742_25685147&quot;&gt;&lt;span title=&quot;2014-09-05 11:47:26Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 5, 2014 at 11:47&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        "],"id":531,"title":"How do I properly clean up Excel interop objects?","content":"\n                \n&lt;p&gt;I&apos;m using the Excel interop in C# (&lt;code&gt;ApplicationClass&lt;/code&gt;) and have placed the following code in my finally clause:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;while&lt;/span&gt; (System.Runtime.InteropServices.Marshal.ReleaseComObject(excelSheet) != &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) { }\nexcelSheet = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\nGC.Collect();\nGC.WaitForPendingFinalizers();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Although this kind of works, the &lt;code&gt;Excel.exe&lt;/code&gt; process is still in the background even after I close Excel. It is only released once my application is manually closed.&lt;/p&gt;\n\n&lt;p&gt;What am I doing wrong, or is there an alternative to ensure interop objects are properly disposed of?&lt;/p&gt;\n    ","slug":"how-do-i-properly-clean-up-excel-interop-objects-1657388329706","postType":"QUESTION","createdAt":"2022-07-09T17:38:49.000Z","updatedAt":"2022-07-09T17:38:49.000Z","tags":[{"id":2612,"name":"interop","slug":"interop","createdAt":"2022-07-09T17:38:49.000Z","updatedAt":"2022-07-09T17:38:49.000Z","Questions_Tags":{"questionId":531,"tagId":2612}},{"id":2613,"name":"com-interop","slug":"com-interop","createdAt":"2022-07-09T17:38:49.000Z","updatedAt":"2022-07-09T17:38:49.000Z","Questions_Tags":{"questionId":531,"tagId":2613}}]}},"__N_SSG":true}