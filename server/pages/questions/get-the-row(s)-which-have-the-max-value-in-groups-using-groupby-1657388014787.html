<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-096e453de8a27667.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-e3d1b60e109d3ba1.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_buildManifest.js" defer=""></script><script src="/_next/static/4Y8KGE-c2lolBeBmcum_I/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.hFcsiD code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-6e32c308-0"]{content:"hFcsiD,"}/*!sc*/
.ljvTUN .comment-item .comment-body .d-inline-flex.ai-center{text-align:right;}/*!sc*/
.ljvTUN .comment-item .comment-body .comment-date{float:right;}/*!sc*/
data-styled.g6[id="sc-6e32c308-1"]{content:"ljvTUN,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-6e32c308-0 hFcsiD flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787">Get the row(s) which have the max value in groups using groupby</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/max">max</a></div></div><div class="question-content mt-5">
                
<p>How do I find all rows in a pandas DataFrame which have the max value for <code>count</code> column, after grouping by <code>['Sp','Mt']</code> columns?</p>
<p><strong>Example 1:</strong> the following DataFrame, which I group by <code>['Sp','Mt']</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   Sp   Mt Value   count
<span class="hljs-number">0</span>  MM1  S1   a     **<span class="hljs-number">3</span>**
<span class="hljs-number">1</span>  MM1  S1   n       <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  MM1  S3   cb    **<span class="hljs-number">5</span>**
<span class="hljs-number">3</span>  MM2  S3   mk    **<span class="hljs-number">8</span>**
<span class="hljs-number">4</span>  MM2  S4   bg    **<span class="hljs-number">10</span>**
<span class="hljs-number">5</span>  MM2  S4   dgd     <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2   rd      <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2   cb      <span class="hljs-number">2</span>
<span class="hljs-number">8</span>  MM4  S2   uyi   **<span class="hljs-number">7</span>**
</code></pre>
<p>Expected output: get the result rows whose count is max in each group, like:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0</span>  MM1  S1   a      **<span class="hljs-number">3</span>**
<span class="hljs-number">2</span>  MM1  S3   cb     **<span class="hljs-number">5</span>**
<span class="hljs-number">3</span>  MM2  S3   mk     **<span class="hljs-number">8</span>**
<span class="hljs-number">4</span>  MM2  S4   bg     **<span class="hljs-number">10</span>** 
<span class="hljs-number">8</span>  MM4  S2   uyi    **<span class="hljs-number">7</span>**
</code></pre>
<p><strong>Example 2:</strong> this DataFrame, which I group by <code>['Sp','Mt']</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   Sp   Mt   Value  count
<span class="hljs-number">4</span>  MM2  S4   bg     <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd    <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2   rd     <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2   cb     <span class="hljs-number">8</span>
<span class="hljs-number">8</span>  MM4  S2   uyi    <span class="hljs-number">8</span>
</code></pre>
<p>For the above example, I want to get <strong>all</strong> the rows where <code>count</code> equals max, in each group e.g:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">MM2  S4   bg     <span class="hljs-number">10</span>
MM4  S2   cb     <span class="hljs-number">8</span>
MM4  S2   uyi    <span class="hljs-number">8</span>
</code></pre>
    </div></div></div><div class="sc-6e32c308-1 ljvTUN flex text-xs pl-10 flex-col comment items-center justify-center"><h4 class="text-left mt-10 text-lg font-semibold">Comments</h4><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">What format is your data frame in?</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/712603/david-robinson" title="74,849 reputation" class="comment-user">David Robinson</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment22304145_15705630"><span title="2013-03-29 14:52:36Z, License: CC BY-SA 3.0" class="relativetime-clean">Mar 29, 2013 at 14:52</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy">I don't get it. What exactly is a group? Why does the second line in the result begin with <code>1 3</code>?</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/1073695/jo-so" title="23,116 reputation" class="comment-user">Jo So</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment22304170_15705630"><span title="2013-03-29 14:53:11Z, License: CC BY-SA 3.0" class="relativetime-clean">Mar 29, 2013 at 14:53</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><div class="comment-item w-9/12 border-t divide-y-8">
            <div class="comment-body js-comment-edit-hide">
                
                <span class="comment-copy"><a href="http://stackoverflow.com/questions/18879782/python-pandas-groupby-forloop-idxmax" title="python pandas groupby forloop idxmax">stackoverflow.com/questions/18879782/</a>    Could be useful</span>
                
              <div class="d-inline-flex ai-center">
&nbsp;<a href="/users/2701516/j-arthur" title="65 reputation" class="comment-user">J_Arthur</a>
                </div>
                <span class="comment-date" dir="ltr"><a class="comment-link" href="#comment28058304_15705630"><span title="2013-09-24 22:30:49Z, License: CC BY-SA 3.0" class="relativetime-clean">Sep 24, 2013 at 22:30</span></a></span>
            </div>
        </div><span class="divide-x-8 "></span><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">See more</button></div><div class="sc-6e32c308-2 bFXWFO"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">1</span>]: df
Out[<span class="hljs-number">1</span>]:
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM1  S1     n      <span class="hljs-number">2</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd      <span class="hljs-number">1</span>
<span class="hljs-number">6</span>  MM4  S2    rd      <span class="hljs-number">2</span>
<span class="hljs-number">7</span>  MM4  S2    cb      <span class="hljs-number">2</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>

In [<span class="hljs-number">2</span>]: df.groupby([<span class="hljs-string">'Mt'</span>], sort=<span class="hljs-literal">False</span>)[<span class="hljs-string">'count'</span>].<span class="hljs-built_in">max</span>()
Out[<span class="hljs-number">2</span>]:
Mt
S1     <span class="hljs-number">3</span>
S3     <span class="hljs-number">8</span>
S4    <span class="hljs-number">10</span>
S2     <span class="hljs-number">7</span>
Name: count
</code></pre>

<p>To get the indices of the original DF you can do:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">3</span>]: idx = df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>) == df[<span class="hljs-string">'count'</span>]

In [<span class="hljs-number">4</span>]: df[idx]
Out[<span class="hljs-number">4</span>]:
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
</code></pre>

<p>Note that if you have multiple max values per group, all will be returned.</p>

<p><strong>Update</strong></p>

<p>On a hail mary chance that this is what the OP is requesting:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">5</span>]: df[<span class="hljs-string">'count_max'</span>] = df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>)

In [<span class="hljs-number">6</span>]: df
Out[<span class="hljs-number">6</span>]:
    Sp  Mt Value  count  count_max
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>          <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM1  S1     n      <span class="hljs-number">2</span>          <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>          <span class="hljs-number">8</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>          <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>         <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  MM2  S4   dgd      <span class="hljs-number">1</span>         <span class="hljs-number">10</span>
<span class="hljs-number">6</span>  MM4  S2    rd      <span class="hljs-number">2</span>          <span class="hljs-number">7</span>
<span class="hljs-number">7</span>  MM4  S2    cb      <span class="hljs-number">2</span>          <span class="hljs-number">7</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>          <span class="hljs-number">7</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You can sort the dataFrame by count and then remove duplicates. I think it's easier:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>, ascending=<span class="hljs-literal">False</span>).drop_duplicates([<span class="hljs-string">'Sp'</span>,<span class="hljs-string">'Mt'</span>])
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Easy solution would be to apply the <code>idxmax()</code> function to get indices of rows with max values.
This would filter out all the rows with max value in the group.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">365</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

In [<span class="hljs-number">366</span>]: df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

In [<span class="hljs-number">367</span>]: df                                                                                                       
Out[<span class="hljs-number">367</span>]: 
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">1</span>      <span class="hljs-number">2</span>  S1  MM1    n
<span class="hljs-number">2</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">3</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">4</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">5</span>      <span class="hljs-number">1</span>  S4  MM2  dgb
<span class="hljs-number">6</span>      <span class="hljs-number">2</span>  S2  MM4   rd
<span class="hljs-number">7</span>      <span class="hljs-number">2</span>  S2  MM4   cb
<span class="hljs-number">8</span>      <span class="hljs-number">7</span>  S2  MM4  uyi


<span class="hljs-comment">### Apply idxmax() and use .loc() on dataframe to filter the rows with max values:</span>
In [<span class="hljs-number">368</span>]: df.loc[df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>])[<span class="hljs-string">"count"</span>].idxmax()]                                                       
Out[<span class="hljs-number">368</span>]: 
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">2</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">3</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">4</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">8</span>      <span class="hljs-number">7</span>  S2  MM4  uyi

<span class="hljs-comment">### Just to show what values are returned by .idxmax() above:</span>
In [<span class="hljs-number">369</span>]: df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>])[<span class="hljs-string">"count"</span>].idxmax().values                                                        
Out[<span class="hljs-number">369</span>]: array([<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">8</span>])
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You may not need to do with group by , using <code>sort_values</code>+ <code>drop_duplicates</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>).drop_duplicates([<span class="hljs-string">'Sp'</span>,<span class="hljs-string">'Mt'</span>],keep=<span class="hljs-string">'last'</span>)
Out[<span class="hljs-number">190</span>]: 
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
</code></pre>

<p>Also almost same logic by using <code>tail</code></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df.sort_values(<span class="hljs-string">'count'</span>).groupby([<span class="hljs-string">'Sp'</span>, <span class="hljs-string">'Mt'</span>]).tail(<span class="hljs-number">1</span>)
Out[<span class="hljs-number">52</span>]: 
    Sp  Mt Value  count
<span class="hljs-number">0</span>  MM1  S1     a      <span class="hljs-number">3</span>
<span class="hljs-number">2</span>  MM1  S3    cb      <span class="hljs-number">5</span>
<span class="hljs-number">8</span>  MM4  S2   uyi      <span class="hljs-number">7</span>
<span class="hljs-number">3</span>  MM2  S3    mk      <span class="hljs-number">8</span>
<span class="hljs-number">4</span>  MM2  S4    bg     <span class="hljs-number">10</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Having tried the solution suggested by Zelazny on a relatively large DataFrame (~400k rows) I found it to be very slow.  Here is an alternative that I found to run orders of magnitude faster on my data set.</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>],
    <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
    })

df_grouped = df.groupby([<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>]).agg({<span class="hljs-string">'count'</span>:<span class="hljs-string">'max'</span>})

df_grouped = df_grouped.reset_index()

df_grouped = df_grouped.rename(columns={<span class="hljs-string">'count'</span>:<span class="hljs-string">'count_max'</span>})

df = pd.merge(df, df_grouped, how=<span class="hljs-string">'left'</span>, on=[<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>])

df = df[df[<span class="hljs-string">'count'</span>] == df[<span class="hljs-string">'count_max'</span>]]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Use <code>groupby</code> and <code>idxmax</code> methods:</p>

<ol>
<li><p>transfer col <code>date</code> to <code>datetime</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'date'</span>]=pd.to_datetime(df[<span class="hljs-string">'date'</span>])
</code></pre></li>
<li><p>get the index of <code>max</code> of column <code>date</code>, after <code>groupyby ad_id</code>:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">idx=df.groupby(by=<span class="hljs-string">'ad_id'</span>)[<span class="hljs-string">'date'</span>].idxmax()
</code></pre></li>
<li><p>get the wanted data:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df_max=df.loc[idx,]
</code></pre></li>
</ol>

<p>Out[54]:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">ad_id  price       date
<span class="hljs-number">7</span>     <span class="hljs-number">22</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">11</span>
<span class="hljs-number">6</span>     <span class="hljs-number">23</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">22</span>
<span class="hljs-number">2</span>     <span class="hljs-number">24</span>      <span class="hljs-number">2</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">30</span>
<span class="hljs-number">3</span>     <span class="hljs-number">28</span>      <span class="hljs-number">5</span> <span class="hljs-number">2018</span>-06-<span class="hljs-number">22</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For me, the easiest solution would be keep value when count is equal to the maximum. Therefore, the following one line command is enough : </p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df[df[<span class="hljs-string">'count'</span>] == df.groupby([<span class="hljs-string">'Mt'</span>])[<span class="hljs-string">'count'</span>].transform(<span class="hljs-built_in">max</span>)]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Summarizing, there are many ways, but which one is faster?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> time

df = pd.DataFrame(np.random.randint(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>,size=(<span class="hljs-number">1000000</span>, <span class="hljs-number">2</span>)), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'AB'</span>))

start_time = time.time()
df1idx = df.groupby([<span class="hljs-string">'A'</span>])[<span class="hljs-string">'B'</span>].transform(<span class="hljs-built_in">max</span>) == df[<span class="hljs-string">'B'</span>]
df1 = df[df1idx]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---1 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df2 = df.sort_values(<span class="hljs-string">'B'</span>).groupby([<span class="hljs-string">'A'</span>]).tail(<span class="hljs-number">1</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---2 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df3 = df.sort_values(<span class="hljs-string">'B'</span>).drop_duplicates([<span class="hljs-string">'A'</span>],keep=<span class="hljs-string">'last'</span>)
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---3 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df3b = df.sort_values(<span class="hljs-string">'B'</span>, ascending=<span class="hljs-literal">False</span>).drop_duplicates([<span class="hljs-string">'A'</span>])
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---3b) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
df4 = df[df[<span class="hljs-string">'B'</span>] == df.groupby([<span class="hljs-string">'A'</span>])[<span class="hljs-string">'B'</span>].transform(<span class="hljs-built_in">max</span>)]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---4 ) %s seconds ---"</span> % (time.time() - start_time))

start_time = time.time()
d = df.groupby(<span class="hljs-string">'A'</span>)[<span class="hljs-string">'B'</span>].nlargest(<span class="hljs-number">1</span>)
df5 = df.iloc[[i[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d.index], :]
<span class="hljs-built_in">print</span>(<span class="hljs-string">"---5 ) %s seconds ---"</span> % (time.time() - start_time))
</code></pre>
<p>And the winner is...</p>
<ul>
<li>--1 ) 0.03337574005126953 seconds ---</li>
<li>--2 ) 0.1346898078918457 seconds ---</li>
<li>--3 ) 0.10243558883666992 seconds ---</li>
<li>--3b) 0.1004343032836914 seconds ---</li>
<li>--4 ) 0.028397560119628906 seconds ---</li>
<li>--5 ) 0.07552886009216309 seconds ---</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Try using "nlargest" on the groupby object. The advantage of using nlargest is that it returns the index of the rows where "the nlargest item(s)" were fetched from.
Note: we slice the second(1) element of our index since our index in this case consist of tuples(eg.(s1, 0)).</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

d = df.groupby(<span class="hljs-string">'mt'</span>)[<span class="hljs-string">'count'</span>].nlargest(<span class="hljs-number">1</span>) <span class="hljs-comment"># pass 1 since we want the max</span>

df.iloc[[i[<span class="hljs-number">1</span>] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> d.index], :] <span class="hljs-comment"># pass the index of d as list comprehension</span>
</code></pre>
<p><a href="https://i.stack.imgur.com/F2h7N.png" rel="nofollow noreferrer"><img src="https://i.stack.imgur.com/F2h7N.png" alt="enter image description here"></a></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Realizing that <strong>"applying" "nlargest"</strong> to <strong>groupby object</strong> works just as fine:</p>

<p>Additional advantage - <strong>also can fetch</strong> <strong>top n values</strong> if required:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">In [<span class="hljs-number">85</span>]: <span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd

In [<span class="hljs-number">86</span>]: df = pd.DataFrame({
    ...: <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
    ...: <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    ...: <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    ...: <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
    ...: })

<span class="hljs-comment">## Apply nlargest(1) to find the max val df, and nlargest(n) gives top n values for df:</span>
In [<span class="hljs-number">87</span>]: df.groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>]).apply(<span class="hljs-keyword">lambda</span> x: x.nlargest(<span class="hljs-number">1</span>, <span class="hljs-string">"count"</span>)).reset_index(drop=<span class="hljs-literal">True</span>)
Out[<span class="hljs-number">87</span>]:
   count  mt   sp  val
<span class="hljs-number">0</span>      <span class="hljs-number">3</span>  S1  MM1    a
<span class="hljs-number">1</span>      <span class="hljs-number">5</span>  S3  MM1   cb
<span class="hljs-number">2</span>      <span class="hljs-number">8</span>  S3  MM2   mk
<span class="hljs-number">3</span>     <span class="hljs-number">10</span>  S4  MM2   bg
<span class="hljs-number">4</span>      <span class="hljs-number">7</span>  S2  MM4  uyi
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you sort your DataFrame that ordering will be preserved in the groupby.  You can then just grab the first or last element and reset the index.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
    <span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
    <span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
    <span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.sort_values(<span class="hljs-string">"count"</span>, ascending=<span class="hljs-literal">False</span>).groupby([<span class="hljs-string">"sp"</span>, <span class="hljs-string">"mt"</span>]).first().reset_index()
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
<span class="hljs-string">'sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>,<span class="hljs-string">'MM4'</span>],
<span class="hljs-string">'mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
<span class="hljs-string">'val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
<span class="hljs-string">'count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.groupby([<span class="hljs-string">'sp'</span>, <span class="hljs-string">'mt'</span>]).apply(<span class="hljs-keyword">lambda</span> grp: grp.nlargest(<span class="hljs-number">1</span>, <span class="hljs-string">'count'</span>))
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I've been using this functional style for many group operations:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
   <span class="hljs-string">'Sp'</span> : [<span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM1'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM2'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>, <span class="hljs-string">'MM4'</span>],
   <span class="hljs-string">'Mt'</span> : [<span class="hljs-string">'S1'</span>, <span class="hljs-string">'S1'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S3'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S4'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>, <span class="hljs-string">'S2'</span>],
   <span class="hljs-string">'Val'</span> : [<span class="hljs-string">'a'</span>, <span class="hljs-string">'n'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'mk'</span>, <span class="hljs-string">'bg'</span>, <span class="hljs-string">'dgb'</span>, <span class="hljs-string">'rd'</span>, <span class="hljs-string">'cb'</span>, <span class="hljs-string">'uyi'</span>],
   <span class="hljs-string">'Count'</span> : [<span class="hljs-number">3</span>,<span class="hljs-number">2</span>,<span class="hljs-number">5</span>,<span class="hljs-number">8</span>,<span class="hljs-number">10</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">2</span>,<span class="hljs-number">7</span>]
})

df.groupby(<span class="hljs-string">'Mt'</span>)\
  .apply(<span class="hljs-keyword">lambda</span> group: group[group.Count == group.Count.<span class="hljs-built_in">max</span>()])\
  .reset_index(drop=<span class="hljs-literal">True</span>)

    sp  mt  val  count
<span class="hljs-number">0</span>  MM1  S1    a      <span class="hljs-number">3</span>
<span class="hljs-number">1</span>  MM4  S2  uyi      <span class="hljs-number">7</span>
<span class="hljs-number">2</span>  MM2  S3   mk      <span class="hljs-number">8</span>
<span class="hljs-number">3</span>  MM2  S4   bg     <span class="hljs-number">10</span>
</code></pre>

<p><code>.reset_index(drop=True)</code> gets you back to the original index by dropping the group-index.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><code>df.loc[df.groupby('mt')['count'].idxmax()]</code></p>
<p>if the <code>df</code> index isn't unique you may need this step <code>df.reset_index(inplace=True)</code> first.</p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1     n      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2    rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;], sort=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;()\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;]:\nMt\nS1     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\nS3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\nS4    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\nS2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\nName: count\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;To get the indices of the original DF you can do:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;]: idx = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;) == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;]\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]: df[idx]\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Note that if you have multiple max values per group, all will be returned.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Update\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;On a hail mary chance that this is what the OP is requesting:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;]: df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;] = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]: df\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;]:\n    Sp  Mt Value  count  count_max\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1     n      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;         \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2    rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;          \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You can sort the dataFrame by count and then remove duplicates. I think it\u0026apos;s easier:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Easy solution would be to apply the \u0026lt;code\u0026gt;idxmax()\u0026lt;/code\u0026gt; function to get indices of rows with max values.\nThis would filter out all the rows with max value in the group.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;365\u0026lt;/span\u0026gt;]: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;366\u0026lt;/span\u0026gt;]: df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt;]: df                                                                                                       \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;367\u0026lt;/span\u0026gt;]: \n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S1  MM1    n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  S4  MM2  dgb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S2  MM4   rd\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  S2  MM4   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;### Apply idxmax() and use .loc() on dataframe to filter the rows with max values:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;368\u0026lt;/span\u0026gt;]: df.loc[df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;].idxmax()]                                                       \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;368\u0026lt;/span\u0026gt;]: \n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;### Just to show what values are returned by .idxmax() above:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;369\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;].idxmax().values                                                        \nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;369\u0026lt;/span\u0026gt;]: array([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You may not need to do with group by , using \u0026lt;code\u0026gt;sort_values\u0026lt;/code\u0026gt;+ \u0026lt;code\u0026gt;drop_duplicates\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;],keep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;last\u0026apos;\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;190\u0026lt;/span\u0026gt;]: \n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Also almost same logic by using \u0026lt;code\u0026gt;tail\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;]).tail(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;52\u0026lt;/span\u0026gt;]: \n    Sp  Mt Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1     a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3    cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3    mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4    bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Having tried the solution suggested by Zelazny on a relatively large DataFrame (~400k rows) I found it to be very slow.  Here is an alternative that I found to run orders of magnitude faster on my data set.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n    })\n\ndf_grouped = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;]).agg({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;max\u0026apos;\u0026lt;/span\u0026gt;})\n\ndf_grouped = df_grouped.reset_index()\n\ndf_grouped = df_grouped.rename(columns={\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;})\n\ndf = pd.merge(df, df_grouped, how=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;left\u0026apos;\u0026lt;/span\u0026gt;, on=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;])\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;] == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count_max\u0026apos;\u0026lt;/span\u0026gt;]]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Use \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;idxmax\u0026lt;/code\u0026gt; methods:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;transfer col \u0026lt;code\u0026gt;date\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;datetime\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;]=pd.to_datetime(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;get the index of \u0026lt;code\u0026gt;max\u0026lt;/code\u0026gt; of column \u0026lt;code\u0026gt;date\u0026lt;/code\u0026gt;, after \u0026lt;code\u0026gt;groupyby ad_id\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;idx=df.groupby(by=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ad_id\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;date\u0026apos;\u0026lt;/span\u0026gt;].idxmax()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;get the wanted data:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df_max=df.loc[idx,]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Out[54]:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;ad_id  price       date\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;24\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;30\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2018\u0026lt;/span\u0026gt;-06-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;22\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For me, the easiest solution would be keep value when count is equal to the maximum. Therefore, the following one line command is enough : \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;] == df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Summarizing, there are many ways, but which one is faster?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; time\n\ndf = pd.DataFrame(np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,size=(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1000000\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;AB\u0026apos;\u0026lt;/span\u0026gt;))\n\nstart_time = time.time()\ndf1idx = df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;) == df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;]\ndf1 = df[df1idx]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---1 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf2 = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;]).tail(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---2 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3 = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;],keep=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;last\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---3 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf3b = df.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).drop_duplicates([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---3b) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\ndf4 = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;] == df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].transform(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;)]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---4 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\nstart_time = time.time()\nd = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\ndf5 = df.iloc[[i[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; d.index], :]\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;---5 ) %s seconds ---\u0026quot;\u0026lt;/span\u0026gt; % (time.time() - start_time))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;And the winner is...\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;--1 ) 0.03337574005126953 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--2 ) 0.1346898078918457 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--3 ) 0.10243558883666992 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--3b) 0.1004343032836914 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--4 ) 0.028397560119628906 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;--5 ) 0.07552886009216309 seconds ---\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Try using \u0026quot;nlargest\u0026quot; on the groupby object. The advantage of using nlargest is that it returns the index of the rows where \u0026quot;the nlargest item(s)\u0026quot; were fetched from.\nNote: we slice the second(1) element of our index since our index in this case consist of tuples(eg.(s1, 0)).\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\nd = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;].nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pass 1 since we want the max\u0026lt;/span\u0026gt;\n\ndf.iloc[[i[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;] \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; d.index], :] \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# pass the index of d as list comprehension\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/F2h7N.png\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/F2h7N.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Realizing that \u0026lt;strong\u0026gt;\u0026quot;applying\u0026quot; \u0026quot;nlargest\u0026quot;\u0026lt;/strong\u0026gt; to \u0026lt;strong\u0026gt;groupby object\u0026lt;/strong\u0026gt; works just as fine:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Additional advantage - \u0026lt;strong\u0026gt;also can fetch\u0026lt;/strong\u0026gt; \u0026lt;strong\u0026gt;top n values\u0026lt;/strong\u0026gt; if required:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;In [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;85\u0026lt;/span\u0026gt;]: \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;86\u0026lt;/span\u0026gt;]: df = pd.DataFrame({\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    ...: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n    ...: })\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;## Apply nlargest(1) to find the max val df, and nlargest(n) gives top n values for df:\u0026lt;/span\u0026gt;\nIn [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;87\u0026lt;/span\u0026gt;]: df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;]).apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; x: x.nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;)).reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\nOut[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;87\u0026lt;/span\u0026gt;]:\n   count  mt   sp  val\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  S1  MM1    a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  S3  MM1   cb\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  S3  MM2   mk\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  S4  MM2   bg\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  S2  MM4  uyi\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you sort your DataFrame that ordering will be preserved in the groupby.  You can then just grab the first or last element and reset the index.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.sort_values(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;count\u0026quot;\u0026lt;/span\u0026gt;, ascending=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;sp\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;mt\u0026quot;\u0026lt;/span\u0026gt;]).first().reset_index()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sp\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mt\u0026apos;\u0026lt;/span\u0026gt;]).apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; grp: grp.nlargest(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ve been using this functional style for many group operations:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Sp\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;MM4\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S1\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S3\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S4\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;S2\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Val\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;n\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mk\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bg\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;dgb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;rd\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;cb\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;uyi\u0026apos;\u0026lt;/span\u0026gt;],\n   \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Count\u0026apos;\u0026lt;/span\u0026gt; : [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;]\n})\n\ndf.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Mt\u0026apos;\u0026lt;/span\u0026gt;)\\\n  .apply(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;lambda\u0026lt;/span\u0026gt; group: group[group.Count == group.Count.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;max\u0026lt;/span\u0026gt;()])\\\n  .reset_index(drop=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;)\n\n    sp  mt  val  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1    a      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM4  S2  uyi      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM2  S3   mk      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;.reset_index(drop=True)\u0026lt;/code\u0026gt; gets you back to the original index by dropping the group-index.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;df.loc[df.groupby(\u0026apos;mt\u0026apos;)[\u0026apos;count\u0026apos;].idxmax()]\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;if the \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; index isn\u0026apos;t unique you may need this step \u0026lt;code\u0026gt;df.reset_index(inplace=True)\u0026lt;/code\u0026gt; first.\u0026lt;/p\u0026gt;\n    "],"comment":["\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;What format is your data frame in?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/712603/david-robinson\u0026quot; title=\u0026quot;74,849 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;David Robinson\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment22304145_15705630\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-03-29 14:52:36Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 29, 2013 at 14:52\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I don\u0026apos;t get it. What exactly is a group? Why does the second line in the result begin with \u0026lt;code\u0026gt;1 3\u0026lt;/code\u0026gt;?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1073695/jo-so\u0026quot; title=\u0026quot;23,116 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Jo So\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment22304170_15705630\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-03-29 14:53:11Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 29, 2013 at 14:53\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026lt;a href=\u0026quot;http://stackoverflow.com/questions/18879782/python-pandas-groupby-forloop-idxmax\u0026quot; title=\u0026quot;python pandas groupby forloop idxmax\u0026quot;\u0026gt;stackoverflow.com/questions/18879782/\u0026lt;/a\u0026gt;    Could be useful\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2701516/j-arthur\u0026quot; title=\u0026quot;65 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;J_Arthur\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment28058304_15705630\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2013-09-24 22:30:49Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 24, 2013 at 22:30\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This answer is the fastest solution I could find: \u0026lt;a href=\u0026quot;http://stackoverflow.com/a/21007047/778533\u0026quot;\u0026gt;stackoverflow.com/a/21007047/778533\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/778533/tommy-carstensen\u0026quot; title=\u0026quot;8,052 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;tommy.carstensen\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment73135452_15705630\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-03-26 02:17:51Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 26, 2017 at 2:17\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Similar to this question, could anybody please answer this: \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/62069465/match-lists-and-get-value-of-one-column-based-on-values-of-other-columns-from-da\u0026quot; title=\u0026quot;match lists and get value of one column based on values of other columns from da\u0026quot;\u0026gt;stackoverflow.com/questions/62069465/\u0026lt;/a\u0026gt;   Thanks.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1362817/ds-abc\u0026quot; title=\u0026quot;141 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;ds_Abc\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment109796153_15705630\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2020-05-29 05:42:24Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 29, 2020 at 5:42\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Zelazny7, is there a way to adopt this answer to apply to grouping by a column and then looking at 2 columns and doing a max of them to get a greater of the two? I can\u0026apos;t get that to work. What I currently have is:def Greater(Merge, maximumA, maximumB):     a = Merge[maximumA]     b = Merge[maximumB]     return max(a, b)  Merger.groupby(\u0026quot;Search_Term\u0026quot;).apply(Greater,\u0026quot;Ratio_x\u0026quot;,\u0026quot;Ratio_y\u0026quot;)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/7620499/bernando-vialli\u0026quot; title=\u0026quot;857 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;bernando_vialli\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment81584384_15705958\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-11-15 20:35:01Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 15, 2017 at 20:35\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Zelazny7 I\u0026apos;m using the second, \u0026lt;code\u0026gt;idx\u0026lt;/code\u0026gt; approach. But, I can only afford to a single maximum for each group (and my data has a few duplicate-max\u0026apos;s). is there a way to get around this with your solution?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6027379/3pitt\u0026quot; title=\u0026quot;779 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;3pitt\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment83144285_15705958\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-01-03 20:36:10Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jan 3, 2018 at 20:36\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;actually, that does not work for me. I can not track the problem, because dataframe if quit big, but the solution by @Rani works good\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/7365076/ladenkov-vladislav\u0026quot; title=\u0026quot;1,156 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Ladenkov Vladislav\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment84713256_15705958\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-02-18 18:09:48Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 18, 2018 at 18:09\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Hi Zealzny, If I want to take top 3 maximum row instead of one max value, How can I tweak your code?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/9561497/zephyr\u0026quot; title=\u0026quot;1,312 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Zephyr\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment93451393_15705958\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-11-13 15:51:32Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Nov 13, 2018 at 15:51\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;\u0026lt;code\u0026gt;transform\u0026lt;/code\u0026gt; method may have pool performance when the data set is large enough, get the max value first then merge the dataframes will be better.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/9933468/woods-chen\u0026quot; title=\u0026quot;554 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Woods Chen\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment97903409_15705958\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-04-10 02:54:17Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 10, 2019 at 2:54\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Very nice! Fast with largish frames (25k rows)\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/3521179/nolan-conaway\u0026quot; title=\u0026quot;2,419 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Nolan Conaway\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment79865014_40629420\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-09-27 18:23:53Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 27, 2017 at 18:23\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;For those who are somewhat new with Python, you will need to assign this to a new variable, it doesn\u0026apos;t change the current df variable.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/605875/tyler\u0026quot; title=\u0026quot;3,621 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Tyler\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment94735576_40629420\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-12-27 17:14:52Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 27, 2018 at 17:14\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;@Samir or use \u0026lt;code\u0026gt;inplace = True\u0026lt;/code\u0026gt; as an argument to \u0026lt;code\u0026gt;drop_duplicates\u0026lt;/code\u0026gt;\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4919355/tmrtsmith\u0026quot; title=\u0026quot;451 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;TMrtSmith\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment95836545_40629420\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-02-04 13:11:47Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 4, 2019 at 13:11\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 1 time\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is a great answer when need only one of rows with the same max values, however it wont work as expected if I need all the rows with max values.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/9933468/woods-chen\u0026quot; title=\u0026quot;554 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Woods Chen\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment97903373_40629420\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-04-10 02:50:40Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 10, 2019 at 2:50\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I mean if the dataframe is pd.DataFrame({\u0026apos;sp\u0026apos;:[1, 1, 2], \u0026apos;mt\u0026apos;:[1, 1, 2], \u0026apos;value\u0026apos;:[2, 2, 3]}, then there will be 2 rows with the same max value 2 in the group where sp==1 and mt==2. @Rani\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/9933468/woods-chen\u0026quot; title=\u0026quot;554 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Woods Chen\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment97950047_40629420\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-04-11 09:37:07Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Apr 11, 2019 at 9:37\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;The questioner here specified \u0026lt;code\u0026gt;\u0026quot;I want to get ALL the rows where count equals max in each group\u0026quot;\u0026lt;/code\u0026gt;, while \u0026lt;code\u0026gt;idxmax\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;Return[s] index of first occurrence of maximum over requested axis\u0026quot;\u0026lt;/code\u0026gt; according to the docs (0.21).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1870832/max-power\u0026quot; title=\u0026quot;7,600 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Max Power\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment82738470_44960833\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-12-19 11:55:23Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Dec 19, 2017 at 11:55\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n                        \u0026lt;span title=\u0026quot;this comment was edited 2 times\u0026quot;\u0026gt;\n                            \u0026lt;svg aria-hidden=\u0026quot;true\u0026quot; class=\u0026quot;va-text-bottom o50 svg-icon iconPencilSm\u0026quot; width=\u0026quot;14\u0026quot; height=\u0026quot;14\u0026quot; viewBox=\u0026quot;0 0 14 14\u0026quot;\u0026gt;\u0026lt;path d=\u0026quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z\u0026quot;\u0026gt;\u0026lt;/path\u0026gt;\u0026lt;/svg\u0026gt;\n                        \u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;This is a great solution, but for a different problem\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/1881329/carlos-souza\u0026quot; title=\u0026quot;193 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Carlos Souza\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment103478808_44960833\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-10-27 18:40:12Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Oct 27, 2019 at 18:40\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Not only is this an order of magnitude faster than the other solutions (at least for my use case), it has the added benefit of simply chaining as part of the construction of the original dataframe.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/5060792/clay\u0026quot; title=\u0026quot;2,349 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Clay\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment101341000_54041328\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2019-08-09 13:49:45Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 9, 2019 at 13:49\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;When you see this answer, you realize that all the others are wrong. This is clearly the way to do it. Thanks.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4224686/hunaphu\u0026quot; title=\u0026quot;392 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Hunaphu\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment117338961_54041328\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-02-25 15:32:48Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 25, 2021 at 15:32\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;One should add \u0026lt;code\u0026gt;na_position=\u0026quot;first\u0026quot;\u0026lt;/code\u0026gt; to \u0026lt;code\u0026gt;sort_values\u0026lt;/code\u0026gt; in order to ignore \u0026lt;code\u0026gt;NaN\u0026lt;/code\u0026gt;s.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2281318/antoine\u0026quot; title=\u0026quot;776 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Antoine\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment121697669_54041328\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2021-08-20 10:57:21Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Aug 20, 2021 at 10:57\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I found this to be fast for my DF of several million rows.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/6534818/john-stud\u0026quot; title=\u0026quot;1,141 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;John Stud\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment125615022_54041328\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2022-02-10 02:07:35Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Feb 10 at 2:07\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;indeed this is much faster. transform seems to be slow for large dataset.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/357236/goh\u0026quot; title=\u0026quot;25,023 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;goh\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment38286769_21709413\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2014-07-11 06:30:52Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 11, 2014 at 6:30\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;Can you add comments to explain what each line does?\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/778533/tommy-carstensen\u0026quot; title=\u0026quot;8,052 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;tommy.carstensen\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment73134456_21709413\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-03-26 00:47:26Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Mar 26, 2017 at 0:47\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;fwiw: I found the more elegant-looking solution from @Zelazny7 took a long time to execute for my set of ~100K rows, but this one ran pretty quickly. (I\u0026apos;m running a now way-obsolete 0.13.0, which might account for slowness).\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/2101132/roland\u0026quot; title=\u0026quot;439 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Roland\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment74626814_21709413\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-05-04 21:25:45Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;May 4, 2017 at 21:25\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;But doing this \u0026lt;code\u0026gt;df[df[\u0026apos;count\u0026apos;] == df[\u0026apos;count_max\u0026apos;]]\u0026lt;/code\u0026gt; will lose NaN rows, as well as the answers above.\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/4038986/qy-zuo\u0026quot; title=\u0026quot;2,344 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Qy Zuo\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment77382620_21709413\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2017-07-20 07:38:28Z, License: CC BY-SA 3.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Jul 20, 2017 at 7:38\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        ","\n            \u0026lt;div class=\u0026quot;comment-body js-comment-edit-hide\u0026quot;\u0026gt;\n                \n                \u0026lt;span class=\u0026quot;comment-copy\u0026quot;\u0026gt;I highly suggest to use this approach, for bigger data frames it is much faster to use .appy() or .agg().\u0026lt;/span\u0026gt;\n                \n              \u0026lt;div class=\u0026quot;d-inline-flex ai-center\u0026quot;\u0026gt;\n\u0026amp;nbsp;\u0026lt;a href=\u0026quot;/users/5760497/gerard\u0026quot; title=\u0026quot;476 reputation\u0026quot; class=\u0026quot;comment-user\u0026quot;\u0026gt;Gerard\u0026lt;/a\u0026gt;\n                \u0026lt;/div\u0026gt;\n                \u0026lt;span class=\u0026quot;comment-date\u0026quot; dir=\u0026quot;ltr\u0026quot;\u0026gt;\u0026lt;a class=\u0026quot;comment-link\u0026quot; href=\u0026quot;#comment91703376_21709413\u0026quot;\u0026gt;\u0026lt;span title=\u0026quot;2018-09-18 05:37:42Z, License: CC BY-SA 4.0\u0026quot; class=\u0026quot;relativetime-clean\u0026quot;\u0026gt;Sep 18, 2018 at 5:37\u0026lt;/span\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/span\u0026gt;\n            \u0026lt;/div\u0026gt;\n        "],"id":451,"title":"Get the row(s) which have the max value in groups using groupby","content":"\n                \n\u0026lt;p\u0026gt;How do I find all rows in a pandas DataFrame which have the max value for \u0026lt;code\u0026gt;count\u0026lt;/code\u0026gt; column, after grouping by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt; columns?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 1:\u0026lt;/strong\u0026gt; the following DataFrame, which I group by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   Sp   Mt Value   count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1   a     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  MM1  S1   n       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3   cb    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3   mk    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2   rd      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2   cb      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi   **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;**\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Expected output: get the result rows whose count is max in each group, like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  MM1  S1   a      **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  MM1  S3   cb     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  MM2  S3   mk     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;**\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg     **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;** \n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi    **\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;**\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example 2:\u0026lt;/strong\u0026gt; this DataFrame, which I group by \u0026lt;code\u0026gt;[\u0026apos;Sp\u0026apos;,\u0026apos;Mt\u0026apos;]\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   Sp   Mt   Value  count\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  MM2  S4   dgd    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  MM4  S2   rd     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  MM4  S2   cb     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;  MM4  S2   uyi    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For the above example, I want to get \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; the rows where \u0026lt;code\u0026gt;count\u0026lt;/code\u0026gt; equals max, in each group e.g:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;MM2  S4   bg     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\nMM4  S2   cb     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\nMM4  S2   uyi    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787","postType":"QUESTION","createdAt":"2022-07-09T17:33:34.000Z","updatedAt":"2022-07-09T17:33:34.000Z","tags":[{"id":2326,"name":"max","slug":"max","createdAt":"2022-07-09T17:33:34.000Z","updatedAt":"2022-07-09T17:33:34.000Z","Questions_Tags":{"questionId":451,"tagId":2326}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"get-the-row(s)-which-have-the-max-value-in-groups-using-groupby-1657388014787"},"buildId":"4Y8KGE-c2lolBeBmcum_I","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>