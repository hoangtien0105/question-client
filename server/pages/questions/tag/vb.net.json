{"pageProps":{"data":{"count":1,"rows":[{"id":6,"title":"What is a NullReferenceException, and how do I fix it?","slug":"what-is-a-nullreferenceexception-and-how-do-i-fix-it-1657384234873","postType":"QUESTION","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","tags":[{"id":17,"name":"vb.net","slug":"vb.net","createdAt":"2022-07-09T16:30:34.000Z","updatedAt":"2022-07-09T16:30:34.000Z","Questions_Tags":{"questionId":6,"tagId":17}}]}]},"slug":"vb.net","page":1,"answers":{"6":["\n&lt;h1&gt;What is the cause?&lt;/h1&gt;\n&lt;h2&gt;Bottom Line&lt;/h2&gt;\n&lt;p&gt;You are trying to use something that is &lt;code&gt;null&lt;/code&gt; (or &lt;code&gt;Nothing&lt;/code&gt; in VB.NET). This means you either set it to &lt;code&gt;null&lt;/code&gt;, or you never set it to anything at all.&lt;/p&gt;\n&lt;p&gt;Like anything else, &lt;code&gt;null&lt;/code&gt; gets passed around. If it is &lt;code&gt;null&lt;/code&gt; &lt;em&gt;in&lt;/em&gt; method &quot;A&quot;, it could be that method &quot;B&quot; passed a &lt;code&gt;null&lt;/code&gt; &lt;em&gt;to&lt;/em&gt; method &quot;A&quot;.&lt;/p&gt;\n&lt;p&gt;&lt;code&gt;null&lt;/code&gt; can have different meanings:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;Object variables that are &lt;strong&gt;uninitialized&lt;/strong&gt; and hence &lt;strong&gt;point to nothing.&lt;/strong&gt; In this case, if you access members of such objects, it causes a &lt;code&gt;NullReferenceException&lt;/code&gt;.&lt;/li&gt;\n&lt;li&gt;The developer is &lt;strong&gt;using &lt;code&gt;null&lt;/code&gt; intentionally to indicate there is no meaningful value available.&lt;/strong&gt; Note that C# has the concept of nullable datatypes for variables (like database tables can have nullable fields) - you can assign &lt;code&gt;null&lt;/code&gt; to them to indicate there is no value stored in it, for example &lt;code&gt;int? a = null;&lt;/code&gt; (which is a shortcut for &lt;code&gt;Nullable&amp;lt;int&amp;gt; a = null;&lt;/code&gt;) where the question mark indicates it is allowed to store &lt;code&gt;null&lt;/code&gt; in variable &lt;code&gt;a&lt;/code&gt;. You can check that either with &lt;code&gt;if (a.HasValue) {...}&lt;/code&gt; or with &lt;code&gt;if (a==null) {...}&lt;/code&gt;. Nullable variables, like &lt;code&gt;a&lt;/code&gt; this example, allow to access the value via &lt;code&gt;a.Value&lt;/code&gt; explicitly, or just as normal via &lt;code&gt;a&lt;/code&gt;. &lt;br&gt;&lt;strong&gt;Note&lt;/strong&gt; that accessing it via &lt;code&gt;a.Value&lt;/code&gt; throws an &lt;code&gt;InvalidOperationException&lt;/code&gt; instead of a &lt;code&gt;NullReferenceException&lt;/code&gt; if &lt;code&gt;a&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt; - you should do the check beforehand, i.e. if you have another non-nullable variable &lt;code&gt;int b;&lt;/code&gt; then you should do assignments like &lt;code&gt;if (a.HasValue) { b = a.Value; }&lt;/code&gt; or shorter &lt;code&gt;if (a != null) { b = a; }&lt;/code&gt;.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;The rest of this article goes into more detail and shows mistakes that many programmers often make which can lead to a &lt;code&gt;NullReferenceException&lt;/code&gt;.&lt;/p&gt;\n&lt;h2&gt;More Specifically&lt;/h2&gt;\n&lt;p&gt;The &lt;code&gt;runtime&lt;/code&gt; throwing a &lt;code&gt;NullReferenceException&lt;/code&gt; &lt;strong&gt;always&lt;/strong&gt; means the same thing: you are trying to use a reference, and the reference is not initialized (or it was &lt;em&gt;once&lt;/em&gt; initialized, but is &lt;em&gt;no longer&lt;/em&gt; initialized).&lt;/p&gt;\n&lt;p&gt;This means the reference is &lt;code&gt;null&lt;/code&gt;, and you cannot access members (such as methods) through a &lt;code&gt;null&lt;/code&gt; reference. The simplest case:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; foo = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\nfoo.ToUpper();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This will throw a &lt;code&gt;NullReferenceException&lt;/code&gt; at the second line because you can&apos;t call the instance method &lt;code&gt;ToUpper()&lt;/code&gt; on a &lt;code&gt;string&lt;/code&gt; reference pointing to &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;\n&lt;h1&gt;Debugging&lt;/h1&gt;\n&lt;p&gt;How do you find the source of a &lt;code&gt;NullReferenceException&lt;/code&gt;? Apart from looking at the exception itself, which will be thrown exactly at the location where it occurs, the general rules of debugging in Visual Studio apply: place strategic breakpoints and &lt;a href=&quot;https://docs.microsoft.com/en-us/visualstudio/debugger/debugger-windows&quot; rel=&quot;noreferrer&quot;&gt;inspect your variables&lt;/a&gt;, either by hovering the mouse over their names, opening a (Quick)Watch window or using the various debugging panels like Locals and Autos.&lt;/p&gt;\n&lt;p&gt;If you want to find out where the reference is or isn&apos;t set, right-click its name and select &quot;Find All References&quot;. You can then place a breakpoint at every found location and run your program with the debugger attached. Every time the debugger breaks on such a breakpoint, you need to determine whether you expect the reference to be non-null, inspect the variable, and verify that it points to an instance when you expect it to.&lt;/p&gt;\n&lt;p&gt;By following the program flow this way, you can find the location where the instance should not be null, and why it isn&apos;t properly set.&lt;/p&gt;\n&lt;h1&gt;Examples&lt;/h1&gt;\n&lt;p&gt;Some common scenarios where the exception can be thrown:&lt;/p&gt;\n&lt;h3&gt;Generic&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;ref1.ref2.ref3.member\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If ref1 or ref2 or ref3 is null, then you&apos;ll get a &lt;code&gt;NullReferenceException&lt;/code&gt;. If you want to solve the problem, then find out which one is null by rewriting the expression to its simpler equivalent:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; r1 = ref1;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; r2 = r1.ref2;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; r3 = r2.ref3;\nr3.member\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Specifically, in &lt;code&gt;HttpContext.Current.User.Identity.Name&lt;/code&gt;, the &lt;code&gt;HttpContext.Current&lt;/code&gt; could be null, or the &lt;code&gt;User&lt;/code&gt; property could be null, or the &lt;code&gt;Identity&lt;/code&gt; property could be null.&lt;/p&gt;\n&lt;h3&gt;Indirect&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Person&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; Age { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Book&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Person Author { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Example&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Foo&lt;/span&gt;()&lt;/span&gt; \n    {\n        Book b1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book();\n        &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; authorAge = b1.Author.Age; &lt;span class=&quot;hljs-comment&quot;&gt;// You never initialized the Author property.&lt;/span&gt;\n                                       &lt;span class=&quot;hljs-comment&quot;&gt;// there is no Person to get an Age from.&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If you want to avoid the child (Person) null reference, you could initialize it in the parent (Book) object&apos;s constructor.&lt;/p&gt;\n&lt;h3&gt;Nested Object Initializers&lt;/h3&gt;\n&lt;p&gt;The same applies to nested object initializers:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Book b1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book \n{ \n   Author = { Age = &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt; } \n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This translates to:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Book b1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book();\nb1.Author.Age = &lt;span class=&quot;hljs-number&quot;&gt;45&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;While the &lt;code&gt;new&lt;/code&gt; keyword is used, it only creates a new instance of &lt;code&gt;Book&lt;/code&gt;, but not a new instance of &lt;code&gt;Person&lt;/code&gt;, so the &lt;code&gt;Author&lt;/code&gt; the property is still &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;\n&lt;h3&gt;Nested Collection Initializers&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Person&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ICollection&amp;lt;Book&amp;gt; Books { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Book&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; Title { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The nested collection &lt;code&gt;Initializers&lt;/code&gt; behave the same:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Person p1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Person \n{\n    Books = {\n         &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book { Title = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Title1&quot;&lt;/span&gt; },\n         &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book { Title = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Title2&quot;&lt;/span&gt; },\n    }\n};\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This translates to:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Person p1 = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Person();\np1.Books.Add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book { Title = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Title1&quot;&lt;/span&gt; });\np1.Books.Add(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Book { Title = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Title2&quot;&lt;/span&gt; });\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;code&gt;new Person&lt;/code&gt; only creates an instance of &lt;code&gt;Person&lt;/code&gt;, but the &lt;code&gt;Books&lt;/code&gt; collection is still &lt;code&gt;null&lt;/code&gt;. The collection &lt;code&gt;Initializer&lt;/code&gt; syntax does not create a collection\nfor &lt;code&gt;p1.Books&lt;/code&gt;, it only translates to the &lt;code&gt;p1.Books.Add(...)&lt;/code&gt; statements.&lt;/p&gt;\n&lt;h3&gt;Array&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;[] numbers = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; n = numbers[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;]; &lt;span class=&quot;hljs-comment&quot;&gt;// numbers is null. There is no array to index.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Array Elements&lt;/h3&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Person[] people = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Person[&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;];\npeople[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;].Age = &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// people[0] is null. The array was allocated but not&lt;/span&gt;\n                   &lt;span class=&quot;hljs-comment&quot;&gt;// initialized. There is no Person to set the Age for.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Jagged Arrays&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;long&lt;/span&gt;[][] array = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;long&lt;/span&gt;[&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;][];\narray[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;][&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;] = &lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// is null because only the first dimension is yet initialized.&lt;/span&gt;\n                 &lt;span class=&quot;hljs-comment&quot;&gt;// Use array[0] = new long[2]; first.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Collection/List/Dictionary&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Dictionary&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt; agesForNames = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; age = agesForNames[&lt;span class=&quot;hljs-string&quot;&gt;&quot;Bob&quot;&lt;/span&gt;]; &lt;span class=&quot;hljs-comment&quot;&gt;// agesForNames is null.&lt;/span&gt;\n                               &lt;span class=&quot;hljs-comment&quot;&gt;// There is no Dictionary to perform the lookup.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Range Variable (Indirect/Deferred)&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Person&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; Name { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; people = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; List&amp;lt;Person&amp;gt;();\npeople.Add(&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; names = &lt;span class=&quot;hljs-keyword&quot;&gt;from&lt;/span&gt; p &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; people &lt;span class=&quot;hljs-keyword&quot;&gt;select&lt;/span&gt; p.Name;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; firstName = names.First(); &lt;span class=&quot;hljs-comment&quot;&gt;// Exception is thrown here, but actually occurs&lt;/span&gt;\n                                  &lt;span class=&quot;hljs-comment&quot;&gt;// on the line above.  &quot;p&quot; is null because the&lt;/span&gt;\n                                  &lt;span class=&quot;hljs-comment&quot;&gt;// first element we added to the list is null.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Events (C#)&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Demo&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;event&lt;/span&gt; EventHandler StateChanged;\n    \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;virtual&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;OnStateChanged&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;EventArgs e&lt;/span&gt;)&lt;/span&gt;\n    {        \n        StateChanged(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;, e); &lt;span class=&quot;hljs-comment&quot;&gt;// Exception is thrown here &lt;/span&gt;\n                               &lt;span class=&quot;hljs-comment&quot;&gt;// if no event handlers have been attached&lt;/span&gt;\n                               &lt;span class=&quot;hljs-comment&quot;&gt;// to StateChanged event&lt;/span&gt;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;(Note: The VB.NET compiler inserts null checks for event usage, so it&apos;s not necessary to check events for &lt;code&gt;Nothing&lt;/code&gt; in VB.NET.)&lt;/p&gt;\n&lt;h3&gt;Bad Naming Conventions:&lt;/h3&gt;\n&lt;p&gt;If you named fields differently from locals, you might have realized that you never initialized the field.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Form1&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Customer customer;\n    \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Form1_Load&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt; \n    {\n        Customer customer = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Customer();\n        customer.Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;John&quot;&lt;/span&gt;;\n    }\n    \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Button_Click&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt;\n    {\n        MessageBox.Show(customer.Name);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This can be solved by following the convention to prefix fields with an underscore:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; Customer _customer;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;ASP.NET Page Life cycle:&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;partial&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Issues_Edit&lt;/span&gt; : &lt;span class=&quot;hljs-title&quot;&gt;System.Web.UI.Page&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; TestIssue myIssue;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Page_Load&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!IsPostBack)\n        {\n             &lt;span class=&quot;hljs-comment&quot;&gt;// Only called on first load, not when button clicked&lt;/span&gt;\n             myIssue = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; TestIssue(); \n        }\n    }\n        \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;SaveButton_Click&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, EventArgs e&lt;/span&gt;)&lt;/span&gt;\n    {\n        myIssue.Entry = &lt;span class=&quot;hljs-string&quot;&gt;&quot;NullReferenceException here!&quot;&lt;/span&gt;;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;ASP.NET Session Values&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// if the &quot;FirstName&quot; session value has not yet been set,&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;// then this line will throw a NullReferenceException&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; firstName = Session[&lt;span class=&quot;hljs-string&quot;&gt;&quot;FirstName&quot;&lt;/span&gt;].ToString();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;ASP.NET MVC empty view models&lt;/h3&gt;\n&lt;p&gt;If the exception occurs when referencing a property of &lt;code&gt;@Model&lt;/code&gt; in an &lt;code&gt;ASP.NET MVC View&lt;/code&gt;, you need to understand that the &lt;code&gt;Model&lt;/code&gt; gets set in your action method, when you &lt;code&gt;return&lt;/code&gt; a view. When you return an empty model (or model property) from your controller, the exception occurs when the views access it:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// Controller&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Restaurant&lt;/span&gt;:&lt;span class=&quot;hljs-title&quot;&gt;Controller&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; ActionResult &lt;span class=&quot;hljs-title&quot;&gt;Search&lt;/span&gt;()&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; View();  &lt;span class=&quot;hljs-comment&quot;&gt;// Forgot the provide a Model here.&lt;/span&gt;\n    }\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;// Razor view &lt;/span&gt;\n@foreach (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; restaurantSearch &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; Model.RestaurantSearch)  &lt;span class=&quot;hljs-comment&quot;&gt;// Throws.&lt;/span&gt;\n{\n}\n    \n&amp;lt;p&amp;gt;@Model.somePropertyName&amp;lt;/p&amp;gt; &amp;lt;!-- Also throws --&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;WPF Control Creation Order and Events&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;WPF&lt;/code&gt; controls are created during the call to &lt;code&gt;InitializeComponent&lt;/code&gt; in the order they appear in the visual tree.  A &lt;code&gt;NullReferenceException&lt;/code&gt; will be raised in the case of early-created controls with event handlers, etc., that fire during &lt;code&gt;InitializeComponent&lt;/code&gt; which reference late-created controls.&lt;/p&gt;\n&lt;p&gt;For example:&lt;/p&gt;\n&lt;pre class=&quot;lang-xml s-code-block&quot;&gt;&lt;code class=&quot;hljs language-xml&quot;&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;Grid&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- Combobox declared first --&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ComboBox&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;Name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;comboBox1&quot;&lt;/span&gt; \n              &lt;span class=&quot;hljs-attr&quot;&gt;Margin&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;10&quot;&lt;/span&gt;\n              &lt;span class=&quot;hljs-attr&quot;&gt;SelectedIndex&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;0&quot;&lt;/span&gt; \n              &lt;span class=&quot;hljs-attr&quot;&gt;SelectionChanged&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;comboBox1_SelectionChanged&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n       &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ComboBoxItem&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;Content&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Item 1&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n       &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ComboBoxItem&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;Content&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Item 2&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n       &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ComboBoxItem&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;Content&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Item 3&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;ComboBox&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        \n    &lt;span class=&quot;hljs-comment&quot;&gt;&amp;lt;!-- Label declared later --&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;Label&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;Name&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;label1&quot;&lt;/span&gt; \n           &lt;span class=&quot;hljs-attr&quot;&gt;Content&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;Label&quot;&lt;/span&gt;\n           &lt;span class=&quot;hljs-attr&quot;&gt;Margin&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;10&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;Grid&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here &lt;code&gt;comboBox1&lt;/code&gt; is created before &lt;code&gt;label1&lt;/code&gt;. If &lt;code&gt;comboBox1_SelectionChanged&lt;/code&gt; attempts to reference `label1, it will not yet have been created.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;comboBox1_SelectionChanged&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; sender, SelectionChangedEventArgs e&lt;/span&gt;)&lt;/span&gt;\n{\n    label1.Content = comboBox1.SelectedIndex.ToString(); &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException here!!&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Changing the order of the declarations in the &lt;code&gt;XAML&lt;/code&gt; (i.e., listing &lt;code&gt;label1&lt;/code&gt; before &lt;code&gt;comboBox1&lt;/code&gt;, ignoring issues of design philosophy) would at least resolve the &lt;code&gt;NullReferenceException&lt;/code&gt; here.&lt;/p&gt;\n&lt;h3&gt;Cast with &lt;code&gt;as&lt;/code&gt;&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; myThing = someObject &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; Thing;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This doesn&apos;t throw an &lt;code&gt;InvalidCastException&lt;/code&gt; but returns a &lt;code&gt;null&lt;/code&gt; when the cast fails (and when &lt;code&gt;someObject&lt;/code&gt; is itself null). So be aware of that.&lt;/p&gt;\n&lt;h3&gt;LINQ &lt;code&gt;FirstOrDefault()&lt;/code&gt; and &lt;code&gt;SingleOrDefault()&lt;/code&gt;&lt;/h3&gt;\n&lt;p&gt;The plain versions &lt;code&gt;First()&lt;/code&gt; and &lt;code&gt;Single()&lt;/code&gt; throw exceptions when there is nothing. The &quot;OrDefault&quot; versions return &lt;code&gt;null&lt;/code&gt; in that case. So be aware of that.&lt;/p&gt;\n&lt;h3&gt;foreach&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;foreach&lt;/code&gt; throws when you try to iterate on a &lt;code&gt;null&lt;/code&gt; collection. Usually caused by unexpected &lt;code&gt;null&lt;/code&gt; result from methods that return collections.&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;List&amp;lt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;&amp;gt; list = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;    \n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; v &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; list) { } &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException here&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;More realistic example - select nodes from XML document. Will throw if nodes are not found but initial debugging shows that all properties valid:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; node &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; myData.MyXml.DocumentNode.SelectNodes(&lt;span class=&quot;hljs-string&quot;&gt;&quot;//Data&quot;&lt;/span&gt;))\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h1&gt;Ways to Avoid&lt;/h1&gt;\n&lt;h3&gt;Explicitly check for &lt;code&gt;null&lt;/code&gt; and ignore &lt;code&gt;null&lt;/code&gt; values.&lt;/h3&gt;\n&lt;p&gt;If you expect the reference sometimes to be &lt;code&gt;null&lt;/code&gt;, you can check for it being &lt;code&gt;null&lt;/code&gt; before accessing instance members:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;PrintName&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Person p&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (p != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) \n    {\n        Console.WriteLine(p.Name);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Explicitly check for &lt;code&gt;null&lt;/code&gt; and provide a default value.&lt;/h3&gt;\n&lt;p&gt;Methods you call expecting an instance can return &lt;code&gt;null&lt;/code&gt;, for example when the object being sought cannot be found. You can choose to return a default value when this is the case:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetCategory&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;Book b&lt;/span&gt;)&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (b == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Unknown&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; b.Category;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Explicitly check for &lt;code&gt;null&lt;/code&gt; from method calls and throw a custom exception.&lt;/h3&gt;\n&lt;p&gt;You can also throw a custom exception, only to catch it in the calling code:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetCategory&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; bookTitle&lt;/span&gt;)&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; book = library.FindBook(bookTitle);  &lt;span class=&quot;hljs-comment&quot;&gt;// This may return null&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (book == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; BookNotFoundException(bookTitle);  &lt;span class=&quot;hljs-comment&quot;&gt;// Your custom exception&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; book.Category;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Use &lt;code&gt;Debug.Assert&lt;/code&gt; if a value should never be &lt;code&gt;null&lt;/code&gt;, to catch the problem earlier than the exception occurs.&lt;/h3&gt;\n&lt;p&gt;When you know during development that a method could, but never should return &lt;code&gt;null&lt;/code&gt;, you can use &lt;code&gt;Debug.Assert()&lt;/code&gt; to break as soon as possible when it does occur:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetTitle&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; knownBookID&lt;/span&gt;)&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// You know this should never return null.&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; book = library.GetBook(knownBookID);  \n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Exception will occur on the next line instead of at the end of this method.&lt;/span&gt;\n    Debug.Assert(book != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Library didn&apos;t return a book for known book ID.&quot;&lt;/span&gt;);\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Some other code&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; book.Title; &lt;span class=&quot;hljs-comment&quot;&gt;// Will never throw NullReferenceException in Debug mode.&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Though this check &lt;a href=&quot;https://stackoverflow.com/questions/3021538/debug-assert-appears-in-release-mode&quot;&gt;will not end up in your release build&lt;/a&gt;, causing it to throw the &lt;code&gt;NullReferenceException&lt;/code&gt; again when &lt;code&gt;book == null&lt;/code&gt; at runtime in release mode.&lt;/p&gt;\n&lt;h3&gt;Use &lt;code&gt;GetValueOrDefault()&lt;/code&gt; for &lt;code&gt;nullable&lt;/code&gt; value types to provide a default value when they are &lt;code&gt;null&lt;/code&gt;.&lt;/h3&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;DateTime? appointment = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n&lt;span class=&quot;hljs-comment&quot;&gt;// Will display the default value provided (DateTime.Now), because appointment is null.&lt;/span&gt;\n\nappointment = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; DateTime(&lt;span class=&quot;hljs-number&quot;&gt;2022&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;20&lt;/span&gt;);\nConsole.WriteLine(appointment.GetValueOrDefault(DateTime.Now));\n&lt;span class=&quot;hljs-comment&quot;&gt;// Will display the appointment date, not the default&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Use the null coalescing operator: &lt;code&gt;??&lt;/code&gt; [C#] or &lt;code&gt;If()&lt;/code&gt; [VB].&lt;/h3&gt;\n&lt;p&gt;The shorthand to providing a default value when a &lt;code&gt;null&lt;/code&gt; is encountered:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;IService &lt;span class=&quot;hljs-title&quot;&gt;CreateService&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;ILogger log, Int32? frobPowerLevel&lt;/span&gt;)&lt;/span&gt;\n{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; serviceImpl = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; MyService(log ?? NullLog.Instance);\n \n   &lt;span class=&quot;hljs-comment&quot;&gt;// Note that the above &quot;GetValueOrDefault()&quot; can also be rewritten to use&lt;/span&gt;\n   &lt;span class=&quot;hljs-comment&quot;&gt;// the coalesce operator:&lt;/span&gt;\n   serviceImpl.FrobPowerLevel = frobPowerLevel ?? &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Use the null condition operator: &lt;code&gt;?.&lt;/code&gt; or &lt;code&gt;?[x]&lt;/code&gt; for arrays (available in C# 6 and VB.NET 14):&lt;/h3&gt;\n&lt;p&gt;This is also sometimes called the safe navigation or Elvis (after its shape) operator. If the expression on the left side of the operator is null, then the right side will not be evaluated, and null is returned instead. That means cases like this:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; title = person.Title.ToUpper();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If the person does not have a title, this will throw an exception because it is trying to call &lt;code&gt;ToUpper&lt;/code&gt; on a property with a null value.&lt;/p&gt;\n&lt;p&gt;In &lt;code&gt;C# 5&lt;/code&gt; and below, this can be guarded with:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; title = person.Title == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt; : person.Title.ToUpper();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now the title variable will be null instead of throwing an exception. C# 6 introduces a shorter syntax for this:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; title = person.Title?.ToUpper();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This will result in the title variable being &lt;code&gt;null&lt;/code&gt;, and the call to &lt;code&gt;ToUpper&lt;/code&gt; is not made if &lt;code&gt;person.Title&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;Of course, you &lt;em&gt;still&lt;/em&gt; have to check &lt;code&gt;title&lt;/code&gt; for &lt;code&gt;null&lt;/code&gt; or use the null condition operator together with the null coalescing operator (&lt;code&gt;??&lt;/code&gt;) to supply a default value:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// regular null check&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; titleLength = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (title != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n    titleLength = title.Length; &lt;span class=&quot;hljs-comment&quot;&gt;// If title is null, this would throw NullReferenceException&lt;/span&gt;\n    \n&lt;span class=&quot;hljs-comment&quot;&gt;// combining the `?` and the `??` operator&lt;/span&gt;\n&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; titleLength = title?.Length ?? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Likewise, for arrays you can use &lt;code&gt;?[i]&lt;/code&gt; as follows:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;[] myIntArray = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;;\n&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt;? elem = myIntArray?[i];\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!elem.HasValue) Console.WriteLine(&lt;span class=&quot;hljs-string&quot;&gt;&quot;No value&quot;&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This will do the following: If &lt;code&gt;myIntArray&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt;, the expression returns &lt;code&gt;null&lt;/code&gt; and you can safely check it. If it contains an array, it will do the same as:\n&lt;code&gt;elem = myIntArray[i];&lt;/code&gt; and returns the i&lt;sup&gt;th&lt;/sup&gt; element.&lt;/p&gt;\n&lt;h3&gt;Use null context (available in C# 8):&lt;/h3&gt;\n&lt;p&gt;Introduced in &lt;code&gt;C# 8&lt;/code&gt;, null contexts and nullable reference types perform static analysis on variables and provide a compiler warning if a value can be potentially &lt;code&gt;null&lt;/code&gt; or have been set to &lt;code&gt;null&lt;/code&gt;. The nullable reference types allow types to be explicitly allowed to be &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;The nullable annotation context and nullable warning context can be set for a project using the &lt;code&gt;Nullable&lt;/code&gt; element in your &lt;code&gt;csproj&lt;/code&gt; file. This element configures how the compiler interprets the nullability of types and what warnings are generated. Valid settings are:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;code&gt;enable&lt;/code&gt;: The nullable annotation context is enabled. The nullable warning context is enabled. Variables of a reference type, string, for example, are non-nullable. All nullability warnings are enabled.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;disable&lt;/code&gt;: The nullable annotation context is disabled. The nullable warning context is disabled. Variables of a reference type are oblivious, just like earlier versions of C#. All nullability warnings are disabled.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;safeonly&lt;/code&gt;: The nullable annotation context is enabled. The nullable warning context is safeonly. Variables of a reference type are non-nullable. All safety nullability warnings are enabled.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;warnings&lt;/code&gt;: The nullable annotation context is disabled. The nullable warning context is enabled. Variables of a reference type are oblivious. All nullability warnings are enabled.&lt;/li&gt;\n&lt;li&gt;&lt;code&gt;safeonlywarnings&lt;/code&gt;: The nullable annotation context is disabled. The nullable warning context is safeonly.\nVariables of a reference type are oblivious. All safety nullability warnings are enabled.&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;A nullable reference type is noted using the same syntax as nullable value types: a &lt;code&gt;?&lt;/code&gt; is appended to the type of the variable.&lt;/p&gt;\n&lt;h3&gt;Special techniques for debugging and fixing null derefs in iterators&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;C#&lt;/code&gt; supports &quot;iterator blocks&quot; (called &quot;generators&quot; in some other popular languages). &lt;code&gt;NullReferenceException&lt;/code&gt; can be particularly tricky to debug in iterator blocks because of deferred execution:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IEnumerable&amp;lt;Frob&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetFrobs&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;FrobFactory f, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count&lt;/span&gt;)&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; ++i)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; f.MakeFrob();\n}\n...\nFrobFactory factory = whatever;\nIEnumerable&amp;lt;Frobs&amp;gt; frobs = GetFrobs();\n...\n&lt;span class=&quot;hljs-keyword&quot;&gt;foreach&lt;/span&gt;(Frob frob &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; frobs) { ... }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If &lt;code&gt;whatever&lt;/code&gt; results in &lt;code&gt;null&lt;/code&gt; then &lt;code&gt;MakeFrob&lt;/code&gt; will throw. Now, you might think that the right thing to do is this:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// DON&apos;T DO THIS&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IEnumerable&amp;lt;Frob&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetFrobs&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;FrobFactory f, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count&lt;/span&gt;)&lt;/span&gt;\n{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (f == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) \n      &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;f&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;factory must not be null&quot;&lt;/span&gt;);\n   &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; ++i)\n      &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; f.MakeFrob();\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Why is this wrong?  Because the iterator block does not actually &lt;em&gt;run&lt;/em&gt; until the &lt;code&gt;foreach&lt;/code&gt;!  The call to &lt;code&gt;GetFrobs&lt;/code&gt; simply returns an object which &lt;em&gt;when iterated&lt;/em&gt; will run the iterator block.&lt;/p&gt;\n&lt;p&gt;By writing a &lt;code&gt;null&lt;/code&gt; check like this you prevent the &lt;code&gt;NullReferenceException&lt;/code&gt;, but you move the &lt;code&gt;NullArgumentException&lt;/code&gt; to the point of the &lt;em&gt;iteration&lt;/em&gt;, not to the point of the &lt;em&gt;call&lt;/em&gt;, and that is &lt;em&gt;very confusing to debug&lt;/em&gt;.&lt;/p&gt;\n&lt;p&gt;The correct fix is:&lt;/p&gt;\n&lt;pre class=&quot;lang-cs s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;// DO THIS&lt;/span&gt;\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; IEnumerable&amp;lt;Frob&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetFrobs&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;FrobFactory f, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count&lt;/span&gt;)&lt;/span&gt;\n{\n   &lt;span class=&quot;hljs-comment&quot;&gt;// No yields in a public method that throws!&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (f == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) \n       &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;f&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;factory must not be null&quot;&lt;/span&gt;);\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; GetFrobsForReal(f, count);\n}\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; IEnumerable&amp;lt;Frob&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetFrobsForReal&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;FrobFactory f, &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; count&lt;/span&gt;)&lt;/span&gt;\n{\n   &lt;span class=&quot;hljs-comment&quot;&gt;// Yields in a private method&lt;/span&gt;\n   Debug.Assert(f != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n   &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;; i &amp;lt; count; ++i)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;yield&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; f.MakeFrob();\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;That is, make a private helper method that has the iterator block logic and a public surface method that does the &lt;code&gt;null&lt;/code&gt; check and returns the iterator. Now when &lt;code&gt;GetFrobs&lt;/code&gt; is called, the &lt;code&gt;null&lt;/code&gt; check happens immediately, and then &lt;code&gt;GetFrobsForReal&lt;/code&gt; executes when the sequence is iterated.&lt;/p&gt;\n&lt;p&gt;If you examine the reference source for &lt;code&gt;LINQ&lt;/code&gt; to Objects you will see that this technique is used throughout. It is slightly more clunky to write, but it makes debugging nullity errors much easier. &lt;strong&gt;Optimize your code for the convenience of the caller, not the convenience of the author&lt;/strong&gt;.&lt;/p&gt;\n&lt;h3&gt;A note on null dereferences in unsafe code&lt;/h3&gt;\n&lt;p&gt;&lt;code&gt;C#&lt;/code&gt; has an &quot;unsafe&quot; mode which is, as the name implies, extremely dangerous because the normal safety mechanisms which provide memory safety and type safety are not enforced. &lt;strong&gt;You should not be writing unsafe code unless you have a thorough and deep understanding of how memory works&lt;/strong&gt;.&lt;/p&gt;\n&lt;p&gt;In unsafe mode, you should be aware of two important facts:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;dereferencing a null &lt;strong&gt;pointer&lt;/strong&gt; produces the same exception as dereferencing a null &lt;strong&gt;reference&lt;/strong&gt;&lt;/li&gt;\n&lt;li&gt;dereferencing an invalid non-null pointer &lt;strong&gt;can&lt;/strong&gt; produce that exception in some circumstances&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;To understand why that is, it helps to understand how .NET produces &lt;code&gt;NullReferenceException&lt;/code&gt; in the first place. (These details apply to .NET running on Windows; other operating systems use similar mechanisms.)&lt;/p&gt;\n&lt;p&gt;Memory is virtualized in &lt;code&gt;Windows&lt;/code&gt;; each process gets a virtual memory space of many &quot;pages&quot; of memory that are tracked by the operating system. Each page of memory has flags set on it that determine how it may be used: read from, written to, executed, and so on. The &lt;em&gt;lowest&lt;/em&gt; page is marked as &quot;produce an error if ever used in any way&quot;.&lt;/p&gt;\n&lt;p&gt;Both a null pointer and a null reference in &lt;code&gt;C#&lt;/code&gt; are internally represented as the number zero, and so any attempt to dereference it into its corresponding memory storage causes the operating system to produce an error. The .NET runtime then detects this error and turns it into the &lt;code&gt;NullReferenceException&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;That&apos;s why dereferencing both a null pointer and a null reference produces the same exception.&lt;/p&gt;\n&lt;p&gt;What about the second point? Dereferencing &lt;em&gt;any&lt;/em&gt; invalid pointer that falls in the lowest page of virtual memory causes the same operating system error, and thereby the same exception.&lt;/p&gt;\n&lt;p&gt;Why does this make sense?  Well, suppose we have a struct containing two ints, and an unmanaged pointer equal to null. If we attempt to dereference the second int in the struct, the &lt;code&gt;CLR&lt;/code&gt; will not attempt to access the storage at location zero; it will access the storage at location four. But logically this is a null dereference because we are getting to that address &lt;em&gt;via&lt;/em&gt; the null.&lt;/p&gt;\n&lt;p&gt;If you are working with unsafe code and you get a &lt;code&gt;NullReferenceException&lt;/code&gt;, just be aware that the offending pointer need not be null. It can be any location in the lowest page, and this exception will be produced.&lt;/p&gt;\n    ","\n&lt;h1&gt;NullReference Exception  Visual Basic&lt;/h1&gt;\n&lt;p&gt;The &lt;code&gt;NullReference Exception&lt;/code&gt; for &lt;strong&gt;Visual Basic&lt;/strong&gt; is no different from the one in &lt;strong&gt;C#&lt;/strong&gt;. After all, they are both reporting the same exception defined in the .NET Framework which they both use. Causes unique to Visual Basic are rare (perhaps only one).&lt;/p&gt;\n&lt;p&gt;This answer will use Visual Basic terms, syntax, and context. The examples used come from a large number of past Stack&amp;nbsp; Overflow questions. This is to maximize relevance by using the &lt;em&gt;kinds&lt;/em&gt; of situations often seen in posts. A bit more explanation is also provided for those who might need it. An example similar to yours is &lt;em&gt;very&lt;/em&gt; likely listed here.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Note:&lt;/strong&gt;&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;This is concept-based: there is no code for you to paste into your project. It is intended to help you understand what causes a &lt;code&gt;NullReferenceException&lt;/code&gt; (NRE), how to find it, how to fix it, and how to avoid it. An NRE can be caused many ways so this is unlikely to be your sole encounter.&lt;/li&gt;\n&lt;li&gt;The examples (from Stack&amp;nbsp; Overflow posts) do not always show the best way to do something in the first place.&lt;/li&gt;\n&lt;li&gt;Typically, the simplest remedy is used.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;h2&gt;Basic Meaning&lt;/h2&gt;\n&lt;p&gt;The message &lt;em&gt;&quot;Object not set to an instance of Object&quot;&lt;/em&gt; means you are trying to use an object which has not been initialized. This boils down to one of these:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Your code &lt;em&gt;declared&lt;/em&gt; an object variable, but it did not &lt;em&gt;initialize&lt;/em&gt; it (create an instance or &apos;&lt;em&gt;instantiate&lt;/em&gt;&apos; it)&lt;/li&gt;\n&lt;li&gt;Something which your code assumed would initialize an object, did not&lt;/li&gt;\n&lt;li&gt;Possibly, other code prematurely invalidated an object still in use&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;Finding The Cause&lt;/h2&gt;\n&lt;p&gt;Since the problem is an object reference which is &lt;code&gt;Nothing&lt;/code&gt;, the answer is to examine them to find out which one. Then determine why it is not initialized. Hold the mouse over the various variables and Visual Studio (VS) will show their values - the culprit will be &lt;code&gt;Nothing&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/5ndSA.jpg&quot; alt=&quot;IDE debug display&quot;&gt;&lt;/p&gt;\n&lt;p&gt;You should also remove any Try/Catch blocks from the relevant code, especially ones where there is nothing in the Catch block. This will cause your code to crash when it tries to use an object which is &lt;code&gt;Nothing&lt;/code&gt;. &lt;strong&gt;This is what you want&lt;/strong&gt; because it will identify the exact &lt;em&gt;location&lt;/em&gt; of the problem, and allow you to identify the object causing it.&lt;/p&gt;\n&lt;p&gt;A &lt;code&gt;MsgBox&lt;/code&gt; in the Catch which displays &lt;code&gt;Error while...&lt;/code&gt; will be of little help. This method also leads to &lt;em&gt;very bad&lt;/em&gt; Stack&amp;nbsp; Overflow questions, because you can&apos;t describe the actual exception, the object involved or even the line of code where it happens.&lt;/p&gt;\n&lt;p&gt;You can also use the &lt;code&gt;Locals Window&lt;/code&gt; (&lt;strong&gt;Debug -&amp;gt; Windows -&amp;gt; Locals&lt;/strong&gt;) to examine your objects.&lt;/p&gt;\n&lt;p&gt;Once you know what and where the problem is, it is usually fairly easy to fix and faster than posting a new question.&lt;/p&gt;\n&lt;p&gt;See also:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://msdn.microsoft.com/en-us/library/ktf38f66.aspx&quot; rel=&quot;noreferrer&quot;&gt;Breakpoints&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/xtd0s8kd(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;MSDN: How to: Use the Try/Catch Block to Catch Exceptions&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/seyhszts(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;MSDN: Best Practices for Exceptions&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;Examples and Remedies&lt;/h2&gt;\n&lt;h2&gt;Class Objects / Creating an Instance&lt;/h2&gt;\n\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; CashRegister\n...\nTextBox1.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; = reg.Amount         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; NRE&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The problem is that &lt;code&gt;Dim&lt;/code&gt; does not create a CashRegister &lt;em&gt;object&lt;/em&gt;; it only declares a variable named &lt;code&gt;reg&lt;/code&gt; of that Type. &lt;em&gt;Declaring&lt;/em&gt; an object variable and creating an &lt;em&gt;instance&lt;/em&gt; are two different things.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;The &lt;code&gt;New&lt;/code&gt; operator can often be used to create the instance when you declare it:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; CashRegister        &lt;span class=&quot;hljs-comment&quot;&gt;&apos; [New] creates instance, invokes the constructor&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Longer, more explicit form:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; CashRegister = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; CashRegister\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;When it is only appropriate to create the instance later:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; CashRegister         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Declare&lt;/span&gt;\n  ...\nreg = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; CashRegister()            &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Create instance&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note: &lt;strong&gt;Do not&lt;/strong&gt; use &lt;code&gt;Dim&lt;/code&gt; again in a procedure, including the constructor (&lt;code&gt;Sub New&lt;/code&gt;):&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; CashRegister\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;...&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt;()\n   &lt;span class=&quot;hljs-comment&quot;&gt;&apos;...&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; reg &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; CashRegister\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This will create a &lt;em&gt;local&lt;/em&gt; variable, &lt;code&gt;reg&lt;/code&gt;, which exists only in that context (sub). The &lt;code&gt;reg&lt;/code&gt; variable with module level &lt;code&gt;Scope&lt;/code&gt; which you will use everywhere else remains &lt;code&gt;Nothing&lt;/code&gt;.&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;&lt;strong&gt;Missing the &lt;code&gt;New&lt;/code&gt; operator is the #1 cause of &lt;code&gt;NullReference Exceptions&lt;/code&gt;&lt;/strong&gt; seen in the Stack&amp;nbsp; Overflow questions reviewed.&lt;/p&gt;\n&lt;p&gt;Visual Basic tries to make the process clear repeatedly using &lt;strong&gt;&lt;code&gt;New&lt;/code&gt;&lt;/strong&gt;: Using the &lt;strong&gt;&lt;code&gt;New&lt;/code&gt;&lt;/strong&gt; Operator creates a &lt;strong&gt;new&lt;/strong&gt; object and calls &lt;strong&gt;&lt;code&gt;Sub New&lt;/code&gt;&lt;/strong&gt; -- the constructor -- where your object can perform any other initialization.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;To be clear, &lt;code&gt;Dim&lt;/code&gt; (or &lt;code&gt;Private&lt;/code&gt;) only &lt;em&gt;declares&lt;/em&gt; a variable and its &lt;code&gt;Type&lt;/code&gt;.   The &lt;em&gt;Scope&lt;/em&gt; of the variable - whether it exists for the entire module/class or is local to a procedure - is determined by &lt;em&gt;where&lt;/em&gt; it is declared. &lt;code&gt;Private | Friend | Public&lt;/code&gt; defines the access level, not &lt;em&gt;Scope&lt;/em&gt;.&lt;/p&gt;\n&lt;p&gt;For more information, see:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/new-operator&quot; rel=&quot;noreferrer&quot;&gt;New Operator&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope&quot; rel=&quot;noreferrer&quot;&gt;Scope in Visual Basic&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/access-levels&quot; rel=&quot;noreferrer&quot;&gt;Access Levels in Visual Basic&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/value-types-and-reference-types&quot; rel=&quot;noreferrer&quot;&gt;Value Types and Reference Types&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Arrays&lt;/h2&gt;\n&lt;p&gt;Arrays must also be instantiated:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; arr &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;()\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This array has only been declared, not created. There are several ways to initialize an array:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; arr &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;() = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;){}\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; or&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; arr() &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;){}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; For a local array (in a procedure) and using &apos;Option Infer&apos;:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; arr = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;) {}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Note: Beginning with VS 2010, when initializing a local array using a literal and &lt;code&gt;Option Infer&lt;/code&gt;, the &lt;code&gt;As &amp;lt;Type&amp;gt;&lt;/code&gt; and &lt;code&gt;New&lt;/code&gt; elements are optional:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; myDbl &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Double&lt;/span&gt;() = {&lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9.9&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3.14&lt;/span&gt;}\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; myDbl = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Double&lt;/span&gt;() {&lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9.9&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3.14&lt;/span&gt;}\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; myDbl() = {&lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9.9&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3.14&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The data Type and array size are inferred from the data being assigned. Class/Module level declarations still require &lt;code&gt;As &amp;lt;Type&amp;gt;&lt;/code&gt; with &lt;code&gt;Option Strict&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; myDoubles &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Double&lt;/span&gt;() = {&lt;span class=&quot;hljs-number&quot;&gt;1.5&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;9.9&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;18&lt;/span&gt;, &lt;span class=&quot;hljs-number&quot;&gt;3.14&lt;/span&gt;}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Example: Array of class objects&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; arrFoo(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Foo\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; arrFoo.Count - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n   arrFoo(i).Bar = i * &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;       &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Exception&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The array has been created, but the &lt;code&gt;Foo&lt;/code&gt; objects in it have not.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; arrFoo.Count - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    arrFoo(i) = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; Foo()         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Create Foo instance&lt;/span&gt;\n    arrFoo(i).Bar = i * &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Using a &lt;code&gt;List(Of T)&lt;/code&gt; will make it quite difficult to have an element without a valid object:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; FooList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Foo)     &lt;span class=&quot;hljs-comment&quot;&gt;&apos; List created, but it is empty&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; f &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Foo                        &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Temporary variable for the loop&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; i &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; &lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;\n    f = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; Foo()                    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Foo instance created&lt;/span&gt;\n    f.Bar =  i * &lt;span class=&quot;hljs-number&quot;&gt;10&lt;/span&gt;\n    FooList.Add(f)                   &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Foo object added to list&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For more information, see:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-infer-statement&quot; rel=&quot;noreferrer&quot;&gt;Option Infer Statement&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/declared-elements/scope&quot; rel=&quot;noreferrer&quot;&gt;Scope in Visual Basic&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/arrays/index&quot; rel=&quot;noreferrer&quot;&gt;Arrays in Visual Basic&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;hr&gt;\n&lt;h2&gt;Lists and Collections&lt;/h2&gt;\n&lt;p&gt;.NET collections (of which there are many varieties - Lists, Dictionary, etc.) must also be instantiated or created.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; myList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)\n..\nmyList.Add(&lt;span class=&quot;hljs-string&quot;&gt;&quot;ziggy&quot;&lt;/span&gt;)           &lt;span class=&quot;hljs-comment&quot;&gt;&apos; NullReference&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;You get the same exception for the same reason - &lt;code&gt;myList&lt;/code&gt; was only declared, but no instance created. The remedy is the same:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;myList = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Or create an instance when declared:&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; myList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;A common oversight is a class which uses a collection &lt;code&gt;Type&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Class&lt;/span&gt; Foo\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; barList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Bar)\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Friend&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; BarCount &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Return&lt;/span&gt; barList.Count\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Friend&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; AddItem(newBar &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Bar)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; barList.Contains(newBar) = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n            barList.Add(newBar)\n        &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Either procedure will result in an NRE, because &lt;code&gt;barList&lt;/code&gt; is only declared, not instantiated. Creating an instance of &lt;code&gt;Foo&lt;/code&gt; will not also create an instance of the internal &lt;code&gt;barList&lt;/code&gt;. It may have been the intent to do this in the constructor:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt;         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Constructor&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Stuff to do when a new Foo is created...&lt;/span&gt;\n    barList = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Bar)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;As before, this is incorrect:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt;()\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Creates another barList local to this procedure&lt;/span&gt;\n     &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; barList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Bar)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For more information, see &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;List(Of T)&lt;/code&gt; Class&lt;/a&gt;.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;Data Provider Objects&lt;/h2&gt;\n&lt;p&gt;Working with databases presents many opportunities for a NullReference because there can be many objects (&lt;code&gt;Command&lt;/code&gt;, &lt;code&gt;Connection&lt;/code&gt;, &lt;code&gt;Transaction&lt;/code&gt;, &lt;code&gt;Dataset&lt;/code&gt;, &lt;code&gt;DataTable&lt;/code&gt;, &lt;code&gt;DataRows&lt;/code&gt;....) in use at once.  &lt;strong&gt;Note:&lt;/strong&gt; It does not matter which data provider you are using -- MySQL, SQL Server, OleDB, etc. -- the &lt;em&gt;concepts&lt;/em&gt; are the same.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Example 1&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; da &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; OleDbDataAdapter\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ds &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; DataSet\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; MaxRows &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt;\n\ncon.Open()\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; sql = &lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT * FROM tblfoobar_List&quot;&lt;/span&gt;\nda = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; OleDbDataAdapter(sql, con)\nda.Fill(ds, &lt;span class=&quot;hljs-string&quot;&gt;&quot;foobar&quot;&lt;/span&gt;)\ncon.Close()\n\nMaxRows = ds.Tables(&lt;span class=&quot;hljs-string&quot;&gt;&quot;foobar&quot;&lt;/span&gt;).Rows.Count      &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Error&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;As before, the &lt;code&gt;ds&lt;/code&gt; Dataset object was declared, but an instance was never created. The &lt;code&gt;DataAdapter&lt;/code&gt; will fill an existing &lt;code&gt;DataSet&lt;/code&gt;, not create one. In this case, since &lt;code&gt;ds&lt;/code&gt; is a local variable, &lt;em&gt;the IDE warns you&lt;/em&gt; that this might happen:&lt;/p&gt;\n&lt;p&gt;&lt;img src=&quot;https://i.stack.imgur.com/E5d94.jpg&quot; alt=&quot;img&quot;&gt;&lt;/p&gt;\n&lt;p&gt;When declared as a module/class level variable, as appears to be the case with &lt;code&gt;con&lt;/code&gt;, the compiler can&apos;t know if the object was created by an upstream procedure. Do not ignore warnings.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ds &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; DataSet\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Example 2&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;ds = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; DataSet\nda = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; OleDBDataAdapter(sql, con)\nda.Fill(ds, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Employees&quot;&lt;/span&gt;)\n\ntxtID.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; = ds.Tables(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Employee&quot;&lt;/span&gt;).Rows(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Item(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\ntxtID.Name = ds.Tables(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Employee&quot;&lt;/span&gt;).Rows(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Item(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;A typo is a problem here: &lt;code&gt;Employees&lt;/code&gt; vs &lt;code&gt;Employee&lt;/code&gt;. There was no &lt;code&gt;DataTable&lt;/code&gt; named &quot;Employee&quot; created, so a &lt;code&gt;NullReferenceException&lt;/code&gt; results trying to access it. Another potential problem is assuming there will be &lt;code&gt;Items&lt;/code&gt; which may not be so when the SQL includes a WHERE clause.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Since this uses one table, using &lt;code&gt;Tables(0)&lt;/code&gt; will avoid spelling errors.  Examining &lt;code&gt;Rows.Count&lt;/code&gt; can also help:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; ds.Tables(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Rows.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    txtID.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; = ds.Tables(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Rows(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Item(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n    txtID.Name = ds.Tables(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Rows(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Item(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;Fill&lt;/code&gt; is a function returning the number of &lt;code&gt;Rows&lt;/code&gt; affected which can also be tested:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; da.Fill(ds, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Employees&quot;&lt;/span&gt;) &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Example 3&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; da &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; OleDb.OleDbDataAdapter(&lt;span class=&quot;hljs-string&quot;&gt;&quot;SELECT TICKET.TICKET_NO,\n        TICKET.CUSTOMER_ID, ... FROM TICKET_RESERVATION AS TICKET INNER JOIN\n        FLIGHT_DETAILS AS FLIGHT ... WHERE [TICKET.TICKET_NO]= ...&quot;&lt;/span&gt;, con)\n&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; ds &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; DataSet\nda.Fill(ds)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; ds.Tables(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TICKET_RESERVATION&quot;&lt;/span&gt;).Rows.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;code&gt;DataAdapter&lt;/code&gt; will provide &lt;code&gt;TableNames&lt;/code&gt; as shown in the previous example, but it does not parse names from the SQL or database table. As a result, &lt;code&gt;ds.Tables(&quot;TICKET_RESERVATION&quot;)&lt;/code&gt; references a non-existent table.&lt;/p&gt;\n&lt;p&gt;The &lt;strong&gt;Remedy&lt;/strong&gt; is the same, reference the table by index:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; ds.Tables(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Rows.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;See also &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/System.Data.DataTable(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;DataTable Class&lt;/a&gt;.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;Object Paths / Nested&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; myFoo.Bar.Items &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n   ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The code is only testing &lt;code&gt;Items&lt;/code&gt; while both &lt;code&gt;myFoo&lt;/code&gt; and &lt;code&gt;Bar&lt;/code&gt; may also be Nothing. The &lt;strong&gt;remedy&lt;/strong&gt; is to test the entire chain or path of objects one at a time:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; (myFoo &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt;\n    (myFoo.Bar &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt;\n    (myFoo.Bar.Items &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    ....\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;AndAlso&lt;/code&gt; is important. Subsequent tests will not be performed once the first &lt;code&gt;False&lt;/code&gt; condition is encountered. This allows the code to safely &apos;drill&apos; into the object(s) one &apos;level&apos; at a time, evaluating &lt;code&gt;myFoo.Bar&lt;/code&gt; only after (and if) &lt;code&gt;myFoo&lt;/code&gt; is determined to be valid. Object chains or paths can get quite long when coding complex objects:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;myBase&lt;/span&gt;.myNodes(&lt;span class=&quot;hljs-number&quot;&gt;3&lt;/span&gt;).Layer.SubLayer.Foo.Files.Add(&lt;span class=&quot;hljs-string&quot;&gt;&quot;somefilename&quot;&lt;/span&gt;)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;It is not possible to reference anything &apos;downstream&apos; of a &lt;code&gt;null&lt;/code&gt; object.  This also applies to controls:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;myWebBrowser.Document.GetElementById(&lt;span class=&quot;hljs-string&quot;&gt;&quot;formfld1&quot;&lt;/span&gt;).InnerText = &lt;span class=&quot;hljs-string&quot;&gt;&quot;some value&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Here, &lt;code&gt;myWebBrowser&lt;/code&gt; or &lt;code&gt;Document&lt;/code&gt; could be Nothing or the &lt;code&gt;formfld1&lt;/code&gt; element may not exist.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;UI Controls&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; cmd5 &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; SqlCommand(&lt;span class=&quot;hljs-string&quot;&gt;&quot;select Cartons, Pieces, Foobar &quot;&lt;/span&gt; _\n     &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;FROM Invoice where invoice_no = &apos;&quot;&lt;/span&gt; &amp;amp; _\n     &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.ComboBox5.SelectedItem.ToString.Trim &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; And category = &apos;&quot;&lt;/span&gt; &amp;amp; _\n     &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.ListBox1.SelectedItem.ToString.Trim &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; And item_name = &apos;&quot;&lt;/span&gt; &amp;amp; _\n     &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.ComboBox2.SelectedValue.ToString.Trim &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos; And expiry_date = &apos;&quot;&lt;/span&gt; &amp;amp; _\n     &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.expiry.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt;, con)\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Among other things, this code does not anticipate that the user may not have selected something in one or more UI controls.  &lt;code&gt;ListBox1.SelectedItem&lt;/code&gt; may well be &lt;code&gt;Nothing&lt;/code&gt;, so &lt;code&gt;ListBox1.SelectedItem.ToString&lt;/code&gt; will result in an NRE.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Validate data before using it (also use &lt;code&gt;Option Strict&lt;/code&gt; and SQL parameters):&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; expiry &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; DateTime         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; for text date validation&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; (ComboBox5.SelectedItems.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt;\n    (ListBox1.SelectedItems.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt;\n    (ComboBox2.SelectedItems.Count &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt;\n    (DateTime.TryParse(expiry.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt;, expiry) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;... do stuff&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n    MessageBox.Show(...&lt;span class=&quot;hljs-keyword&quot;&gt;error&lt;/span&gt; message...)\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Alternatively, you can use &lt;code&gt;(ComboBox5.SelectedItem IsNot Nothing) AndAlso...&lt;/code&gt;&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;Visual Basic Forms&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Class&lt;/span&gt; Form1\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; NameBoxes = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; TextBox(&lt;span class=&quot;hljs-number&quot;&gt;5&lt;/span&gt;) {Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox1&quot;&lt;/span&gt;), _\n                   Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox2&quot;&lt;/span&gt;), Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox3&quot;&lt;/span&gt;), _\n                   Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox4&quot;&lt;/span&gt;), Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox5&quot;&lt;/span&gt;), _\n                   Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox6&quot;&lt;/span&gt;)}\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; same thing in a different format:&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; boxList &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; TextBox) &lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt; {TextBox1, TextBox2, TextBox3 ...}\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Immediate NRE:&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; somevar &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox1&quot;&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This is a fairly common way to get an NRE. In C#, depending on how it is coded, the IDE will report that &lt;code&gt;Controls&lt;/code&gt; does not exist in the current context, or &quot;cannot reference non-static member&quot;. So, to some extent, this is a VB-only situation. It is also complex because it can result in a failure cascade.&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;The arrays and collections cannot be initialized this way.&lt;/em&gt; This initialization code will run &lt;em&gt;before&lt;/em&gt; the constructor creates the &lt;code&gt;Form&lt;/code&gt; or the &lt;code&gt;Controls&lt;/code&gt;. As a result:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Lists and Collection will simply be empty&lt;/li&gt;\n&lt;li&gt;The Array will contain five elements of Nothing&lt;/li&gt;\n&lt;li&gt;The &lt;code&gt;somevar&lt;/code&gt; assignment will result in an immediate NRE because Nothing doesn&apos;t have a &lt;code&gt;.Text&lt;/code&gt; property&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;Referencing array elements later will result in an NRE. If you do this in &lt;code&gt;Form_Load&lt;/code&gt;, due to an odd bug, the IDE &lt;em&gt;may not&lt;/em&gt; report the exception when it happens. The exception will pop up &lt;em&gt;later&lt;/em&gt; when your code tries to use the array. This &quot;silent exception&quot; is &lt;a href=&quot;https://stackoverflow.com/a/4934010/1070452&quot;&gt;detailed in this post&lt;/a&gt;. For our purposes, the key is that when something catastrophic happens while creating a form (&lt;code&gt;Sub New&lt;/code&gt; or &lt;code&gt;Form Load&lt;/code&gt; event), exceptions may go unreported, the code exits the procedure and just displays the form.&lt;/p&gt;\n&lt;p&gt;Since no other code in your &lt;code&gt;Sub New&lt;/code&gt; or &lt;code&gt;Form Load&lt;/code&gt; event will run after the NRE, &lt;em&gt;a great many other things&lt;/em&gt; can be left uninitialized.&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt; Form_Load(..._\n   &lt;span class=&quot;hljs-comment&quot;&gt;&apos;...&lt;/span&gt;\n   &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; name &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = NameBoxes(&lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;).&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt;        &lt;span class=&quot;hljs-comment&quot;&gt;&apos; NRE&lt;/span&gt;\n   &lt;span class=&quot;hljs-comment&quot;&gt;&apos; ...&lt;/span&gt;\n   &lt;span class=&quot;hljs-comment&quot;&gt;&apos; More code (which will likely not be executed)&lt;/span&gt;\n   &lt;span class=&quot;hljs-comment&quot;&gt;&apos; ...&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Sub&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt; this applies to any and all control and component references making these illegal where they are:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Class&lt;/span&gt; Form1\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; myFiles() &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.OpenFileDialog1.FileName &amp;amp; ...\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; dbcon &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = OpenFileDialog1.FileName &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;;Jet Oledb...&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; studentName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = TextBox13.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Partial Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;It is curious that VB does not provide a warning, but the remedy is to &lt;strong&gt;declare&lt;/strong&gt; the containers at the form level, but &lt;strong&gt;initialize&lt;/strong&gt; them in form load event handler when the controls &lt;strong&gt;do&lt;/strong&gt; exist. This can be done in &lt;code&gt;Sub New&lt;/code&gt; as long as your code is after the &lt;code&gt;InitializeComponent&lt;/code&gt; call:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Module level declaration&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; NameBoxes &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; TextBox()\n&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; studentName &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt;\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Form Load, Form Shown or Sub New:&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos;&lt;/span&gt;\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Using the OP&apos;s approach (illegal using OPTION STRICT)&lt;/span&gt;\nNameBoxes = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; TextBox() {&lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TextBox1&quot;&lt;/span&gt;), &lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.Controls(&lt;span class=&quot;hljs-string&quot;&gt;&quot;TestBox2&quot;&lt;/span&gt;), ...)\nstudentName = TextBox32.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt;           &lt;span class=&quot;hljs-comment&quot;&gt;&apos; For simple control references&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The array code may not be out of the woods yet. Any controls which are in a container control (like a &lt;code&gt;GroupBox&lt;/code&gt; or &lt;code&gt;Panel&lt;/code&gt;) will not be found in &lt;code&gt;Me.Controls&lt;/code&gt;; they will be in the Controls collection of that Panel or GroupBox. Nor will a control be returned when the control name is misspelled (&lt;code&gt;&quot;TeStBox2&quot;&lt;/code&gt;). In such cases, &lt;code&gt;Nothing&lt;/code&gt; will again be stored in those array elements and an NRE will result when you attempt to reference it.&lt;/p&gt;\n&lt;p&gt;These should be easy to find now that you know what you are looking for:\n&lt;img src=&quot;https://i.stack.imgur.com/5ndSA.jpg&quot; alt=&quot;VS shows you the error of your ways&quot;&gt;&lt;/p&gt;\n&lt;p&gt;&quot;Button2&quot; resides on a &lt;code&gt;Panel&lt;/code&gt;&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Rather than indirect references by name using the form&apos;s &lt;code&gt;Controls&lt;/code&gt; collection, use the control reference:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Declaration&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; NameBoxes &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; TextBox()\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Initialization -  simple and easy to read, hard to botch:&lt;/span&gt;\nNameBoxes = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; TextBox() {TextBox1, TextBox2, ...)\n\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; Initialize a List&lt;/span&gt;\nNamesList = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; TextBox)({TextBox1, TextBox2, TextBox3...})\n&lt;span class=&quot;hljs-comment&quot;&gt;&apos; or&lt;/span&gt;\nNamesList = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; TextBox)\nNamesList.AddRange({TextBox1, TextBox2, TextBox3...})\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h2&gt;Function Returning Nothing&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Private&lt;/span&gt; bars &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Bars)        &lt;span class=&quot;hljs-comment&quot;&gt;&apos; Declared and created&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;Public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt; BarList() &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; List(&lt;span class=&quot;hljs-keyword&quot;&gt;Of&lt;/span&gt; Bars)\n    bars.Clear\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; someCondition &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; n &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;to&lt;/span&gt; someValue\n            bars.Add(GetBar(n))\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt; n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Exit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Return&lt;/span&gt; bars\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Function&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This is a case where the IDE will warn you that &apos;&lt;em&gt;not all paths return a value and a &lt;code&gt;NullReferenceException&lt;/code&gt; may result&lt;/em&gt;&apos;. You can suppress the warning, by replacing &lt;code&gt;Exit Function&lt;/code&gt; with &lt;code&gt;Return Nothing&lt;/code&gt;, but that does not solve the problem. Anything which tries to use the return when &lt;code&gt;someCondition = False&lt;/code&gt; will result in an NRE:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;bList = myFoo.BarList()\n&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; b &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; Bar &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; bList      &lt;span class=&quot;hljs-comment&quot;&gt;&apos; EXCEPTION&lt;/span&gt;\n      ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Replace &lt;code&gt;Exit Function&lt;/code&gt; in the function with &lt;code&gt;Return bList&lt;/code&gt;. Returning an &lt;em&gt;empty&lt;/em&gt; &lt;code&gt;List&lt;/code&gt; is not the same as returning &lt;code&gt;Nothing&lt;/code&gt;. If there is a chance that a returned object can be &lt;code&gt;Nothing&lt;/code&gt;, test before using it:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt; bList = myFoo.BarList()\n &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; bList &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h2&gt;Poorly Implemented Try/Catch&lt;/h2&gt;\n&lt;p&gt;A badly implemented Try/Catch can hide where the problem is and result in new ones:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; dr &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; SqlDataReader\n&lt;span class=&quot;hljs-keyword&quot;&gt;Try&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; lnk &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; LinkButton = &lt;span class=&quot;hljs-built_in&quot;&gt;TryCast&lt;/span&gt;(sender, LinkButton)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; gr &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; GridViewRow = &lt;span class=&quot;hljs-built_in&quot;&gt;DirectCast&lt;/span&gt;(lnk.NamingContainer, GridViewRow)\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; eid &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;String&lt;/span&gt; = GridView1.DataKeys(gr.RowIndex).Value.ToString()\n    ViewState(&lt;span class=&quot;hljs-string&quot;&gt;&quot;username&quot;&lt;/span&gt;) = eid\n    sqlQry = &lt;span class=&quot;hljs-string&quot;&gt;&quot;select FirstName, Surname, DepartmentName, ExtensionName, jobTitle,\n             Pager, mailaddress, from employees1 where username=&apos;&quot;&lt;/span&gt; &amp;amp; eid &amp;amp; &lt;span class=&quot;hljs-string&quot;&gt;&quot;&apos;&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; connection.State &amp;lt;&amp;gt; ConnectionState.Open &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        connection.Open()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    command = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; SqlCommand(sqlQry, connection)\n\n    &lt;span class=&quot;hljs-comment&quot;&gt;&apos;More code fooing and barring&lt;/span&gt;\n\n    dr = command.ExecuteReader()\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; dr.Read() &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        lblFirstName.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; = Convert.ToString(dr(&lt;span class=&quot;hljs-string&quot;&gt;&quot;FirstName&quot;&lt;/span&gt;))\n        ...\n    &lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n    mpe.Show()\n&lt;span class=&quot;hljs-keyword&quot;&gt;Catch&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;Finally&lt;/span&gt;\n    command.Dispose()\n    dr.Close()             &lt;span class=&quot;hljs-comment&quot;&gt;&apos; &amp;lt;-- NRE&lt;/span&gt;\n    connection.Close()\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Try&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This is a case of an object not being created as expected, but also demonstrates the counter usefulness of an empty &lt;code&gt;Catch&lt;/code&gt;.&lt;/p&gt;\n&lt;p&gt;There is an extra comma in the SQL (after &apos;mailaddress&apos;) which results in an exception at &lt;code&gt;.ExecuteReader&lt;/code&gt;. After the &lt;code&gt;Catch&lt;/code&gt; does nothing, &lt;code&gt;Finally&lt;/code&gt; tries to perform clean up, but since you cannot &lt;code&gt;Close&lt;/code&gt; a null &lt;code&gt;DataReader&lt;/code&gt; object, a brand new &lt;code&gt;NullReferenceException&lt;/code&gt; results.&lt;/p&gt;\n&lt;p&gt;An empty &lt;code&gt;Catch&lt;/code&gt; block is the devil&apos;s playground. This OP was baffled why he was getting an NRE in the &lt;code&gt;Finally&lt;/code&gt; block. In other situations, an empty &lt;code&gt;Catch&lt;/code&gt; may result in something else much further downstream going haywire and cause you to spend time looking at the wrong things in the wrong place for the problem. (The &quot;silent exception&quot; described above provides the same entertainment value.)&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Don&apos;t use empty Try/Catch blocks - let the code crash so you can a) identify the cause b) identify the location and c) apply a proper remedy.  Try/Catch blocks are not intended to hide exceptions from the person uniquely qualified to fix them - the developer.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;DBNull is not the same as Nothing&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; row &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; DataGridViewRow &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; dgvPlanning.Rows\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Not&lt;/span&gt; IsDBNull(row.Cells(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Value) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The &lt;code&gt;IsDBNull&lt;/code&gt; function is used to test if a &lt;em&gt;value&lt;/em&gt; equals &lt;code&gt;System.DBNull&lt;/code&gt;:  &lt;a href=&quot;https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/tckcces5(v=vs.90)&quot; rel=&quot;noreferrer&quot;&gt;From MSDN:&lt;/a&gt;&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;The System.DBNull value indicates that the Object represents missing or non-existent data. DBNull is not the same as Nothing, which indicates that a variable has not yet been initialized.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; row.Cells(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt; ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;As before, you can test for Nothing, then for a specific value:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; (row.Cells(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt; (IsDBNull(row.Cells(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Value) = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;Example 2&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; getFoo = (&lt;span class=&quot;hljs-keyword&quot;&gt;From&lt;/span&gt; f &lt;span class=&quot;hljs-keyword&quot;&gt;In&lt;/span&gt; dbContext.FooBars\n               &lt;span class=&quot;hljs-keyword&quot;&gt;Where&lt;/span&gt; f.something = something\n               &lt;span class=&quot;hljs-keyword&quot;&gt;Select&lt;/span&gt; f).FirstOrDefault\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;Not&lt;/span&gt; IsDBNull(getFoo) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; IsDBNull(getFoo.user_id) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n        txtFirst.&lt;span class=&quot;hljs-keyword&quot;&gt;Text&lt;/span&gt; = getFoo.first_name\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Else&lt;/span&gt;\n       ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;code&gt;FirstOrDefault&lt;/code&gt; returns the first item or the default value, which is &lt;code&gt;Nothing&lt;/code&gt; for reference types and never &lt;code&gt;DBNull&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; getFoo &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;hr&gt;\n&lt;h2&gt;Controls&lt;/h2&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;Dim&lt;/span&gt; chk &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; CheckBox\n\nchk = CType(&lt;span class=&quot;hljs-keyword&quot;&gt;Me&lt;/span&gt;.Controls(chkName), CheckBox)\n&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; chk.Checked &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Return&lt;/span&gt; chk\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If a &lt;code&gt;CheckBox&lt;/code&gt; with &lt;code&gt;chkName&lt;/code&gt; can&apos;t be found (or exists in a &lt;code&gt;GroupBox&lt;/code&gt;), then &lt;code&gt;chk&lt;/code&gt; will be Nothing and be attempting to reference any property will result in an exception.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; (chk &lt;span class=&quot;hljs-built_in&quot;&gt;IsNot&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt;) &lt;span class=&quot;hljs-built_in&quot;&gt;AndAlso&lt;/span&gt; (chk.Checked) &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt; ...\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;The DataGridView&lt;/h3&gt;\n&lt;p&gt;The DGV has a few quirks seen periodically:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;dgvBooks.DataSource = loan.Books\ndgvBooks.Columns(&lt;span class=&quot;hljs-string&quot;&gt;&quot;ISBN&quot;&lt;/span&gt;).Visible = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;       &lt;span class=&quot;hljs-comment&quot;&gt;&apos; NullReferenceException&lt;/span&gt;\ndgvBooks.Columns(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Title&quot;&lt;/span&gt;).DefaultCellStyle.Format = &lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;\ndgvBooks.Columns(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Author&quot;&lt;/span&gt;).DefaultCellStyle.Format = &lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;\ndgvBooks.Columns(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Price&quot;&lt;/span&gt;).DefaultCellStyle.Format = &lt;span class=&quot;hljs-string&quot;&gt;&quot;C&quot;&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If &lt;code&gt;dgvBooks&lt;/code&gt; has &lt;code&gt;AutoGenerateColumns = True&lt;/code&gt;, it will create the columns, but it does not name them, so the above code fails when it references them by name.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Name the columns manually, or reference by index:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;dgvBooks.Columns(&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;).Visible = &lt;span class=&quot;hljs-literal&quot;&gt;True&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;h3&gt;Example 2  Beware of the NewRow&lt;/h3&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;xlWorkSheet = xlWorkBook.Sheets(&lt;span class=&quot;hljs-string&quot;&gt;&quot;sheet1&quot;&lt;/span&gt;)\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; i = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; myDGV.RowCount - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; j = &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; myDGV.ColumnCount - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;Integer&lt;/span&gt; = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;To&lt;/span&gt; myDGV.Columns.Count\n            xlWorkSheet.Cells(&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;, k) = myDGV.Columns(k - &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;).HeaderText\n            xlWorkSheet.Cells(i + &lt;span class=&quot;hljs-number&quot;&gt;2&lt;/span&gt;, j + &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;) = myDGV(j, i).Value.ToString()\n        &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;Next&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;When your &lt;code&gt;DataGridView&lt;/code&gt; has &lt;code&gt;AllowUserToAddRows&lt;/code&gt; as &lt;code&gt;True&lt;/code&gt; (the default), the &lt;code&gt;Cells&lt;/code&gt; in the blank/new row at the bottom will all contain &lt;code&gt;Nothing&lt;/code&gt;.  Most attempts to use the contents (for example, &lt;code&gt;ToString&lt;/code&gt;) will result in an NRE.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Use a &lt;code&gt;For/Each&lt;/code&gt; loop and test the &lt;code&gt;IsNewRow&lt;/code&gt; property to determine if it is that last row. This works whether &lt;code&gt;AllowUserToAddRows&lt;/code&gt; is true or not:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;For&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Each&lt;/span&gt; r &lt;span class=&quot;hljs-keyword&quot;&gt;As&lt;/span&gt; DataGridViewRow &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; myDGV.Rows\n    &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; r.IsNewRow = &lt;span class=&quot;hljs-literal&quot;&gt;False&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; ok to use this row&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;If you do use a &lt;code&gt;For n&lt;/code&gt; loop, modify the row count or use &lt;code&gt;Exit For&lt;/code&gt; when &lt;code&gt;IsNewRow&lt;/code&gt; is true.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h2&gt;My.Settings (StringCollection)&lt;/h2&gt;\n&lt;p&gt;Under certain circumstances, trying to use an item from &lt;code&gt;My.Settings&lt;/code&gt; which is a &lt;code&gt;StringCollection&lt;/code&gt; can result in a NullReference the first time you use it. The solution is the same, but not as obvious. Consider:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;My.Settings.FooBars.Add(&lt;span class=&quot;hljs-string&quot;&gt;&quot;ziggy&quot;&lt;/span&gt;)         &lt;span class=&quot;hljs-comment&quot;&gt;&apos; foobars is a string collection&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Since VB is managing Settings for you, it is reasonable to expect it to initialize the collection. It will, but only if you have previously added an initial entry to the collection (in the Settings editor). Since the collection is (apparently) initialized when an item is added, it remains &lt;code&gt;Nothing&lt;/code&gt; when there are no items in the Settings editor to add.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;Remedy&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Initialize the settings collection in the form&apos;s &lt;code&gt;Load&lt;/code&gt; event handler, if/when needed:&lt;/p&gt;\n&lt;pre class=&quot;lang-vb s-code-block&quot;&gt;&lt;code class=&quot;hljs language-vbnet&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt; My.Settings.FooBars &lt;span class=&quot;hljs-built_in&quot;&gt;Is&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;Nothing&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;Then&lt;/span&gt;\n    My.Settings.FooBars = &lt;span class=&quot;hljs-built_in&quot;&gt;New&lt;/span&gt; System.Collections.Specialized.StringCollection\n&lt;span class=&quot;hljs-keyword&quot;&gt;End&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;If&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Typically, the &lt;code&gt;Settings&lt;/code&gt; collection will only need to be initialized the first time the application runs. An alternate remedy is to add an initial value to your collection in &lt;strong&gt;Project -&amp;gt; Settings | FooBars&lt;/strong&gt;, save the project, then remove the fake value.&lt;/p&gt;\n&lt;hr&gt;\n&lt;h1&gt;Key Points&lt;/h1&gt;\n&lt;p&gt;You probably forgot the &lt;code&gt;New&lt;/code&gt; operator.&lt;/p&gt;\n&lt;p&gt;or&lt;/p&gt;\n&lt;p&gt;Something you assumed would perform flawlessly to return an initialized object to your code, did not.&lt;/p&gt;\n&lt;p&gt;Don&apos;t ignore compiler warnings (ever) and use &lt;code&gt;Option Strict On&lt;/code&gt; (always).&lt;/p&gt;\n&lt;hr&gt;\n&lt;p&gt;&lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;MSDN NullReference Exception&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Another scenario is when you cast a null object into a &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types&quot; rel=&quot;noreferrer&quot;&gt;value type&lt;/a&gt;. For example, the code below:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-type&quot;&gt;DateTime&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (DateTime)o;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;It will throw a &lt;code&gt;NullReferenceException&lt;/code&gt; on the cast. It seems quite obvious in the above sample, but this can happen in more &quot;late-binding&quot; intricate scenarios where the null object has been returned from some code you don&apos;t own, and the cast is for example generated by some automatic system.&lt;/p&gt;\n\n&lt;p&gt;One example of this is this simple ASP.NET binding fragment with the Calendar control:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-perl&quot;&gt;&amp;lt;asp:Calendar runat=&lt;span class=&quot;hljs-string&quot;&gt;&quot;server&quot;&lt;/span&gt; SelectedDate=&lt;span class=&quot;hljs-string&quot;&gt;&quot;&amp;lt;%#Bind(&quot;&lt;/span&gt;Something&lt;span class=&quot;hljs-string&quot;&gt;&quot;)%&amp;gt;&quot;&lt;/span&gt; /&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here, &lt;code&gt;SelectedDate&lt;/code&gt; is in fact a property - of &lt;code&gt;DateTime&lt;/code&gt; type - of the &lt;code&gt;Calendar&lt;/code&gt; Web Control type, and the binding could perfectly return something null. The implicit ASP.NET Generator will create a piece of code that will be equivalent to the cast code above. And this will raise a &lt;code&gt;NullReferenceException&lt;/code&gt; that is quite difficult to spot, because it lies in ASP.NET generated code which compiles fine...&lt;/p&gt;\n    ","\n&lt;p&gt;It means your code used an object reference variable that was set to null (i.e. it did not reference an actual object instance).&lt;/p&gt;\n\n&lt;p&gt;To prevent the error, objects that could be null should be tested for null before being used.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (myvar != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Go ahead and use myvar&lt;/span&gt;\n    myvar.property = ...\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;else&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Whoops! myvar is null and cannot be used without first&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// assigning it to an instance reference&lt;/span&gt;\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Attempting to use myvar here will result in NullReferenceException&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;It means that the variable in question is pointed at nothing. I could generate this like so:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;SqlConnection&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;connection&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\nconnection.Open();\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;That will throw the error because while I&apos;ve declared the variable &quot;&lt;code&gt;connection&lt;/code&gt;&quot;, it&apos;s not pointed to anything. When I try to call the member &quot;&lt;code&gt;Open&lt;/code&gt;&quot;, there&apos;s no reference for it to resolve, and it will throw the error.&lt;/p&gt;\n&lt;p&gt;To avoid this error:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;Always initialize your objects before you try to do anything with them.&lt;/li&gt;\n&lt;li&gt;If you&apos;re not sure whether the object is null, check it with &lt;code&gt;object == null&lt;/code&gt;.&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;JetBrains&apos; &lt;a href=&quot;https://en.wikipedia.org/wiki/JetBrains#ReSharper_Ultimate&quot; rel=&quot;nofollow noreferrer&quot;&gt;ReSharper&lt;/a&gt; tool will identify every place in your code that has the possibility of a null reference error, allowing you to put in a null check. This error is the number one source of bugs, IMHO.&lt;/p&gt;\n    ","\n&lt;p&gt;Be aware that regardless of the scenario, the cause is always the same in .NET:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;You are trying to use a reference variable whose value is &lt;code&gt;Nothing&lt;/code&gt;/&lt;code&gt;null&lt;/code&gt;.  When the value is &lt;code&gt;Nothing&lt;/code&gt;/&lt;code&gt;null&lt;/code&gt; for the reference variable, that means it is not actually holding a reference to an instance of any object that exists on the heap.&lt;/p&gt;\n&lt;p&gt;You either never assigned something to the variable, never created an instance of the value assigned to the variable, or you set the variable equal to &lt;code&gt;Nothing&lt;/code&gt;/&lt;code&gt;null&lt;/code&gt; manually, or you called a function that set the variable to &lt;code&gt;Nothing&lt;/code&gt;/&lt;code&gt;null&lt;/code&gt; for you.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;An example of this exception being thrown is: When you are trying to check something, that is null.&lt;/p&gt;\n\n&lt;p&gt;For example:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; testString = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;//Because it doesn&apos;t have a value (i.e. it&apos;s null; &quot;Length&quot; cannot do what it needs to do)&lt;/span&gt;\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (testString.Length == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// Throws a nullreferenceexception&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-comment&quot;&gt;//Do something&lt;/span&gt;\n} \n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The .NET runtime will throw a NullReferenceException when you attempt to perform an action on something which hasn&apos;t been instantiated i.e. the code above.&lt;/p&gt;\n\n&lt;p&gt;In comparison to an ArgumentNullException which is typically thrown as a defensive measure if a method expects that what is being passed to it is not null.&lt;/p&gt;\n\n&lt;p&gt;More information is in &lt;em&gt;&lt;a href=&quot;https://www.dotnetperls.com/nullreferenceexception&quot; rel=&quot;noreferrer&quot;&gt;C# NullReferenceException and Null Parameter&lt;/a&gt;&lt;/em&gt;. &lt;/p&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/csharp/nullable-references&quot; rel=&quot;noreferrer&quot;&gt;&lt;strong&gt;Update C#8.0, 2019: Nullable reference types&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;C#8.0 introduces &lt;strong&gt;nullable reference types&lt;/strong&gt; and &lt;strong&gt;non-nullable reference types&lt;/strong&gt;. So only nullable reference types must be checked to avoid a &lt;strong&gt;NullReferenceException&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;If you have not initialized a reference type, and you want to set or read one of its properties, it will throw a &lt;strong&gt;NullReferenceException&lt;/strong&gt;.&lt;/p&gt;\n\n&lt;p&gt;Example:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\np.Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Harry&quot;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException occurs here.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You can simply avoid this by checking if the variable is not null:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (p!=&lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n{\n    p.Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Harry&quot;&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// Not going to run to this point&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;To fully understand why a NullReferenceException is thrown, it is important to know the difference between &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/value-types&quot; rel=&quot;noreferrer&quot;&gt;value types&lt;/a&gt; and [reference types][3].&lt;/p&gt;\n\n&lt;p&gt;So, if you&apos;re dealing with &lt;strong&gt;value types&lt;/strong&gt;, NullReferenceExceptions can &lt;strong&gt;not&lt;/strong&gt; occur. Though you need to keep alert when dealing with &lt;strong&gt;reference types&lt;/strong&gt;!&lt;/p&gt;\n\n&lt;p&gt;Only reference types, as the name is suggesting, can hold references or point literally to nothing (or &apos;null&apos;). Whereas value types always contain a value.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Reference types (these ones must be checked):&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;dynamic&lt;/li&gt;\n&lt;li&gt;object&lt;/li&gt;\n&lt;li&gt;string&lt;/li&gt;\n&lt;/ul&gt;\n\n&lt;p&gt;&lt;strong&gt;Value types (you can simply ignore these ones):&lt;/strong&gt;&lt;/p&gt;\n\n&lt;ul&gt;\n&lt;li&gt;Numeric types&lt;/li&gt;\n&lt;li&gt;Integral types&lt;/li&gt;\n&lt;li&gt;Floating-point types&lt;/li&gt;\n&lt;li&gt;decimal&lt;/li&gt;\n&lt;li&gt;bool&lt;/li&gt;\n&lt;li&gt;User defined structs&lt;/li&gt;\n&lt;/ul&gt;\n    ","\n&lt;p&gt;Another case where &lt;code&gt;NullReferenceExceptions&lt;/code&gt; can happen is the (incorrect) use of the &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/as&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;as&lt;/code&gt; operator&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Book&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; Name { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\n&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Car&lt;/span&gt; { }\n\nCar mycar = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Car();\nBook mybook = mycar &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; Book;   &lt;span class=&quot;hljs-comment&quot;&gt;// Incompatible conversion --&amp;gt; mybook = null&lt;/span&gt;\n\nConsole.WriteLine(mybook.Name);   &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Here, &lt;code&gt;Book&lt;/code&gt; and &lt;code&gt;Car&lt;/code&gt; are incompatible types; a &lt;code&gt;Car&lt;/code&gt; cannot be converted/cast to a &lt;code&gt;Book&lt;/code&gt;.  When this cast fails, &lt;code&gt;as&lt;/code&gt; returns &lt;code&gt;null&lt;/code&gt;.  Using &lt;code&gt;mybook&lt;/code&gt; after this causes a &lt;code&gt;NullReferenceException&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;In general, you should use a cast or &lt;code&gt;as&lt;/code&gt;, as follows:&lt;/p&gt;\n\n&lt;p&gt;If you are expecting the type conversion to always succeed (ie. you know what the object should be ahead of time), then you should use a cast:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;ComicBook&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;cb&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (ComicBook)specificBook;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If you are unsure of the type, but you want to &lt;em&gt;try&lt;/em&gt; to use it as a specific type, then use &lt;code&gt;as&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;ComicBook cb = specificBook &lt;span class=&quot;hljs-keyword&quot;&gt;as&lt;/span&gt; ComicBook;\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (cb != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n   &lt;span class=&quot;hljs-comment&quot;&gt;// ...&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;You are using the object that contains the null value reference. So it&apos;s giving a null exception. In the example the string value is null and when checking its length, the exception occurred.&lt;/p&gt;\n&lt;p&gt;Example:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;.Length == &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;) &lt;span class=&quot;hljs-comment&quot;&gt;// &amp;lt;-- Causes exception&lt;/span&gt;\n{\n    Console.WriteLine(&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// &amp;lt;-- Never reached&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The exception error is:&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;Unhandled Exception:&lt;/p&gt;\n&lt;p&gt;System.NullReferenceException: Object reference not set to an instance\nof an object. at Program.Main()&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;While &lt;em&gt;what&lt;/em&gt; causes a &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;NullReferenceExceptions&lt;/a&gt; and approaches to &lt;em&gt;avoid/fix&lt;/em&gt; such an exception have been addressed in other answers, what many programmers haven&apos;t learned yet is how to independently &lt;em&gt;debug&lt;/em&gt; such exceptions during development.&lt;/p&gt;\n\n&lt;p&gt;In Visual Studio this is usually easy thanks to the &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/sc65sadd.aspx&quot; rel=&quot;noreferrer&quot;&gt;Visual Studio Debugger&lt;/a&gt;.&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;First, make sure that the correct error is going to be caught - see\n&lt;a href=&quot;https://stackoverflow.com/questions/4475464/&quot;&gt;How do I allow breaking on &apos;System.NullReferenceException&apos; in VS2010?&lt;/a&gt; &lt;em&gt;Note&lt;sup&gt;1&lt;/sup&gt;&lt;/em&gt;&lt;/p&gt;\n\n&lt;p&gt;Then either &lt;a href=&quot;https://blogs.msdn.microsoft.com/zainnab/2010/11/01/start-debugging-vs-start-without-debugging/&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;Start with Debugging (F5)&lt;/em&gt;&lt;/a&gt; or &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/3s68z0b3.aspx&quot; rel=&quot;noreferrer&quot;&gt;&lt;em&gt;Attach [the VS Debugger] to Running Process&lt;/em&gt;&lt;/a&gt;. On occasion it may be useful to use &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.break(v=vs.110).aspx&quot; rel=&quot;noreferrer&quot;&gt;&lt;code&gt;Debugger.Break&lt;/code&gt;&lt;/a&gt;, which will prompt to launch the debugger.&lt;/p&gt;\n\n&lt;p&gt;Now, when the NullReferenceException is thrown (or unhandled) the debugger will stop (remember the rule set above?) on the line on which the exception occurred. Sometimes the error will be easy to spot.&lt;/p&gt;\n\n&lt;p&gt;For instance,\nin the following line the only code that &lt;em&gt;can&lt;/em&gt; cause the exception is if &lt;code&gt;myString&lt;/code&gt; evaluates to null. This can be verified by looking at the &lt;a href=&quot;http://msdn.microsoft.com/en-us/library/aa290869(v=vs.71).aspx&quot; rel=&quot;noreferrer&quot;&gt;Watch Window&lt;/a&gt; or running expressions in the &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/f177hahy.aspx&quot; rel=&quot;noreferrer&quot;&gt;Immediate Window&lt;/a&gt;.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; x = myString.Trim();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;In more advanced cases, such as the following, you&apos;ll need to use one of the techniques above (Watch or Immediate Windows) to inspect the expressions to determine if &lt;code&gt;str1&lt;/code&gt; was null or if &lt;code&gt;str2&lt;/code&gt; was null.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-sql&quot;&gt;var x &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; str1.&lt;span class=&quot;hljs-built_in&quot;&gt;Trim&lt;/span&gt;() &lt;span class=&quot;hljs-operator&quot;&gt;+&lt;/span&gt; str2.&lt;span class=&quot;hljs-built_in&quot;&gt;Trim&lt;/span&gt;();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Once &lt;em&gt;where&lt;/em&gt; the exception is throw has been located, it&apos;s usually trivial to reason backwards to find out where the null value was [incorrectly] introduced --&lt;/p&gt;\n\n&lt;p&gt;Take the time required to understand the cause of the exception. Inspect for null expressions. Inspect the previous expressions which could have resulted in such null expressions. Add &lt;a href=&quot;https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ktf38f66(v=vs.90)&quot; rel=&quot;noreferrer&quot;&gt;breakpoints&lt;/a&gt; and step through the program as appropriate. &lt;em&gt;Use the debugger.&lt;/em&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;&lt;sup&gt;1&lt;/sup&gt;  If Break on Throws is too aggressive and the debugger stops on an NPE in the .NET or 3rd-party library, &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/038tzxdw.aspx&quot; rel=&quot;noreferrer&quot;&gt;Break on User-Unhandled&lt;/a&gt; can be used to limit the exceptions caught. Additionally, VS2012 introduces &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/dn457346.aspx&quot; rel=&quot;noreferrer&quot;&gt;Just My Code&lt;/a&gt; which I recommend enabling as well.&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;If you are debugging with Just My Code enabled, the behavior is slightly different. With Just My Code enabled, the debugger ignores first-chance common language runtime (CLR) exceptions that are thrown outside of My Code and do not pass through My Code&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/11244949/5407188&quot;&gt;Simon Mourier gave this example&lt;/a&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;object&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;o&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-type&quot;&gt;DateTime&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; (DateTime)o;  &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;where an &lt;strong&gt;&lt;em&gt;unboxing&lt;/em&gt;&lt;/strong&gt; conversion (cast) &lt;em&gt;from&lt;/em&gt; &lt;code&gt;object&lt;/code&gt; (or from one of the classes &lt;code&gt;System.ValueType&lt;/code&gt; or &lt;code&gt;System.Enum&lt;/code&gt;, or from an interface type) &lt;em&gt;to&lt;/em&gt; a value type (other than &lt;code&gt;Nullable&amp;lt;&amp;gt;&lt;/code&gt;) in itself gives the &lt;code&gt;NullReferenceException&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;In the other direction, a &lt;strong&gt;&lt;em&gt;boxing&lt;/em&gt;&lt;/strong&gt; conversion &lt;em&gt;from&lt;/em&gt; a &lt;code&gt;Nullable&amp;lt;&amp;gt;&lt;/code&gt; which has &lt;code&gt;HasValue&lt;/code&gt; equal to &lt;code&gt;false&lt;/code&gt; &lt;em&gt;to&lt;/em&gt; a reference type, can give a &lt;code&gt;null&lt;/code&gt; reference which can then later lead to a &lt;code&gt;NullReferenceException&lt;/code&gt;. The classic example is:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-dart&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;DateTime?&lt;/span&gt; d = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; s = d.ToString();  &lt;span class=&quot;hljs-comment&quot;&gt;// OK, no exception (no boxing), returns &quot;&quot;&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; t = d.GetType();   &lt;span class=&quot;hljs-comment&quot;&gt;// Bang! d is boxed, NullReferenceException&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Sometimes the boxing happens in another way. For example with this non-generic extension method:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyExtension&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;object&lt;/span&gt; x&lt;/span&gt;)&lt;/span&gt;\n{\n  x.ToString();\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;the following code will be problematic:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-dart&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;DateTime?&lt;/span&gt; d = &lt;span class=&quot;hljs-keyword&quot;&gt;null&lt;/span&gt;;\nd.MyExtension();  &lt;span class=&quot;hljs-comment&quot;&gt;// Leads to boxing, NullReferenceException occurs inside the body of the called method, not here.&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;These cases arise because of the special rules the runtime uses when boxing &lt;code&gt;Nullable&amp;lt;&amp;gt;&lt;/code&gt; instances.&lt;/p&gt;\n    ","\n&lt;p&gt;Adding a case when the class name for entity used in entity framework is same as class name for a web form code-behind file.&lt;/p&gt;\n\n&lt;p&gt;Suppose you have a web form Contact.aspx whose codebehind class is Contact and you have an entity name Contact.&lt;/p&gt;\n\n&lt;p&gt;Then following code will throw a NullReferenceException when you call context.SaveChanges()&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Contact&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;contact&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Contact&lt;/span&gt; { Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Abhinav&quot;&lt;/span&gt;};\n&lt;span class=&quot;hljs-type&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;context&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;DataContext&lt;/span&gt;();\ncontext.Contacts.Add(contact);\ncontext.SaveChanges(); &lt;span class=&quot;hljs-comment&quot;&gt;// NullReferenceException at this line&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;For the sake of completeness DataContext class&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-kotlin&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-class&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DataContext&lt;/span&gt; : &lt;span class=&quot;hljs-type&quot;&gt;DbContext &lt;/span&gt;&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; DbSet&amp;lt;Contact&amp;gt; Contacts {&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;;}\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;and Contact entity class. Sometimes entity classes are partial classes so that you can extend them in other files too.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;partial&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Contact&lt;/span&gt; \n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; Name {&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;;}\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The error occurs when both the entity and codebehind class are in same namespace.\nTo fix this, rename the entity class or the codebehind class for Contact.aspx.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Reason&lt;/strong&gt;\nI am still not sure about the reason. But whenever any of the entity class will extend System.Web.UI.Page this error occurs.&lt;/p&gt;\n\n&lt;p&gt;For discussion have a look at &lt;a href=&quot;https://stackoverflow.com/questions/17136455/nullreferenceexception-in-dbcontext-savechanges&quot;&gt;NullReferenceException in DbContext.saveChanges()&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Another general case where one might receive this exception involves mocking classes during unit testing. Regardless of the mocking framework being used, you must ensure that all appropriate levels of the class hierarchy are properly mocked. In particular, all properties of &lt;code&gt;HttpContext&lt;/code&gt; which are referenced by the code under test must be mocked.&lt;/p&gt;\n\n&lt;p&gt;See &quot;&lt;a href=&quot;https://stackoverflow.com/questions/19314340/nullreferenceexception-thrown-when-testing-custom-authorizationattribute&quot;&gt;NullReferenceException thrown when testing custom AuthorizationAttribute&lt;/a&gt;&quot; for a somewhat verbose example.&lt;/p&gt;\n    ","\n&lt;p&gt;I have a different perspective to answering this. This sort of answers &lt;strong&gt;&quot;what else can I do to avoid it?&lt;/strong&gt;&quot;&lt;/p&gt;\n\n&lt;p&gt;When working &lt;strong&gt;across different layers&lt;/strong&gt;, for example in an MVC application, a controller needs services to call business operations. In such scenarios &lt;strong&gt;Dependency Injection Container&lt;/strong&gt; can be used to initialize the services to avoid the &lt;strong&gt;NullReferenceException&lt;/strong&gt;. So that means you don&apos;t need to worry about checking for null and just call the services from the controller as though they will always to available (and initialized) as either a singleton or a prototype.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyController&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ServiceA serviceA;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; ServiceB serviceB;\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyController&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;ServiceA serviceA, ServiceB serviceB&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.serviceA = serviceA;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.serviceB = serviceB;\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyMethod&lt;/span&gt;()&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-comment&quot;&gt;// We don&apos;t need to check null because the dependency injection container &lt;/span&gt;\n        &lt;span class=&quot;hljs-comment&quot;&gt;// injects it, provided you took care of bootstrapping it.&lt;/span&gt;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; someObject = serviceA.DoThis();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;On the matter of &lt;strong&gt;&quot;what should I do about it&quot;&lt;/strong&gt;, there can be many answers.&lt;/p&gt;\n&lt;p&gt;A more &quot;formal&quot; way of preventing such error conditions &lt;em&gt;while developing&lt;/em&gt; is applying &lt;em&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Design_by_contract&quot; rel=&quot;nofollow noreferrer&quot;&gt;design by contract&lt;/a&gt;&lt;/em&gt; in your code. This means you need to set class &lt;em&gt;invariants&lt;/em&gt;, and/or even function/method &lt;em&gt;preconditions&lt;/em&gt; and &lt;em&gt;postconditions&lt;/em&gt; on your system, while developing.&lt;/p&gt;\n&lt;p&gt;In short, &lt;em&gt;class invariants&lt;/em&gt; ensure that there will be some constraints in your class that will not get violated in normal use (and therefore, the class will &lt;em&gt;not&lt;/em&gt; get in an inconsistent state). &lt;em&gt;Preconditions&lt;/em&gt; mean that data given as input to a function/method must follow some constraints set and &lt;strong&gt;never&lt;/strong&gt; violate them, and &lt;em&gt;postconditions&lt;/em&gt; mean that a function/method output must follow the set constraints again without ever violating them.\nContract conditions should &lt;strong&gt;never&lt;/strong&gt; be violated during execution of a bug-free program, therefore design by contract is checked in practice in debug mode, while being &lt;em&gt;disabled in releases&lt;/em&gt;, to maximize the developed system performance.&lt;/p&gt;\n&lt;p&gt;This way, you can avoid &lt;code&gt;NullReferenceException&lt;/code&gt; cases that are results of violation of the constraints set. For example, if you use an object property &lt;code&gt;X&lt;/code&gt; in a class and later try to invoke one of its methods and &lt;code&gt;X&lt;/code&gt; has a null value, then this will lead to &lt;code&gt;NullReferenceException&lt;/code&gt;:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; X { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;InvokeX&lt;/span&gt;()&lt;/span&gt;\n{\n    X.DoSomething(); &lt;span class=&quot;hljs-comment&quot;&gt;// if X value is null, you will get a NullReferenceException&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;But if you set &quot;property X must never have a null value&quot; as method precondition, then you can prevent the scenario described before:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-comment&quot;&gt;//Using code contracts:&lt;/span&gt;\n[&lt;span class=&quot;hljs-meta&quot;&gt;ContractInvariantMethod&lt;/span&gt;]\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;ObjectInvariant&lt;/span&gt;()&lt;/span&gt; \n{\n    Contract.Invariant(X != &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;);\n    &lt;span class=&quot;hljs-comment&quot;&gt;//...&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;For this cause, &lt;em&gt;&lt;a href=&quot;http://msdn.microsoft.com/en-us/library/dd264808%28v=vs.110%29.aspx&quot; rel=&quot;nofollow noreferrer&quot;&gt;Code Contracts&lt;/a&gt;&lt;/em&gt; project exists for .NET applications.&lt;/p&gt;\n&lt;p&gt;Alternatively, design by contract can be applied using &lt;em&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Assertion_%28software_development%29&quot; rel=&quot;nofollow noreferrer&quot;&gt;assertions&lt;/a&gt;&lt;/em&gt;.&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt; It is worth mentioning that the term was coined by Bertrand Meyer &lt;a href=&quot;https://www.eiffel.com/values/design-by-contract/&quot; rel=&quot;nofollow noreferrer&quot;&gt;in connection with his design of the Eiffel programming language&lt;/a&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;A &lt;code&gt;NullReferenceException&lt;/code&gt; is thrown when we are trying to access Properties of a null object or when a string value becomes empty and we are trying to access string methods.&lt;/p&gt;\n\n&lt;p&gt;For example: &lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;When a string method of an empty string accessed:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; str = &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;.Empty;\nstr.ToLower(); &lt;span class=&quot;hljs-comment&quot;&gt;// throw null reference exception&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;When a property of a null object accessed:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Public Class Person {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; Name { &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;; &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;; }\n}\nPerson objPerson;\nobjPerson.Name  &lt;span class=&quot;hljs-comment&quot;&gt;&lt;span class=&quot;hljs-doctag&quot;&gt;///&lt;/span&gt; throw Null refernce Exception &lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;/ol&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;TL;DR:&lt;/strong&gt; Try using &lt;code&gt;Html.Partial&lt;/code&gt; instead of &lt;code&gt;Renderpage&lt;/code&gt;&lt;/p&gt;\n\n&lt;hr&gt;\n\n&lt;p&gt;I was getting &lt;code&gt;Object reference not set to an instance of an object&lt;/code&gt; when I tried to render a View within a View by sending it a Model, like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;@{\n    &lt;span class=&quot;hljs-type&quot;&gt;MyEntity&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;();\n}\n&lt;span class=&quot;hljs-meta&quot;&gt;@RenderPage(&quot;_MyOtherView.cshtml&quot;, M)&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;// error in _MyOtherView, the Model was Null&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Debugging showed the model was Null inside MyOtherView. Until I changed it to:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;@{\n    &lt;span class=&quot;hljs-type&quot;&gt;MyEntity&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;M&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;();\n}\n&lt;span class=&quot;hljs-meta&quot;&gt;@Html&lt;/span&gt;.Partial(&lt;span class=&quot;hljs-string&quot;&gt;&quot;_MyOtherView.cshtml&quot;&lt;/span&gt;, M);\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And it worked.&lt;/p&gt;\n\n&lt;p&gt;Furthermore, the reason I didn&apos;t have &lt;code&gt;Html.Partial&lt;/code&gt; to begin with was because Visual Studio &lt;strong&gt;sometimes&lt;/strong&gt; throws error-looking squiggly lines under &lt;code&gt;Html.Partial&lt;/code&gt; if it&apos;s inside a differently constructed &lt;code&gt;foreach&lt;/code&gt; loop, even though it&apos;s not really an error:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-typescript&quot;&gt;&lt;span class=&quot;hljs-meta&quot;&gt;@inherits&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;System&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Web&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Mvc&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;WebViewPage&lt;/span&gt;\n@{\n    &lt;span class=&quot;hljs-title class_&quot;&gt;ViewBag&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;Title&lt;/span&gt; = &lt;span class=&quot;hljs-string&quot;&gt;&quot;Entity Index&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-title class_&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;&amp;gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntities&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;List&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;&amp;gt;();\n    &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntities&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;Add&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;());\n    &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntities&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;Add&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;());\n    &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntities&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;Add&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;MyEntity&lt;/span&gt;());\n}\n&amp;lt;div&amp;gt;\n    @{\n        &lt;span class=&quot;hljs-title function_&quot;&gt;foreach&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; M &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; MyEntities&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// Squiggly lines below. Hovering says: cannot convert method group &apos;partial&apos; to non-delegate type Object, did you intend to envoke the Method?&lt;/span&gt;\n            &lt;span class=&quot;hljs-meta&quot;&gt;@Html&lt;/span&gt;.&lt;span class=&quot;hljs-title class_&quot;&gt;Partial&lt;/span&gt;(&lt;span class=&quot;hljs-string&quot;&gt;&quot;MyOtherView.cshtml&quot;&lt;/span&gt;);\n        }\n    }\n&amp;lt;/div&amp;gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;But I was able to run the application with no problems with this &quot;error&quot;. I was able to get rid of the error by changing the structure of the &lt;code&gt;foreach&lt;/code&gt; loop to look like this:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;@&lt;span class=&quot;hljs-title function_&quot;&gt;foreach&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; M &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; MyEntities&lt;/span&gt;){\n    ...\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Although I have a feeling it was because Visual Studio was misreading the ampersands and brackets.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;What can you do about it?&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;There is a lot of good answers here explaining what a null reference is and how to debug it. But there is very little on how to prevent the issue or at least make it easier to catch.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Check arguments&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;For example, methods can check the different arguments to see if they are null and throw an &lt;code&gt;ArgumentNullException&lt;/code&gt;, an exception obviously created for this exact purpose. &lt;/p&gt;\n\n&lt;p&gt;The constructor for the &lt;code&gt;ArgumentNullException&lt;/code&gt; even takes the name of the parameter and a message as arguments so you can tell the developer exactly what the problem is.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;DoSomething&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;MyObject obj&lt;/span&gt;)&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt;(obj == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) \n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; ArgumentNullException(&lt;span class=&quot;hljs-string&quot;&gt;&quot;obj&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;Need a reference to obj.&quot;&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Use Tools&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;There are also several libraries that can help. &quot;Resharper&quot; for example can provide you with warnings while you are writing code, especially if you use their attribute: &lt;a href=&quot;https://www.jetbrains.com/resharper/help/Reference__Code_Annotation_Attributes.html#NotNullAttribute&quot; rel=&quot;noreferrer&quot;&gt;NotNullAttribute&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;There&apos;s &quot;Microsoft Code Contracts&quot; where you use syntax like &lt;code&gt;Contract.Requires(obj != null)&lt;/code&gt; which gives you runtime and compile checking: &lt;a href=&quot;http://www.codeproject.com/Articles/103779/Introducing-Code-Contracts&quot; rel=&quot;noreferrer&quot;&gt;Introducing Code Contracts&lt;/a&gt;.&lt;/p&gt;\n\n&lt;p&gt;There&apos;s also &quot;PostSharp&quot; which will allow you to just use attributes like this: &lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;DoSometing&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;([NotNull] obj)&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;By doing that and making PostSharp part of your build process &lt;code&gt;obj&lt;/code&gt; will be checked for null at runtime. See: &lt;a href=&quot;http://www.postsharp.net/blog/post/Validating-parameters-field-and-properties-in-PostSharp-3&quot; rel=&quot;noreferrer&quot;&gt;PostSharp null check&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Plain Code Solution&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Or you can always code your own approach using plain old code. For example here is a struct that you can use to catch null references. It&apos;s modeled after the same concept as &lt;code&gt;Nullable&amp;lt;T&amp;gt;&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;[&lt;span class=&quot;hljs-meta&quot;&gt;System.Diagnostics.DebuggerNonUserCode&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;struct&lt;/span&gt; NotNull&amp;lt;T&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; T: &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; T _value;\n\n    &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; T Value\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (_value == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;hljs-string&quot;&gt;&quot;null value not allowed&quot;&lt;/span&gt;);\n            }\n\n            &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; _value;\n        }\n        &lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n            {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;hljs-string&quot;&gt;&quot;null value not allowed.&quot;&lt;/span&gt;);\n            }\n\n            _value = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;;\n        }\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;NotNull&amp;lt;T&amp;gt; notNullValue&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; notNullValue.Value;\n    }\n\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;implicit&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;operator&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;NotNull&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;T &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt;&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; NotNull&amp;lt;T&amp;gt; { Value = &lt;span class=&quot;hljs-keyword&quot;&gt;value&lt;/span&gt; };\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;You would use very similar to the same way you would use &lt;code&gt;Nullable&amp;lt;T&amp;gt;&lt;/code&gt;, except with the goal of accomplishing exactly the opposite - to not allow &lt;code&gt;null&lt;/code&gt;. Here are some examples:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-swift&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;NotNull&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt;&amp;gt; person &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; null; &lt;span class=&quot;hljs-comment&quot;&gt;// throws exception&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;NotNull&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt;&amp;gt; person &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; new &lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt;(); &lt;span class=&quot;hljs-comment&quot;&gt;// OK&lt;/span&gt;\n&lt;span class=&quot;hljs-type&quot;&gt;NotNull&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt;&amp;gt; person &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;GetPerson&lt;/span&gt;(); &lt;span class=&quot;hljs-comment&quot;&gt;// throws exception if GetPerson() returns null&lt;/span&gt;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;code&gt;NotNull&amp;lt;T&amp;gt;&lt;/code&gt; is implicitly cast to and from &lt;code&gt;T&lt;/code&gt; so you can use it just about anywhere you need it. For example, you can pass a &lt;code&gt;Person&lt;/code&gt; object to a method that takes a &lt;code&gt;NotNull&amp;lt;Person&amp;gt;&lt;/code&gt;:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-java&quot;&gt;&lt;span class=&quot;hljs-type&quot;&gt;Person&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;person&lt;/span&gt; &lt;span class=&quot;hljs-operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Person&lt;/span&gt; { Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;John&quot;&lt;/span&gt; };\nWriteName(person);\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;WriteName&lt;/span&gt;&lt;span class=&quot;hljs-params&quot;&gt;(NotNull&amp;lt;Person&amp;gt; person)&lt;/span&gt;\n{\n    Console.WriteLine(person.Value.Name);\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;As you can see above as with nullable you would access the underlying value through the &lt;code&gt;Value&lt;/code&gt; property. Alternatively, you can use an explicit or implicit cast, you can see an example with the return value below:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Person person = GetPerson();\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; NotNull&amp;lt;Person&amp;gt; &lt;span class=&quot;hljs-title&quot;&gt;GetPerson&lt;/span&gt;()&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Person { Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;John&quot;&lt;/span&gt; };\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Or you can even use it when the method just returns &lt;code&gt;T&lt;/code&gt; (in this case &lt;code&gt;Person&lt;/code&gt;) by doing a cast. For example, the following code would just like the code above:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;Person person = (NotNull&amp;lt;Person&amp;gt;)GetPerson();\n\n&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; Person &lt;span class=&quot;hljs-title&quot;&gt;GetPerson&lt;/span&gt;()&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Person { Name = &lt;span class=&quot;hljs-string&quot;&gt;&quot;John&quot;&lt;/span&gt; };\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;&lt;strong&gt;Combine with Extension&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;Combine &lt;code&gt;NotNull&amp;lt;T&amp;gt;&lt;/code&gt; with an extension method and you can cover even more situations. Here is an example of what the extension method can look like:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;[&lt;span class=&quot;hljs-meta&quot;&gt;System.Diagnostics.DebuggerNonUserCode&lt;/span&gt;]\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;NotNullExtension&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; T &lt;span class=&quot;hljs-title&quot;&gt;NotNull&lt;/span&gt;&amp;lt;&lt;span class=&quot;hljs-title&quot;&gt;T&lt;/span&gt;&amp;gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt; T @&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;&lt;/span&gt;) &lt;span class=&quot;hljs-keyword&quot;&gt;where&lt;/span&gt; T: &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt;&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (@this == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;)\n        {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;hljs-string&quot;&gt;&quot;null value not allowed&quot;&lt;/span&gt;);\n        }\n\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; @this;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;And here is an example of how it could be used:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; person = GetPerson().NotNull();\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;GitHub&lt;/p&gt;\n\n&lt;p&gt;For your reference I made the code above available on GitHub, you can find it at:&lt;/p&gt;\n\n&lt;p&gt;&lt;a href=&quot;https://github.com/luisperezphd/NotNull&quot; rel=&quot;noreferrer&quot;&gt;https://github.com/luisperezphd/NotNull&lt;/a&gt;&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Related Language Feature&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;C# 6.0 introduced the &quot;null-conditional operator&quot; that helps with this a little. With this feature, you can reference nested objects and if any one of them is &lt;code&gt;null&lt;/code&gt; the whole expression returns &lt;code&gt;null&lt;/code&gt;.&lt;/p&gt;\n\n&lt;p&gt;This reduces the number of null checks you have to do in some cases. The syntax is to put a question mark before each dot. Take the following code for example:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; address = country?.State?.County?.City;\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Imagine that &lt;code&gt;country&lt;/code&gt; is an object of type &lt;code&gt;Country&lt;/code&gt; that has a property called &lt;code&gt;State&lt;/code&gt; and so on. If &lt;code&gt;country&lt;/code&gt;, &lt;code&gt;State&lt;/code&gt;, &lt;code&gt;County&lt;/code&gt;, or &lt;code&gt;City&lt;/code&gt; is &lt;code&gt;null&lt;/code&gt; then &lt;code&gt;address will be&lt;/code&gt;null&lt;code&gt;. Therefore you only have to check whether&lt;/code&gt;address&lt;code&gt;is&lt;/code&gt;null`.&lt;/p&gt;\n\n&lt;p&gt;It&apos;s a great feature, but it gives you less information. It doesn&apos;t make it obvious which of the 4 is null.&lt;/p&gt;\n\n&lt;p&gt;&lt;strong&gt;Built-in like Nullable?&lt;/strong&gt;&lt;/p&gt;\n\n&lt;p&gt;C# has a nice shorthand for &lt;code&gt;Nullable&amp;lt;T&amp;gt;&lt;/code&gt;, you can make something nullable by putting a question mark after the type like so &lt;code&gt;int?&lt;/code&gt;. &lt;/p&gt;\n\n&lt;p&gt;It would be nice if C# had something like the &lt;code&gt;NotNull&amp;lt;T&amp;gt;&lt;/code&gt; struct above and had a similar shorthand, maybe the exclamation point (!) so that you could write something like: &lt;code&gt;public void WriteName(Person! person)&lt;/code&gt;.&lt;/p&gt;\n    ","\n&lt;p&gt;You can fix NullReferenceException in a clean way using Null-conditional Operators in C# 6 and write less code to handle null checks.&lt;/p&gt;\n&lt;p&gt;It&apos;s used to test for null before performing a member access (?.) or index (?[) operation.&lt;/p&gt;\n&lt;h3&gt;Example&lt;/h3&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-delphi&quot;&gt;  &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;name&lt;/span&gt; = p?.Spouse?.FirstName;\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;It is equivalent to:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-yaml&quot;&gt;    &lt;span class=&quot;hljs-string&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;(p&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-string&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;(p.Spouse&lt;/span&gt; &lt;span class=&quot;hljs-type&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;hljs-string&quot;&gt;)&lt;/span&gt;\n        {\n            &lt;span class=&quot;hljs-string&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;p.Spouse.FirstName;&lt;/span&gt;\n        }\n    }\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The result is that the name will be null when p is null or when p.Spouse is null.&lt;/p&gt;\n&lt;p&gt;Otherwise, the variable name will be assigned the value of the p.Spouse.FirstName.&lt;/p&gt;\n&lt;p&gt;For &lt;em&gt;more&lt;/em&gt; details: &lt;a href=&quot;https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/operators/null-conditional-operators&quot; rel=&quot;nofollow noreferrer&quot;&gt;Null-conditional Operators&lt;/a&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Interestingly, none of the answers on this page mention the two edge cases:&lt;/p&gt;\n&lt;h2&gt;Edge case #1: concurrent access to a Dictionary&lt;/h2&gt;\n&lt;p&gt;Generic dictionaries in .NET are not thread-safe and they &lt;em&gt;sometimes&lt;/em&gt; might throw a &lt;code&gt;NullReference&lt;/code&gt; or even (more frequent) a &lt;code&gt;KeyNotFoundException&lt;/code&gt; when you try to access a key from two concurrent threads. The exception is quite misleading in this case.&lt;/p&gt;\n&lt;h2&gt;Edge case #2: unsafe code&lt;/h2&gt;\n&lt;p&gt;If a &lt;code&gt;NullReferenceException&lt;/code&gt; is thrown by &lt;code&gt;unsafe&lt;/code&gt; code, you might look at your pointer variables, and check them for &lt;code&gt;IntPtr.Zero&lt;/code&gt; or something. Which is the same thing (&quot;null pointer exception&quot;), but in unsafe code, variables are often cast to value-types/arrays, etc., and you bang your head against the wall, wondering how a value-type can throw this exception.&lt;/p&gt;\n&lt;p&gt;(Another reason for non-using unsafe code unless you need it, by the way.)&lt;/p&gt;\n&lt;h2&gt;Edge case #3: Visual Studio multi monitor setup with secondary monitor(s) that has different DPI setting than the primary monitor&lt;/h2&gt;\n&lt;p&gt;This edge case is software-specific and pertains to the &lt;a href=&quot;https://en.wikipedia.org/wiki/Microsoft_Visual_Studio#2019&quot; rel=&quot;nofollow noreferrer&quot;&gt;Visual&amp;nbsp;Studio&amp;nbsp;2019&lt;/a&gt; IDE (and possibly earlier versions).&lt;/p&gt;\n&lt;p&gt;A method to reproduce the problem: drag any component from the Toolbox to a Windows form on a non-primary monitor with different DPI setting than the primary monitor, and you get a pop-up with Object reference not set to an instance of an object. According to &lt;a href=&quot;https://developercommunity.visualstudio.com/content/problem/824685/adding-any-component-to-winform-in-vs2019-gives-ob.html&quot; rel=&quot;nofollow noreferrer&quot;&gt;this thread&lt;/a&gt;, this issue has been known for quite some time and at the time of writing it still hasn&apos;t been fixed.&lt;/p&gt;\n    ","\n&lt;p&gt;The error line &quot;Object reference not set to an instance of an object.&quot; states that you have not assigned an instance object to a object reference and still you are accessing properties/methods of that object.&lt;/p&gt;\n&lt;p&gt;For example: let&apos;s say you have a class called myClass and it contains one property, &lt;em&gt;prop1&lt;/em&gt;.&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; Class myClass\n{\n   &lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;int&lt;/span&gt; prop1 {&lt;span class=&quot;hljs-keyword&quot;&gt;get&lt;/span&gt;;&lt;span class=&quot;hljs-keyword&quot;&gt;set&lt;/span&gt;;}\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Now you are accessing this prop1 in some other class just like below:&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Demo&lt;/span&gt;\n{\n     &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;testMethod&lt;/span&gt;()&lt;/span&gt;\n     {\n        myClass &lt;span class=&quot;hljs-keyword&quot;&gt;ref&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;ref&lt;/span&gt;.prop1 = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;  &lt;span class=&quot;hljs-comment&quot;&gt;// This line throws an error&lt;/span&gt;\n     }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The above line throws an error because reference of class myClass is declared, but not instantiated or an instance of object is not assigned to a reference of that class.&lt;/p&gt;\n&lt;p&gt;To fix this you have to instantiate (assign an object to a reference of that class).&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Demo&lt;/span&gt;\n{\n     &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;testMethod&lt;/span&gt;()&lt;/span&gt;\n     {\n        myClass &lt;span class=&quot;hljs-keyword&quot;&gt;ref&lt;/span&gt; = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;ref&lt;/span&gt; = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; myClass();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;ref&lt;/span&gt;.prop1 = &lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;;\n     }\n}\n&lt;/code&gt;&lt;/pre&gt;\n    ","\n&lt;p&gt;NullReferenceException or Object reference not set to an instance of an object occurs when an object of the class you are trying to use is not instantiated.\nFor example:&lt;/p&gt;\n\n&lt;p&gt;Assume that you have a class named Student.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Student&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; FirstName;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; LastName;\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetFullName&lt;/span&gt;()&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; FirstName + LastName;\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Now, consider another class where you are trying to retrieve the student&apos;s full name.&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;StudentInfo&lt;/span&gt;\n{      \n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;GetStudentName&lt;/span&gt;()&lt;/span&gt;\n    {\n        Student s;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; fullname = s.GetFullName();\n        &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; fullname;\n    }        \n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;As seen in the above code, the statement \n&lt;strong&gt;Student s&lt;/strong&gt; - only declares the variable of type Student, note that the Student class is not instantiated at this point.\nHence, when the statement &lt;strong&gt;s.GetFullName()&lt;/strong&gt; gets executed, it will throw the NullReferenceException.  &lt;/p&gt;\n    ","\n&lt;p&gt;Well, in simple terms:&lt;/p&gt;\n\n&lt;p&gt;You are trying to access an object that isn&apos;t created or currently not in memory.&lt;/p&gt;\n\n&lt;p&gt;So how to tackle this:&lt;/p&gt;\n\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Debug and let the debugger break... It will directly take you to the variable that is broken... Now your task is to simply fix this.. Using the &lt;strong&gt;new&lt;/strong&gt; keyword in the appropriate place.&lt;/p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;If it is caused on some &lt;strong&gt;database&lt;/strong&gt; commands because the object isn&apos;t present then all you need to do is do a null check and handle it:&lt;/p&gt;\n\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (i == &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// Handle this&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;The hardest one .. if the &lt;strong&gt;&lt;a href=&quot;http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29&quot; rel=&quot;noreferrer&quot;&gt;GC&lt;/a&gt;&lt;/strong&gt; collected the object already... This generally occurs if you are trying to find an object using strings... That is, finding it by name of the object then it may happen that the GC might already cleaned it up... This is hard to find and will become quite a problem... A better way to tackle this is do null checks wherever necessary during the development process. This will save you a lot of time.&lt;/p&gt;&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p&gt;By finding by name I mean some framework allow you to FIndObjects using strings and the code might look like this: &lt;strong&gt;FindObject(&quot;ObjectName&quot;);&lt;/strong&gt;&lt;/p&gt;\n    ","\n&lt;p&gt;Literally the easiest way to fix a NullReferenceExeption has two ways.&lt;/p&gt;\n&lt;p&gt;If you have a GameObject for example with a script attached and a variable named &lt;em&gt;rb&lt;/em&gt; (rigidbody) this variable will start with null when you start your game.\nThis is why you get a NullReferenceExeption because the computer does not have data stored in that variable.&lt;/p&gt;\n&lt;p&gt;I&apos;ll be using a RigidBody variable as an example.\nWe can add data really easily actually in a few ways:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;Add a RigidBody to your object with AddComponent &amp;gt; Physics &amp;gt; Rigidbody\nThen go into your script and type &lt;code&gt;rb = GetComponent&amp;lt;Rigidbody&amp;gt;();&lt;/code&gt;\nThis line of code works best under your &lt;code&gt;Start()&lt;/code&gt; or &lt;code&gt;Awake()&lt;/code&gt; functions.&lt;/li&gt;\n&lt;li&gt;You can add a component programmatically and assign the variable at the same time with one line of code: &lt;code&gt;rb = AddComponent&amp;lt;RigidBody&amp;gt;();&lt;/code&gt;&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;Further Notes: If you want &lt;a href=&quot;https://en.wikipedia.org/wiki/Unity_(game_engine)&quot; rel=&quot;nofollow noreferrer&quot;&gt;Unity&lt;/a&gt; to add a component to your object and you might have forgotten to add one, you can type &lt;code&gt;[RequireComponent(typeof(RigidBody))]&lt;/code&gt; above your class declaration (the space below all of your &lt;em&gt;using&lt;/em&gt;s).&lt;/p&gt;\n&lt;p&gt;Enjoy and have fun making games!&lt;/p&gt;\n    ","\n&lt;p&gt;If one is getting this message during saving or compiling the build, just close all the files and then open any file to compile and save.&lt;/p&gt;\n&lt;p&gt;For me the reason was that I had rename the file and the old file was still open.&lt;/p&gt;\n    ","\n&lt;p&gt;&lt;strong&gt;This is basically is a Null reference exception&lt;/strong&gt;. As &lt;a href=&quot;https://msdn.microsoft.com/en-us/library/system.nullreferenceexception(v=vs.110).aspx&quot; rel=&quot;nofollow noreferrer&quot;&gt;Microsoft&lt;/a&gt; states-&lt;/p&gt;\n&lt;blockquote&gt;\n&lt;p&gt;A NullReferenceException exception is thrown when you try to access a\nmember of a type whose value is null.&lt;/p&gt;\n&lt;/blockquote&gt;\n&lt;h2&gt;What does that mean?&lt;/h2&gt;\n&lt;p&gt;That means if any member which doesnt hold any value and we are making that member to perform certain task then the system will undoubtedly toss a message and say-&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;Hey wait, that member has no values so it cant perform the task which you are handing it over.&lt;/em&gt;&lt;/p&gt;\n&lt;p&gt;The exception itself says that something is being referred but whose value is not being set. So this denotes that it only occurs while using reference types as Value types are non-nullable.&lt;/p&gt;\n&lt;p&gt;NullReferenceException won&apos;t occur if we are using Value type members.&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Program&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Main&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;[] args&lt;/span&gt;)&lt;/span&gt;\n    {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt; str = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        Console.WriteLine(str.Length);\n        Console.ReadLine();\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;The above code shows simple string which is assigned with a &lt;strong&gt;null&lt;/strong&gt; value.&lt;/p&gt;\n&lt;p&gt;Now, when I try to print the length of the string &lt;strong&gt;str&lt;/strong&gt;, I do get &lt;em&gt;An unhandled exception of type System.NullReferenceException occurred&lt;/em&gt; message because member &lt;strong&gt;str&lt;/strong&gt; is pointing to null and there cant be any length of null.&lt;/p&gt;\n&lt;p&gt;&lt;em&gt;&lt;strong&gt;NullReferenceException&lt;/strong&gt;&lt;/em&gt; also occurs when we forget to instantiate a reference type.&lt;/p&gt;\n&lt;p&gt;Suppose I have a class and member method in it. I have not instantiated my class but only named my class. Now if I try to use the method, the compiler will throw an error or issue a warning (depending on the compiler).&lt;/p&gt;\n&lt;pre class=&quot;default s-code-block&quot;&gt;&lt;code class=&quot;hljs language-csharp&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Program&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;Main&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;span class=&quot;hljs-built_in&quot;&gt;string&lt;/span&gt;[] args&lt;/span&gt;)&lt;/span&gt;\n    {\n        MyClass1 obj;\n        obj.foo();  &lt;span class=&quot;hljs-comment&quot;&gt;// Use of unassigned local variable &apos;obj&apos;&lt;/span&gt;\n    }\n}\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;MyClass1&lt;/span&gt;\n{\n    &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;internal&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;foo&lt;/span&gt;()&lt;/span&gt;\n    {\n        Console.WriteLine(&lt;span class=&quot;hljs-string&quot;&gt;&quot;Hello from foo&quot;&lt;/span&gt;);\n    }\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;Compiler for the above code raises an error that variable &lt;strong&gt;obj&lt;/strong&gt; is unassigned which signifies that our variable has null values or nothing. Compiler for the above code raises an error that variable &lt;strong&gt;obj&lt;/strong&gt; is unassigned which signifies that our variable has null values or nothing.&lt;/p&gt;\n&lt;h2&gt;Why does it occur?&lt;/h2&gt;\n&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;NullReferenceException arises due to our fault for not checking the objects value. We often leave the object values unchecked in the code development.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;It also arises when we forget to instantiate our objects. Using methods, properties, collections etc. which can return or set null values can also be the cause of this exception.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ul&gt;\n&lt;h2&gt;How can it be avoided?&lt;/h2&gt;\n&lt;p&gt;There are various ways and methods to avoid this renowned exception:&lt;/p&gt;\n&lt;ol&gt;\n&lt;li&gt;&lt;p&gt;Explicit Checking: We should adhere to the tradition of checking the objects, properties, methods, arrays, and collections whether they are null. This can be simply implemented using conditional statements like if-else if-else etc.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Exception handling: One of the important ways of managing this exception. Using simple try-catch-finally blocks we can control this exception and also maintain a log of it. This can be very useful when your application is on production stage.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Null operators: Null Coalescing operator and null conditional operators can also be used in handy while setting values to objects, variables, properties and fields.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Debugger: For developers, we have the big weapon of Debugging with us. If have we face NullReferenceException during the development face we can use the debugger to get to the source of the exception.&lt;/p&gt;\n&lt;/li&gt;\n&lt;li&gt;&lt;p&gt;Built-in method: System methods such as GetValueOrDefault(), IsNullOrWhiteSpace(), and IsNullorEmpty() checks for nulls and assign the default value if there is a null value.&lt;/p&gt;\n&lt;/li&gt;\n&lt;/ol&gt;\n&lt;p&gt;There are many good answers already here. You can also check more detailed description with examples on my &lt;a href=&quot;https://www.mistercode.net/2017/07/09/object-reference-not-set-to-an-instance-of-an-object/&quot; rel=&quot;nofollow noreferrer&quot;&gt;blog&lt;/a&gt;.&lt;/p&gt;\n&lt;p&gt;Hope this helps too!&lt;/p&gt;\n    "]},"randomTags":[{"name":"iec10967","slug":"iec10967"},{"name":"c++","slug":"c++"},{"name":"precision","slug":"precision"},{"name":"linux","slug":"linux"},{"name":"universal-image-loader","slug":"universal-image-loader"},{"name":"firebase","slug":"firebase"},{"name":"event-bubbling","slug":"event-bubbling"},{"name":"ssl-certificate","slug":"ssl-certificate"},{"name":"tabs","slug":"tabs"},{"name":"http","slug":"http"},{"name":"scope","slug":"scope"},{"name":"angular","slug":"angular"},{"name":"ajax","slug":"ajax"},{"name":"xhtml","slug":"xhtml"},{"name":"hex","slug":"hex"},{"name":"restriction","slug":"restriction"},{"name":"list","slug":"list"},{"name":"c#","slug":"c"},{"name":"serialization","slug":"serialization"},{"name":"subprocess","slug":"subprocess"}]},"__N_SSG":true}