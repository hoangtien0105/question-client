{"pageProps":{"data":{"count":1,"rows":[{"answer":["\n&lt;p&gt;The &lt;a href=&quot;https://github.com/petkaantonov/bluebird/wiki/Promise-anti-patterns#the-deferred-anti-pattern&quot; rel=&quot;noreferrer&quot;&gt;deferred antipattern (now explicit-construction anti-pattern)&lt;/a&gt; coined by &lt;a href=&quot;https://stackoverflow.com/users/995876/esailija&quot;&gt;Esailija&lt;/a&gt; is a common anti-pattern people who are new to promises make, I&apos;ve made it myself when I first used promises. The problem with the above code is that is fails to utilize the fact that promises chain.&lt;/p&gt;\n\n&lt;p&gt;Promises can chain with &lt;code&gt;.then&lt;/code&gt; and you can return promises directly. Your code in &lt;code&gt;getStuffDone&lt;/code&gt; can be rewritten as:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getStuffDone&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;param&lt;/span&gt;){\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;myPromiseFn&lt;/span&gt;(param+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;); &lt;span class=&quot;hljs-comment&quot;&gt;// much nicer, right?&lt;/span&gt;\n}\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Promises are all about making asynchronous code more readable and behave like synchronous code without hiding that fact. Promises represent an abstraction over a value of one time operation, they abstract the notion of a statement or expression in a programming language.&lt;/p&gt;\n\n&lt;p&gt;You should only use deferred objects when you are &lt;a href=&quot;https://stackoverflow.com/questions/22519784/how-do-i-convert-an-existing-callback-api-to-promises&quot;&gt;converting an API to promises&lt;/a&gt; and can&apos;t do it automatically, or when you&apos;re writing aggregation functions that are easier expressed this way. &lt;/p&gt;\n\n&lt;p&gt;Quoting Esailija:&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;This is the most common anti-pattern. It is easy to fall into this when you don&apos;t really understand promises and think of them as glorified event emitters or callback utility. Let&apos;s recap: promises are about making asynchronous code retain most of the lost properties of synchronous code such as flat indentation and one exception channel.&lt;/p&gt;\n&lt;/blockquote&gt;\n    ","\n&lt;h1&gt;What&apos;s wrong with it?&lt;/h1&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;But the pattern works!&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Lucky you. Unfortunately, it probably doesn&apos;t, as you likely forgot some edge case. In more than half of the occurrences I&apos;ve seen, the author has forgotten to take care of the error handler:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;resolve&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title function_&quot;&gt;getOtherPromise&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;result&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-title function_&quot;&gt;resolve&lt;/span&gt;(result.&lt;span class=&quot;hljs-property&quot;&gt;property&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;example&lt;/span&gt;);\n    });\n})\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;If the other promise is rejected, this will happen unnoticed instead of being propagated to the new promise (where it would get handled) - and the new promise stays forever pending, which can induce leaks.&lt;/p&gt;\n\n&lt;p&gt;The same thing happens in the case that your callback code causes an error - e.g. when &lt;code&gt;result&lt;/code&gt; doesn&apos;t have a &lt;code&gt;property&lt;/code&gt; and an exception is thrown. That would go unhandled and leave the new promise unresolved. &lt;/p&gt;\n\n&lt;p&gt;In contrast, using &lt;code&gt;.then()&lt;/code&gt; does automatically take care of both these scenarios, and rejects the new promise when an error happens:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getOtherPromise&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;result&lt;/span&gt;) {\n     &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result.&lt;span class=&quot;hljs-property&quot;&gt;property&lt;/span&gt;.&lt;span class=&quot;hljs-property&quot;&gt;example&lt;/span&gt;;\n })\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;The deferred antipattern is not only cumbersome, but also &lt;strong&gt;error-prone&lt;/strong&gt;. Using &lt;code&gt;.then()&lt;/code&gt; for chaining is much safer.&lt;/p&gt;\n\n&lt;blockquote&gt;\n  &lt;p&gt;But I&apos;ve handled everything!&lt;/p&gt;\n&lt;/blockquote&gt;\n\n&lt;p&gt;Really? Good. However, this will be pretty detailed and copious, especially if you use a promise library that supports other features like cancellation or message passing. Or maybe it will in the future, or you want to swap your library against a better one? You won&apos;t want to rewrite your code for that.&lt;/p&gt;\n\n&lt;p&gt;The libraries&apos; methods (&lt;code&gt;then&lt;/code&gt;) do not only natively support all the features, they also might have certain optimisations in place. Using them will likely make your code faster, or at least allow to be optimised by future revisions of the library.&lt;/p&gt;\n\n&lt;h1&gt;How do I avoid it?&lt;/h1&gt;\n\n&lt;p&gt;So whenever you find yourself manually creating a &lt;code&gt;Promise&lt;/code&gt; or &lt;code&gt;Deferred&lt;/code&gt; and already existing promises are involved, &lt;strong&gt;check the library API first&lt;/strong&gt;. The Deferred antipattern is often applied by people who see promises [only] as an observer pattern - but &lt;a href=&quot;https://stackoverflow.com/a/22562045/1048572&quot;&gt;promises are &lt;em&gt;more&lt;/em&gt; than callbacks&lt;/a&gt;: they are supposed to be composable. Every decent library has lots of easy-to-use functions for the composition of promises in every thinkable manner, taking care of all the low-level stuff you don&apos;t want to deal with.&lt;/p&gt;\n\n&lt;p&gt;If you have found a need to compose some promises in a new way that is not supported by an existing helper function, writing your own function with unavoidable Deferreds should be your last option. Consider switching to a more featureful library, and/or file a bug against your current library. Its maintainer should be able to derive the composition from existing functions, implement a new helper function for you and/or help to identify the edge cases that need to be handled.&lt;/p&gt;\n    ","\n&lt;p&gt;Now 7 years later there is a simpler answer to this question:&lt;/p&gt;\n&lt;p&gt;&lt;strong&gt;How do I avoid the explicit constructor antipattern?&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;Use &lt;code&gt;async function&lt;/code&gt;s, then &lt;code&gt;await&lt;/code&gt; every Promise!&lt;/p&gt;\n&lt;p&gt;Instead of manually constructing nested Promise chains such as this one:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;promised&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n  &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;resolve&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-title function_&quot;&gt;getOtherPromise&lt;/span&gt;().&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;result&lt;/span&gt;) {\n      &lt;span class=&quot;hljs-title function_&quot;&gt;getAnotherPromise&lt;/span&gt;(result).&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;result2&lt;/span&gt;) {\n        &lt;span class=&quot;hljs-title function_&quot;&gt;resolve&lt;/span&gt;(result2);\n      });\n    });\n  });\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;just turn your function &lt;code&gt;async&lt;/code&gt; and use the &lt;code&gt;await&lt;/code&gt; keyword to &lt;em&gt;stop execution of the function&lt;/em&gt; until the Promise resolves:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;promised&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;&lt;/span&gt;) {\n   &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; result =  &lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getOtherPromise&lt;/span&gt;();\n   &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; result2 = &lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getAnotherPromise&lt;/span&gt;(result);\n   &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; result2;\n}\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;This has various benefits:&lt;/p&gt;\n&lt;ul&gt;\n&lt;li&gt;Calling the &lt;code&gt;async&lt;/code&gt; function always returns a Promise, which resolves with the returned value and rejects if an error get&apos;s thrown inside the async function&lt;/li&gt;\n&lt;li&gt;If an &lt;code&gt;await&lt;/code&gt;ed Promise rejects, the error get&apos;s thrown inside the async function, so you can just &lt;code&gt;try { ... } catch(error) { ... }&lt;/code&gt; it like the synchronous errors.&lt;/li&gt;\n&lt;li&gt;You can &lt;code&gt;await&lt;/code&gt; inside loops and if branches, making most of the Promise chain logic trivial&lt;/li&gt;\n&lt;li&gt;Although async functions behave mostly like chains of Promises, they are way easier to read (and easier to reason about)&lt;/li&gt;\n&lt;/ul&gt;\n&lt;p&gt;&lt;strong&gt;How can I &lt;code&gt;await&lt;/code&gt; a callback?&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;If the callback only calls back once, and the API you are calling does not provide a Promise already (most of them do!) this is the &lt;em&gt;only reason&lt;/em&gt; to use a Promise constructor:&lt;/p&gt;\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt; &lt;span class=&quot;hljs-comment&quot;&gt;// Create a wrapper around the &quot;old&quot; function taking a callback, passing the &apos;resolve&apos; function as callback&lt;/span&gt;\n &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;delay&lt;/span&gt; = time =&amp;gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;resolve, reject&lt;/span&gt;) =&amp;gt;&lt;/span&gt;\n   &lt;span class=&quot;hljs-built_in&quot;&gt;setTimeout&lt;/span&gt;(resolve, time)\n ); \n\n &lt;span class=&quot;hljs-keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;delay&lt;/span&gt;(&lt;span class=&quot;hljs-number&quot;&gt;1000&lt;/span&gt;);\n&lt;/code&gt;&lt;/pre&gt;\n&lt;p&gt;&lt;strong&gt;If &lt;code&gt;await&lt;/code&gt; stops execution, does calling an &lt;code&gt;async function&lt;/code&gt; return the result directly?&lt;/strong&gt;&lt;/p&gt;\n&lt;p&gt;No. If you call an async function, a Promise gets always returned. You can then &lt;code&gt;await&lt;/code&gt; that Promise too inside an async function. You cannot wait for the result inside of a synchronous function (you would have to call &lt;code&gt;.then&lt;/code&gt; and attach a callback).&lt;/p&gt;\n&lt;p&gt;Conceptually, synchronous &lt;code&gt;function&lt;/code&gt;s always run to completion in one job, while &lt;code&gt;async function&lt;/code&gt;s run synchronously till they reach an &lt;code&gt;await&lt;/code&gt;, then they continue in another job.&lt;/p&gt;\n    "],"comment":["\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;or is having the &lt;code&gt;catch&lt;/code&gt; block in the &lt;code&gt;getStuffDone&lt;/code&gt; wrapper the antipattern?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/5689384/the-dembinski&quot; title=&quot;1,410 reputation&quot; class=&quot;comment-user&quot;&gt;The Dembinski&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment70238480_23803743&quot;&gt;&lt;span title=&quot;2017-01-06 23:45:11Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Jan 6, 2017 at 23:45&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;At least for the native &lt;code&gt;Promise&lt;/code&gt; example you also have unnecessary function wrappers for the &lt;code&gt;.then&lt;/code&gt; and &lt;code&gt;.catch&lt;/code&gt; handlers (i.e. it could just be &lt;code&gt;.then(resolve).catch(reject)&lt;/code&gt;.)  A perfect storm of anti-patterns.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1370576/noah-freitas&quot; title=&quot;16,902 reputation&quot; class=&quot;comment-user&quot;&gt;Noah Freitas&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment78892479_23803743&quot;&gt;&lt;span title=&quot;2017-08-30 17:48:42Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 30, 2017 at 17:48&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@NoahFreitas that code is written that way for didactic purposes. I wrote this question and answer in order to help people who run into this issue after reading a lot of code looking like that :)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1348195/benjamin-gruenbaum&quot; title=&quot;261,374 reputation&quot; class=&quot;comment-user owner&quot;&gt;Benjamin Gruenbaum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment78893846_23803743&quot;&gt;&lt;span title=&quot;2017-08-30 18:28:35Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 30, 2017 at 18:28&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;See also &lt;a href=&quot;https://stackoverflow.com/questions/57661537/nested-extended-promises-seem-to-require-a-global-variable&quot; title=&quot;nested extended promises seem to require a global variable&quot;&gt;stackoverflow.com/questions/57661537/&lt;/a&gt; for how to eliminate not only explicit Promise construction, but the use of a global variable as well.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2184308/david-spector&quot; title=&quot;1,249 reputation&quot; class=&quot;comment-user&quot;&gt;David Spector&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment101778484_23803743&quot;&gt;&lt;span title=&quot;2019-08-26 21:01:41Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 26, 2019 at 21:01&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;What&apos;s up the odd side-by-side code examples? Never seen that here before, find it quite confusing. Had to check the revision history to understand that both are example of the same thing.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/681538/alex&quot; title=&quot;13,308 reputation&quot; class=&quot;comment-user&quot;&gt;Alex&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment121348447_23803743&quot;&gt;&lt;span title=&quot;2021-08-05 10:11:30Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 5, 2021 at 10:11&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@BenjaminGruenbaum: I&apos;m confident in my use of deferreds for this, so no need for a new question. I just thought it was a use-case you were missing from your answer. What I&apos;m doing seems more like the opposite of aggregation, doesn&apos;t it?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/681588/mhelvens&quot; title=&quot;4,035 reputation&quot; class=&quot;comment-user&quot;&gt;mhelvens&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment40803418_23803744&quot;&gt;&lt;span title=&quot;2014-09-25 19:43:31Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 25, 2014 at 19:43&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@mhelvens If you&apos;re manually splitting a non-callback API into a promise API that fits the &quot;converting a callback API to promises&quot; part. The antipattern is about wrapping a promise in another promise for no good reason, you&apos;re not wrapping a promise to begin with so it doesn&apos;t apply here.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1348195/benjamin-gruenbaum&quot; title=&quot;261,374 reputation&quot; class=&quot;comment-user owner&quot;&gt;Benjamin Gruenbaum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment40803520_23803744&quot;&gt;&lt;span title=&quot;2014-09-25 19:47:10Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 25, 2014 at 19:47&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@BenjaminGruenbaum: Ah, I though deferreds themselves were considered an anti-pattern, what with bluebird deprecating them, and you mentioning &quot;converting an API to promises&quot; (which is also a case of not wrapping a promise to begin with).&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/681588/mhelvens&quot; title=&quot;4,035 reputation&quot; class=&quot;comment-user&quot;&gt;mhelvens&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment40804077_23803744&quot;&gt;&lt;span title=&quot;2014-09-25 20:05:15Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 25, 2014 at 20:05&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@mhelvens I guess the &lt;i&gt;excess&lt;/i&gt; deferred anti pattern would be more accurate for what it actually does. Bluebird deprecated the &lt;code&gt;.defer()&lt;/code&gt; api into the newer (and throw safe) promise constructor, it did not (in no way) deprecate the notion of constructing promises :)&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1348195/benjamin-gruenbaum&quot; title=&quot;261,374 reputation&quot; class=&quot;comment-user owner&quot;&gt;Benjamin Gruenbaum&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment40804126_23803744&quot;&gt;&lt;span title=&quot;2014-09-25 20:06:44Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Sep 25, 2014 at 20:06&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Thank you @Roamer-1888 your reference helped me finally figuring out what was my issue. Looks like I was creating nested (unreturned) promises without realising it.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/3390601/ghuroo&quot; title=&quot;198 reputation&quot; class=&quot;comment-user&quot;&gt;ghuroo&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment75512568_23803744&quot;&gt;&lt;span title=&quot;2017-05-30 01:21:12Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;May 30, 2017 at 1:21&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 2 times&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Are there examples , other than a function including &lt;code&gt;setTimeout&lt;/code&gt; , where constructor could be used but not be considered &quot;Promise constructor anitpattern&quot; ?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2801559/guest271314&quot; title=&quot;1 reputation&quot; class=&quot;comment-user&quot;&gt;guest271314&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55526826_25569299&quot;&gt;&lt;span title=&quot;2015-11-23 21:39:08Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 23, 2015 at 21:39&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@guest271314: Everything asynchronous that doesn&apos;t return a promise. Though often enough you get better results with the libraries&apos; dedicated promisification helpers. And make sure to always promisify at the lowest level, so it&apos;s not &quot;&lt;i&gt;a function including &lt;code&gt;setTimeout&lt;/code&gt;&lt;/i&gt;&quot;, but &quot;&lt;i&gt;the function &lt;code&gt;setTimeout&lt;/code&gt; itself&lt;/i&gt;&quot;.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1048572/bergi&quot; title=&quot;577,643 reputation&quot; class=&quot;comment-user&quot;&gt;Bergi&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55527854_25569299&quot;&gt;&lt;span title=&quot;2015-11-23 22:13:26Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 23, 2015 at 22:13&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@guest271314 A function that just includes a call to &lt;code&gt;setTimeout&lt;/code&gt; is clearly different from &lt;i&gt;the function &lt;code&gt;setTimeout&lt;/code&gt; itself&lt;/i&gt;, isn&apos;t it?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/1048572/bergi&quot; title=&quot;577,643 reputation&quot; class=&quot;comment-user&quot;&gt;Bergi&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55528098_25569299&quot;&gt;&lt;span title=&quot;2015-11-23 22:21:29Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 23, 2015 at 22:21&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Perhaps not aware of clear difference , here.  &lt;code&gt;function () {setTimeout(dostuff, duration)}&lt;/code&gt; ,  &lt;code&gt;setTimeout(dostuff, duration)&lt;/code&gt; ? Can describe context difference between two , if above two variations are , or are not , accurate representation of &lt;i&gt;&quot; call to setTimeout is clearly different from the function setTimeout&quot;&lt;/i&gt; ?&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2801559/guest271314&quot; title=&quot;1 reputation&quot; class=&quot;comment-user&quot;&gt;guest271314&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment55528252_25569299&quot;&gt;&lt;span title=&quot;2015-11-23 22:26:32Z, License: CC BY-SA 3.0&quot; class=&quot;relativetime-clean&quot;&gt;Nov 23, 2015 at 22:26&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 4 times&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;I think one of the important lessons here, one that has not been clearly stated so far, is that a Promise and its chained &apos;then&apos; represents one asynchronous operation: the initial operation is in the Promise constructor and the eventual endpoint is in the &apos;then&apos; function. So if you have a sync operation followed by an asynch operation, put the sync stuff in the Promise. If you have an async operation followed by a sync, put the sync stuff in the &apos;then&apos;. In the first case, return the original Promise. In the second case, return the Promise/then chain (which is also a Promise).&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/2184308/david-spector&quot; title=&quot;1,249 reputation&quot; class=&quot;comment-user&quot;&gt;David Spector&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment101781397_25569299&quot;&gt;&lt;span title=&quot;2019-08-27 00:44:18Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Aug 27, 2019 at 0:44&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 1 time&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;The whole point of using an async function is so you &lt;i&gt;don&apos;t&lt;/i&gt; stop execution....&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/396483/john-ktejik&quot; title=&quot;5,619 reputation&quot; class=&quot;comment-user&quot;&gt;john ktejik&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment120310837_66747114&quot;&gt;&lt;span title=&quot;2021-06-21 14:47:46Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Jun 21, 2021 at 14:47&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@john there is a huge difference between &quot;stops execution of the async function&quot; and &quot;stops execution&quot;.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/5260024/jonas-wilms&quot; title=&quot;121,707 reputation&quot; class=&quot;comment-user&quot;&gt;Jonas Wilms&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment120313154_66747114&quot;&gt;&lt;span title=&quot;2021-06-21 16:16:14Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Jun 21, 2021 at 16:16&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;Even better: use async/await, and add eslint rules &lt;code&gt;no-floating-promises&lt;/code&gt; and &lt;code&gt;no-misused-promises&lt;/code&gt;.  If you forget to &lt;code&gt;await&lt;/code&gt; a Promise, the linter will yell at you.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/26286/coderer&quot; title=&quot;23,769 reputation&quot; class=&quot;comment-user&quot;&gt;Coderer&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment123163913_66747114&quot;&gt;&lt;span title=&quot;2021-10-22 15:27:00Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;Oct 22, 2021 at 15:27&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;&lt;i&gt;&quot;stop execution of ...&quot;&lt;/i&gt; is confusing... the truth is that the execution &lt;i&gt;returns&lt;/i&gt; from the function call.&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/5459839/trincot&quot; title=&quot;269,083 reputation&quot; class=&quot;comment-user&quot;&gt;trincot&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment127911255_66747114&quot;&gt;&lt;span title=&quot;2022-05-27 13:55:49Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;May 27 at 13:55&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n            &lt;/div&gt;\n        ","\n            &lt;div class=&quot;comment-body js-comment-edit-hide&quot;&gt;\n                \n                &lt;span class=&quot;comment-copy&quot;&gt;@trincot that&apos;s only true for the first await. I&apos;m open to suggestions though to word this better. The &lt;a href=&quot;https://262.ecma-international.org/12.0/#await&quot; rel=&quot;nofollow noreferrer&quot;&gt;spec&lt;/a&gt; says &quot;restore the execution context that is at the top of the execution context stack&quot; which could be the settlement of a previously awaited promise (so I guess this is even more confusing).&lt;/span&gt;\n                \n              &lt;div class=&quot;d-inline-flex ai-center&quot;&gt;\n&amp;nbsp;&lt;a href=&quot;/users/5260024/jonas-wilms&quot; title=&quot;121,707 reputation&quot; class=&quot;comment-user&quot;&gt;Jonas Wilms&lt;/a&gt;\n                &lt;/div&gt;\n                &lt;span class=&quot;comment-date&quot; dir=&quot;ltr&quot;&gt;&lt;a class=&quot;comment-link&quot; href=&quot;#comment127912440_66747114&quot;&gt;&lt;span title=&quot;2022-05-27 14:43:22Z, License: CC BY-SA 4.0&quot; class=&quot;relativetime-clean&quot;&gt;May 27 at 14:43&lt;/span&gt;&lt;/a&gt;&lt;/span&gt;\n                        &lt;span title=&quot;this comment was edited 2 times&quot;&gt;\n                            &lt;svg aria-hidden=&quot;true&quot; class=&quot;va-text-bottom o50 svg-icon iconPencilSm&quot; width=&quot;14&quot; height=&quot;14&quot; viewBox=&quot;0 0 14 14&quot;&gt;&lt;path d=&quot;m11.1 1.71 1.13 1.12c.2.2.2.51 0 .71L11.1 4.7 9.21 2.86l1.17-1.15c.2-.2.51-.2.71 0ZM2 10.12l6.37-6.43 1.88 1.88L3.88 12H2v-1.88Z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;\n                        &lt;/span&gt;\n            &lt;/div&gt;\n        "],"id":57,"title":"What is the explicit promise construction antipattern and how do I avoid it?","content":"\n                \n&lt;p&gt;I was writing code that does something that looks like:&lt;/p&gt;\n\n&lt;pre class=&quot;lang-js s-code-block&quot;&gt;&lt;code class=&quot;hljs language-javascript&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getStuffDone&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;param&lt;/span&gt;) {           | &lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title function_&quot;&gt;getStuffDone&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;param&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;var&lt;/span&gt; d = Q.&lt;span class=&quot;hljs-title function_&quot;&gt;defer&lt;/span&gt;(); &lt;span class=&quot;hljs-comment&quot;&gt;/* or $q.defer */&lt;/span&gt; |     &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;hljs-title class_&quot;&gt;Promise&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;resolve, reject&lt;/span&gt;) {\n    &lt;span class=&quot;hljs-comment&quot;&gt;// or = new $.Deferred() etc.        |     // using a promise constructor&lt;/span&gt;\n    &lt;span class=&quot;hljs-title function_&quot;&gt;myPromiseFn&lt;/span&gt;(param+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)                 |         &lt;span class=&quot;hljs-title function_&quot;&gt;myPromiseFn&lt;/span&gt;(param+&lt;span class=&quot;hljs-number&quot;&gt;1&lt;/span&gt;)\n    .&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;val&lt;/span&gt;) { &lt;span class=&quot;hljs-comment&quot;&gt;/* or .done */&lt;/span&gt; |         .&lt;span class=&quot;hljs-title function_&quot;&gt;then&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;val&lt;/span&gt;) {\n        d.&lt;span class=&quot;hljs-title function_&quot;&gt;resolve&lt;/span&gt;(val);                  |             &lt;span class=&quot;hljs-title function_&quot;&gt;resolve&lt;/span&gt;(val);\n    }).&lt;span class=&quot;hljs-title function_&quot;&gt;catch&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;err&lt;/span&gt;) { &lt;span class=&quot;hljs-comment&quot;&gt;/* .fail */&lt;/span&gt; |         }).&lt;span class=&quot;hljs-title function_&quot;&gt;catch&lt;/span&gt;(&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;err&lt;/span&gt;) {\n        d.&lt;span class=&quot;hljs-title function_&quot;&gt;reject&lt;/span&gt;(err);                   |             &lt;span class=&quot;hljs-title function_&quot;&gt;reject&lt;/span&gt;(err);\n    });                                  |         });\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; d.&lt;span class=&quot;hljs-property&quot;&gt;promise&lt;/span&gt;; &lt;span class=&quot;hljs-comment&quot;&gt;/* or promise() */&lt;/span&gt; |     });\n}                                        | }\n&lt;/code&gt;&lt;/pre&gt;\n\n&lt;p&gt;Someone told me this is called the &quot;&lt;strong&gt;deferred antipattern&lt;/strong&gt;&quot; or the &quot;&lt;strong&gt;&lt;code&gt;Promise&lt;/code&gt; constructor antipattern&lt;/strong&gt;&quot; respectively, what&apos;s bad about this code and why is this called an &lt;a href=&quot;https://en.wikipedia.org/wiki/Anti-pattern&quot; rel=&quot;noreferrer&quot;&gt;antipattern&lt;/a&gt;?&lt;/p&gt;\n    ","slug":"what-is-the-explicit-promise-construction-antipattern-and-how-do-i-avoid-it-1657384436212","postType":"QUESTION","createdAt":"2022-07-09T16:33:56.000Z","updatedAt":"2022-07-09T16:33:56.000Z","tags":[{"id":207,"name":"es6-promise","slug":"es6-promise","createdAt":"2022-07-09T16:33:56.000Z","updatedAt":"2022-07-09T16:33:56.000Z","Questions_Tags":{"questionId":57,"tagId":207}}]}]}},"__N_SSG":true}