<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/B9ZMQqRLGvIP-RcWN9dT2/_buildManifest.js" defer=""></script><script src="/_next/static/B9ZMQqRLGvIP-RcWN9dT2/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-can-i-pivot-a-dataframe-1657384433802#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-can-i-pivot-a-dataframe-1657384433802">How can I pivot a dataframe?</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/group-by">group-by</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pivot">pivot</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/pandas-groupby">pandas-groupby</a></div></div><div class="question-content mt-5">
                
<ul>
<li>What is pivot?</li>
<li>How do I pivot?</li>
<li>Is this a pivot?</li>
<li>Long format to wide format?</li>
</ul>
<p>I've seen a lot of questions that ask about pivot tables.  Even if they don't know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...</p>
<p>... But I'm going to give it a go.</p>
<hr>
<p>The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it's a daunting task)</p>
<p>Look a few examples from my <a href="https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe&amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe" rel="noreferrer"><strong>Google Search</strong></a></p>
<ol>
<li><a href="https://stackoverflow.com/q/28337117/2336654">How to pivot a dataframe in Pandas?</a></li>
</ol>
<ul>
<li>Good question and answer.  But the answer only answers the specific question with little explanation.</li>
</ul>
<ol start="2">
<li><a href="https://stackoverflow.com/q/42708193/2336654">pandas pivot table to data frame</a></li>
</ol>
<ul>
<li>In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn't very helpful for pandas users.</li>
</ul>
<ol start="3">
<li><a href="https://stackoverflow.com/q/11400181/2336654">pandas pivoting a dataframe, duplicate rows</a></li>
</ol>
<ul>
<li>Another decent question but the answer focuses on one method, namely <code>pd.DataFrame.pivot</code></li>
</ul>
<p>So whenever someone searches for <code>pivot</code> they get sporadic results that are likely not going to answer their specific question.</p>
<hr>
<h1>Setup</h1>
<p>You may notice that I conspicuously named my columns and relevant column values to correspond with how I'm going to pivot in the answers below.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-keyword">from</span> numpy.core.defchararray <span class="hljs-keyword">import</span> add

np.random.seed([<span class="hljs-number">3</span>,<span class="hljs-number">1415</span>])
n = <span class="hljs-number">20</span>

cols = np.array([<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>])
arr1 = (np.random.randint(<span class="hljs-number">5</span>, size=(n, <span class="hljs-number">4</span>)) // [<span class="hljs-number">2</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>]).astype(<span class="hljs-built_in">str</span>)

df = pd.DataFrame(
    add(cols, arr1), columns=cols
).join(
    pd.DataFrame(np.random.rand(n, <span class="hljs-number">2</span>).<span class="hljs-built_in">round</span>(<span class="hljs-number">2</span>)).add_prefix(<span class="hljs-string">'val'</span>)
)
<span class="hljs-built_in">print</span>(df)

     key   row   item   col  val0  val1
<span class="hljs-number">0</span>   key0  row3  item1  col3  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.04</span>
<span class="hljs-number">1</span>   key1  row2  item1  col2  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.07</span>
<span class="hljs-number">2</span>   key1  row0  item1  col0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.01</span>
<span class="hljs-number">3</span>   key0  row4  item0  col2  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.59</span>
<span class="hljs-number">4</span>   key1  row0  item2  col1  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.64</span>
<span class="hljs-number">5</span>   key1  row2  item2  col4  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.88</span>
<span class="hljs-number">6</span>   key2  row4  item1  col3  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.39</span>
<span class="hljs-number">7</span>   key1  row4  item1  col1  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.07</span>
<span class="hljs-number">8</span>   key1  row0  item2  col4  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.02</span>
<span class="hljs-number">9</span>   key1  row2  item0  col2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.61</span>
<span class="hljs-number">10</span>  key2  row0  item2  col1  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.85</span>
<span class="hljs-number">11</span>  key2  row4  item1  col2  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.25</span>
<span class="hljs-number">12</span>  key0  row2  item2  col3  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.44</span>
<span class="hljs-number">13</span>  key0  row4  item1  col4  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.46</span>
<span class="hljs-number">14</span>  key1  row3  item2  col3  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.11</span>
<span class="hljs-number">15</span>  key0  row3  item1  col1  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.23</span>
<span class="hljs-number">16</span>  key0  row0  item2  col3  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.01</span>
<span class="hljs-number">17</span>  key0  row4  item0  col3  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.21</span>
<span class="hljs-number">18</span>  key2  row2  item2  col0  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.45</span>
<span class="hljs-number">19</span>  key0  row2  item0  col4  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.70</span>
</code></pre>
<h3>Question(s)</h3>
<ol>
<li><p>Why do I get <code>ValueError: Index contains duplicate entries, cannot reshape</code></p>
</li>
<li><p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, and mean of <code>val0</code> are the values?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>    NaN  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>    NaN  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3   NaN  <span class="hljs-number">0.310</span>    NaN  <span class="hljs-number">0.545</span>   NaN
 row4   NaN  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, mean of <code>val0</code> are the values, and missing values are <code>0</code>?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I get something other than <code>mean</code>, like maybe <code>sum</code>?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0  col1  col2  col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I do more that one aggregation at a time?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">        <span class="hljs-built_in">sum</span>                          mean
 col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p>Can I aggregate over multiple value columns?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">       val0                             val1
 col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
 row
 row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.01</span>  <span class="hljs-number">0.745</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.010</span>  <span class="hljs-number">0.02</span>
 row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>  <span class="hljs-number">0.45</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.34</span>  <span class="hljs-number">0.440</span>  <span class="hljs-number">0.79</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.230</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.075</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.070</span>  <span class="hljs-number">0.42</span>  <span class="hljs-number">0.300</span>  <span class="hljs-number">0.46</span>
</code></pre>
</li>
<li><p>Can Subdivide by multiple columns?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> item item0             item1                         item2
 col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
 row
 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
 row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>
 row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
 row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p>Or</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> item      item0             item1                         item2
 col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
 key  row
 key0 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.00</span>
      row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.00</span>
      row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
 key1 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.65</span>
      row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>
      row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
 key2 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
      row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p>Can I aggregate the frequency in which the column and rows occur together, aka "cross tabulation"?</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"> col   col0  col1  col2  col3  col4
 row
 row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
 row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
 row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
 row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p>How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed([<span class="hljs-number">3</span>, <span class="hljs-number">1415</span>])
df2 = pd.DataFrame({<span class="hljs-string">'A'</span>: <span class="hljs-built_in">list</span>(<span class="hljs-string">'aaaabbbc'</span>), <span class="hljs-string">'B'</span>: np.random.choice(<span class="hljs-number">15</span>, <span class="hljs-number">8</span>)})
df2
   A   B
<span class="hljs-number">0</span>  a   <span class="hljs-number">0</span>
<span class="hljs-number">1</span>  a  <span class="hljs-number">11</span>
<span class="hljs-number">2</span>  a   <span class="hljs-number">2</span>
<span class="hljs-number">3</span>  a  <span class="hljs-number">11</span>
<span class="hljs-number">4</span>  b  <span class="hljs-number">10</span>
<span class="hljs-number">5</span>  b  <span class="hljs-number">10</span>
<span class="hljs-number">6</span>  b  <span class="hljs-number">14</span>
<span class="hljs-number">7</span>  c   <span class="hljs-number">7</span>
</code></pre>
<p>The expected should look something like</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">      a     b    c
<span class="hljs-number">0</span>   <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
<span class="hljs-number">1</span>  <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
<span class="hljs-number">2</span>   <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
<span class="hljs-number">3</span>  <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
<li><p>How do I flatten the multiple index to single index after <code>pivot</code>?</p>
<p>From</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
   <span class="hljs-number">1</span>  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>
a  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">1</span>
b  <span class="hljs-number">2</span>  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>
c  <span class="hljs-number">1</span>  <span class="hljs-number">0</span>  <span class="hljs-number">0</span>
</code></pre>
<p>To</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">1</span>|<span class="hljs-number">1</span>  <span class="hljs-number">2</span>|<span class="hljs-number">1</span>  <span class="hljs-number">2</span>|<span class="hljs-number">2</span>
a    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">1</span>
b    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>
c    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">0</span>
</code></pre>
</li>
</ol>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>We start by answering the first question:</p>
<h2>Question 1</h2>
<blockquote>
<p>Why do I get <code>ValueError: Index contains duplicate entries, cannot reshape</code></p>
</blockquote>
<p>This occurs because pandas is attempting to reindex either a <code>columns</code> or <code>index</code> object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider <code>pd.DataFrame.pivot</code>.  I know there are duplicate entries that share the <code>row</code> and <code>col</code> values:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.duplicated([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>]).<span class="hljs-built_in">any</span>()

<span class="hljs-literal">True</span>
</code></pre>
<p>So when I <code>pivot</code> using</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.pivot(index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>, values=<span class="hljs-string">'val0'</span>)
</code></pre>
<p>I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.set_index([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].unstack()
</code></pre>
<p>Here is a list of idioms we can use to pivot</p>
<ol>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html" rel="noreferrer"><strong><code>pd.DataFrame.unstack</code></strong></a></p>
<ul>
<li>Good general approach for doing just about any type of pivot</li>
<li>You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you <code>unstack</code> the levels that you want to be in the column index.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<ul>
<li>A glorified version of <code>groupby</code> with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.</li>
<li>Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html" rel="noreferrer"><strong><code>pd.DataFrame.set_index</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html" rel="noreferrer"><strong><code>pd.DataFrame.unstack</code></strong></a></p>
<ul>
<li>Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.</li>
<li>Similar to the <code>groupby</code> paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then <code>unstack</code> the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot</code></strong></a></p>
<ul>
<li>Very similar to <code>set_index</code> in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for <code>index</code>, <code>columns</code>, <code>values</code>.</li>
<li>Similar to the <code>pivot_table</code> method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<ul>
<li>This a specialized version of <code>pivot_table</code> and in its purest form is the most intuitive way to perform several tasks.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html" rel="noreferrer"><strong><code>pd.factorize</code></strong></a> + <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html" rel="noreferrer"><strong><code>np.bincount</code></strong></a></p>
<ul>
<li>This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" rel="noreferrer"><strong><code>pd.get_dummies</code></strong></a> + <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html" rel="noreferrer"><strong><code>pd.DataFrame.dot</code></strong></a></p>
<ul>
<li>I use this for cleverly performing cross tabulation.</li>
</ul>
</li>
</ol>
<hr>
<h1>Examples</h1>
<p>What I'm going to do for each subsequent answer and question is to answer it using <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a>.  Then I'll provide alternatives to perform the same task.</p>
<h2>Question 3</h2>
<blockquote>
<p>How do I pivot <code>df</code> such that the <code>col</code> values are columns, <code>row</code> values are the index, mean of <code>val0</code> are the values, and missing values are <code>0</code>?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<ul>
<li><p><code>fill_value</code> is not set by default.  I tend to set it appropriately.  In this case I set it to <code>0</code>.  Notice I skipped <strong>question 2</strong> as it's the same as this answer without the <code>fill_value</code></p>
</li>
<li><p><code>aggfunc='mean'</code> is the default and I didn't have to set it.  I included it to be explicit.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">    df.pivot_table(
        values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
        fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

    col   col0   col1   col2   col3  col4
    row
    row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
    row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
    row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
    row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
</ul>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].mean().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=<span class="hljs-string">'mean'</span>).fillna(<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 4</h2>
<blockquote>
<p>Can I get something other than <code>mean</code>, like maybe <code>sum</code>?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'sum'</span>)

  col   col0  col1  col2  col3  col4
  row
  row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">1.21</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
  row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.50</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">1.09</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.79</span>  <span class="hljs-number">1.52</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].<span class="hljs-built_in">sum</span>().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=<span class="hljs-string">'sum'</span>).fillna(<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 5</h2>
<blockquote>
<p>Can I do more that one aggregation at a time?</p>
</blockquote>
<p>Notice that for <code>pivot_table</code> and <code>crosstab</code> I needed to pass list of callables.  On the other hand, <code>groupby.agg</code> is able to take strings for a limited number of special functions.  <code>groupby.agg</code> would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.</p>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=[np.size, np.mean])

       size                      mean
  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4
  row
  row0    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">1</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>
  row2    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>
  row3    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">0</span>    <span class="hljs-number">2</span>    <span class="hljs-number">0</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>
  row4    <span class="hljs-number">0</span>    <span class="hljs-number">1</span>    <span class="hljs-number">2</span>    <span class="hljs-number">2</span>    <span class="hljs-number">1</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].agg([<span class="hljs-string">'size'</span>, <span class="hljs-string">'mean'</span>]).unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(
      index=df[<span class="hljs-string">'row'</span>], columns=df[<span class="hljs-string">'col'</span>],
      values=df[<span class="hljs-string">'val0'</span>], aggfunc=[np.size, np.mean]).fillna(<span class="hljs-number">0</span>, downcast=<span class="hljs-string">'infer'</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 6</h2>
<blockquote>
<p>Can I aggregate over multiple value columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a> we pass <code>values=['val0', 'val1']</code> but we could've left that off completely</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=[<span class="hljs-string">'val0'</span>, <span class="hljs-string">'val1'</span>], index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>,
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

        val0                             val1
  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4
  row
  row0  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.860</span>  <span class="hljs-number">0.65</span>  <span class="hljs-number">0.01</span>  <span class="hljs-number">0.745</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.010</span>  <span class="hljs-number">0.02</span>
  row2  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.500</span>  <span class="hljs-number">0.25</span>  <span class="hljs-number">0.45</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.34</span>  <span class="hljs-number">0.440</span>  <span class="hljs-number">0.79</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.310</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.545</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.230</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.075</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.100</span>  <span class="hljs-number">0.395</span>  <span class="hljs-number">0.760</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.070</span>  <span class="hljs-number">0.42</span>  <span class="hljs-number">0.300</span>  <span class="hljs-number">0.46</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>, <span class="hljs-string">'val1'</span>].mean().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 7</h2>
<blockquote>
<p>Can Subdivide by multiple columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=<span class="hljs-string">'row'</span>, columns=[<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>],
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

  item item0             item1                         item2
  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4
  row
  row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.605</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.65</span>
  row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.13</span>
  row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
  row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.000</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby(
      [<span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].mean().unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 8</h2>
<blockquote>
<p>Can Subdivide by multiple columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(
      values=<span class="hljs-string">'val0'</span>, index=[<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>], columns=[<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>],
      fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'mean'</span>)

  item      item0             item1                         item2
  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4
  key  row
  key0 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.86</span>  <span class="hljs-number">0.00</span>
       row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.37</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.50</span>  <span class="hljs-number">0.00</span>
       row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.31</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.15</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.24</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
  key1 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.77</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.81</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.65</span>
       row2  <span class="hljs-number">0.35</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.44</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>
       row3  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.28</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.10</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
  key2 row0  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.40</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row2  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.13</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
       row4  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.64</span>  <span class="hljs-number">0.88</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>  <span class="hljs-number">0.00</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby(
      [<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].mean().unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html" rel="noreferrer"><strong><code>pd.DataFrame.set_index</code></strong></a> because the set of keys are unique for both rows and columns</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.set_index(
      [<span class="hljs-string">'key'</span>, <span class="hljs-string">'row'</span>, <span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]
  )[<span class="hljs-string">'val0'</span>].unstack([<span class="hljs-string">'item'</span>, <span class="hljs-string">'col'</span>]).fillna(<span class="hljs-number">0</span>).sort_index(<span class="hljs-number">1</span>)
</code></pre>
</li>
</ul>
<hr>
<h2>Question 9</h2>
<blockquote>
<p>Can I aggregate the frequency in which the column and rows occur together, aka "cross tabulation"?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>pd.DataFrame.pivot_table</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.pivot_table(index=<span class="hljs-string">'row'</span>, columns=<span class="hljs-string">'col'</span>, fill_value=<span class="hljs-number">0</span>, aggfunc=<span class="hljs-string">'size'</span>)

      col   col0  col1  col2  col3  col4
  row
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
  row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
  row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html" rel="noreferrer"><strong><code>pd.DataFrame.groupby</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df.groupby([<span class="hljs-string">'row'</span>, <span class="hljs-string">'col'</span>])[<span class="hljs-string">'val0'</span>].size().unstack(fill_value=<span class="hljs-number">0</span>)
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html" rel="noreferrer"><strong><code>pd.crosstab</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.crosstab(df[<span class="hljs-string">'row'</span>], df[<span class="hljs-string">'col'</span>])
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html" rel="noreferrer"><strong><code>pd.factorize</code></strong></a> + <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html" rel="noreferrer"><strong><code>np.bincount</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  <span class="hljs-comment"># get integer factorization `i` and unique values `r`</span>
  <span class="hljs-comment"># for column `'row'`</span>
  i, r = pd.factorize(df[<span class="hljs-string">'row'</span>].values)
  <span class="hljs-comment"># get integer factorization `j` and unique values `c`</span>
  <span class="hljs-comment"># for column `'col'`</span>
  j, c = pd.factorize(df[<span class="hljs-string">'col'</span>].values)
  <span class="hljs-comment"># `n` will be the number of rows</span>
  <span class="hljs-comment"># `m` will be the number of columns</span>
  n, m = r.size, c.size
  <span class="hljs-comment"># `i * m + j` is a clever way of counting the</span>
  <span class="hljs-comment"># factorization bins assuming a flat array of length</span>
  <span class="hljs-comment"># `n * m`.  Which is why we subsequently reshape as `(n, m)`</span>
  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)
  <span class="hljs-comment"># BTW, whenever I read this, I think 'Bean, Rice, and Cheese'</span>
  pd.DataFrame(b, r, c)

        col3  col2  col0  col1  col4
  row3     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
  row4     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html" rel="noreferrer"><strong><code>pd.get_dummies</code></strong></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  pd.get_dummies(df[<span class="hljs-string">'row'</span>]).T.dot(pd.get_dummies(df[<span class="hljs-string">'col'</span>]))

        col0  col1  col2  col3  col4
  row0     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">1</span>
  row2     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
  row3     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">0</span>     <span class="hljs-number">2</span>     <span class="hljs-number">0</span>
  row4     <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>     <span class="hljs-number">2</span>     <span class="hljs-number">1</span>
</code></pre>
</li>
</ul>
<hr>
<h2>Question 10</h2>
<blockquote>
<p>How do I convert a DataFrame from long to wide by pivoting on ONLY two
columns?</p>
</blockquote>
<ul>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a></p>
<p>The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html" rel="noreferrer"><strong><code>GroupBy.cumcount</code></strong></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.insert(<span class="hljs-number">0</span>, <span class="hljs-string">'count'</span>, df2.groupby(<span class="hljs-string">'A'</span>).cumcount())
  df2

     count  A   B
  <span class="hljs-number">0</span>      <span class="hljs-number">0</span>  a   <span class="hljs-number">0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">1</span>  a  <span class="hljs-number">11</span>
  <span class="hljs-number">2</span>      <span class="hljs-number">2</span>  a   <span class="hljs-number">2</span>
  <span class="hljs-number">3</span>      <span class="hljs-number">3</span>  a  <span class="hljs-number">11</span>
  <span class="hljs-number">4</span>      <span class="hljs-number">0</span>  b  <span class="hljs-number">10</span>
  <span class="hljs-number">5</span>      <span class="hljs-number">1</span>  b  <span class="hljs-number">10</span>
  <span class="hljs-number">6</span>      <span class="hljs-number">2</span>  b  <span class="hljs-number">14</span>
  <span class="hljs-number">7</span>      <span class="hljs-number">0</span>  c   <span class="hljs-number">7</span>
</code></pre>
<p>The second step is to use the newly created column as the index to call <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.pivot(*df2)
  <span class="hljs-comment"># df2.pivot(index='count', columns='A', values='B')</span>

  A         a     b    c
  count
  <span class="hljs-number">0</span>       <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
  <span class="hljs-number">2</span>       <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
  <span class="hljs-number">3</span>      <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
<li><p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>DataFrame.pivot_table</code></strong></a></p>
<p>Whereas <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html" rel="noreferrer"><strong><code>DataFrame.pivot</code></strong></a> only accepts columns, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html" rel="noreferrer"><strong><code>DataFrame.pivot_table</code></strong></a> also accepts arrays, so the <code>GroupBy.cumcount</code> can be passed directly as the <code>index</code> without creating an explicit column.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  df2.pivot_table(index=df2.groupby(<span class="hljs-string">'A'</span>).cumcount(), columns=<span class="hljs-string">'A'</span>, values=<span class="hljs-string">'B'</span>)

  A         a     b    c
  <span class="hljs-number">0</span>       <span class="hljs-number">0.0</span>  <span class="hljs-number">10.0</span>  <span class="hljs-number">7.0</span>
  <span class="hljs-number">1</span>      <span class="hljs-number">11.0</span>  <span class="hljs-number">10.0</span>  NaN
  <span class="hljs-number">2</span>       <span class="hljs-number">2.0</span>  <span class="hljs-number">14.0</span>  NaN
  <span class="hljs-number">3</span>      <span class="hljs-number">11.0</span>   NaN  NaN
</code></pre>
</li>
</ul>
<hr>
<h2>Question 11</h2>
<blockquote>
<p>How do I flatten the multiple index to single index after <code>pivot</code></p>
</blockquote>
<p>If <code>columns</code> type <code>object</code> with string <code>join</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.columns = df.columns.<span class="hljs-built_in">map</span>(<span class="hljs-string">'|'</span>.join)
</code></pre>
<p>else <code>format</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.columns = df.columns.<span class="hljs-built_in">map</span>(<span class="hljs-string">'{0[0]}|{0[1]}'</span>.<span class="hljs-built_in">format</span>)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To extend <a href="https://stackoverflow.com/a/47152692/12416453">@piRSquared's answer</a> another version of <b><a href="https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python">Question 10</a></b></p>

<h3>Question 10.1</h3>

<p>DataFrame:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">d = data = {<span class="hljs-string">'A'</span>: {<span class="hljs-number">0</span>: <span class="hljs-number">1</span>, <span class="hljs-number">1</span>: <span class="hljs-number">1</span>, <span class="hljs-number">2</span>: <span class="hljs-number">1</span>, <span class="hljs-number">3</span>: <span class="hljs-number">2</span>, <span class="hljs-number">4</span>: <span class="hljs-number">2</span>, <span class="hljs-number">5</span>: <span class="hljs-number">3</span>, <span class="hljs-number">6</span>: <span class="hljs-number">5</span>},
 <span class="hljs-string">'B'</span>: {<span class="hljs-number">0</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">1</span>: <span class="hljs-string">'b'</span>, <span class="hljs-number">2</span>: <span class="hljs-string">'c'</span>, <span class="hljs-number">3</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">4</span>: <span class="hljs-string">'b'</span>, <span class="hljs-number">5</span>: <span class="hljs-string">'a'</span>, <span class="hljs-number">6</span>: <span class="hljs-string">'c'</span>}}
df = pd.DataFrame(d)

   A  B
<span class="hljs-number">0</span>  <span class="hljs-number">1</span>  a
<span class="hljs-number">1</span>  <span class="hljs-number">1</span>  b
<span class="hljs-number">2</span>  <span class="hljs-number">1</span>  c
<span class="hljs-number">3</span>  <span class="hljs-number">2</span>  a
<span class="hljs-number">4</span>  <span class="hljs-number">2</span>  b
<span class="hljs-number">5</span>  <span class="hljs-number">3</span>  a
<span class="hljs-number">6</span>  <span class="hljs-number">5</span>  c
</code></pre>

<p>Output:</p>

<pre class="lang-py s-code-block"><code class="hljs language-python">   <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
A
<span class="hljs-number">1</span>  a     b     c
<span class="hljs-number">2</span>  a     b  <span class="hljs-literal">None</span>
<span class="hljs-number">3</span>  a  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  c  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
</code></pre>

<hr>

<p>Using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html" rel="noreferrer"><code>df.groupby</code></a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist" rel="noreferrer"><code>pd.Series.tolist</code></a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">t = df.groupby(<span class="hljs-string">'A'</span>)[<span class="hljs-string">'B'</span>].apply(<span class="hljs-built_in">list</span>)
out = pd.DataFrame(t.tolist(),index=t.index)
out
   <span class="hljs-number">0</span>     <span class="hljs-number">1</span>     <span class="hljs-number">2</span>
A
<span class="hljs-number">1</span>  a     b     c
<span class="hljs-number">2</span>  a     b  <span class="hljs-literal">None</span>
<span class="hljs-number">3</span>  a  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
<span class="hljs-number">5</span>  c  <span class="hljs-literal">None</span>  <span class="hljs-literal">None</span>
</code></pre>

<p>Or 
A much better alternative using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html" rel="noreferrer"><code>pd.pivot_table</code></a> with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html" rel="noreferrer"><code>df.squeeze.</code></a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python">t = df.pivot_table(index=<span class="hljs-string">'A'</span>,values=<span class="hljs-string">'B'</span>,aggfunc=<span class="hljs-built_in">list</span>).squeeze()
out = pd.DataFrame(t.tolist(),index=t.index)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>To better understand how <a href="http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot" rel="noreferrer">pivot</a> works you can look at the <a href="https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects" rel="noreferrer">example</a> from Pandas documentation:</p>
<p><a href="https://i.stack.imgur.com/GPsB5.png" rel="noreferrer"><img src="https://i.stack.imgur.com/GPsB5.png" alt="enter image description here"></a></p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = pd.DataFrame({
    <span class="hljs-string">'foo'</span>: [<span class="hljs-string">'one'</span>, <span class="hljs-string">'one'</span>, <span class="hljs-string">'one'</span>, <span class="hljs-string">'two'</span>, <span class="hljs-string">'two'</span>, <span class="hljs-string">'two'</span>],
    <span class="hljs-string">'bar'</span>: [<span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>, <span class="hljs-string">'A'</span>, <span class="hljs-string">'B'</span>, <span class="hljs-string">'C'</span>],
    <span class="hljs-string">'baz'</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>, <span class="hljs-number">5</span>, <span class="hljs-number">6</span>],
    <span class="hljs-string">'zoo'</span>: [<span class="hljs-string">'x'</span>, <span class="hljs-string">'y'</span>, <span class="hljs-string">'z'</span>, <span class="hljs-string">'q'</span>, <span class="hljs-string">'w'</span>, <span class="hljs-string">'t'</span>]
})
</code></pre>
<p>Input Table:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">   foo bar  baz zoo
<span class="hljs-number">0</span>  one   A    <span class="hljs-number">1</span>   x
<span class="hljs-number">1</span>  one   B    <span class="hljs-number">2</span>   y
<span class="hljs-number">2</span>  one   C    <span class="hljs-number">3</span>   z
<span class="hljs-number">3</span>  two   A    <span class="hljs-number">4</span>   q
<span class="hljs-number">4</span>  two   B    <span class="hljs-number">5</span>   w
<span class="hljs-number">5</span>  two   C    <span class="hljs-number">6</span>   t
</code></pre>
<p><strong>Pivot</strong>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">pd.pivot(
    data=df,        
    index=<span class="hljs-string">'foo'</span>,    <span class="hljs-comment"># Column to use to make new frames index. If None, uses existing index.</span>
    columns=<span class="hljs-string">'bar'</span>,  <span class="hljs-comment"># Column to use to make new frames columns.</span>
    values=<span class="hljs-string">'baz'</span>    <span class="hljs-comment"># Column(s) to use for populating new frames values.</span>
)
</code></pre>
<p>Output table:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">bar  A  B  C
foo         
one  <span class="hljs-number">1</span>  <span class="hljs-number">2</span>  <span class="hljs-number">3</span>
two  <span class="hljs-number">4</span>  <span class="hljs-number">5</span>  <span class="hljs-number">6</span>
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;We start by answering the first question:\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Question 1\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Why do I get \u0026lt;code\u0026gt;ValueError: Index contains duplicate entries, cannot reshape\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;This occurs because pandas is attempting to reindex either a \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; object with duplicate entries.  There are varying methods to use that can perform a pivot.  Some of them are not well suited to when there are duplicates of the keys in which it is being asked to pivot on.  For example.  Consider \u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;.  I know there are duplicate entries that share the \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.duplicated([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()\n\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So when I \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt; using\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.pivot(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;, values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I get the error mentioned above.  In fact, I get the same error when I try to perform the same task with:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.set_index([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].unstack()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Here is a list of idioms we can use to pivot\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.unstack\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Good general approach for doing just about any type of pivot\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You specify all columns that will constitute the pivoted row levels and column levels in one group by.  You follow that by selecting the remaining columns you want to aggregate and the function(s) you want to perform the aggregation.  Finally, you \u0026lt;code\u0026gt;unstack\u0026lt;/code\u0026gt; the levels that you want to be in the column index.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;A glorified version of \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; with more intuitive API.  For many people, this is the preferred approach.  And is the intended approach by the developers.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Specify row level, column levels, values to be aggregated, and function(s) to perform aggregations.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.unstack.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.unstack\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Convenient and intuitive for some (myself included).  Cannot handle duplicate grouped keys.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Similar to the \u0026lt;code\u0026gt;groupby\u0026lt;/code\u0026gt; paradigm, we specify all columns that will eventually be either row or column levels and set those to be the index.  We then \u0026lt;code\u0026gt;unstack\u0026lt;/code\u0026gt; the levels we want in the columns.  If either the remaining index levels or column levels are not unique, this method will fail.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Very similar to \u0026lt;code\u0026gt;set_index\u0026lt;/code\u0026gt; in that it shares the duplicate key limitation.  The API is very limited as well.  It only takes scalar values for \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;values\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Similar to the \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; method in that we select rows, columns, and values on which to pivot.  However, we cannot aggregate and if either rows or columns are not unique, this method will fail.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;This a specialized version of \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; and in its purest form is the most intuitive way to perform several tasks.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.factorize\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;np.bincount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;This is a highly advanced technique that is very obscure but is very fast.  It cannot be used in all circumstances, but when it can be used and you are comfortable using it, you will reap the performance rewards.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.get_dummies\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.dot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;I use this for cleverly performing cross tabulation.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Examples\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;What I\u0026apos;m going to do for each subsequent answer and question is to answer it using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;.  Then I\u0026apos;ll provide alternatives to perform the same task.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Question 3\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values, and missing values are \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;fill_value\u0026lt;/code\u0026gt; is not set by default.  I tend to set it appropriately.  In this case I set it to \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;.  Notice I skipped \u0026lt;strong\u0026gt;question 2\u0026lt;/strong\u0026gt; as it\u0026apos;s the same as this answer without the \u0026lt;code\u0026gt;fill_value\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;aggfunc=\u0026apos;mean\u0026apos;\u0026lt;/code\u0026gt; is the default and I didn\u0026apos;t have to set it.  I included it to be explicit.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;    df.pivot_table(\n        values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n        fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n    col   col0   col1   col2   col3  col4\n    row\n    row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n    row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n    row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n    row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 4\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I get something other than \u0026lt;code\u0026gt;mean\u0026lt;/code\u0026gt;, like maybe \u0026lt;code\u0026gt;sum\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sum\u0026apos;\u0026lt;/span\u0026gt;)\n\n  col   col0  col1  col2  col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;sum\u0026apos;\u0026lt;/span\u0026gt;).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 5\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I do more that one aggregation at a time?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;Notice that for \u0026lt;code\u0026gt;pivot_table\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;crosstab\u0026lt;/code\u0026gt; I needed to pass list of callables.  On the other hand, \u0026lt;code\u0026gt;groupby.agg\u0026lt;/code\u0026gt; is able to take strings for a limited number of special functions.  \u0026lt;code\u0026gt;groupby.agg\u0026lt;/code\u0026gt; would also have taken the same callables we passed to the others, but it is often more efficient to leverage the string function names as there are efficiencies to be gained.\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=[np.size, np.mean])\n\n       size                      mean\n  col  col0 col1 col2 col3 col4  col0   col1   col2   col3  col4\n  row\n  row0    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n  row3    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].agg([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;size\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;]).unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(\n      index=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      values=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;], aggfunc=[np.size, np.mean]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, downcast=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;infer\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 6\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I aggregate over multiple value columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; we pass \u0026lt;code\u0026gt;values=[\u0026apos;val0\u0026apos;, \u0026apos;val1\u0026apos;]\u0026lt;/code\u0026gt; but we could\u0026apos;ve left that off completely\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val1\u0026apos;\u0026lt;/span\u0026gt;], index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;,\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n        val0                             val1\n  col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.745\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.010\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.34\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.440\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.230\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.075\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.070\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.42\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.300\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val1\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 7\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n  item item0             item1                         item2\n  col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n  row\n  row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n  row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n  row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 8\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(\n      values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;, index=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], columns=[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;],\n      fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mean\u0026apos;\u0026lt;/span\u0026gt;)\n\n  item      item0             item1                         item2\n  col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n  key  row\n  key0 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  key1 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n       row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n  key2 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n       row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].mean().unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.set_index.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.set_index\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; because the set of keys are unique for both rows and columns\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.set_index(\n      [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]\n  )[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].unstack([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]).fillna(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).sort_index(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 9\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Can I aggregate the frequency in which the column and rows occur together, aka \u0026quot;cross tabulation\u0026quot;?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.pivot_table(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;, fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, aggfunc=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;size\u0026apos;\u0026lt;/span\u0026gt;)\n\n      col   col0  col1  col2  col3  col4\n  row\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.DataFrame.groupby\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df.groupby([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val0\u0026apos;\u0026lt;/span\u0026gt;].size().unstack(fill_value=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.crosstab.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.crosstab\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.crosstab(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;], df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.factorize.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.factorize\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; + \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy-1.13.0/reference/generated/numpy.bincount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;np.bincount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# get integer factorization `i` and unique values `r`\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# for column `\u0026apos;row\u0026apos;`\u0026lt;/span\u0026gt;\n  i, r = pd.factorize(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;].values)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# get integer factorization `j` and unique values `c`\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# for column `\u0026apos;col\u0026apos;`\u0026lt;/span\u0026gt;\n  j, c = pd.factorize(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].values)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `n` will be the number of rows\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `m` will be the number of columns\u0026lt;/span\u0026gt;\n  n, m = r.size, c.size\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `i * m + j` is a clever way of counting the\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# factorization bins assuming a flat array of length\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# `n * m`.  Which is why we subsequently reshape as `(n, m)`\u0026lt;/span\u0026gt;\n  b = np.bincount(i * m + j, minlength=n * m).reshape(n, m)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# BTW, whenever I read this, I think \u0026apos;Bean, Rice, and Cheese\u0026apos;\u0026lt;/span\u0026gt;\n  pd.DataFrame(b, r, c)\n\n        col3  col2  col0  col1  col4\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;pd.get_dummies\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  pd.get_dummies(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;]).T.dot(pd.get_dummies(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;]))\n\n        col0  col1  col2  col3  col4\n  row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n  row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 10\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two\ncolumns?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The first step is to assign a number to each row - this number will be the row index of that value in the pivoted result. This is done using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.cumcount.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;GroupBy.cumcount\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.insert(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;count\u0026apos;\u0026lt;/span\u0026gt;, df2.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).cumcount())\n  df2\n\n     count  A   B\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The second step is to use the newly created column as the index to call \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.pivot(*df2)\n  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# df2.pivot(index=\u0026apos;count\u0026apos;, columns=\u0026apos;A\u0026apos;, values=\u0026apos;B\u0026apos;)\u0026lt;/span\u0026gt;\n\n  A         a     b    c\n  count\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Whereas \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pivot.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; only accepts columns, \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/generated/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;DataFrame.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; also accepts arrays, so the \u0026lt;code\u0026gt;GroupBy.cumcount\u0026lt;/code\u0026gt; can be passed directly as the \u0026lt;code\u0026gt;index\u0026lt;/code\u0026gt; without creating an explicit column.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  df2.pivot_table(index=df2.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;).cumcount(), columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;)\n\n  A         a     b    c\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;       \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;      \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h2\u0026gt;Question 11\u0026lt;/h2\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How do I flatten the multiple index to single index after \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;If \u0026lt;code\u0026gt;columns\u0026lt;/code\u0026gt; type \u0026lt;code\u0026gt;object\u0026lt;/code\u0026gt; with string \u0026lt;code\u0026gt;join\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.columns = df.columns.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;|\u0026apos;\u0026lt;/span\u0026gt;.join)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;else \u0026lt;code\u0026gt;format\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.columns = df.columns.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;map\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;{0[0]}|{0[1]}\u0026apos;\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;format\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To extend \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/47152692/12416453\u0026quot;\u0026gt;@piRSquared\u0026apos;s answer\u0026lt;/a\u0026gt; another version of \u0026lt;b\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/62218881/how-to-transpose-a-specif-column-from-a-dataframe-and-group-by-python\u0026quot;\u0026gt;Question 10\u0026lt;/a\u0026gt;\u0026lt;/b\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Question 10.1\u0026lt;/h3\u0026gt;\n\n\u0026lt;p\u0026gt;DataFrame:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;d = data = {\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;},\n \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: {\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;b\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;c\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;b\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;a\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;c\u0026apos;\u0026lt;/span\u0026gt;}}\ndf = pd.DataFrame(d)\n\n   A  B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  b\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  b\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Output:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nA\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a     b     c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a     b  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;Using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;df.groupby\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html?highlight=series%20tolist#pandas.Series.tolist\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.Series.tolist\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;t = df.groupby(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;)[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;].apply(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;)\nout = pd.DataFrame(t.tolist(),index=t.index)\nout\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\nA\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a     b     c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a     b  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  c  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;None\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Or \nA much better alternative using \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.pivot_table.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pd.pivot_table\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; with \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.squeeze.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;df.squeeze.\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;t = df.pivot_table(index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;,values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;,aggfunc=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;).squeeze()\nout = pd.DataFrame(t.tolist(),index=t.index)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;To better understand how \u0026lt;a href=\u0026quot;http://pandas.pydata.org/docs/reference/api/pandas.pivot.html#pandas.pivot\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;pivot\u0026lt;/a\u0026gt; works you can look at the \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/user_guide/reshaping.html#reshaping-by-pivoting-dataframe-objects\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;example\u0026lt;/a\u0026gt; from Pandas documentation:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://i.stack.imgur.com/GPsB5.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/GPsB5.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = pd.DataFrame({\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;one\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;two\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;C\u0026apos;\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;],\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;zoo\u0026apos;\u0026lt;/span\u0026gt;: [\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;y\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;z\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;q\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;w\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;t\u0026apos;\u0026lt;/span\u0026gt;]\n})\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Input Table:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   foo bar  baz zoo\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  one   A    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   x\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  one   B    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   y\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  one   C    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   z\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  two   A    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   q\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  two   B    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   w\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  two   C    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   t\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Pivot\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;pd.pivot(\n    data=df,        \n    index=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;foo\u0026apos;\u0026lt;/span\u0026gt;,    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column to use to make new frames index. If None, uses existing index.\u0026lt;/span\u0026gt;\n    columns=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;bar\u0026apos;\u0026lt;/span\u0026gt;,  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column to use to make new frames columns.\u0026lt;/span\u0026gt;\n    values=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;baz\u0026apos;\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Column(s) to use for populating new frames values.\u0026lt;/span\u0026gt;\n)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Output table:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;bar  A  B  C\nfoo         \none  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;\ntwo  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":56,"title":"How can I pivot a dataframe?","content":"\n                \n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;What is pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;How do I pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Is this a pivot?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Long format to wide format?\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;ve seen a lot of questions that ask about pivot tables.  Even if they don\u0026apos;t know that they are asking about pivot tables, they usually are.  It is virtually impossible to write a canonical question and answer that encompasses all aspects of pivoting...\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;... But I\u0026apos;m going to give it a go.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The problem with existing questions and answers is that often the question is focused on a nuance that the OP has trouble generalizing in order to use a number of the existing good answers.  However, none of the answers attempt to give a comprehensive explanation (because it\u0026apos;s a daunting task)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Look a few examples from my \u0026lt;a href=\u0026quot;https://www.google.com/search?q=how%20to%20pivot%20a%20pandas%20dataframe\u0026amp;amp;oq=How%20do%20I%20pivot%20a%20pandas%20dataframe\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Google Search\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/28337117/2336654\u0026quot;\u0026gt;How to pivot a dataframe in Pandas?\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Good question and answer.  But the answer only answers the specific question with little explanation.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/42708193/2336654\u0026quot;\u0026gt;pandas pivot table to data frame\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;In this question, the OP is concerned with the output of the pivot.  Namely how the columns look.  OP wanted it to look like R.  This isn\u0026apos;t very helpful for pandas users.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/q/11400181/2336654\u0026quot;\u0026gt;pandas pivoting a dataframe, duplicate rows\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Another decent question but the answer focuses on one method, namely \u0026lt;code\u0026gt;pd.DataFrame.pivot\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;So whenever someone searches for \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt; they get sporadic results that are likely not going to answer their specific question.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;h1\u0026gt;Setup\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;You may notice that I conspicuously named my columns and relevant column values to correspond with how I\u0026apos;m going to pivot in the answers below.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; numpy.core.defchararray \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; add\n\nnp.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1415\u0026lt;/span\u0026gt;])\nn = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;20\u0026lt;/span\u0026gt;\n\ncols = np.array([\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;key\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;row\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;item\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;])\narr1 = (np.random.randint(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;, size=(n, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;)) // [\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;]).astype(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;str\u0026lt;/span\u0026gt;)\n\ndf = pd.DataFrame(\n    add(cols, arr1), columns=cols\n).join(\n    pd.DataFrame(np.random.rand(n, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;round\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;)).add_prefix(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;val\u0026apos;\u0026lt;/span\u0026gt;)\n)\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(df)\n\n     key   row   item   col  val0  val1\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   key0  row3  item1  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.04\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;   key1  row2  item1  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.07\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   key1  row0  item1  col0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;   key0  row4  item0  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.59\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;   key1  row0  item2  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;   key1  row2  item2  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;   key2  row4  item1  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.39\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;   key1  row4  item1  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.07\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;   key1  row0  item2  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9\u0026lt;/span\u0026gt;   key1  row2  item0  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.61\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;  key2  row0  item2  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.85\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;  key2  row4  item1  col2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;12\u0026lt;/span\u0026gt;  key0  row2  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;13\u0026lt;/span\u0026gt;  key0  row4  item1  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;  key1  row3  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;  key0  row3  item1  col1  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.23\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;16\u0026lt;/span\u0026gt;  key0  row0  item2  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;17\u0026lt;/span\u0026gt;  key0  row4  item0  col3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.21\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18\u0026lt;/span\u0026gt;  key2  row2  item2  col0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;19\u0026lt;/span\u0026gt;  key0  row2  item0  col4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.70\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Question(s)\u0026lt;/h3\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Why do I get \u0026lt;code\u0026gt;ValueError: Index contains duplicate entries, cannot reshape\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, and mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3   NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;    NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;   NaN\n row4   NaN  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I pivot \u0026lt;code\u0026gt;df\u0026lt;/code\u0026gt; such that the \u0026lt;code\u0026gt;col\u0026lt;/code\u0026gt; values are columns, \u0026lt;code\u0026gt;row\u0026lt;/code\u0026gt; values are the index, mean of \u0026lt;code\u0026gt;val0\u0026lt;/code\u0026gt; are the values, and missing values are \u0026lt;code\u0026gt;0\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I get something other than \u0026lt;code\u0026gt;mean\u0026lt;/code\u0026gt;, like maybe \u0026lt;code\u0026gt;sum\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0  col1  col2  col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I do more that one aggregation at a time?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;sum\u0026lt;/span\u0026gt;                          mean\n col   col0  col1  col2  col3  col4  col0   col1   col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.21\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.09\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.52\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I aggregate over multiple value columns?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;       val0                             val1\n col   col0   col1   col2   col3  col4  col0   col1  col2   col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.860\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.01\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.745\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.010\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.02\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.500\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.45\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.34\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.440\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.79\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.310\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.545\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.230\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.075\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.100\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.395\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.760\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.070\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.42\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.300\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.46\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can Subdivide by multiple columns?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; item item0             item1                         item2\n col   col2  col3  col4  col0  col1  col2  col3  col4  col0   col1  col3  col4\n row\n row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.605\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.000\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Or\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; item      item0             item1                         item2\n col        col2  col3  col4  col0  col1  col2  col3  col4  col0  col1  col3  col4\n key  row\n key0 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.86\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.37\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.50\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.31\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.15\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.24\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n key1 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.77\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.81\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.65\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.35\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.44\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;\n      row3  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.28\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.10\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n key2 row0  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.40\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row2  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.13\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n      row4  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.64\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.88\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.00\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Can I aggregate the frequency in which the column and rows occur together, aka \u0026quot;cross tabulation\u0026quot;?\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt; col   col0  col1  col2  col3  col4\n row\n row0     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n row2     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n row3     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n row4     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I convert a DataFrame from long to wide by pivoting on ONLY two columns? Given,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1415\u0026lt;/span\u0026gt;])\ndf2 = pd.DataFrame({\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;A\u0026apos;\u0026lt;/span\u0026gt;: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;aaaabbbc\u0026apos;\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;B\u0026apos;\u0026lt;/span\u0026gt;: np.random.choice(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;15\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;)})\ndf2\n   A   B\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  a   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  a  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;6\u0026lt;/span\u0026gt;  b  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;  c   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The expected should look something like\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;      a     b    c\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7.0\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10.0\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;14.0\u0026lt;/span\u0026gt;  NaN\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;11.0\u0026lt;/span\u0026gt;   NaN  NaN\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;How do I flatten the multiple index to single index after \u0026lt;code\u0026gt;pivot\u0026lt;/code\u0026gt;?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;From\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\n   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\na  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nb  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\nc  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;   \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;|\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;\na    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nb    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\nc    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","slug":"how-can-i-pivot-a-dataframe-1657384433802","postType":"QUESTION","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","tags":[{"id":200,"name":"group-by","slug":"group-by","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":200}},{"id":201,"name":"pivot","slug":"pivot","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":201}},{"id":202,"name":"pandas-groupby","slug":"pandas-groupby","createdAt":"2022-07-09T16:33:53.000Z","updatedAt":"2022-07-09T16:33:53.000Z","Questions_Tags":{"questionId":56,"tagId":202}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-can-i-pivot-a-dataframe-1657384433802"},"buildId":"B9ZMQqRLGvIP-RcWN9dT2","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>