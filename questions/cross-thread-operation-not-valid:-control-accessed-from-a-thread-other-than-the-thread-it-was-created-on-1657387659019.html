<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="I have a scenario. (Windows Forms, C#, .NET)

There is a main form which hosts some user control.
The user control does some heavy data operation, such that if I directly call the UserControl_Load method the UI become nonresponsive for the duration for load method execution.
To overcome this I load data on different thread (trying to change existing code as little as I can)
I used a background worker thread which will be loading the data and when done will notify the application that it has done its work.
Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I&#x27;m fetching data based on the values of some control (like textbox) on userControl.

The pseudocode would look like this:
CODE 1
UserContrl1_LoadDataMethod()
{
    if (textbox1.text == &quot;MyName&quot;) // This gives exception
    {
        //Load data corresponding to &quot;MyName&quot;.
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage.
    }
}

The Exception it gave was

Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.

To know more about this I did some googling and a suggestion came up like using the following code
CODE 2
UserContrl1_LoadDataMethod()
{
    if (InvokeRequired) // Line #1
    {
        this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod));
        return;
    }

    if (textbox1.text == &quot;MyName&quot;) // Now it won&#x27;t give an exception
    {
    //Load data correspondin to &quot;MyName&quot;
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage
    }
}

But it still seems that I&#x27;ve come back to square one. The Application again
becomes unresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.
I don&#x27;t know whether I perceived this right or wrong. I&#x27;m new to threading.
How do I resolve this and also what is the effect of execution of Line#1 if block?
The situation is this: I want to load data into a global variable based on the value of a control. I don&#x27;t want to change the value of a control from the child thread. I&#x27;m not going to do it ever from a child thread.
So only accessing the value so that the corresponding data can be fetched from the database.
    "/><meta property="og:title" content="Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on | Solutions Checker"/><meta property="og:description" content="I have a scenario. (Windows Forms, C#, .NET)

There is a main form which hosts some user control.
The user control does some heavy data operation, such that if I directly call the UserControl_Load method the UI become nonresponsive for the duration for load method execution.
To overcome this I load data on different thread (trying to change existing code as little as I can)
I used a background worker thread which will be loading the data and when done will notify the application that it has done its work.
Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I&#x27;m fetching data based on the values of some control (like textbox) on userControl.

The pseudocode would look like this:
CODE 1
UserContrl1_LoadDataMethod()
{
    if (textbox1.text == &quot;MyName&quot;) // This gives exception
    {
        //Load data corresponding to &quot;MyName&quot;.
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage.
    }
}

The Exception it gave was

Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.

To know more about this I did some googling and a suggestion came up like using the following code
CODE 2
UserContrl1_LoadDataMethod()
{
    if (InvokeRequired) // Line #1
    {
        this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod));
        return;
    }

    if (textbox1.text == &quot;MyName&quot;) // Now it won&#x27;t give an exception
    {
    //Load data correspondin to &quot;MyName&quot;
        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage
    }
}

But it still seems that I&#x27;ve come back to square one. The Application again
becomes unresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.
I don&#x27;t know whether I perceived this right or wrong. I&#x27;m new to threading.
How do I resolve this and also what is the effect of execution of Line#1 if block?
The situation is this: I want to load data into a global variable based on the value of a control. I don&#x27;t want to change the value of a control from the child thread. I&#x27;m not going to do it ever from a child thread.
So only accessing the value so that the corresponding data can be fetched from the database.
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on","text":"I have a scenario. (Windows Forms, C#, .NET)\n\nThere is a main form which hosts some user control.\nThe user control does some heavy data operation, such that if I directly call the UserControl_Load method the UI become nonresponsive for the duration for load method execution.\nTo overcome this I load data on different thread (trying to change existing code as little as I can)\nI used a background worker thread which will be loading the data and when done will notify the application that it has done its work.\nNow came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I&apos;m fetching data based on the values of some control (like textbox) on userControl.\n\nThe pseudocode would look like this:\nCODE 1\nUserContrl1_LoadDataMethod()\n{\n    if (textbox1.text == &quot;MyName&quot;) // This gives exception\n    {\n        //Load data corresponding to &quot;MyName&quot;.\n        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage.\n    }\n}\n\nThe Exception it gave was\n\nCross-thread operation not valid: Control accessed from a thread other than the thread it was created on.\n\nTo know more about this I did some googling and a suggestion came up like using the following code\nCODE 2\nUserContrl1_LoadDataMethod()\n{\n    if (InvokeRequired) // Line #1\n    {\n        this.Invoke(new MethodInvoker(UserContrl1_LoadDataMethod));\n        return;\n    }\n\n    if (textbox1.text == &quot;MyName&quot;) // Now it won&apos;t give an exception\n    {\n    //Load data correspondin to &quot;MyName&quot;\n        //Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage\n    }\n}\n\nBut it still seems that I&apos;ve come back to square one. The Application again\nbecomes unresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.\nI don&apos;t know whether I perceived this right or wrong. I&apos;m new to threading.\nHow do I resolve this and also what is the effect of execution of Line#1 if block?\nThe situation is this: I want to load data into a global variable based on the value of a control. I don&apos;t want to change the value of a control from the child thread. I&apos;m not going to do it ever from a child thread.\nSo only accessing the value so that the corresponding data can be fetched from the database.\n    ","answerCount":22,"upVoteCount":500,"suggestedAnswer":[{"text":"As per Prerak K&apos;s update comment (since deleted):\n\nI guess I have not presented the question properly.\nSituation is this: I want to load data into a global variable based on the value of a control. I don&apos;t want to change the value of a control from the child thread. I&apos;m not going to do it ever from a child thread.\nSo only accessing the value so that corresponding data can be fetched from the database.\n\nThe solution you want then should look like:\nUserContrl1_LOadDataMethod()\n{\n    string name = &quot;&quot;;\n    if(textbox1.InvokeRequired)\n    {\n        textbox1.Invoke(new MethodInvoker(delegate { name = textbox1.text; }));\n    }\n    if(name == &quot;MyName&quot;)\n    {\n        // do whatever\n    }\n}\n\nDo your serious processing in the separate thread before you attempt to switch back to the control&apos;s thread. For example:\nUserContrl1_LOadDataMethod()\n{\n    if(textbox1.text==&quot;MyName&quot;) //&lt;&lt;======Now it wont give exception**\n    {\n        //Load data correspondin to &quot;MyName&quot;\n        //Populate a globale variable List&lt;string&gt; which will be\n        //bound to grid at some later stage\n        if(InvokeRequired)\n        {\n            // after we&apos;ve done all the processing, \n            this.Invoke(new MethodInvoker(delegate {\n                // load the control with the appropriate data\n            }));\n            return;\n        }\n    }\n}\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Threading Model in UI\n\nPlease read the Threading Model in UI applications (old VB link is here) in order to understand basic concepts. The link navigates to page that describes the WPF threading model. However, Windows Forms utilizes the same idea.\n\nThe UI Thread\n\n\nThere is only one thread (UI thread), that is allowed to access System.Windows.Forms.Control and its subclasses members.\nAttempt to access member of System.Windows.Forms.Control from different thread than UI thread will cause cross-thread exception.\nSince there is only one thread, all UI operations are queued as work items into that thread:\n\n\n\n\n\nIf there is no work for UI thread, then there are idle gaps that can be used by a not-UI related computing.\nIn order to use mentioned gaps use System.Windows.Forms.Control.Invoke or System.Windows.Forms.Control.BeginInvoke methods:\n\n\n\n\nBeginInvoke and Invoke methods\n\n\nThe computing overhead of method being invoked should be small as well as computing overhead of event handler methods because the UI thread is used there - the same that is responsible for handling user input. Regardless if this is System.Windows.Forms.Control.Invoke or System.Windows.Forms.Control.BeginInvoke.\nTo perform computing expensive operation always use separate thread. Since .NET 2.0 BackgroundWorker is dedicated to performing computing expensive operations in Windows Forms. However in new solutions you should use the async-await pattern as described here.\nUse System.Windows.Forms.Control.Invoke or System.Windows.Forms.Control.BeginInvoke methods only to update a user interface. If you use them for heavy computations, your application will block:\n\n\n\n\nInvoke\n\n\nSystem.Windows.Forms.Control.Invoke causes separate thread to wait till invoked method is completed:\n\n\n\n\nBeginInvoke\n\n\nSystem.Windows.Forms.Control.BeginInvoke doesn&apos;t cause the separate thread to wait till invoked method is completed:\n\n\n\n\nCode solution\n\nRead answers on question How to update the GUI from another thread in C#?.\nFor C# 5.0 and .NET 4.5 the recommended solution is here.\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"You only want to use Invoke or BeginInvoke for the bare minimum piece of work required to change the UI. Your &quot;heavy&quot; method should execute on another thread (e.g. via BackgroundWorker) but then using Control.Invoke/Control.BeginInvoke just to update the UI. That way your UI thread will be free to handle UI events etc.\n\nSee my threading article for a WinForms example - although the article was written before BackgroundWorker arrived on the scene, and I&apos;m afraid I haven&apos;t updated it in that respect. BackgroundWorker merely simplifies the callback a bit.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"I know its too late now. However even today if you are having trouble accessing cross thread controls? This is the shortest answer till date :P\n\nInvoke(new Action(() =&gt;\n                {\n                    label1.Text = &quot;WooHoo!!!&quot;;\n                }));\n\n\nThis is how i access any form control from a thread.\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"I have had this problem with the FileSystemWatcher and found that the following code solved the problem:\n\nfsw.SynchronizingObject = this\n\nThe control then uses the current form object to deal with the events, and will therefore be on the same thread.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"I find the check-and-invoke code which needs to be littered within all methods related to forms to be way too verbose and unneeded. Here&apos;s a simple extension method which lets you do away with it completely:\n\npublic static class Extensions\n{\n    public static void Invoke&lt;TControlType&gt;(this TControlType control, Action&lt;TControlType&gt; del) \n        where TControlType : Control\n        {\n            if (control.InvokeRequired)\n                control.Invoke(new Action(() =&gt; del(control)));\n            else\n                del(control);\n    }\n}\n\n\nAnd then you can simply do this:\n\ntextbox1.Invoke(t =&gt; t.Text = &quot;A&quot;);\n\n\nNo more messing around - simple.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"Controls in .NET are not generally thread safe.  That means you shouldn&apos;t access a control from a thread other than the one where it lives.  To get around this, you need to invoke the control, which is what your 2nd sample is attempting.  \n\nHowever, in your case all you&apos;ve done is pass the long-running method back to the main thread.  Of course, that&apos;s not really what you want to do.  You need to rethink this a little so that all you&apos;re doing on the main thread is setting a quick property here and there.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"The cleanest (and proper) solution for UI cross-threading issues is to use SynchronizationContext, see Synchronizing calls to the UI in a multi-threaded application article, it explains it very nicely.\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"Follow the simplest (in my opinion) way to modify objects from another thread:\n\nusing System.Threading.Tasks;\nusing System.Threading;\n\nnamespace TESTE\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            Action&lt;string&gt; DelegateTeste_ModifyText = THREAD_MOD;\n            Invoke(DelegateTeste_ModifyText, &quot;MODIFY BY THREAD&quot;);\n        }\n\n        private void THREAD_MOD(string teste)\n        {\n            textBox1.Text = teste;\n        }\n    }\n}\n\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"A new look using Async/Await and callbacks.  You only need one line of code if you keep the extension method in your project.  \n\n/// &lt;summary&gt;\n/// A new way to use Tasks for Asynchronous calls\n/// &lt;/summary&gt;\npublic class Example\n{\n    /// &lt;summary&gt;\n    /// No more delegates, background workers etc. just one line of code as shown below\n    /// Note it is dependent on the XTask class shown next.\n    /// &lt;/summary&gt;\n    public async void ExampleMethod()\n    {\n        //Still on GUI/Original Thread here\n        //Do your updates before the next line of code\n        await XTask.RunAsync(() =&gt;\n        {\n            //Running an asynchronous task here\n            //Cannot update GUI Thread here, but can do lots of work\n        });\n        //Can update GUI/Original thread on this line\n    }\n}\n\n/// &lt;summary&gt;\n/// A class containing extension methods for the Task class \n/// Put this file in folder named Extensions\n/// Use prefix of X for the class it Extends\n/// &lt;/summary&gt;\npublic static class XTask\n{\n    /// &lt;summary&gt;\n    /// RunAsync is an extension method that encapsulates the Task.Run using a callback\n    /// &lt;/summary&gt;\n    /// &lt;param name=&quot;Code&quot;&gt;The caller is called back on the new Task (on a different thread)&lt;/param&gt;\n    /// &lt;returns&gt;&lt;/returns&gt;\n    public async static Task RunAsync(Action Code)\n    {\n        await Task.Run(() =&gt;\n        {\n            Code();\n        });\n        return;\n    }\n}\n\n\nYou can add other things to the Extension method such as wrapping it in a Try/Catch statement, allowing caller to tell it what type to return after completion, an exception callback to caller:\n\nAdding Try Catch, Auto Exception Logging and CallBack\n\n    /// &lt;summary&gt;\n    /// Run Async\n    /// &lt;/summary&gt;\n    /// &lt;typeparam name=&quot;T&quot;&gt;The type to return&lt;/typeparam&gt;\n    /// &lt;param name=&quot;Code&quot;&gt;The callback to the code&lt;/param&gt;\n    /// &lt;param name=&quot;Error&quot;&gt;The handled and logged exception if one occurs&lt;/param&gt;\n    /// &lt;returns&gt;The type expected as a competed task&lt;/returns&gt;\n\n    public async static Task&lt;T&gt; RunAsync&lt;T&gt;(Func&lt;string,T&gt; Code, Action&lt;Exception&gt; Error)\n    {\n       var done =  await Task&lt;T&gt;.Run(() =&gt;\n        {\n            T result = default(T);\n            try\n            {\n               result = Code(&quot;Code Here&quot;);\n            }\n            catch (Exception ex)\n            {\n                Console.WriteLine(&quot;Unhandled Exception: &quot; + ex.Message);\n                Console.WriteLine(ex.StackTrace);\n                Error(ex);\n            }\n            return result;\n\n        });\n        return done;\n    }\n    public async void HowToUse()\n    {\n       //We now inject the type we want the async routine to return!\n       var result =  await RunAsync&lt;bool&gt;((code) =&gt; {\n           //write code here, all exceptions are logged via the wrapped try catch.\n           //return what is needed\n           return someBoolValue;\n       }, \n       error =&gt; {\n\n          //exceptions are already handled but are sent back here for further processing\n       });\n        if (result)\n        {\n            //we can now process the result because the code above awaited for the completion before\n            //moving to this statement\n        }\n    }\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"This is not the recommended way to solve this error but you can suppress it quickly, it will do the job . I prefer this for prototypes or demos . add \n\nCheckForIllegalCrossThreadCalls = false\n\n\nin Form1() constructor . \n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"You need to look at the Backgroundworker example:\nhttp://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx\nEspecially how it interacts with the UI layer.  Based on your posting, this seems to answer your issues.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"I found a need for this while programming an iOS-Phone monotouch app controller in a visual studio winforms prototype project outside of xamarin stuidio. Preferring to program in VS over xamarin studio as much as possible, I wanted the controller to be completely decoupled from the phone framework. This way implementing this for other frameworks like Android and Windows Phone would be much easier for future uses.\n\nI wanted a solution where the GUI could respond to events without the burden of dealing with the cross threading switching code behind every button click. Basically let the class controller handle that to keep the client code simple. You could possibly have many events on the GUI where as if you could handle it in one place in the class would be cleaner. I am not a multi theading expert, let me know if this is flawed.\n\npublic partial class Form1 : Form\n{\n    private ExampleController.MyController controller;\n\n    public Form1()\n    {          \n        InitializeComponent();\n        controller = new ExampleController.MyController((ISynchronizeInvoke) this);\n        controller.Finished += controller_Finished;\n    }\n\n    void controller_Finished(string returnValue)\n    {\n        label1.Text = returnValue; \n    }\n\n    private void button1_Click(object sender, EventArgs e)\n    {\n        controller.SubmitTask(&quot;Do It&quot;);\n    }\n}\n\n\nThe GUI form is unaware the controller is running asynchronous tasks.\n\npublic delegate void FinishedTasksHandler(string returnValue);\n\npublic class MyController\n{\n    private ISynchronizeInvoke _syn; \n    public MyController(ISynchronizeInvoke syn) {  _syn = syn; } \n    public event FinishedTasksHandler Finished; \n\n    public void SubmitTask(string someValue)\n    {\n        System.Threading.ThreadPool.QueueUserWorkItem(state =&gt; submitTask(someValue));\n    }\n\n    private void submitTask(string someValue)\n    {\n        someValue = someValue + &quot; &quot; + DateTime.Now.ToString();\n        System.Threading.Thread.Sleep(5000);\n//Finished(someValue); This causes cross threading error if called like this.\n\n        if (Finished != null)\n        {\n            if (_syn.InvokeRequired)\n            {\n                _syn.Invoke(Finished, new object[] { someValue });\n            }\n            else\n            {\n                Finished(someValue);\n            }\n        }\n    }\n}\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"Here is an alternative way if the object you are working with doesn&apos;t have \n\n(InvokeRequired)\n\n\nThis is useful if you are working with the main form in a class other than the main form with an object that is in the main form, but doesn&apos;t have InvokeRequired\n\ndelegate void updateMainFormObject(FormObjectType objectWithoutInvoke, string text);\n\nprivate void updateFormObjectType(FormObjectType objectWithoutInvoke, string text)\n{\n    MainForm.Invoke(new updateMainFormObject(UpdateObject), objectWithoutInvoke, text);\n}\n\npublic void UpdateObject(ToolStripStatusLabel objectWithoutInvoke, string text)\n{\n    objectWithoutInvoke.Text = text;\n}\n\n\nIt works the same as above, but it is a different approach if you don&apos;t have an object with invokerequired, but do have access to the MainForm\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0},{"text":"Along the same lines as previous answers,\nbut a very short addition that Allows to use all Control properties without having cross thread invokation exception.\n\nHelper Method\n\n/// &lt;summary&gt;\n/// Helper method to determin if invoke required, if so will rerun method on correct thread.\n/// if not do nothing.\n/// &lt;/summary&gt;\n/// &lt;param name=&quot;c&quot;&gt;Control that might require invoking&lt;/param&gt;\n/// &lt;param name=&quot;a&quot;&gt;action to preform on control thread if so.&lt;/param&gt;\n/// &lt;returns&gt;true if invoke required&lt;/returns&gt;\npublic bool ControlInvokeRequired(Control c, Action a)\n{\n    if (c.InvokeRequired) c.Invoke(new MethodInvoker(delegate\n    {\n        a();\n    }));\n    else return false;\n\n    return true;\n}\n\n\nSample Usage\n\n// usage on textbox\npublic void UpdateTextBox1(String text)\n{\n    //Check if invoke requied if so return - as i will be recalled in correct thread\n    if (ControlInvokeRequired(textBox1, () =&gt; UpdateTextBox1(text))) return;\n    textBox1.Text = ellapsed;\n}\n\n//Or any control\npublic void UpdateControl(Color c, String s)\n{\n    //Check if invoke requied if so return - as i will be recalled in correct thread\n    if (ControlInvokeRequired(myControl, () =&gt; UpdateControl(c, s))) return;\n    myControl.Text = s;\n    myControl.BackColor = c;\n}\n\n    ","url":"/questions/[slug]#solution15","@type":"Answer","upvoteCount":0},{"text":"this.Invoke(new MethodInvoker(delegate\n            {\n                //your code here;\n            }));\n\n    ","url":"/questions/[slug]#solution16","@type":"Answer","upvoteCount":0},{"text":"For example to get the text from a Control of the UI thread:\n\nPrivate Delegate Function GetControlTextInvoker(ByVal ctl As Control) As String\n\nPrivate Function GetControlText(ByVal ctl As Control) As String\n    Dim text As String\n\n    If ctl.InvokeRequired Then\n        text = CStr(ctl.Invoke(\n            New GetControlTextInvoker(AddressOf GetControlText), ctl))\n    Else\n        text = ctl.Text\n    End If\n\n    Return text\nEnd Function\n\n    ","url":"/questions/[slug]#solution17","@type":"Answer","upvoteCount":0},{"text":"Simple and re-usable way to work around this problem.\n\nExtension Method\n\npublic static class FormExts\n{\n    public static void LoadOnUI(this Form frm, Action action)\n    {\n        if (frm.InvokeRequired) frm.Invoke(action);\n        else action.Invoke();\n    }\n}\n\n\nSample Usage\n\nprivate void OnAnyEvent(object sender, EventArgs args)\n{\n    this.LoadOnUI(() =&gt;\n    {\n        label1.Text = &quot;&quot;;\n        button1.Text = &quot;&quot;;\n    });\n}\n\n    ","url":"/questions/[slug]#solution18","@type":"Answer","upvoteCount":0},{"text":"Same question : how-to-update-the-gui-from-another-thread-in-c\n\nTwo Ways:\n\n\nReturn value in e.result and use it to set yout textbox value in backgroundWorker_RunWorkerCompleted event\nDeclare some variable to hold these kind of values in a separate class (which will work as data holder) . Create static instance of this class adn you can access it over any thread.\n\n\nExample:\n\npublic  class data_holder_for_controls\n{\n    //it will hold value for your label\n    public  string status = string.Empty;\n}\n\nclass Demo\n{\n    public static  data_holder_for_controls d1 = new data_holder_for_controls();\n    static void Main(string[] args)\n    {\n        ThreadStart ts = new ThreadStart(perform_logic);\n        Thread t1 = new Thread(ts);\n        t1.Start();\n        t1.Join();\n        //your_label.Text=d1.status; --- can access it from any thread \n    }\n\n    public static void perform_logic()\n    {\n        //put some code here in this function\n        for (int i = 0; i &lt; 10; i++)\n        {\n            //statements here\n        }\n        //set result in status variable\n        d1.status = &quot;Task done&quot;;\n    }\n}\n\n    ","url":"/questions/[slug]#solution19","@type":"Answer","upvoteCount":0},{"text":"Simply use this:\n\nthis.Invoke((MethodInvoker)delegate\n            {\n                YourControl.Property= value; // runs thread safe\n            });\n\n    ","url":"/questions/[slug]#solution20","@type":"Answer","upvoteCount":0},{"text":"Action y; //declared inside class\n\nlabel1.Invoke(y=()=&gt;label1.Text=&quot;text&quot;);\n    ","url":"/questions/[slug]#solution21","@type":"Answer","upvoteCount":0},{"text":"There are two options for cross thread operations.\n\nControl.InvokeRequired Property \n\n\nand second one is to use \n\nSynchronizationContext Post Method\n\n\nControl.InvokeRequired is only useful when working controls inherited from Control class while SynchronizationContext can be used anywhere. Some useful information is as following links\n\nCross Thread Update UI | .Net \n\nCross Thread Update UI using SynchronizationContext | .Net\n    ","url":"/questions/[slug]#solution22","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/9fb80f4eb9e2d3c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9fb80f4eb9e2d3c9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-88567075f6bc9c6b.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/532-fec3344a80918110.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/817-363561828babdd16.js" defer=""></script><script src="/_next/static/chunks/81-2e45c38dc6fe8298.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-16d8c84aea765d4e.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_buildManifest.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.dlbxiY code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-344134f6-0"]{content:"dlbxiY,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/cross-thread-operation-not-valid%3A-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-344134f6-0 dlbxiY flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/cross-thread-operation-not-valid:-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019">Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/invoke">invoke</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/winforms">winforms</a></div></div><div class="question-content mt-5">
                
<p>I have a scenario. (Windows Forms, C#, .NET)</p>
<ol>
<li>There is a main form which hosts some user control.</li>
<li>The user control does some heavy data operation, such that if I directly call the <code>UserControl_Load</code> method the UI become nonresponsive for the duration for load method execution.</li>
<li>To overcome this I load data on different thread (trying to change existing code as little as I can)</li>
<li>I used a background worker thread which will be loading the data and when done will notify the application that it has done its work.</li>
<li>Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I'm fetching data based on the values of some control (like textbox) on userControl.</li>
</ol>
<p>The pseudocode would look like this:</p>
<p><strong>CODE 1</strong></p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">UserContrl1_LoadDataMethod()
{
    <span class="hljs-keyword">if</span> (textbox1.text == <span class="hljs-string">"MyName"</span>) <span class="hljs-comment">// This gives exception</span>
    {
        <span class="hljs-comment">//Load data corresponding to "MyName".</span>
        <span class="hljs-comment">//Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage.</span>
    }
}
</code></pre>
<p>The Exception it gave was</p>
<blockquote>
<p>Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.</p>
</blockquote>
<p>To know more about this I did some googling and a suggestion came up like using the following code</p>
<p><strong>CODE 2</strong></p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">UserContrl1_LoadDataMethod()
{
    <span class="hljs-keyword">if</span> (InvokeRequired) <span class="hljs-comment">// Line #1</span>
    {
        <span class="hljs-keyword">this</span>.Invoke(<span class="hljs-keyword">new</span> MethodInvoker(UserContrl1_LoadDataMethod));
        <span class="hljs-keyword">return</span>;
    }

    <span class="hljs-keyword">if</span> (textbox1.text == <span class="hljs-string">"MyName"</span>) <span class="hljs-comment">// Now it won't give an exception</span>
    {
    <span class="hljs-comment">//Load data correspondin to "MyName"</span>
        <span class="hljs-comment">//Populate a globale variable List&lt;string&gt; which will be binded to grid at some later stage</span>
    }
}
</code></pre>
<p>But it still seems that I've come back to square one. The Application again
becomes unresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.</p>
<p>I don't know whether I perceived this right or wrong. I'm new to threading.</p>
<p>How do I resolve this and also what is the effect of execution of Line#1 if block?</p>
<p><strong>The situation is this</strong>: I want to load data into a global variable based on the value of a control. I don't want to change the value of a control from the child thread. I'm not going to do it ever from a child thread.</p>
<p>So only accessing the value so that the corresponding data can be fetched from the database.</p>
    </div></div></div><div class="sc-344134f6-2 EUowZ"><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>As per <a href="https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the#142108">Prerak K's update comment</a> (since deleted):</p>
<blockquote>
<p>I guess I have not presented the question properly.</p>
<p>Situation is this: I want to load data into a global variable based on the value of a control. I don't want to change the value of a control from the child thread. I'm not going to do it ever from a child thread.</p>
<p>So only accessing the value so that corresponding data can be fetched from the database.</p>
</blockquote>
<p>The solution you want then should look like:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">UserContrl1_LOadDataMethod()
{
    <span class="hljs-built_in">string</span> name = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">if</span>(textbox1.InvokeRequired)
    {
        textbox1.Invoke(<span class="hljs-keyword">new</span> MethodInvoker(<span class="hljs-built_in">delegate</span> { name = textbox1.text; }));
    }
    <span class="hljs-keyword">if</span>(name == <span class="hljs-string">"MyName"</span>)
    {
        <span class="hljs-comment">// do whatever</span>
    }
}
</code></pre>
<p>Do your serious processing in the separate thread <em>before</em> you attempt to switch back to the control's thread. For example:</p>
<pre class="lang-cs s-code-block"><code class="hljs language-csharp">UserContrl1_LOadDataMethod()
{
    <span class="hljs-keyword">if</span>(textbox1.text==<span class="hljs-string">"MyName"</span>) <span class="hljs-comment">//&lt;&lt;======Now it wont give exception**</span>
    {
        <span class="hljs-comment">//Load data correspondin to "MyName"</span>
        <span class="hljs-comment">//Populate a globale variable List&lt;string&gt; which will be</span>
        <span class="hljs-comment">//bound to grid at some later stage</span>
        <span class="hljs-keyword">if</span>(InvokeRequired)
        {
            <span class="hljs-comment">// after we've done all the processing, </span>
            <span class="hljs-keyword">this</span>.Invoke(<span class="hljs-keyword">new</span> MethodInvoker(<span class="hljs-built_in">delegate</span> {
                <span class="hljs-comment">// load the control with the appropriate data</span>
            }));
            <span class="hljs-keyword">return</span>;
        }
    }
}
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Threading Model in UI</h1>

<p>Please read the <em><a href="https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/threading-model" rel="noreferrer">Threading Model</a></em> in UI applications (<a href="https://msdn.microsoft.com/library/ms741870(v=vs.100).aspx" rel="noreferrer">old VB link is here</a>) in order to understand basic concepts. The link navigates to page that describes the WPF threading model. However, Windows Forms utilizes the same idea.</p>

<h2>The UI Thread</h2>

<ul>
<li>There is only one thread (UI thread), that is allowed to access <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx" rel="noreferrer">System.Windows.Forms.Control</a> and its subclasses members.</li>
<li>Attempt to access member of <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx" rel="noreferrer">System.Windows.Forms.Control</a> from different thread than UI thread will cause cross-thread exception.</li>
<li>Since there is only one thread, all UI operations are queued as work items into that thread:</li>
</ul>

<p><img src="https://i.stack.imgur.com/6MtB3.png" alt="enter image description here"></p>

<ul>
<li>If there is no work for UI thread, then there are idle gaps that can be used by a not-UI related computing.</li>
<li>In order to use mentioned gaps use <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx" rel="noreferrer">System.Windows.Forms.Control.Invoke</a> or <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx" rel="noreferrer">System.Windows.Forms.Control.BeginInvoke</a> methods:</li>
</ul>

<p><img src="https://i.stack.imgur.com/WQPOJ.png" alt="enter image description here"></p>

<h2>BeginInvoke and Invoke methods</h2>

<ul>
<li>The computing overhead of method being invoked should be small as well as computing overhead of event handler methods because the UI thread is used there - the same that is responsible for handling user input. Regardless if this is <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx" rel="noreferrer">System.Windows.Forms.Control.Invoke</a> or <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx" rel="noreferrer">System.Windows.Forms.Control.BeginInvoke</a>.</li>
<li>To perform computing expensive operation always use separate thread. Since .NET 2.0 <a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx" rel="noreferrer">BackgroundWorker</a> is dedicated to performing computing expensive operations in Windows Forms. However in new solutions you should use the async-await pattern as described <a href="https://stackoverflow.com/a/18033198/2042090">here</a>.</li>
<li>Use <a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx" rel="noreferrer">System.Windows.Forms.Control.Invoke</a> or <a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx" rel="noreferrer">System.Windows.Forms.Control.BeginInvoke</a> methods only to update a user interface. If you use them for heavy computations, your application will block:</li>
</ul>

<p><img src="https://i.stack.imgur.com/UfBqr.png" alt="enter image description here"></p>

<h3>Invoke</h3>

<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx" rel="noreferrer">System.Windows.Forms.Control.Invoke</a> causes separate thread to wait till invoked method is completed:</li>
</ul>

<p><img src="https://i.stack.imgur.com/XmFJu.png" alt="enter image description here"></p>

<h3>BeginInvoke</h3>

<ul>
<li><a href="http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx" rel="noreferrer">System.Windows.Forms.Control.BeginInvoke</a> doesn't cause the separate thread to wait till invoked method is completed:</li>
</ul>

<p><img src="https://i.stack.imgur.com/8k5kn.png" alt="enter image description here"></p>

<h2>Code solution</h2>

<p>Read answers on question <a href="https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c">How to update the GUI from another thread in C#?</a>.
For C# 5.0 and .NET 4.5 the recommended solution is <a href="https://stackoverflow.com/a/18033198/2042090">here</a>.</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You only want to use <code>Invoke</code> or <code>BeginInvoke</code> for the bare minimum piece of work required to change the UI. Your "heavy" method should execute on another thread (e.g. via <code>BackgroundWorker</code>) but then using <code>Control.Invoke</code>/<code>Control.BeginInvoke</code> just to update the UI. That way your UI thread will be free to handle UI events etc.</p>

<p>See my <a href="http://pobox.com/~skeet/csharp/threads" rel="nofollow noreferrer">threading article</a> for a <a href="http://pobox.com/~skeet/csharp/threads/winforms.shtml" rel="nofollow noreferrer">WinForms example</a> - although the article was written before <code>BackgroundWorker</code> arrived on the scene, and I'm afraid I haven't updated it in that respect. <code>BackgroundWorker</code> merely simplifies the callback a bit.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I know its too late now. However even today if you are having trouble accessing cross thread controls? This is the shortest answer till date :P</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Invoke(<span class="hljs-keyword">new</span> Action(() =&gt;
                {
                    label1.Text = <span class="hljs-string">"WooHoo!!!"</span>;
                }));
</code></pre>

<p>This is how i access any form control from a thread.</p>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have had this problem with the <code>FileSystemWatcher</code> and found that the following code solved the problem:</p>

<p><code>fsw.SynchronizingObject = this</code></p>

<p>The control then uses the current form object to deal with the events, and will therefore be on the same thread.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I find the check-and-invoke code which needs to be littered within all methods related to forms to be way too verbose and unneeded. Here's a simple extension method which lets you do away with it completely:</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Extensions</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Invoke</span>&lt;<span class="hljs-title">TControlType</span>&gt;(<span class="hljs-params"><span class="hljs-keyword">this</span> TControlType control, Action&lt;TControlType&gt; del</span>) 
        <span class="hljs-keyword">where</span> TControlType : Control</span>
        {
            <span class="hljs-keyword">if</span> (control.InvokeRequired)
                control.Invoke(<span class="hljs-keyword">new</span> Action(() =&gt; del(control)));
            <span class="hljs-keyword">else</span>
                del(control);
    }
}
</code></pre>

<p>And then you can simply do this:</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">textbox1.Invoke(t =&gt; t.Text = <span class="hljs-string">"A"</span>);
</code></pre>

<p>No more messing around - simple.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Controls in .NET are not generally thread safe.  That means you shouldn't access a control from a thread other than the one where it lives.  To get around this, you need to <em>invoke</em> the control, which is what your 2nd sample is attempting.  </p>

<p>However, in your case all you've done is pass the long-running method back to the main thread.  Of course, that's not really what you want to do.  You need to rethink this a little so that all you're doing on the main thread is setting a quick property here and there.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The cleanest (and proper) solution for UI cross-threading issues is to use SynchronizationContext, see <a href="http://www.lostechies.com/blogs/gabrielschenker/archive/2009/01/23/synchronizing-calls-to-the-ui-in-a-multi-threaded-application.aspx" rel="noreferrer">Synchronizing calls to the UI in a multi-threaded application</a> article, it explains it very nicely.</p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Follow the simplest (in my opinion) way to modify objects from another thread:</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">using</span> System.Threading.Tasks;
<span class="hljs-keyword">using</span> System.Threading;

<span class="hljs-keyword">namespace</span> <span class="hljs-title">TESTE</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Form1</span> : <span class="hljs-title">Form</span>
    {
        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Form1</span>()</span>
        {
            InitializeComponent();
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">button1_Click</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
        {
            Action&lt;<span class="hljs-built_in">string</span>&gt; DelegateTeste_ModifyText = THREAD_MOD;
            Invoke(DelegateTeste_ModifyText, <span class="hljs-string">"MODIFY BY THREAD"</span>);
        }

        <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">THREAD_MOD</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> teste</span>)</span>
        {
            textBox1.Text = teste;
        }
    }
}
</code></pre>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>A new look using Async/Await and callbacks.  You only need one line of code if you keep the extension method in your project.  </p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> A new way to use Tasks for Asynchronous calls</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Example</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> No more delegates, background workers etc. just one line of code as shown below</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> Note it is dependent on the XTask class shown next.</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">ExampleMethod</span>()</span>
    {
        <span class="hljs-comment">//Still on GUI/Original Thread here</span>
        <span class="hljs-comment">//Do your updates before the next line of code</span>
        <span class="hljs-keyword">await</span> XTask.RunAsync(() =&gt;
        {
            <span class="hljs-comment">//Running an asynchronous task here</span>
            <span class="hljs-comment">//Cannot update GUI Thread here, but can do lots of work</span>
        });
        <span class="hljs-comment">//Can update GUI/Original thread on this line</span>
    }
}

<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> A class containing extension methods for the Task class </span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> Put this file in folder named Extensions</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> Use prefix of X for the class it Extends</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">XTask</span>
{
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> RunAsync is an extension method that encapsulates the Task.Run using a callback</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="Code"&gt;</span>The caller is called back on the new Task (on a different thread)<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span><span class="hljs-doctag">&lt;/returns&gt;</span></span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">static</span> Task <span class="hljs-title">RunAsync</span>(<span class="hljs-params">Action Code</span>)</span>
    {
        <span class="hljs-keyword">await</span> Task.Run(() =&gt;
        {
            Code();
        });
        <span class="hljs-keyword">return</span>;
    }
}
</code></pre>

<p>You can add other things to the Extension method such as wrapping it in a Try/Catch statement, allowing caller to tell it what type to return after completion, an exception callback to caller:</p>

<p><strong>Adding Try Catch, Auto Exception Logging and CallBack</strong></p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> Run Async</span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;typeparam name="T"&gt;</span>The type to return<span class="hljs-doctag">&lt;/typeparam&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="Code"&gt;</span>The callback to the code<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="Error"&gt;</span>The handled and logged exception if one occurs<span class="hljs-doctag">&lt;/param&gt;</span></span>
    <span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>The type expected as a competed task<span class="hljs-doctag">&lt;/returns&gt;</span></span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">static</span> <span class="hljs-title">Task</span>&lt;<span class="hljs-title">T</span>&gt; <span class="hljs-title">RunAsync</span>&lt;<span class="hljs-title">T</span>&gt;(<span class="hljs-params">Func&lt;<span class="hljs-built_in">string</span>,T&gt; Code, Action&lt;Exception&gt; Error</span>)</span>
    {
       <span class="hljs-keyword">var</span> done =  <span class="hljs-keyword">await</span> Task&lt;T&gt;.Run(() =&gt;
        {
            T result = <span class="hljs-literal">default</span>(T);
            <span class="hljs-keyword">try</span>
            {
               result = Code(<span class="hljs-string">"Code Here"</span>);
            }
            <span class="hljs-keyword">catch</span> (Exception ex)
            {
                Console.WriteLine(<span class="hljs-string">"Unhandled Exception: "</span> + ex.Message);
                Console.WriteLine(ex.StackTrace);
                Error(ex);
            }
            <span class="hljs-keyword">return</span> result;

        });
        <span class="hljs-keyword">return</span> done;
    }
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-keyword">void</span> <span class="hljs-title">HowToUse</span>()</span>
    {
       <span class="hljs-comment">//We now inject the type we want the async routine to return!</span>
       <span class="hljs-keyword">var</span> result =  <span class="hljs-keyword">await</span> RunAsync&lt;<span class="hljs-built_in">bool</span>&gt;((code) =&gt; {
           <span class="hljs-comment">//write code here, all exceptions are logged via the wrapped try catch.</span>
           <span class="hljs-comment">//return what is needed</span>
           <span class="hljs-keyword">return</span> someBoolValue;
       }, 
       error =&gt; {

          <span class="hljs-comment">//exceptions are already handled but are sent back here for further processing</span>
       });
        <span class="hljs-keyword">if</span> (result)
        {
            <span class="hljs-comment">//we can now process the result because the code above awaited for the completion before</span>
            <span class="hljs-comment">//moving to this statement</span>
        }
    }
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is not the recommended way to solve this error but you can suppress it quickly, it will do the job . I prefer this for prototypes or demos . add </p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">CheckForIllegalCrossThreadCalls = <span class="hljs-literal">false</span>
</code></pre>

<p>in <code>Form1()</code> constructor . </p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You need to look at the Backgroundworker example:<br>
<a href="http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx" rel="noreferrer">http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx</a>
Especially how it interacts with the UI layer.  Based on your posting, this seems to answer your issues.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I found a need for this while programming an iOS-Phone monotouch app controller in a visual studio winforms prototype project outside of xamarin stuidio. Preferring to program in VS over xamarin studio as much as possible, I wanted the controller to be completely decoupled from the phone framework. This way implementing this for other frameworks like Android and Windows Phone would be much easier for future uses.</p>

<p>I wanted a solution where the GUI could respond to events without the burden of dealing with the cross threading switching code behind every button click. Basically let the class controller handle that to keep the client code simple. You could possibly have many events on the GUI where as if you could handle it in one place in the class would be cleaner. I am not a multi theading expert, let me know if this is flawed.</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">Form1</span> : <span class="hljs-title">Form</span>
{
    <span class="hljs-keyword">private</span> ExampleController.MyController controller;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Form1</span>()</span>
    {          
        InitializeComponent();
        controller = <span class="hljs-keyword">new</span> ExampleController.MyController((ISynchronizeInvoke) <span class="hljs-keyword">this</span>);
        controller.Finished += controller_Finished;
    }

    <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">controller_Finished</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> returnValue</span>)</span>
    {
        label1.Text = returnValue; 
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">button1_Click</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs e</span>)</span>
    {
        controller.SubmitTask(<span class="hljs-string">"Do It"</span>);
    }
}
</code></pre>

<p>The GUI form is unaware the controller is running asynchronous tasks.</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">FinishedTasksHandler</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> returnValue</span>)</span>;

<span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyController</span>
{
    <span class="hljs-keyword">private</span> ISynchronizeInvoke _syn; 
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">MyController</span>(<span class="hljs-params">ISynchronizeInvoke syn</span>)</span> {  _syn = syn; } 
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">event</span> FinishedTasksHandler Finished; 

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">SubmitTask</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> someValue</span>)</span>
    {
        System.Threading.ThreadPool.QueueUserWorkItem(state =&gt; submitTask(someValue));
    }

    <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">submitTask</span>(<span class="hljs-params"><span class="hljs-built_in">string</span> someValue</span>)</span>
    {
        someValue = someValue + <span class="hljs-string">" "</span> + DateTime.Now.ToString();
        System.Threading.Thread.Sleep(<span class="hljs-number">5000</span>);
<span class="hljs-comment">//Finished(someValue); This causes cross threading error if called like this.</span>

        <span class="hljs-keyword">if</span> (Finished != <span class="hljs-literal">null</span>)
        {
            <span class="hljs-keyword">if</span> (_syn.InvokeRequired)
            {
                _syn.Invoke(Finished, <span class="hljs-keyword">new</span> <span class="hljs-built_in">object</span>[] { someValue });
            }
            <span class="hljs-keyword">else</span>
            {
                Finished(someValue);
            }
        }
    }
}
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Here is an alternative way if the object you are working with doesn't have </p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">(InvokeRequired)
</code></pre>

<p>This is useful if you are working with the main form in a class other than the main form with an object that is in the main form, but doesn't have InvokeRequired</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-built_in">delegate</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateMainFormObject</span>(<span class="hljs-params">FormObjectType objectWithoutInvoke, <span class="hljs-built_in">string</span> text</span>)</span>;

<span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">updateFormObjectType</span>(<span class="hljs-params">FormObjectType objectWithoutInvoke, <span class="hljs-built_in">string</span> text</span>)</span>
{
    MainForm.Invoke(<span class="hljs-keyword">new</span> updateMainFormObject(UpdateObject), objectWithoutInvoke, text);
}

<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateObject</span>(<span class="hljs-params">ToolStripStatusLabel objectWithoutInvoke, <span class="hljs-built_in">string</span> text</span>)</span>
{
    objectWithoutInvoke.Text = text;
}
</code></pre>

<p>It works the same as above, but it is a different approach if you don't have an object with invokerequired, but do have access to the MainForm</p>
    </div></div></div></div><div id="solution15" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 15</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Along the same lines as previous answers,
but a very short addition that Allows to use all Control properties without having cross thread invokation exception.</p>

<p><strong>Helper Method</strong></p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> Helper method to determin if invoke required, if so will rerun method on correct thread.</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> if not do nothing.</span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;/summary&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="c"&gt;</span>Control that might require invoking<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;param name="a"&gt;</span>action to preform on control thread if so.<span class="hljs-doctag">&lt;/param&gt;</span></span>
<span class="hljs-comment"><span class="hljs-doctag">///</span> <span class="hljs-doctag">&lt;returns&gt;</span>true if invoke required<span class="hljs-doctag">&lt;/returns&gt;</span></span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-built_in">bool</span> <span class="hljs-title">ControlInvokeRequired</span>(<span class="hljs-params">Control c, Action a</span>)</span>
{
    <span class="hljs-keyword">if</span> (c.InvokeRequired) c.Invoke(<span class="hljs-keyword">new</span> MethodInvoker(<span class="hljs-built_in">delegate</span>
    {
        a();
    }));
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
}
</code></pre>

<p><strong>Sample Usage</strong></p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-comment">// usage on textbox</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateTextBox1</span>(<span class="hljs-params">String text</span>)</span>
{
    <span class="hljs-comment">//Check if invoke requied if so return - as i will be recalled in correct thread</span>
    <span class="hljs-keyword">if</span> (ControlInvokeRequired(textBox1, () =&gt; UpdateTextBox1(text))) <span class="hljs-keyword">return</span>;
    textBox1.Text = ellapsed;
}

<span class="hljs-comment">//Or any control</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">UpdateControl</span>(<span class="hljs-params">Color c, String s</span>)</span>
{
    <span class="hljs-comment">//Check if invoke requied if so return - as i will be recalled in correct thread</span>
    <span class="hljs-keyword">if</span> (ControlInvokeRequired(myControl, () =&gt; UpdateControl(c, s))) <span class="hljs-keyword">return</span>;
    myControl.Text = s;
    myControl.BackColor = c;
}
</code></pre>
    </div></div></div></div><div id="solution16" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 16</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">this</span>.Invoke(<span class="hljs-keyword">new</span> MethodInvoker(<span class="hljs-built_in">delegate</span>
            {
                <span class="hljs-comment">//your code here;</span>
            }));
</code></pre>
    </div></div></div></div><div id="solution17" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 17</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For example to get the text from a Control of the UI thread:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Delegate</span> <span class="hljs-keyword">Function</span> GetControlTextInvoker(<span class="hljs-keyword">ByVal</span> ctl <span class="hljs-keyword">As</span> Control) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

<span class="hljs-keyword">Private</span> <span class="hljs-keyword">Function</span> GetControlText(<span class="hljs-keyword">ByVal</span> ctl <span class="hljs-keyword">As</span> Control) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> <span class="hljs-keyword">text</span> <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

    <span class="hljs-keyword">If</span> ctl.InvokeRequired <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">text</span> = <span class="hljs-built_in">CStr</span>(ctl.Invoke(
            <span class="hljs-built_in">New</span> GetControlTextInvoker(<span class="hljs-built_in">AddressOf</span> GetControlText), ctl))
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">text</span> = ctl.<span class="hljs-keyword">Text</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    <span class="hljs-keyword">Return</span> <span class="hljs-keyword">text</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
    </div></div></div></div><div id="solution18" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 18</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Simple and re-usable way to work around this problem.</p>

<p><strong>Extension Method</strong></p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FormExts</span>
{
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">LoadOnUI</span>(<span class="hljs-params"><span class="hljs-keyword">this</span> Form frm, Action action</span>)</span>
    {
        <span class="hljs-keyword">if</span> (frm.InvokeRequired) frm.Invoke(action);
        <span class="hljs-keyword">else</span> action.Invoke();
    }
}
</code></pre>

<p><strong>Sample Usage</strong></p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title">OnAnyEvent</span>(<span class="hljs-params"><span class="hljs-built_in">object</span> sender, EventArgs args</span>)</span>
{
    <span class="hljs-keyword">this</span>.LoadOnUI(() =&gt;
    {
        label1.Text = <span class="hljs-string">""</span>;
        button1.Text = <span class="hljs-string">""</span>;
    });
}
</code></pre>
    </div></div></div></div><div id="solution19" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 19</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c">Same question : how-to-update-the-gui-from-another-thread-in-c</a></p>

<p>Two Ways:</p>

<ol>
<li><p>Return value in e.result and use it to set yout textbox value in backgroundWorker_RunWorkerCompleted event</p></li>
<li><p>Declare some variable to hold these kind of values in a separate class (which will work as data holder) . Create static instance of this class adn you can access it over any thread.</p></li>
</ol>

<p>Example:</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">public</span>  <span class="hljs-keyword">class</span> <span class="hljs-title">data_holder_for_controls</span>
{
    <span class="hljs-comment">//it will hold value for your label</span>
    <span class="hljs-keyword">public</span>  <span class="hljs-built_in">string</span> status = <span class="hljs-built_in">string</span>.Empty;
}

<span class="hljs-keyword">class</span> <span class="hljs-title">Demo</span>
{
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span>  data_holder_for_controls d1 = <span class="hljs-keyword">new</span> data_holder_for_controls();
    <span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"><span class="hljs-built_in">string</span>[] args</span>)</span>
    {
        ThreadStart ts = <span class="hljs-keyword">new</span> ThreadStart(perform_logic);
        Thread t1 = <span class="hljs-keyword">new</span> Thread(ts);
        t1.Start();
        t1.Join();
        <span class="hljs-comment">//your_label.Text=d1.status; --- can access it from any thread </span>
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">perform_logic</span>()</span>
    {
        <span class="hljs-comment">//put some code here in this function</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-built_in">int</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">10</span>; i++)
        {
            <span class="hljs-comment">//statements here</span>
        }
        <span class="hljs-comment">//set result in status variable</span>
        d1.status = <span class="hljs-string">"Task done"</span>;
    }
}
</code></pre>
    </div></div></div></div><div id="solution20" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 20</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Simply use this:</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp"><span class="hljs-keyword">this</span>.Invoke((MethodInvoker)<span class="hljs-built_in">delegate</span>
            {
                YourControl.Property= <span class="hljs-keyword">value</span>; <span class="hljs-comment">// runs thread safe</span>
            });
</code></pre>
    </div></div></div></div><div id="solution21" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 21</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Action y; //declared inside class</p>

<p>label1.Invoke(y=()=&gt;label1.Text="text");</p>
    </div></div></div></div><div id="solution22" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 22</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>There are two options for cross thread operations.</p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">Control.InvokeRequired Property 
</code></pre>

<p>and second one is to use </p>

<pre class="lang-cs s-code-block"><code class="hljs language-csharp">SynchronizationContext Post Method
</code></pre>

<p>Control.InvokeRequired is only useful when working controls inherited from Control class while SynchronizationContext can be used anywhere. Some useful information is as following links</p>

<p><a href="http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet" rel="nofollow noreferrer">Cross Thread Update UI | .Net</a> </p>

<p><a href="http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet-synchronization-context" rel="nofollow noreferrer">Cross Thread Update UI using SynchronizationContext | .Net</a></p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;As per \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/142003/cross-thread-operation-not-valid-control-accessed-from-a-thread-other-than-the#142108\u0026quot;\u0026gt;Prerak K\u0026apos;s update comment\u0026lt;/a\u0026gt; (since deleted):\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;I guess I have not presented the question properly.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Situation is this: I want to load data into a global variable based on the value of a control. I don\u0026apos;t want to change the value of a control from the child thread. I\u0026apos;m not going to do it ever from a child thread.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So only accessing the value so that corresponding data can be fetched from the database.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;The solution you want then should look like:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;UserContrl1_LOadDataMethod()\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; name = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(textbox1.InvokeRequired)\n    {\n        textbox1.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MethodInvoker(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt; { name = textbox1.text; }));\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(name == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;)\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// do whatever\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Do your serious processing in the separate thread \u0026lt;em\u0026gt;before\u0026lt;/em\u0026gt; you attempt to switch back to the control\u0026apos;s thread. For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;UserContrl1_LOadDataMethod()\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(textbox1.text==\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//\u0026amp;lt;\u0026amp;lt;======Now it wont give exception**\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Load data correspondin to \u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Populate a globale variable List\u0026amp;lt;string\u0026amp;gt; which will be\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//bound to grid at some later stage\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(InvokeRequired)\n        {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// after we\u0026apos;ve done all the processing, \u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MethodInvoker(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// load the control with the appropriate data\u0026lt;/span\u0026gt;\n            }));\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Threading Model in UI\u0026lt;/h1\u0026gt;\n\n\u0026lt;p\u0026gt;Please read the \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/dotnet/framework/wpf/advanced/threading-model\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Threading Model\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt; in UI applications (\u0026lt;a href=\u0026quot;https://msdn.microsoft.com/library/ms741870(v=vs.100).aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;old VB link is here\u0026lt;/a\u0026gt;) in order to understand basic concepts. The link navigates to page that describes the WPF threading model. However, Windows Forms utilizes the same idea.\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;The UI Thread\u0026lt;/h2\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;There is only one thread (UI thread), that is allowed to access \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control\u0026lt;/a\u0026gt; and its subclasses members.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Attempt to access member of \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control\u0026lt;/a\u0026gt; from different thread than UI thread will cause cross-thread exception.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Since there is only one thread, all UI operations are queued as work items into that thread:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/6MtB3.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;If there is no work for UI thread, then there are idle gaps that can be used by a not-UI related computing.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;In order to use mentioned gaps use \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.Invoke\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.BeginInvoke\u0026lt;/a\u0026gt; methods:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/WQPOJ.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;BeginInvoke and Invoke methods\u0026lt;/h2\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The computing overhead of method being invoked should be small as well as computing overhead of event handler methods because the UI thread is used there - the same that is responsible for handling user input. Regardless if this is \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.Invoke\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.BeginInvoke\u0026lt;/a\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;To perform computing expensive operation always use separate thread. Since .NET 2.0 \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;BackgroundWorker\u0026lt;/a\u0026gt; is dedicated to performing computing expensive operations in Windows Forms. However in new solutions you should use the async-await pattern as described \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/18033198/2042090\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Use \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.Invoke\u0026lt;/a\u0026gt; or \u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.BeginInvoke\u0026lt;/a\u0026gt; methods only to update a user interface. If you use them for heavy computations, your application will block:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/UfBqr.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;Invoke\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/System.Windows.Forms.Control.Invoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.Invoke\u0026lt;/a\u0026gt; causes separate thread to wait till invoked method is completed:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/XmFJu.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h3\u0026gt;BeginInvoke\u0026lt;/h3\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.windows.forms.control.begininvoke.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;System.Windows.Forms.Control.BeginInvoke\u0026lt;/a\u0026gt; doesn\u0026apos;t cause the separate thread to wait till invoked method is completed:\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/8k5kn.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Code solution\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Read answers on question \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c\u0026quot;\u0026gt;How to update the GUI from another thread in C#?\u0026lt;/a\u0026gt;.\nFor C# 5.0 and .NET 4.5 the recommended solution is \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/18033198/2042090\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You only want to use \u0026lt;code\u0026gt;Invoke\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;BeginInvoke\u0026lt;/code\u0026gt; for the bare minimum piece of work required to change the UI. Your \u0026quot;heavy\u0026quot; method should execute on another thread (e.g. via \u0026lt;code\u0026gt;BackgroundWorker\u0026lt;/code\u0026gt;) but then using \u0026lt;code\u0026gt;Control.Invoke\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;Control.BeginInvoke\u0026lt;/code\u0026gt; just to update the UI. That way your UI thread will be free to handle UI events etc.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;See my \u0026lt;a href=\u0026quot;http://pobox.com/~skeet/csharp/threads\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;threading article\u0026lt;/a\u0026gt; for a \u0026lt;a href=\u0026quot;http://pobox.com/~skeet/csharp/threads/winforms.shtml\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;WinForms example\u0026lt;/a\u0026gt; - although the article was written before \u0026lt;code\u0026gt;BackgroundWorker\u0026lt;/code\u0026gt; arrived on the scene, and I\u0026apos;m afraid I haven\u0026apos;t updated it in that respect. \u0026lt;code\u0026gt;BackgroundWorker\u0026lt;/code\u0026gt; merely simplifies the callback a bit.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I know its too late now. However even today if you are having trouble accessing cross thread controls? This is the shortest answer till date :P\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Action(() =\u0026amp;gt;\n                {\n                    label1.Text = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;WooHoo!!!\u0026quot;\u0026lt;/span\u0026gt;;\n                }));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is how i access any form control from a thread.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have had this problem with the \u0026lt;code\u0026gt;FileSystemWatcher\u0026lt;/code\u0026gt; and found that the following code solved the problem:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;fsw.SynchronizingObject = this\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The control then uses the current form object to deal with the events, and will therefore be on the same thread.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I find the check-and-invoke code which needs to be littered within all methods related to forms to be way too verbose and unneeded. Here\u0026apos;s a simple extension method which lets you do away with it completely:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Extensions\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Invoke\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;TControlType\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt; TControlType control, Action\u0026amp;lt;TControlType\u0026amp;gt; del\u0026lt;/span\u0026gt;) \n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;where\u0026lt;/span\u0026gt; TControlType : Control\u0026lt;/span\u0026gt;\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (control.InvokeRequired)\n                control.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Action(() =\u0026amp;gt; del(control)));\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n                del(control);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;And then you can simply do this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;textbox1.Invoke(t =\u0026amp;gt; t.Text = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A\u0026quot;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;No more messing around - simple.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Controls in .NET are not generally thread safe.  That means you shouldn\u0026apos;t access a control from a thread other than the one where it lives.  To get around this, you need to \u0026lt;em\u0026gt;invoke\u0026lt;/em\u0026gt; the control, which is what your 2nd sample is attempting.  \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;However, in your case all you\u0026apos;ve done is pass the long-running method back to the main thread.  Of course, that\u0026apos;s not really what you want to do.  You need to rethink this a little so that all you\u0026apos;re doing on the main thread is setting a quick property here and there.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The cleanest (and proper) solution for UI cross-threading issues is to use SynchronizationContext, see \u0026lt;a href=\u0026quot;http://www.lostechies.com/blogs/gabrielschenker/archive/2009/01/23/synchronizing-calls-to-the-ui-in-a-multi-threaded-application.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Synchronizing calls to the UI in a multi-threaded application\u0026lt;/a\u0026gt; article, it explains it very nicely.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Follow the simplest (in my opinion) way to modify objects from another thread:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Threading.Tasks;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;using\u0026lt;/span\u0026gt; System.Threading;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;namespace\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;TESTE\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partial\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n        {\n            InitializeComponent();\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;button1_Click\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n        {\n            Action\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;\u0026amp;gt; DelegateTeste_ModifyText = THREAD_MOD;\n            Invoke(DelegateTeste_ModifyText, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MODIFY BY THREAD\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n\n        \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;THREAD_MOD\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; teste\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n        {\n            textBox1.Text = teste;\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;A new look using Async/Await and callbacks.  You only need one line of code if you keep the extension method in your project.  \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; A new way to use Tasks for Asynchronous calls\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Example\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; No more delegates, background workers etc. just one line of code as shown below\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; Note it is dependent on the XTask class shown next.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;ExampleMethod\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Still on GUI/Original Thread here\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Do your updates before the next line of code\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; XTask.RunAsync(() =\u0026amp;gt;\n        {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Running an asynchronous task here\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Cannot update GUI Thread here, but can do lots of work\u0026lt;/span\u0026gt;\n        });\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Can update GUI/Original thread on this line\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; A class containing extension methods for the Task class \u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; Put this file in folder named Extensions\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; Use prefix of X for the class it Extends\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;XTask\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; RunAsync is an extension method that encapsulates the Task.Run using a callback\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;param name=\u0026quot;Code\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;The caller is called back on the new Task (on a different thread)\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/param\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;returns\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/returns\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; Task \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;RunAsync\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Action Code\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; Task.Run(() =\u0026amp;gt;\n        {\n            Code();\n        });\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;You can add other things to the Extension method such as wrapping it in a Try/Catch statement, allowing caller to tell it what type to return after completion, an exception callback to caller:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Adding Try Catch, Auto Exception Logging and CallBack\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; Run Async\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;typeparam name=\u0026quot;T\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;The type to return\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/typeparam\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;param name=\u0026quot;Code\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;The callback to the code\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/param\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;param name=\u0026quot;Error\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;The handled and logged exception if one occurs\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/param\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;returns\u0026amp;gt;\u0026lt;/span\u0026gt;The type expected as a competed task\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/returns\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Task\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;RunAsync\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;T\u0026lt;/span\u0026gt;\u0026amp;gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Func\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;,T\u0026amp;gt; Code, Action\u0026amp;lt;Exception\u0026amp;gt; Error\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; done =  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; Task\u0026amp;lt;T\u0026amp;gt;.Run(() =\u0026amp;gt;\n        {\n            T result = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;default\u0026lt;/span\u0026gt;(T);\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt;\n            {\n               result = Code(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Code Here\u0026quot;\u0026lt;/span\u0026gt;);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; (Exception ex)\n            {\n                Console.WriteLine(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Unhandled Exception: \u0026quot;\u0026lt;/span\u0026gt; + ex.Message);\n                Console.WriteLine(ex.StackTrace);\n                Error(ex);\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; result;\n\n        });\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; done;\n    }\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;async\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;HowToUse\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//We now inject the type we want the async routine to return!\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; result =  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;await\u0026lt;/span\u0026gt; RunAsync\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\u0026amp;gt;((code) =\u0026amp;gt; {\n           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//write code here, all exceptions are logged via the wrapped try catch.\u0026lt;/span\u0026gt;\n           \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//return what is needed\u0026lt;/span\u0026gt;\n           \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; someBoolValue;\n       }, \n       error =\u0026amp;gt; {\n\n          \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//exceptions are already handled but are sent back here for further processing\u0026lt;/span\u0026gt;\n       });\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (result)\n        {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//we can now process the result because the code above awaited for the completion before\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//moving to this statement\u0026lt;/span\u0026gt;\n        }\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is not the recommended way to solve this error but you can suppress it quickly, it will do the job . I prefer this for prototypes or demos . add \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;CheckForIllegalCrossThreadCalls = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;in \u0026lt;code\u0026gt;Form1()\u0026lt;/code\u0026gt; constructor . \u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You need to look at the Backgroundworker example:\u0026lt;br\u0026gt;\n\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx\u0026lt;/a\u0026gt;\nEspecially how it interacts with the UI layer.  Based on your posting, this seems to answer your issues.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I found a need for this while programming an iOS-Phone monotouch app controller in a visual studio winforms prototype project outside of xamarin stuidio. Preferring to program in VS over xamarin studio as much as possible, I wanted the controller to be completely decoupled from the phone framework. This way implementing this for other frameworks like Android and Windows Phone would be much easier for future uses.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I wanted a solution where the GUI could respond to events without the burden of dealing with the cross threading switching code behind every button click. Basically let the class controller handle that to keep the client code simple. You could possibly have many events on the GUI where as if you could handle it in one place in the class would be cleaner. I am not a multi theading expert, let me know if this is flawed.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;partial\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; ExampleController.MyController controller;\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Form1\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {          \n        InitializeComponent();\n        controller = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; ExampleController.MyController((ISynchronizeInvoke) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;);\n        controller.Finished += controller_Finished;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;controller_Finished\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; returnValue\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        label1.Text = returnValue; \n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;button1_Click\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs e\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        controller.SubmitTask(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Do It\u0026quot;\u0026lt;/span\u0026gt;);\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;The GUI form is unaware the controller is running asynchronous tasks.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;FinishedTasksHandler\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; returnValue\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyController\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; ISynchronizeInvoke _syn; \n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyController\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ISynchronizeInvoke syn\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt; {  _syn = syn; } \n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;event\u0026lt;/span\u0026gt; FinishedTasksHandler Finished; \n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;SubmitTask\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; someValue\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        System.Threading.ThreadPool.QueueUserWorkItem(state =\u0026amp;gt; submitTask(someValue));\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;submitTask\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; someValue\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        someValue = someValue + \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; \u0026quot;\u0026lt;/span\u0026gt; + DateTime.Now.ToString();\n        System.Threading.Thread.Sleep(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5000\u0026lt;/span\u0026gt;);\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Finished(someValue); This causes cross threading error if called like this.\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (Finished != \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;)\n        {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (_syn.InvokeRequired)\n            {\n                _syn.Invoke(Finished, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt;[] { someValue });\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n            {\n                Finished(someValue);\n            }\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Here is an alternative way if the object you are working with doesn\u0026apos;t have \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;(InvokeRequired)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This is useful if you are working with the main form in a class other than the main form with an object that is in the main form, but doesn\u0026apos;t have InvokeRequired\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;updateMainFormObject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FormObjectType objectWithoutInvoke, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; text\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;;\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;updateFormObjectType\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;FormObjectType objectWithoutInvoke, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; text\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    MainForm.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; updateMainFormObject(UpdateObject), objectWithoutInvoke, text);\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;UpdateObject\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ToolStripStatusLabel objectWithoutInvoke, \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; text\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    objectWithoutInvoke.Text = text;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;It works the same as above, but it is a different approach if you don\u0026apos;t have an object with invokerequired, but do have access to the MainForm\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Along the same lines as previous answers,\nbut a very short addition that Allows to use all Control properties without having cross thread invokation exception.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Helper Method\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; Helper method to determin if invoke required, if so will rerun method on correct thread.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; if not do nothing.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/summary\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;param name=\u0026quot;c\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;Control that might require invoking\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/param\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;param name=\u0026quot;a\u0026quot;\u0026amp;gt;\u0026lt;/span\u0026gt;action to preform on control thread if so.\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/param\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;///\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;returns\u0026amp;gt;\u0026lt;/span\u0026gt;true if invoke required\u0026lt;span class=\u0026quot;hljs-doctag\u0026quot;\u0026gt;\u0026amp;lt;/returns\u0026amp;gt;\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;ControlInvokeRequired\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Control c, Action a\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (c.InvokeRequired) c.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MethodInvoker(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt;\n    {\n        a();\n    }));\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Sample Usage\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// usage on textbox\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;UpdateTextBox1\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;String text\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Check if invoke requied if so return - as i will be recalled in correct thread\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (ControlInvokeRequired(textBox1, () =\u0026amp;gt; UpdateTextBox1(text))) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n    textBox1.Text = ellapsed;\n}\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Or any control\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;UpdateControl\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Color c, String s\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Check if invoke requied if so return - as i will be recalled in correct thread\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (ControlInvokeRequired(myControl, () =\u0026amp;gt; UpdateControl(c, s))) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n    myControl.Text = s;\n    myControl.BackColor = c;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MethodInvoker(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt;\n            {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//your code here;\u0026lt;/span\u0026gt;\n            }));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For example to get the text from a Control of the UI thread:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Delegate\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; GetControlTextInvoker(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; ctl \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Control) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; GetControlText(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;ByVal\u0026lt;/span\u0026gt; ctl \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Control) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;text\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; ctl.InvokeRequired \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;text\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CStr\u0026lt;/span\u0026gt;(ctl.Invoke(\n            \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;New\u0026lt;/span\u0026gt; GetControlTextInvoker(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;AddressOf\u0026lt;/span\u0026gt; GetControlText), ctl))\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;text\u0026lt;/span\u0026gt; = ctl.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Text\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;text\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Simple and re-usable way to work around this problem.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Extension Method\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;FormExts\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;LoadOnUI\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt; Form frm, Action action\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (frm.InvokeRequired) frm.Invoke(action);\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; action.Invoke();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Sample Usage\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;OnAnyEvent\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; sender, EventArgs args\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.LoadOnUI(() =\u0026amp;gt;\n    {\n        label1.Text = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n        button1.Text = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;;\n    });\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/661561/how-to-update-the-gui-from-another-thread-in-c\u0026quot;\u0026gt;Same question : how-to-update-the-gui-from-another-thread-in-c\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Two Ways:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Return value in e.result and use it to set yout textbox value in backgroundWorker_RunWorkerCompleted event\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Declare some variable to hold these kind of values in a separate class (which will work as data holder) . Create static instance of this class adn you can access it over any thread.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;Example:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;data_holder_for_controls\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//it will hold value for your label\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt; status = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;.Empty;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Demo\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt;  data_holder_for_controls d1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; data_holder_for_controls();\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;Main\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;string\u0026lt;/span\u0026gt;[] args\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\n    {\n        ThreadStart ts = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; ThreadStart(perform_logic);\n        Thread t1 = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Thread(ts);\n        t1.Start();\n        t1.Join();\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//your_label.Text=d1.status; --- can access it from any thread \u0026lt;/span\u0026gt;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;perform_logic\u0026lt;/span\u0026gt;()\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//put some code here in this function\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; (\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;; i \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10\u0026lt;/span\u0026gt;; i++)\n        {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//statements here\u0026lt;/span\u0026gt;\n        }\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//set result in status variable\u0026lt;/span\u0026gt;\n        d1.status = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Task done\u0026quot;\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Simply use this:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.Invoke((MethodInvoker)\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;delegate\u0026lt;/span\u0026gt;\n            {\n                YourControl.Property= \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;value\u0026lt;/span\u0026gt;; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// runs thread safe\u0026lt;/span\u0026gt;\n            });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Action y; //declared inside class\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;label1.Invoke(y=()=\u0026amp;gt;label1.Text=\u0026quot;text\u0026quot;);\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;There are two options for cross thread operations.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Control.InvokeRequired Property \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and second one is to use \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;SynchronizationContext Post Method\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Control.InvokeRequired is only useful when working controls inherited from Control class while SynchronizationContext can be used anywhere. Some useful information is as following links\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Cross Thread Update UI | .Net\u0026lt;/a\u0026gt; \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://www.ilmlinks.com/Snippets/cross-thread-update-ui-in-dotnet-synchronization-context\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Cross Thread Update UI using SynchronizationContext | .Net\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    "],"id":330,"title":"Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on","content":"\n                \n\u0026lt;p\u0026gt;I have a scenario. (Windows Forms, C#, .NET)\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;There is a main form which hosts some user control.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;The user control does some heavy data operation, such that if I directly call the \u0026lt;code\u0026gt;UserControl_Load\u0026lt;/code\u0026gt; method the UI become nonresponsive for the duration for load method execution.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;To overcome this I load data on different thread (trying to change existing code as little as I can)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;I used a background worker thread which will be loading the data and when done will notify the application that it has done its work.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Now came a real problem. All the UI (main form and its child usercontrols) was created on the primary main thread. In the LOAD method of the usercontrol I\u0026apos;m fetching data based on the values of some control (like textbox) on userControl.\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;The pseudocode would look like this:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;CODE 1\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;UserContrl1_LoadDataMethod()\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (textbox1.text == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This gives exception\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Load data corresponding to \u0026quot;MyName\u0026quot;.\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Populate a globale variable List\u0026amp;lt;string\u0026amp;gt; which will be binded to grid at some later stage.\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;The Exception it gave was\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Cross-thread operation not valid: Control accessed from a thread other than the thread it was created on.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;To know more about this I did some googling and a suggestion came up like using the following code\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;CODE 2\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-cs s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;UserContrl1_LoadDataMethod()\n{\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (InvokeRequired) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Line #1\u0026lt;/span\u0026gt;\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.Invoke(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; MethodInvoker(UserContrl1_LoadDataMethod));\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (textbox1.text == \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Now it won\u0026apos;t give an exception\u0026lt;/span\u0026gt;\n    {\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Load data correspondin to \u0026quot;MyName\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//Populate a globale variable List\u0026amp;lt;string\u0026amp;gt; which will be binded to grid at some later stage\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But it still seems that I\u0026apos;ve come back to square one. The Application again\nbecomes unresponsive. It seems to be due to the execution of line #1 if condition. The loading task is again done by the parent thread and not the third that I spawned.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I don\u0026apos;t know whether I perceived this right or wrong. I\u0026apos;m new to threading.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;How do I resolve this and also what is the effect of execution of Line#1 if block?\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The situation is this\u0026lt;/strong\u0026gt;: I want to load data into a global variable based on the value of a control. I don\u0026apos;t want to change the value of a control from the child thread. I\u0026apos;m not going to do it ever from a child thread.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So only accessing the value so that the corresponding data can be fetched from the database.\u0026lt;/p\u0026gt;\n    ","slug":"cross-thread-operation-not-valid:-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019","postType":"QUESTION","createdAt":"2022-07-09T17:27:39.000Z","updatedAt":"2022-07-09T17:27:39.000Z","tags":[{"id":1902,"name":"invoke","slug":"invoke","createdAt":"2022-07-09T17:27:39.000Z","updatedAt":"2022-07-09T17:27:39.000Z","Questions_Tags":{"questionId":330,"tagId":1902}},{"id":1903,"name":"winforms","slug":"winforms","createdAt":"2022-07-09T17:27:39.000Z","updatedAt":"2022-07-09T17:27:39.000Z","Questions_Tags":{"questionId":330,"tagId":1903}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"cross-thread-operation-not-valid:-control-accessed-from-a-thread-other-than-the-thread-it-was-created-on-1657387659019"},"buildId":"d4czOeg3MGPNUI9SipfjN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>