<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>Error in finding last used cell in Excel with VBA | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="When I want to find the last used cell value, I use:
Dim LastRow As Long

LastRow = Range(&quot;E4:E48&quot;).End(xlDown).Row

Debug.Print LastRow

I&#x27;m getting the wrong output when I put a single element into a cell. But when I put more than one value into the cell, the output is correct.
What&#x27;s the reason behind this?
    "/><meta property="og:title" content="Error in finding last used cell in Excel with VBA | Solutions Checker"/><meta property="og:description" content="When I want to find the last used cell value, I use:
Dim LastRow As Long

LastRow = Range(&quot;E4:E48&quot;).End(xlDown).Row

Debug.Print LastRow

I&#x27;m getting the wrong output when I put a single element into a cell. But when I put more than one value into the cell, the output is correct.
What&#x27;s the reason behind this?
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"Error in finding last used cell in Excel with VBA","text":"When I want to find the last used cell value, I use:\nDim LastRow As Long\n\nLastRow = Range(&quot;E4:E48&quot;).End(xlDown).Row\n\nDebug.Print LastRow\n\nI&apos;m getting the wrong output when I put a single element into a cell. But when I put more than one value into the cell, the output is correct.\nWhat&apos;s the reason behind this?\n    ","answerCount":14,"upVoteCount":500,"suggestedAnswer":[{"text":"NOTE: I intend to make this a &quot;one stop post&quot; where you can use the Correct way to find the last row. This will also cover the best practices to follow when finding the last row. And hence I will keep on updating it whenever I come across a new scenario/information.\n\n\n\nUnreliable ways of finding the last row\n\nSome of the most common ways of finding last row which are highly unreliable and hence should never be used.\n\n\nUsedRange\nxlDown\nCountA\n\n\nUsedRange should NEVER be used to find the last cell which has data. It is highly unreliable. Try this experiment.\n\nType something in cell A5. Now when you calculate the last row with any of the methods given below, it will give you 5. Now color the cell A10 red. If you now use the any of the below code, you will still get 5. If you use Usedrange.Rows.Count what do you get? It won&apos;t be 5.\n\nHere is a scenario to show how UsedRange works.\n\n\n\nxlDown is equally unreliable. \n\nConsider this code\n\nlastrow = Range(&quot;A1&quot;).End(xlDown).Row\n\n\nWhat would happen if there was only one cell (A1) which had data? You will end up reaching the last row in the worksheet! It&apos;s like selecting cell A1 and then pressing End key and then pressing Down Arrow key. This will also give you unreliable results if there are blank cells in a range.\n\nCountA is also unreliable because it will give you incorrect result if there are blank cells in between. \n\nAnd hence one should avoid the use of UsedRange, xlDown and CountA to find the last cell.\n\n\n\nFind Last Row in a Column\n\nTo find the last Row in Col E use this\n\nWith Sheets(&quot;Sheet1&quot;)\n    LastRow = .Range(&quot;E&quot; &amp; .Rows.Count).End(xlUp).Row\nEnd With\n\n\nIf you notice that we have a . before Rows.Count. We often chose to ignore that. See THIS question on the possible error that you may get. I always advise using . before Rows.Count and Columns.Count. That question is a classic scenario where the code will fail because the Rows.Count returns 65536 for Excel 2003 and earlier and 1048576 for Excel 2007 and later. Similarly Columns.Count returns 256 and 16384, respectively. \n\nThe above fact that Excel 2007+ has 1048576 rows also emphasizes on the fact that we should always declare the variable which will hold the row value as Long instead of Integer else you will get an Overflow error.\n\nNote that this approach will skip any hidden rows. Looking back at my screenshot above for column A, if row 8 were hidden, this approach would return 5 instead of 8.\n\n\n\nFind Last Row in a Sheet\n\nTo find the Effective last row in the sheet, use this. Notice the use of Application.WorksheetFunction.CountA(.Cells). This is required because if there are no cells with data in the worksheet then .Find will give you Run Time Error 91: Object Variable or With block variable not set\n\nWith Sheets(&quot;Sheet1&quot;)\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n        lastrow = .Cells.Find(What:=&quot;*&quot;, _\n                      After:=.Range(&quot;A1&quot;), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastrow = 1\n    End If\nEnd With\n\n\n\n\nFind Last Row in a Table (ListObject)\n\nThe same principles apply, for example to get the last row in the third column of a table:\n\nSub FindLastRowInExcelTableColAandB()\nDim lastRow As Long\nDim ws As Worksheet, tbl as ListObject\nSet ws = Sheets(&quot;Sheet1&quot;)  &apos;Modify as needed\n&apos;Assuming the name of the table is &quot;Table1&quot;, modify as needed\nSet tbl = ws.ListObjects(&quot;Table1&quot;)\n\nWith tbl.ListColumns(3).Range\n    lastrow = .Find(What:=&quot;*&quot;, _\n                After:=.Cells(1), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=False).Row\nEnd With\n\nEnd Sub\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"Note: this answer was motivated by this comment. The purpose of UsedRange is different from what is mentioned in the answer above.\n\nAs to the correct way of finding the last used cell, one has first to decide what is considered used, and then select a suitable method. I conceive at least three meanings:\n\n\nUsed = non-blank, i.e., having data.\nUsed = &quot;... in use, meaning the section that contains data or formatting.&quot;\nAs per official documentation, this is the criterion used by Excel at the time of saving. See also this official documentation.\nIf one is not aware of this, the criterion may produce unexpected results, but it may also be intentionally exploited (less often, surely), e.g., to highlight or print specific regions, which may eventually have no data.\nAnd, of course, it is desirable as a criterion for the range to use when saving a workbook, lest losing part of one&apos;s work.\nUsed = &quot;... in use, meaning the section that contains data or formatting&quot; or conditional formatting.\nSame as 2., but also including cells that are the target for any Conditional Formatting rule.\n\n\nHow to find the last used cell depends on what you want (your criterion).\n\nFor criterion 1, I suggest reading this answer.\nNote that UsedRange is cited as unreliable. I think that is misleading (i.e., &quot;unfair&quot; to UsedRange), as UsedRange is simply not meant to report the last cell containing data. So it should not be used in this case, as indicated in that answer. See also this comment. \n\nFor criterion 2, UsedRange is the most reliable option, as compared to other options also designed for this use. It even makes it unnecessary to save a workbook to make sure that the last cell is updated.\nCtrl+End will go to a wrong cell prior to saving\n(The last cell is not reset until you save the worksheet, from\nhttp://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx.\nIt is an old reference, but in this respect valid).\n\nFor criterion 3, I do not know any built-in method.\nCriterion 2 does not account for Conditional Formatting. One may have formatted cells, based on formulas, which are not detected by UsedRange or Ctrl+End.\nIn the figure, the last cell is B3, since formatting was applied explicitly to it. Cells B6:D7 have a format derived from a Conditional Formatting rule, and this is not detected even by UsedRange.\nAccounting for this would require some VBA programming.\n\n\n\n\n\nAs to your specific question:\nWhat&apos;s the reason behind this?\n\nYour code uses the first cell in your range E4:E48 as a trampoline, for jumping down with End(xlDown).\n\nThe &quot;erroneous&quot; output will obtain if there are no non-blank cells in your range other than perhaps the first. Then, you are leaping in the dark, i.e., down the worksheet\n(you should note the difference between blank and empty string!). \n\nNote that:\n\n\nIf your range contains non-contiguous non-blank cells, then it will also give a wrong result.\nIf there is only one non-blank cell, but it is not the first one, your code will still give you the correct result.\n\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"I created this one-stop function for determining the last row, column and cell, be it for data, formatted (grouped/commented/hidden) cells or conditional formatting.\n\nSub LastCellMsg()\n    Dim strResult As String\n    Dim lngDataRow As Long\n    Dim lngDataCol As Long\n    Dim strDataCell As String\n    Dim strDataFormatRow As String\n    Dim lngDataFormatCol As Long\n    Dim strDataFormatCell As String\n    Dim oFormatCond As FormatCondition\n    Dim lngTempRow As Long\n    Dim lngTempCol As Long\n    Dim lngCFRow As Long\n    Dim lngCFCol As Long\n    Dim strCFCell As String\n    Dim lngOverallRow As Long\n    Dim lngOverallCol As Long\n    Dim strOverallCell As String\n\n    With ActiveSheet\n\n        If .ListObjects.Count &gt; 0 Then\n            MsgBox &quot;Cannot return reliable results, as there is at least one table in the worksheet.&quot;\n            Exit Sub\n        End If\n\n        strResult = &quot;Workbook name: &quot; &amp; .Parent.Name &amp; vbCrLf\n        strResult = strResult &amp; &quot;Sheet name: &quot; &amp; .Name &amp; vbCrLf\n\n        &apos;DATA:\n        &apos;last data row\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            lngDataRow = .Cells.Find(What:=&quot;*&quot;, _\n             After:=.Range(&quot;A1&quot;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=False).Row\n        Else\n            lngDataRow = 1\n        End If\n        &apos;strResult = strResult &amp; &quot;Last data row: &quot; &amp; lngDataRow &amp; vbCrLf\n\n        &apos;last data column\n        If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n            lngDataCol = .Cells.Find(What:=&quot;*&quot;, _\n             After:=.Range(&quot;A1&quot;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByColumns, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=False).Column\n        Else\n            lngDataCol = 1\n        End If\n        &apos;strResult = strResult &amp; &quot;Last data column: &quot; &amp; lngDataCol &amp; vbCrLf\n\n        &apos;last data cell\n        strDataCell = Replace(Cells(lngDataRow, lngDataCol).Address, &quot;$&quot;, vbNullString)\n        strResult = strResult &amp; &quot;Last data cell: &quot; &amp; strDataCell &amp; vbCrLf\n\n        &apos;FORMATS:\n        &apos;last data/formatted/grouped/commented/hidden row\n        strDataFormatRow = StrReverse(Split(StrReverse(.UsedRange.Address), &quot;$&quot;)(0))\n        &apos;strResult = strResult &amp; &quot;Last data/formatted row: &quot; &amp; strDataFormatRow &amp; vbCrLf\n\n        &apos;last data/formatted/grouped/commented/hidden column\n        lngDataFormatCol = Range(StrReverse(Split(StrReverse(.UsedRange.Address), &quot;$&quot;)(1)) &amp; &quot;1&quot;).Column\n        &apos;strResult = strResult &amp; &quot;Last data/formatted column: &quot; &amp; lngDataFormatCol &amp; vbCrLf\n\n        &apos;last data/formatted/grouped/commented/hidden cell\n        strDataFormatCell = Replace(Cells(strDataFormatRow, lngDataFormatCol).Address, &quot;$&quot;, vbNullString)\n        strResult = strResult &amp; &quot;Last data/formatted cell: &quot; &amp; strDataFormatCell &amp; vbCrLf\n\n        &apos;CONDITIONAL FORMATS:\n        For Each oFormatCond In .Cells.FormatConditions\n\n            &apos;last conditionally-formatted row\n            lngTempRow = CLng(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), &quot;$&quot;)(0)))\n            If lngTempRow &gt; lngCFRow Then lngCFRow = lngTempRow\n\n            &apos;last conditionally-formatted column\n            lngTempCol = Range(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), &quot;$&quot;)(1)) &amp; &quot;1&quot;).Column\n            If lngTempCol &gt; lngCFCol Then lngCFCol = lngTempCol\n        Next\n        &apos;no results are returned for Conditional Format if there is no such\n        If lngCFRow &lt;&gt; 0 Then\n            &apos;strResult = strResult &amp; &quot;Last cond-formatted row: &quot; &amp; lngCFRow &amp; vbCrLf\n            &apos;strResult = strResult &amp; &quot;Last cond-formatted column: &quot; &amp; lngCFCol &amp; vbCrLf\n\n            &apos;last conditionally-formatted cell\n            strCFCell = Replace(Cells(lngCFRow, lngCFCol).Address, &quot;$&quot;, vbNullString)\n            strResult = strResult &amp; &quot;Last cond-formatted cell: &quot; &amp; strCFCell &amp; vbCrLf\n        End If\n\n        &apos;OVERALL:\n        lngOverallRow = Application.WorksheetFunction.Max(lngDataRow, strDataFormatRow, lngCFRow)\n        &apos;strResult = strResult &amp; &quot;Last overall row: &quot; &amp; lngOverallRow &amp; vbCrLf\n        lngOverallCol = Application.WorksheetFunction.Max(lngDataCol, lngDataFormatCol, lngCFCol)\n        &apos;strResult = strResult &amp; &quot;Last overall column: &quot; &amp; lngOverallCol &amp; vbCrLf\n        strOverallCell = Replace(.Cells(lngOverallRow, lngOverallCol).Address, &quot;$&quot;, vbNullString)\n        strResult = strResult &amp; &quot;Last overall cell: &quot; &amp; strOverallCell &amp; vbCrLf\n\n        MsgBox strResult\n        Debug.Print strResult\n\n    End With\n\nEnd Sub\n\n\nResults look like this:\n\n\nFor more detailed results, some lines in the code can be uncommented:\n\n\nOne limitation exists - if there are tables in the sheet, results can become unreliable, so I decided to avoid running the code in this case:\n\nIf .ListObjects.Count &gt; 0 Then\n    MsgBox &quot;Cannot return reliable results, as there is at least one table in the worksheet.&quot;\n    Exit Sub\nEnd If\n\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"One important note to keep in mind when using the solution ...\n\nLastRow = ws.Cells.Find(What:=&quot;*&quot;, After:=ws.range(&quot;a1&quot;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\n\n... is to ensure that your LastRow variable is of Long type:\n\nDim LastRow as Long\n\n\nOtherwise you will end up getting OVERFLOW errors in certain situations in .XLSX workbooks\n\nThis is my encapsulated function that I drop in to various code uses.\n\nPrivate Function FindLastRow(ws As Worksheet) As Long\n    &apos; --------------------------------------------------------------------------------\n    &apos; Find the last used Row on a Worksheet\n    &apos; --------------------------------------------------------------------------------\n    If WorksheetFunction.CountA(ws.Cells) &gt; 0 Then\n        &apos; Search for any entry, by searching backwards by Rows.\n        FindLastRow = ws.Cells.Find(What:=&quot;*&quot;, After:=ws.range(&quot;a1&quot;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    End If\nEnd Function\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"Since the original question is about problems with finding the last cell, in this answer I will list the various ways you can get unexpected results; see my answer to &quot;How can I find last row that contains data in the Excel sheet with a macro?&quot; for my take on solving this.\n\nI&apos;ll start by expanding on the answer by sancho.s and the comment by GlennFromIowa, adding even more detail:\n\n\n  [...] one has first to decide what is considered used. I see at least 6 meanings. Cell has:\n  \n  \n  1) data, i.e., a formula, possibly resulting in a blank value;\n  2) a value, i.e., a non-blank formula or constant;\n  3) formatting;\n  4) conditional formatting;\n  5) a shape (including Comment) overlapping the cell;\n  6) involvement in a Table (List Object).\n  \n  \n  Which combination do you want to test for? Some (such as Tables) may be more difficult to test for, and some may be rare (such as a shape outside of data range),  but others may vary based on the situation (e.g., formulas with blank values).\n\n\nOther things you might want to consider:\n\n\nA) Can there be hidden rows (e.g. autofilter), blank cells or blank rows?\nB) What kind of performance is acceptable?\nC) Can the VBA macro affect the workbook or the application settings in any way?\n\n\nWith that in mind, let&apos;s see how the common ways of getting the &quot;last cell&quot; can produce unexpected results:\n\n\nThe .End(xlDown) code from the question will break most easily (e.g. with a single non-empty cell or when there are blank cells in between) for the reasons explained in the answer by Siddharth Rout here (search for &quot;xlDown is equally unreliable.&quot;) \nAny solution based on Counting (CountA or Cells*.Count) or .CurrentRegion will also break in presence of blank cells or rows \nA solution involving .End(xlUp) to search backwards from the end of a column will, just as CTRL+UP, look for data (formulas producing a blank value are considered &quot;data&quot;) in visible rows (so using it with autofilter enabled might produce incorrect results ). You have to take care to avoid the standard pitfalls (for details I&apos;ll again refer to the answer by Siddharth Rout here, look for the &quot;Find Last Row in a Column&quot; section), such as hard-coding the last row (Range(&quot;A65536&quot;).End(xlUp)) instead of relying on sht.Rows.Count.\n.SpecialCells(xlLastCell) is equivalent to CTRL+END, returning the bottom-most and right-most cell of the &quot;used range&quot;, so all caveats that apply to relying on the &quot;used range&quot;, apply to this method as well. In addition, the &quot;used range&quot; is only reset when saving the workbook and when accessing worksheet.UsedRange, so xlLastCell might produce stale results with unsaved modifications (e.g. after some rows were deleted). See the nearby answer by dotNET.\nsht.UsedRange (described in detail in the answer by sancho.s here) considers both data and formatting (though not conditional formatting) and resets the &quot;used range&quot; of the worksheet, which may or may not be what you want.Note that a common mistake is to use .UsedRange.Rows.Count, which returns the number of rows in the used range, not the last row number (they will be different if the first few rows are blank), for details see newguy&apos;s answer to How can I find last row that contains data in the Excel sheet with a macro?\n.Find allows you to find the last row with any data (including formulas) or a non-blank value in any column. You can choose whether you&apos;re interested in formulas or values, but the catch is that it resets the defaults in the Excel&apos;s Find dialog , which can be highly confusing to your users. It also needs to be used carefully, see the answer by Siddharth Rout here (section &quot;Find Last Row in a Sheet&quot;)\nMore explicit solutions that check individual Cells&apos; in a loop are generally slower than re-using an Excel function (although can still be performant), but let you specify exactly what you want to find. See my solution based on UsedRange and VBA arrays to find the last cell with data in the given column -- it handles hidden rows, filters, blanks, does not modify the Find defaults and is quite performant.\n\n\nWhatever solution you pick, be careful\n\n\nto use Long instead of Integer to store the row numbers (to avoid getting Overflow with more than 65k rows) and\nto always specify the worksheet you&apos;re working with (i.e. Dim ws As Worksheet ... ws.Range(...) instead of Range(...))\nwhen using .Value (which is a Variant) avoid implicit casts like .Value &lt;&gt; &quot;&quot; as they will fail if the cell contains an error value.\n\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"I would add to the answer given by Siddarth Rout to say that the CountA call can be skipped by having Find return a Range object, instead of a row number, and then test the returned Range object to see if it is Nothing (blank worksheet). \n\nAlso, I would have my version of any LastRow procedure return a zero for a blank worksheet, then I can know it is blank.\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"I wonder that nobody has mentioned this, But the easiest way of getting the last used cell is:\n\nFunction GetLastCell(sh as Worksheet) As Range\n    GetLastCell = sh.Cells(1,1).SpecialCells(xlLastCell)\nEnd Function\n\n\nThis essentially returns the same cell that you get by Ctrl + End after selecting Cell A1.\n\nA word of caution: Excel keeps track of the most bottom-right cell that was ever used in a worksheet. So if for example you enter something in B3 and something else in H8 and then later on delete the contents of H8, pressing Ctrl + End will still take you to H8 cell. The above function will have the same behavior.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"Updated at End of 2021\nWith Excel&apos;s new calculation engine and array functionality, and Filter Function, I believe this topic should now be far less contested and that the below options offer the best mix of speed, reliability, and simplicity (which has proven difficult to balance in the past as the numerous posts here illustrate).\nAlso, I&apos;m defining last used as NOT blank as defined by the isBlank function.\nExcel Formula\nFirst, note that the Filter Function makes it much simpler to get a last cell using the below formulas for a specific row or column (in these case Column A or Row 1):\n=MAX(FILTER(ROW(A:A),NOT(ISBLANK(A:A))))\n=MAX(FILTER(COLUMN(1:1),NOT(ISBLANK(1:1))))\n\nVBA Function For Last Row Specific Range\nUsing the above function we can convert it into a VBA function, yet make it even faster by limiting the range, while expanding its capabilities by doing multiple columns (thanks to Chris Neilsen for immediate feedback tweeking/suggestions). I also found massive speed improvement by scoping each column to only be a range with a row HIGHER than the previous last row.\nFunction FindLastRowInRange(someColumns As Range) As Long\nConst zFx = &quot;=MAX(FILTER(ROW(????),NOT(ISBLANK(????)),0))&quot;\n   \n   Dim tRng As Range, i As Long, tRow As Long, pRng As Range\n   With someColumns.Worksheet\n      Set tRng = Intersect(someColumns.EntireColumn, .UsedRange)\n      \n      For i = 1 To tRng.Columns.Count\n         \n         Set pRng = Intersect(tRng.Columns(i), _\n         Range(.Rows(FindLastRowInRange + 1), .Rows(.Rows.Count)))\n         \n         If Not pRng Is Nothing Then\n            tRow = .Evaluate(Replace(zFx, &quot;????&quot;, _\n               pRng.Address, 1, -1))\n         \n            If tRow &gt; FindLastRowInRange Then _\n               FindLastRowInRange = tRow\n            \n         End If\n      Next i\n   End With\nEnd Function\n\nVBA Function For Last Row In Worksheet\nTo consider the entire worksheet (all columns), I would recommend using a different VBA formula that references the prior one, but is a Volatile Function. This ensures that the formula updates with any changes to a worksheet. Obviously, one could combine these two formulas, but I prefer to limit the usage of volatile functions.\nFunction FindLastRowInSheet(anywhereInSheet As Range) As Long\n      Application.Volatile\n      FindLastRowInSheet = FindLastRowInRange(anywhereInSheet.Worksheet.UsedRange)\nEnd Function\n\nAdvantages Compared To Other Options\n\nAllows for some or ALL rows/columns in worksheet without changing approach.\nNo possibility of missing hidden rows as is a risk with xlup\nIgnores formatted/usedrange issues.\nDoes not interfere with user&apos;s Find settings.\nUses worksheet functionality which is faster than VBA calcs.\nNo counting cells (performance hog).\n\nHopefully this ends the debate, but if anyone finds weaknesses in this please share.\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"sub last_filled_cell()\nmsgbox range(&quot;A65536&quot;).end(xlup).row\nend sub\n\n\nHere, A65536 is the last cell in the Column A this code was tested on excel 2003.\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"However this question is seeking to find the last row using VBA, I think it would be good to include an array formula for worksheet function  as this gets visited frequently:\n{=ADDRESS(MATCH(INDEX(D:D,MAX(IF(D:D&lt;&gt;&quot;&quot;,ROW(D:D)-ROW(D1)+1)),1),D:D,0),COLUMN(D:D))}\n\nYou need to enter the formula without brackets and then hit Shift + Ctrl + Enter to make it an array formula.\nThis will give you address of last used cell in the column D.\n\nThanks to pgsystemtester, this will give you the row number of last used cell:\n{=MATCH(INDEX(D:D,MAX(IF(D:D&lt;&gt;&quot;&quot;,ROW(D:D)-ROW(D1)+1)),1),D:D,0)}\n\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"I was looking for a way to mimic the CTRL+Shift+End, so dotNET solution is great, except with my Excel 2010 I need to add a set if I want to avoid an error:\n\nFunction GetLastCell(sh As Worksheet) As Range\n  Set GetLastCell = sh.Cells(1, 1).SpecialCells(xlLastCell)\nEnd Function\n\n\nand how to check this for yourself:\n\nSub test()\n  Dim ws As Worksheet, r As Range\n  Set ws = ActiveWorkbook.Sheets(&quot;Sheet1&quot;)\n  Set r = GetLastCell(ws)\n  MsgBox r.Column &amp; &quot;-&quot; &amp; r.Row\nEnd Sub\n\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"Sub lastRow()\n\n    Dim i As Long\n        i = Cells(Rows.Count, 1).End(xlUp).Row\n            MsgBox i\n\nEnd Sub\n\nsub LastRow()\n\n&apos;Paste &amp; for better understanding of the working use F8 Key to run the code .\n\ndim WS as worksheet\ndim i as long\n\nset ws = thisworkbook(&quot;SheetName&quot;)\n\nws.activate\n\nws.range(&quot;a1&quot;).select\n\nws.range(&quot;a1048576&quot;).select\n\nactivecell.end(xlup).select\n\ni= activecell.row\n\nmsgbox &quot;My Last Row Is &quot; &amp; i\n\nEnd sub\n\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"For the last 3+ years these are the functions that I am using for finding last row and last column per defined column(for row) and row(for column):\n\nLast Column:\n\nFunction lastCol(Optional wsName As String, Optional rowToCheck As Long = 1) As Long\n\n    Dim ws  As Worksheet\n\n    If wsName = vbNullString Then\n        Set ws = ActiveSheet\n    Else\n        Set ws = Worksheets(wsName)\n    End If\n\n    lastCol = ws.Cells(rowToCheck, ws.Columns.Count).End(xlToLeft).Column\n\nEnd Function\n\n\nLast Row:\n\nFunction lastRow(Optional wsName As String, Optional columnToCheck As Long = 1) As Long\n\n    Dim ws As Worksheet\n\n    If wsName = vbNullString Then\n        Set ws = ActiveSheet\n    Else\n        Set ws = Worksheets(wsName)\n    End If\n\n    lastRow = ws.Cells(ws.Rows.Count, columnToCheck).End(xlUp).Row\n\nEnd Function\n\n\nFor the case of the OP, this is the way to get the last row in column E:\n\nDebug.Print lastRow(columnToCheck:=Range(&quot;E4:E48&quot;).Column)\n\nLast Row, counting empty rows with data:\n\nHere we may use the well-known Excel formulas, which give us the last row of a worksheet in Excel, without involving VBA - =IFERROR(LOOKUP(2,1/(NOT(ISBLANK(A:A))),ROW(A:A)),0)\n\nIn order to put this in VBA and not to write anything in Excel, using the parameters for the latter functions, something like this could be in mind:\n\nPublic Function LastRowWithHidden(Optional wsName As String, Optional columnToCheck As Long = 1) As Long\n\n    Dim ws As Worksheet\n\n    If wsName = vbNullString Then\n        Set ws = ActiveSheet\n    Else\n        Set ws = Worksheets(wsName)\n    End If\n\n    Dim letters As String\n    letters = ColLettersGenerator(columnToCheck)\n    LastRowWithHidden = ws.Evaluate(&quot;=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(&quot; &amp; letters &amp; &quot;))),ROW(&quot; &amp; letters &amp; &quot; )),0)&quot;)\n\nEnd Function\n\nFunction ColLettersGenerator(col As Long) As String\n\n    Dim result As Variant\n    result = Split(Cells(1, col).Address(True, False), &quot;$&quot;)\n    ColLettersGenerator = result(0) &amp; &quot;:&quot; &amp; result(0)\n\nEnd Function\n\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0},{"text":"Last Row in a regular range or a Table (ListObject)\n\nFinding the last row requires using different methods if the range is a regular range or table (List Object).\nFinding the last row in tables requires specifying additional parameters (table name , the column relative position to the first tables column).\n\nI created this universal function for last row, regardless of range type. Just give it any cell reference whatsoever and it will return the last row.\nNo hassle having to knew range characteristics, especially if your ranges are some times a regular range and sometimes a ListObject.\nUsing a regular range method on a table might return wrong results.\nSure you can plan ahead of time and use the right method each time, but why bother if you can utilizes a universal function ?\n\nSub RunMyLastRow()\nDim Result As Long\nResult = MyLastRow(Worksheets(1).Range(&quot;A1&quot;))\nEnd Sub\n\n\n    Function MyLastRow(RefrenceRange As Range) As Long\n    Dim WS As Worksheet\n    Dim TableName As String\n    Dim ColNumber As Long\n    Dim LastRow As Long\n    Dim FirstColumnTable As Long\n    Dim ColNumberTable As Long\n    Set WS = RefrenceRange.Worksheet\n    TableName = GetTableName(RefrenceRange)\n    ColNumber = RefrenceRange.Column\n    \n    &apos;&apos;If the table (ListObject) does not start in column &quot;A&quot; we need to calculate the \n    &apos;&apos;first Column table and how many Columns from its beginning the Column is located.\n    If TableName &lt;&gt; vbNullString Then\n     FirstColumnTable = WS.ListObjects(TableName).ListColumns(1).Range.Column\n     ColNumberTable = ColNumber - FirstColumnTable + 1\n    End If \n\n    If TableName = vbNullString Then\n    LastRow = WS.Cells(WS.Rows.Count, ColNumber).End(xlUp).Row\n    Else\n    LastRow = WS.ListObjects(TableName).ListColumns(ColNumberTable).Range.Find( _\n               What:=&quot;*&quot;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    End If\n    MyLastRow = LastRow\n    End Function\n    \n\n\n    &apos;&apos;Get Table Name by Cell Range\n    Function GetTableName(RefrenceRange As Range) As String\n        If RefrenceRange.ListObject Is Nothing Then\n            GetTableName = vbNullString\n        Else\n            GetTableName = RefrenceRange.ListObject.Name\n        End If\n    End Function\n\n\n    ","url":"/questions/[slug]#solution14","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/9fb80f4eb9e2d3c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9fb80f4eb9e2d3c9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-88567075f6bc9c6b.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/532-fec3344a80918110.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/817-363561828babdd16.js" defer=""></script><script src="/_next/static/chunks/81-2e45c38dc6fe8298.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-16d8c84aea765d4e.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_buildManifest.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.dlbxiY code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-344134f6-0"]{content:"dlbxiY,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/error-in-finding-last-used-cell-in-excel-with-vba-1657384584748#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-344134f6-0 dlbxiY flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/error-in-finding-last-used-cell-in-excel-with-vba-1657384584748">Error in finding last used cell in Excel with VBA</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/excel-formula">excel-formula</a></div></div><div class="question-content mt-5">
                
<p>When I want to find the last used cell value, I use:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> LastRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>

LastRow = Range(<span class="hljs-string">"E4:E48"</span>).<span class="hljs-keyword">End</span>(xlDown).Row

Debug.Print LastRow
</code></pre>
<p>I'm getting the wrong output when I put a single element into a cell. But when I put more than one value into the cell, the output is correct.
What's the reason behind this?</p>
    </div></div></div><div class="sc-344134f6-2 EUowZ"><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>NOTE</strong>: I intend to make this a "one stop post" where you can use the <code>Correct</code> way to find the last row. This will also cover the best practices to follow when finding the last row. And hence I will keep on updating it whenever I come across a new scenario/information.</p>

<hr>

<h2><strong>Unreliable ways of finding the last row</strong></h2>

<p>Some of the most common ways of finding last row which are highly unreliable and hence should never be used.</p>

<ol>
<li>UsedRange</li>
<li>xlDown</li>
<li>CountA</li>
</ol>

<p><code>UsedRange</code> should <strong>NEVER</strong> be used to find the last cell which has data. It is highly unreliable. Try this experiment.</p>

<p>Type something in cell <code>A5</code>. Now when you calculate the last row with any of the methods given below, it will give you 5. Now color the cell <code>A10</code> red. If you now use the any of the below code, you will still get 5. If you use <code>Usedrange.Rows.Count</code> what do you get? It won't be 5.</p>

<p>Here is a scenario to show how <code>UsedRange</code> works.</p>

<p><img src="https://i.stack.imgur.com/3TqSI.png" alt="enter image description here"></p>

<p><code>xlDown</code> is equally unreliable. </p>

<p>Consider this code</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">lastrow = Range(<span class="hljs-string">"A1"</span>).<span class="hljs-keyword">End</span>(xlDown).Row
</code></pre>

<p>What would happen if there was only one cell (<code>A1</code>) which had data? You will end up reaching the last row in the worksheet! It's like selecting cell <code>A1</code> and then pressing <kbd>End</kbd> key and then pressing <kbd>Down Arrow</kbd> key. This will also give you unreliable results if there are blank cells in a range.</p>

<p><code>CountA</code> is also unreliable because it will give you incorrect result if there are blank cells in between. </p>

<p>And hence one should avoid the use of <code>UsedRange</code>, <code>xlDown</code> and <code>CountA</code> to find the last cell.</p>

<hr>

<h2>Find Last Row in a Column</h2>

<p>To find the last Row in Col E use this</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">With</span> Sheets(<span class="hljs-string">"Sheet1"</span>)
    LastRow = .Range(<span class="hljs-string">"E"</span> &amp; .Rows.Count).<span class="hljs-keyword">End</span>(xlUp).Row
<span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
</code></pre>

<p>If you notice that we have a <code>.</code> before <code>Rows.Count</code>. We often chose to ignore that. See <a href="https://stackoverflow.com/questions/19985345/vba-excel-compability-mode#comment29753337_19985345">THIS</a> question on the possible error that you may get. I always advise using <code>.</code> before <code>Rows.Count</code> and <code>Columns.Count</code>. That question is a classic scenario where the code will fail because the <code>Rows.Count</code> returns <code>65536</code> for Excel 2003 and earlier and <code>1048576</code> for Excel 2007 and later. Similarly <code>Columns.Count</code> returns <code>256</code> and <code>16384</code>, respectively. </p>

<p>The above fact that Excel 2007+ has <code>1048576</code> rows also emphasizes on the fact that we should always declare the variable which will hold the row value as <code>Long</code> instead of <code>Integer</code> else you will get an <code>Overflow</code> error.</p>

<p>Note that this approach will skip any hidden rows. Looking back at <a href="https://i.stack.imgur.com/3TqSI.png" rel="noreferrer">my screenshot above for column A</a>, if row 8 were hidden, this approach would return <code>5</code> instead of <code>8</code>.</p>

<hr>

<h2>Find Last Row in a Sheet</h2>

<p>To find the <code>Effective</code> last row in the sheet, use this. Notice the use of <code>Application.WorksheetFunction.CountA(.Cells)</code>. This is required because if there are no cells with data in the worksheet then <code>.Find</code> will give you <code>Run Time Error 91: Object Variable or With block variable not set</code></p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">With</span> Sheets(<span class="hljs-string">"Sheet1"</span>)
    <span class="hljs-keyword">If</span> Application.WorksheetFunction.CountA(.Cells) &lt;&gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
        lastrow = .Cells.Find(What:=<span class="hljs-string">"*"</span>, _
                      After:=.Range(<span class="hljs-string">"A1"</span>), _
                      Lookat:=xlPart, _
                      LookIn:=xlFormulas, _
                      SearchOrder:=xlByRows, _
                      SearchDirection:=xlPrevious, _
                      MatchCase:=<span class="hljs-literal">False</span>).Row
    <span class="hljs-keyword">Else</span>
        lastrow = <span class="hljs-number">1</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
</code></pre>

<hr>

<h2>Find Last Row in a Table (ListObject)</h2>

<p>The same principles apply, for example to get the last row in the third column of a table:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> FindLastRowInExcelTableColAandB()
<span class="hljs-keyword">Dim</span> lastRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
<span class="hljs-keyword">Dim</span> ws <span class="hljs-keyword">As</span> Worksheet, tbl <span class="hljs-keyword">as</span> ListObject
<span class="hljs-keyword">Set</span> ws = Sheets(<span class="hljs-string">"Sheet1"</span>)  <span class="hljs-comment">'Modify as needed</span>
<span class="hljs-comment">'Assuming the name of the table is "Table1", modify as needed</span>
<span class="hljs-keyword">Set</span> tbl = ws.ListObjects(<span class="hljs-string">"Table1"</span>)

<span class="hljs-keyword">With</span> tbl.ListColumns(<span class="hljs-number">3</span>).Range
    lastrow = .Find(What:=<span class="hljs-string">"*"</span>, _
                After:=.Cells(<span class="hljs-number">1</span>), _
                Lookat:=xlPart, _
                LookIn:=xlFormulas, _
                SearchOrder:=xlByRows, _
                SearchDirection:=xlPrevious, _
                MatchCase:=<span class="hljs-literal">False</span>).Row
<span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Note: this answer was motivated by <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/27637752#comment43694683_11169920">this comment</a>. The purpose of <code>UsedRange</code> is different from what is mentioned in the answer above.</strong></p>

<p><strong>As to the correct way of finding the last used cell, one has first to decide what is considered <em>used</em>, and then select a suitable method</strong>. I conceive at least three meanings:</p>

<ol>
<li><p>Used = non-blank, i.e., having <strong>data</strong>.</p></li>
<li><p>Used = "... in use, meaning the section that contains <strong>data or formatting</strong>."
<a href="http://support.microsoft.com/kb/244435" rel="noreferrer">As per official documentation</a>, this is the criterion used by Excel at the time of saving. See also <a href="https://support.office.com/en-sg/article/Locate-and-reset-the-last-cell-on-a-worksheet-c9e468a8-0fc3-4f69-8038-b3c1d86e99e9" rel="noreferrer">this official documentation</a>.
If one is not aware of this, the criterion may produce unexpected results, but it may also be intentionally exploited (less often, surely), e.g., to highlight or print specific regions, which may eventually have no data.
And, of course, it is desirable as a criterion for the range to use when saving a workbook, lest losing part of one's work.</p></li>
<li><p>Used = "... in use, meaning the section that contains <strong>data or formatting</strong>" <strong>or conditional formatting.</strong>
Same as 2., but also including cells that are the target for any Conditional Formatting rule.</p></li>
</ol>

<p><strong>How to find the last used cell depends on what <em>you</em> want (your criterion)</strong>.</p>

<p><em>For criterion 1, I suggest reading <a href="https://stackoverflow.com/a/11169920/2707864">this answer</a></em>.
Note that <code>UsedRange</code> is cited as unreliable. I think that is misleading (i.e., "unfair" to <code>UsedRange</code>), as <code>UsedRange</code> is simply not meant to report the last cell containing data. So it should not be used in this case, as indicated in that answer. See also <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#comment43694683_11169920">this comment</a>. </p>

<p><em>For criterion 2, <code>UsedRange</code> is the most reliable option</em>, as compared to other options also designed for this use. It even makes it unnecessary to save a workbook to make sure that the last cell is updated.
<kbd>Ctrl</kbd>+<kbd>End</kbd> will go to a wrong cell prior to saving
(The last cell is not reset until you save the worksheet, from
<a href="http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx" rel="noreferrer">http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx</a>.
It is an old reference, but in this respect valid).</p>

<p><em>For criterion 3, I do not know any built-in method</em>.
Criterion 2 does not account for Conditional Formatting. One may have formatted cells, based on formulas, which are not detected by <code>UsedRange</code> or <kbd>Ctrl</kbd>+<kbd>End</kbd>.
In the figure, the last cell is B3, since formatting was applied explicitly to it. Cells B6:D7 have a format derived from a Conditional Formatting rule, and this is not detected even by <code>UsedRange</code>.
Accounting for this would require some VBA programming.</p>

<p><img src="https://i.stack.imgur.com/vhayX.jpg" alt="enter image description here"></p>

<hr>

<p><strong>As to your specific question</strong>:
<em>What's the reason behind this?</em></p>

<p>Your code uses the first cell in your range E4:E48 as a trampoline, for <em>jumping</em> down with <code>End(xlDown)</code>.</p>

<p>The "erroneous" output will obtain if there are no <em>non-blank</em> cells in your range other than perhaps the first. Then, you are <em>leaping in the dark</em>, i.e., down the worksheet
(you should note the difference between <em>blank</em> and <em>empty string</em>!). </p>

<p>Note that:</p>

<ol>
<li><p>If your range contains non-contiguous non-blank cells, then it will also give a wrong result.</p></li>
<li><p>If there is only one non-blank cell, but it is not the first one, your code will still give you the correct result.</p></li>
</ol>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I created this one-stop function for <strong>determining the last row, column and cell, be it for data, formatted (grouped/commented/hidden) cells or conditional formatting</strong>.</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> LastCellMsg()
    <span class="hljs-keyword">Dim</span> strResult <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> lngDataRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> lngDataCol <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> strDataCell <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> strDataFormatRow <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> lngDataFormatCol <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> strDataFormatCell <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> oFormatCond <span class="hljs-keyword">As</span> FormatCondition
    <span class="hljs-keyword">Dim</span> lngTempRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> lngTempCol <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> lngCFRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> lngCFCol <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> strCFCell <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> lngOverallRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> lngOverallCol <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> strOverallCell <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

    <span class="hljs-keyword">With</span> ActiveSheet

        <span class="hljs-keyword">If</span> .ListObjects.Count &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            MsgBox <span class="hljs-string">"Cannot return reliable results, as there is at least one table in the worksheet."</span>
            <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Sub</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

        strResult = <span class="hljs-string">"Workbook name: "</span> &amp; .Parent.Name &amp; vbCrLf
        strResult = strResult &amp; <span class="hljs-string">"Sheet name: "</span> &amp; .Name &amp; vbCrLf

        <span class="hljs-comment">'DATA:</span>
        <span class="hljs-comment">'last data row</span>
        <span class="hljs-keyword">If</span> Application.WorksheetFunction.CountA(.Cells) &lt;&gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            lngDataRow = .Cells.Find(What:=<span class="hljs-string">"*"</span>, _
             After:=.Range(<span class="hljs-string">"A1"</span>), _
             Lookat:=xlPart, _
             LookIn:=xlFormulas, _
             SearchOrder:=xlByRows, _
             SearchDirection:=xlPrevious, _
             MatchCase:=<span class="hljs-literal">False</span>).Row
        <span class="hljs-keyword">Else</span>
            lngDataRow = <span class="hljs-number">1</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-comment">'strResult = strResult &amp; "Last data row: " &amp; lngDataRow &amp; vbCrLf</span>

        <span class="hljs-comment">'last data column</span>
        <span class="hljs-keyword">If</span> Application.WorksheetFunction.CountA(.Cells) &lt;&gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            lngDataCol = .Cells.Find(What:=<span class="hljs-string">"*"</span>, _
             After:=.Range(<span class="hljs-string">"A1"</span>), _
             Lookat:=xlPart, _
             LookIn:=xlFormulas, _
             SearchOrder:=xlByColumns, _
             SearchDirection:=xlPrevious, _
             MatchCase:=<span class="hljs-literal">False</span>).Column
        <span class="hljs-keyword">Else</span>
            lngDataCol = <span class="hljs-number">1</span>
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
        <span class="hljs-comment">'strResult = strResult &amp; "Last data column: " &amp; lngDataCol &amp; vbCrLf</span>

        <span class="hljs-comment">'last data cell</span>
        strDataCell = Replace(Cells(lngDataRow, lngDataCol).Address, <span class="hljs-string">"$"</span>, vbNullString)
        strResult = strResult &amp; <span class="hljs-string">"Last data cell: "</span> &amp; strDataCell &amp; vbCrLf

        <span class="hljs-comment">'FORMATS:</span>
        <span class="hljs-comment">'last data/formatted/grouped/commented/hidden row</span>
        strDataFormatRow = StrReverse(Split(StrReverse(.UsedRange.Address), <span class="hljs-string">"$"</span>)(<span class="hljs-number">0</span>))
        <span class="hljs-comment">'strResult = strResult &amp; "Last data/formatted row: " &amp; strDataFormatRow &amp; vbCrLf</span>

        <span class="hljs-comment">'last data/formatted/grouped/commented/hidden column</span>
        lngDataFormatCol = Range(StrReverse(Split(StrReverse(.UsedRange.Address), <span class="hljs-string">"$"</span>)(<span class="hljs-number">1</span>)) &amp; <span class="hljs-string">"1"</span>).Column
        <span class="hljs-comment">'strResult = strResult &amp; "Last data/formatted column: " &amp; lngDataFormatCol &amp; vbCrLf</span>

        <span class="hljs-comment">'last data/formatted/grouped/commented/hidden cell</span>
        strDataFormatCell = Replace(Cells(strDataFormatRow, lngDataFormatCol).Address, <span class="hljs-string">"$"</span>, vbNullString)
        strResult = strResult &amp; <span class="hljs-string">"Last data/formatted cell: "</span> &amp; strDataFormatCell &amp; vbCrLf

        <span class="hljs-comment">'CONDITIONAL FORMATS:</span>
        <span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> oFormatCond <span class="hljs-keyword">In</span> .Cells.FormatConditions

            <span class="hljs-comment">'last conditionally-formatted row</span>
            lngTempRow = <span class="hljs-built_in">CLng</span>(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), <span class="hljs-string">"$"</span>)(<span class="hljs-number">0</span>)))
            <span class="hljs-keyword">If</span> lngTempRow &gt; lngCFRow <span class="hljs-keyword">Then</span> lngCFRow = lngTempRow

            <span class="hljs-comment">'last conditionally-formatted column</span>
            lngTempCol = Range(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), <span class="hljs-string">"$"</span>)(<span class="hljs-number">1</span>)) &amp; <span class="hljs-string">"1"</span>).Column
            <span class="hljs-keyword">If</span> lngTempCol &gt; lngCFCol <span class="hljs-keyword">Then</span> lngCFCol = lngTempCol
        <span class="hljs-keyword">Next</span>
        <span class="hljs-comment">'no results are returned for Conditional Format if there is no such</span>
        <span class="hljs-keyword">If</span> lngCFRow &lt;&gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
            <span class="hljs-comment">'strResult = strResult &amp; "Last cond-formatted row: " &amp; lngCFRow &amp; vbCrLf</span>
            <span class="hljs-comment">'strResult = strResult &amp; "Last cond-formatted column: " &amp; lngCFCol &amp; vbCrLf</span>

            <span class="hljs-comment">'last conditionally-formatted cell</span>
            strCFCell = Replace(Cells(lngCFRow, lngCFCol).Address, <span class="hljs-string">"$"</span>, vbNullString)
            strResult = strResult &amp; <span class="hljs-string">"Last cond-formatted cell: "</span> &amp; strCFCell &amp; vbCrLf
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

        <span class="hljs-comment">'OVERALL:</span>
        lngOverallRow = Application.WorksheetFunction.Max(lngDataRow, strDataFormatRow, lngCFRow)
        <span class="hljs-comment">'strResult = strResult &amp; "Last overall row: " &amp; lngOverallRow &amp; vbCrLf</span>
        lngOverallCol = Application.WorksheetFunction.Max(lngDataCol, lngDataFormatCol, lngCFCol)
        <span class="hljs-comment">'strResult = strResult &amp; "Last overall column: " &amp; lngOverallCol &amp; vbCrLf</span>
        strOverallCell = Replace(.Cells(lngOverallRow, lngOverallCol).Address, <span class="hljs-string">"$"</span>, vbNullString)
        strResult = strResult &amp; <span class="hljs-string">"Last overall cell: "</span> &amp; strOverallCell &amp; vbCrLf

        MsgBox strResult
        Debug.Print strResult

    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>

<p>Results look like this:<br>
<img src="https://i.stack.imgur.com/4UaTd.jpg" alt="determine last cell"></p>

<p>For more detailed results, some lines in the code can be uncommented:<br>
<img src="https://i.stack.imgur.com/iqXQ0.jpg" alt="last column, row"></p>

<p>One limitation exists - if there are tables in the sheet, results can become unreliable, so I decided to avoid running the code in this case:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">If</span> .ListObjects.Count &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
    MsgBox <span class="hljs-string">"Cannot return reliable results, as there is at least one table in the worksheet."</span>
    <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">Sub</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
</code></pre>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One important note to keep in mind when using the solution ...</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">LastRow = ws.Cells.Find(What:=<span class="hljs-string">"*"</span>, After:=ws.range(<span class="hljs-string">"a1"</span>), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
</code></pre>

<p>... is to ensure that your <code>LastRow</code> variable is of <code>Long</code> type:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Dim</span> LastRow <span class="hljs-keyword">as</span> <span class="hljs-type">Long</span>
</code></pre>

<p>Otherwise you will end up getting OVERFLOW errors in certain situations in .XLSX workbooks</p>

<p>This is my encapsulated function that I drop in to various code uses.</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Private</span> <span class="hljs-keyword">Function</span> FindLastRow(ws <span class="hljs-keyword">As</span> Worksheet) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-comment">' --------------------------------------------------------------------------------</span>
    <span class="hljs-comment">' Find the last used Row on a Worksheet</span>
    <span class="hljs-comment">' --------------------------------------------------------------------------------</span>
    <span class="hljs-keyword">If</span> WorksheetFunction.CountA(ws.Cells) &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
        <span class="hljs-comment">' Search for any entry, by searching backwards by Rows.</span>
        FindLastRow = ws.Cells.Find(What:=<span class="hljs-string">"*"</span>, After:=ws.range(<span class="hljs-string">"a1"</span>), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Since the original question is about <em>problems</em> with finding the last cell, <strong>in this answer I will list the various ways you can get unexpected results</strong>; see <a href="https://stackoverflow.com/a/49971492/1026">my answer to <em>"How can I find last row that contains data in the Excel sheet with a macro?"</em></a> for my take on solving this.</p>

<p>I'll start by expanding on <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752">the answer by sancho.s</a> and <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba#comment73816621_27637752">the comment by GlennFromIowa</a>, adding even more detail:</p>

<blockquote>
  <p>[...] one has first to decide what is considered used. I see at least 6 meanings. Cell has:</p>
  
  <ul>
  <li>1) data, i.e., a formula, possibly resulting in a blank value;</li>
  <li>2) a value, i.e., a non-blank formula or constant;</li>
  <li>3) formatting;</li>
  <li>4) conditional formatting;</li>
  <li>5) a shape (including Comment) overlapping the cell;</li>
  <li>6) involvement in a Table (List Object).</li>
  </ul>
  
  <p>Which combination do you want to test for? Some (such as Tables) may be more difficult to test for, and some may be rare (such as a shape outside of data range),  but others may vary based on the situation (e.g., formulas with blank values).</p>
</blockquote>

<p>Other things you might want to consider:</p>

<ul>
<li>A) Can there be <em>hidden rows</em> (e.g. autofilter), <em>blank cells</em> or blank rows?</li>
<li>B) What kind of performance is acceptable?</li>
<li>C) Can the VBA macro affect the workbook or the application settings in any way?</li>
</ul>

<p>With that in mind, let's see <strong>how the common ways of getting the "last cell" can produce unexpected results:</strong></p>

<ul>
<li>The <code>.End(xlDown)</code> code from the question will break most easily (e.g. with <strong>a single non-empty cell</strong> or when there are <strong>blank cells in between</strong>) for the reasons explained in <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920">the answer by Siddharth Rout</a> here (search for <em>"xlDown is equally unreliable."</em>) </li>
<li>Any solution based on <code>Count</code>ing (<code>CountA</code> or <code>Cells*.Count</code>) or <code>.CurrentRegion</code> will also break in presence of blank cells or rows </li>
<li>A solution involving <code>.End(xlUp)</code> to search backwards from the end of a column will, just as CTRL+UP, look for <strong>data</strong> (formulas producing a blank value are considered "data") in <strong>visible rows</strong> (so using it with autofilter enabled might produce incorrect results ). <p>You have to take care to avoid the standard pitfalls (for details I'll again refer to <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920">the answer by Siddharth Rout</a> here, look for the <em>"Find Last Row in a Column"</em> section), such as hard-coding the last row (<code>Range("A65536").End(xlUp)</code>) instead of relying on <code>sht.Rows.Count</code>.</p></li>
<li><code>.SpecialCells(xlLastCell)</code> is equivalent to CTRL+END, returning the bottom-most and right-most cell of the "used range", so all caveats that apply to relying on the "used range", apply to this method as well. In addition, the "used range" is only reset when saving the workbook and when accessing <code>worksheet.UsedRange</code>, so <code>xlLastCell</code> might produce stale results with unsaved modifications (e.g. after some rows were deleted). See the <a href="https://stackoverflow.com/a/29899739/1026">nearby answer by dotNET</a>.</li>
<li><code>sht.UsedRange</code> (described in detail in <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752">the answer by sancho.s</a> here) considers <strong>both data and formatting</strong> (though not conditional formatting) and <strong>resets the "used range" of the worksheet</strong>, which may or may not be what you want.<p>Note that a common mistake is to use <code>.UsedRange.Rows.Count</code>, which returns the <em>number of rows</em> in the used range, not the <em>last row number</em> (they will be different if the first few rows are blank), for details see <a href="https://stackoverflow.com/a/35975280/1026">newguy's answer to <em>How can I find last row that contains data in the Excel sheet with a macro?</em></a></p></li>
<li><code>.Find</code> allows you to find the last row with any data (including formulas) or a non-blank value <strong>in any column</strong>. You can choose whether you're interested in formulas or values, but the catch is that it <strong>resets the defaults in the Excel's Find dialog</strong> , which can be highly confusing to your users. It also needs to be used carefully, see <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920">the answer by Siddharth Rout</a> here (section <em>"Find Last Row in a Sheet"</em>)</li>
<li>More explicit solutions that check individual <code>Cells</code>' in a loop are generally slower than re-using an Excel function (although can still be performant), but let you specify exactly what you want to find. See <a href="https://stackoverflow.com/a/49971492/1026">my solution</a> based on <code>UsedRange</code> and VBA arrays to find the last cell with data in the given column -- it handles hidden rows, filters, blanks, does not modify the Find defaults and is quite performant.</li>
</ul>

<p>Whatever solution you pick, be careful</p>

<ul>
<li>to use <code>Long</code> instead of <code>Integer</code> to store the row numbers (to avoid getting <code>Overflow</code> with more than 65k rows) and</li>
<li>to always specify the worksheet you're working with (i.e. <code>Dim ws As Worksheet ... ws.Range(...)</code> instead of <code>Range(...)</code>)</li>
<li>when using <code>.Value</code> (which is a <code>Variant</code>) avoid implicit casts like <code>.Value &lt;&gt; ""</code> as they will fail if the cell contains an error value.</li>
</ul>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I would add to the answer given by Siddarth Rout to say that the CountA call can be skipped by having Find return a Range object, instead of a row number, and then test the returned Range object to see if it is Nothing (blank worksheet). </p>

<p>Also, I would have my version of any LastRow procedure return a zero for a blank worksheet, then I can know it is blank.</p>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I wonder that nobody has mentioned this, But the easiest way of getting the last used cell is:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> GetLastCell(sh <span class="hljs-keyword">as</span> Worksheet) <span class="hljs-keyword">As</span> Range
    GetLastCell = sh.Cells(<span class="hljs-number">1</span>,<span class="hljs-number">1</span>).SpecialCells(xlLastCell)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>

<p>This essentially returns the same cell that you get by <kbd>Ctrl</kbd> + <kbd>End</kbd> after selecting Cell <strong><code>A1</code></strong>.</p>

<p>A word of caution: Excel keeps track of the most bottom-right cell that was ever used in a worksheet. So if for example you enter something in <strong>B3</strong> and something else in <strong>H8</strong> and then later on delete the contents of <strong>H8</strong>, pressing <kbd>Ctrl</kbd> + <kbd>End</kbd> will still take you to <strong>H8</strong> cell. The above function will have the same behavior.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h1>Updated at End of 2021</h1>
<p>With Excel's new <a href="https://support.microsoft.com/en-us/office/tips-for-improving-excel-s-performance-a8294ac5-652d-47f2-8e89-1c3ce2c09439" rel="nofollow noreferrer">calculation engine and array functionality</a>, and <a href="https://support.microsoft.com/en-us/office/filter-function-f4f7cb66-82eb-4767-8f7c-4877ad80c759" rel="nofollow noreferrer">Filter Function</a>, I believe this topic should now be far less contested and that the below options offer the best mix of speed, reliability, and simplicity (which has proven difficult to balance in the past as the numerous posts here illustrate).</p>
<p>Also, I'm defining <code>last used</code> as <em>NOT blank</em> as defined by the <a href="https://support.microsoft.com/en-us/office/is-functions-0f2d7971-6019-40a0-a171-f2d869135665" rel="nofollow noreferrer">isBlank</a> function.</p>
<h2>Excel Formula</h2>
<p>First, note that the Filter Function makes it much simpler to get a last cell using the below formulas for a specific row or column (in these case <code>Column A</code> or <code>Row 1</code>):</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">=MAX(FILTER(ROW(A:A),<span class="hljs-built_in">NOT</span>(ISBLANK(A:A))))
=MAX(FILTER(COLUMN(<span class="hljs-number">1</span>:<span class="hljs-number">1</span>),<span class="hljs-built_in">NOT</span>(ISBLANK(<span class="hljs-number">1</span>:<span class="hljs-number">1</span>))))
</code></pre>
<h2>VBA Function For Last Row Specific Range</h2>
<p>Using the above function we can convert it into a VBA function, yet make it even faster by limiting the range, while expanding its capabilities by doing multiple columns (thanks to <a href="https://stackoverflow.com/users/445425/chris-neilsen">Chris Neilsen</a> for immediate feedback tweeking/suggestions). I also found massive speed improvement by scoping each column to only be a range with a row HIGHER than the previous last row.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> FindLastRowInRange(someColumns <span class="hljs-keyword">As</span> Range) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
<span class="hljs-keyword">Const</span> zFx = <span class="hljs-string">"=MAX(FILTER(ROW(????),NOT(ISBLANK(????)),0))"</span>
   
   <span class="hljs-keyword">Dim</span> tRng <span class="hljs-keyword">As</span> Range, i <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>, tRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>, pRng <span class="hljs-keyword">As</span> Range
   <span class="hljs-keyword">With</span> someColumns.Worksheet
      <span class="hljs-keyword">Set</span> tRng = Intersect(someColumns.EntireColumn, .UsedRange)
      
      <span class="hljs-keyword">For</span> i = <span class="hljs-number">1</span> <span class="hljs-keyword">To</span> tRng.Columns.Count
         
         <span class="hljs-keyword">Set</span> pRng = Intersect(tRng.Columns(i), _
         Range(.Rows(FindLastRowInRange + <span class="hljs-number">1</span>), .Rows(.Rows.Count)))
         
         <span class="hljs-keyword">If</span> <span class="hljs-built_in">Not</span> pRng <span class="hljs-built_in">Is</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>
            tRow = .Evaluate(Replace(zFx, <span class="hljs-string">"????"</span>, _
               pRng.Address, <span class="hljs-number">1</span>, -<span class="hljs-number">1</span>))
         
            <span class="hljs-keyword">If</span> tRow &gt; FindLastRowInRange <span class="hljs-keyword">Then</span> _
               FindLastRowInRange = tRow
            
         <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
      <span class="hljs-keyword">Next</span> i
   <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<h2>VBA Function For Last Row In Worksheet</h2>
<p>To consider the entire worksheet (all columns), I would recommend using a different VBA formula that references the prior one, but is a <a href="https://docs.microsoft.com/en-us/office/vba/api/excel.application.volatile" rel="nofollow noreferrer">Volatile Function</a>. This ensures that the formula updates with <em>any</em> changes to a worksheet. Obviously, one could combine these two formulas, but I prefer to limit the usage of volatile functions.</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> FindLastRowInSheet(anywhereInSheet <span class="hljs-keyword">As</span> Range) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
      Application.Volatile
      FindLastRowInSheet = FindLastRowInRange(anywhereInSheet.Worksheet.UsedRange)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
<h2>Advantages Compared To Other Options</h2>
<ul>
<li>Allows for some or ALL rows/columns in worksheet without changing approach.</li>
<li>No possibility of missing hidden rows as is a risk with <code>xlup</code></li>
<li>Ignores formatted/usedrange issues.</li>
<li>Does not interfere with user's <code>Find</code> settings.</li>
<li>Uses worksheet functionality which is faster than VBA calcs.</li>
<li>No counting cells (performance hog).</li>
</ul>
<p>Hopefully this ends the debate, but if anyone finds weaknesses in this please share.</p>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">sub</span> last_filled_cell()
msgbox range(<span class="hljs-string">"A65536"</span>).<span class="hljs-keyword">end</span>(xlup).row
<span class="hljs-keyword">end</span> <span class="hljs-keyword">sub</span>
</code></pre>

<p>Here, <kbd>A65536</kbd> is the last cell in the Column A this code was tested on excel 2003.</p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>However this question is seeking to find the last row using VBA, I think it would be good to include an array formula for worksheet function  as this gets visited frequently:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">{=ADDRESS(MATCH(INDEX(D:D,MAX(<span class="hljs-keyword">IF</span>(D:D&lt;&gt;<span class="hljs-string">""</span>,ROW(D:D)-ROW(D1)+<span class="hljs-number">1</span>)),<span class="hljs-number">1</span>),D:D,<span class="hljs-number">0</span>),COLUMN(D:D))}
</code></pre>
<p>You need to enter the formula without brackets and then hit <kbd>Shift</kbd> + <kbd>Ctrl</kbd> + <kbd>Enter</kbd> to make it an array formula.</p>
<p>This will give you address of last used cell in the column D.</p>
<hr>
<p>Thanks to <a href="https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/43857774#comment104400383_43857774">pgsystemtester</a>, this will give you the row number of last used cell:</p>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">{=MATCH(INDEX(D:D,MAX(<span class="hljs-keyword">IF</span>(D:D&lt;&gt;<span class="hljs-string">""</span>,ROW(D:D)-ROW(D1)+<span class="hljs-number">1</span>)),<span class="hljs-number">1</span>),D:D,<span class="hljs-number">0</span>)}
</code></pre>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I was looking for a way to mimic the <kbd>CTRL</kbd>+<kbd>Shift</kbd>+<kbd>End</kbd>, so dotNET solution is great, except with my Excel 2010 I need to add a <code>set</code> if I want to avoid an error:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> GetLastCell(sh <span class="hljs-keyword">As</span> Worksheet) <span class="hljs-keyword">As</span> Range
  <span class="hljs-keyword">Set</span> GetLastCell = sh.Cells(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>).SpecialCells(xlLastCell)
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>

<p>and how to check this for yourself:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> test()
  <span class="hljs-keyword">Dim</span> ws <span class="hljs-keyword">As</span> Worksheet, r <span class="hljs-keyword">As</span> Range
  <span class="hljs-keyword">Set</span> ws = ActiveWorkbook.Sheets(<span class="hljs-string">"Sheet1"</span>)
  <span class="hljs-keyword">Set</span> r = GetLastCell(ws)
  MsgBox r.Column &amp; <span class="hljs-string">"-"</span> &amp; r.Row
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> lastRow()

    <span class="hljs-keyword">Dim</span> i <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
        i = Cells(Rows.Count, <span class="hljs-number">1</span>).<span class="hljs-keyword">End</span>(xlUp).Row
            MsgBox i

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>

<span class="hljs-keyword">sub</span> LastRow()

<span class="hljs-comment">'Paste &amp; for better understanding of the working use F8 Key to run the code .</span>

<span class="hljs-keyword">dim</span> WS <span class="hljs-keyword">as</span> worksheet
<span class="hljs-keyword">dim</span> i <span class="hljs-keyword">as</span> <span class="hljs-type">long</span>

<span class="hljs-keyword">set</span> ws = thisworkbook(<span class="hljs-string">"SheetName"</span>)

ws.activate

ws.range(<span class="hljs-string">"a1"</span>).<span class="hljs-keyword">select</span>

ws.range(<span class="hljs-string">"a1048576"</span>).<span class="hljs-keyword">select</span>

activecell.<span class="hljs-keyword">end</span>(xlup).<span class="hljs-keyword">select</span>

i= activecell.row

msgbox <span class="hljs-string">"My Last Row Is "</span> &amp; i

<span class="hljs-keyword">End</span> <span class="hljs-keyword">sub</span>
</code></pre>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For the last 3+ years these are the functions that I am using for finding last row and last column per defined column(for row) and row(for column):</p>

<h2>Last Column:</h2>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> lastCol(<span class="hljs-keyword">Optional</span> wsName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, <span class="hljs-keyword">Optional</span> rowToCheck <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span> = <span class="hljs-number">1</span>) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>

    <span class="hljs-keyword">Dim</span> ws  <span class="hljs-keyword">As</span> Worksheet

    <span class="hljs-keyword">If</span> wsName = vbNullString <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">Set</span> ws = ActiveSheet
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">Set</span> ws = Worksheets(wsName)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    lastCol = ws.Cells(rowToCheck, ws.Columns.Count).<span class="hljs-keyword">End</span>(xlToLeft).Column

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>

<h2>Last Row:</h2>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Function</span> lastRow(<span class="hljs-keyword">Optional</span> wsName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, <span class="hljs-keyword">Optional</span> columnToCheck <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span> = <span class="hljs-number">1</span>) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>

    <span class="hljs-keyword">Dim</span> ws <span class="hljs-keyword">As</span> Worksheet

    <span class="hljs-keyword">If</span> wsName = vbNullString <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">Set</span> ws = ActiveSheet
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">Set</span> ws = Worksheets(wsName)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    lastRow = ws.Cells(ws.Rows.Count, columnToCheck).<span class="hljs-keyword">End</span>(xlUp).Row

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>

<p>For the case of the OP, this is the way to get the last row in column <code>E</code>:</p>

<p><code>Debug.Print lastRow(columnToCheck:=Range("E4:E48").Column)</code></p>

<h2>Last Row, counting empty rows with data:</h2>

<p>Here we may use the <a href="https://www.vitoshacademy.com/last-used-row-last-used-column-in-excel-with-formula-without-vba/" rel="nofollow noreferrer">well-known Excel formulas</a>, which give us the last row of a worksheet in Excel, without involving VBA - <code>=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(A:A))),ROW(A:A)),0)</code></p>

<p>In order to put this in VBA and not to write anything in Excel, using the parameters for the latter functions, something like this could be in mind:</p>

<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Public</span> <span class="hljs-keyword">Function</span> LastRowWithHidden(<span class="hljs-keyword">Optional</span> wsName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>, <span class="hljs-keyword">Optional</span> columnToCheck <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span> = <span class="hljs-number">1</span>) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>

    <span class="hljs-keyword">Dim</span> ws <span class="hljs-keyword">As</span> Worksheet

    <span class="hljs-keyword">If</span> wsName = vbNullString <span class="hljs-keyword">Then</span>
        <span class="hljs-keyword">Set</span> ws = ActiveSheet
    <span class="hljs-keyword">Else</span>
        <span class="hljs-keyword">Set</span> ws = Worksheets(wsName)
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

    <span class="hljs-keyword">Dim</span> letters <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    letters = ColLettersGenerator(columnToCheck)
    LastRowWithHidden = ws.Evaluate(<span class="hljs-string">"=IFERROR(LOOKUP(2,1/(NOT(ISBLANK("</span> &amp; letters &amp; <span class="hljs-string">"))),ROW("</span> &amp; letters &amp; <span class="hljs-string">" )),0)"</span>)

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>

<span class="hljs-keyword">Function</span> ColLettersGenerator(col <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>

    <span class="hljs-keyword">Dim</span> result <span class="hljs-keyword">As</span> Variant
    result = Split(Cells(<span class="hljs-number">1</span>, col).Address(<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>), <span class="hljs-string">"$"</span>)
    ColLettersGenerator = result(<span class="hljs-number">0</span>) &amp; <span class="hljs-string">":"</span> &amp; result(<span class="hljs-number">0</span>)

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
    </div></div></div></div><div id="solution14" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2 id="last-row-in-a-regular-range-or-a-table-listobject"><strong>Last Row in a regular range or a Table (ListObject)</strong></h2>
<ol>
<li>Finding the last row requires using different methods if the range is a regular range or table (List Object).</li>
<li>Finding the last row in tables requires specifying additional parameters (table name , the column relative position to the first tables column).</li>
</ol>
<p>I created this universal function for last row, regardless of range type. Just give it any cell reference whatsoever and it will return the last row.
No hassle having to knew range characteristics, especially if your ranges are some times a regular range and sometimes a ListObject.
Using a regular range method on a table might return wrong results.
Sure you can plan ahead of time and use the right method each time, but why bother if you can utilizes a universal function ?</p>
<blockquote>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet"><span class="hljs-keyword">Sub</span> RunMyLastRow()
<span class="hljs-keyword">Dim</span> Result <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
Result = MyLastRow(Worksheets(<span class="hljs-number">1</span>).Range(<span class="hljs-string">"A1"</span>))
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span>
</code></pre>
</blockquote>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">    <span class="hljs-keyword">Function</span> MyLastRow(RefrenceRange <span class="hljs-keyword">As</span> Range) <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> WS <span class="hljs-keyword">As</span> Worksheet
    <span class="hljs-keyword">Dim</span> TableName <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
    <span class="hljs-keyword">Dim</span> ColNumber <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> LastRow <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> FirstColumnTable <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Dim</span> ColNumberTable <span class="hljs-keyword">As</span> <span class="hljs-type">Long</span>
    <span class="hljs-keyword">Set</span> WS = RefrenceRange.Worksheet
    TableName = GetTableName(RefrenceRange)
    ColNumber = RefrenceRange.Column
    
    <span class="hljs-comment">''If the table (ListObject) does not start in column "A" we need to calculate the </span>
    <span class="hljs-comment">''first Column table and how many Columns from its beginning the Column is located.</span>
    <span class="hljs-keyword">If</span> TableName &lt;&gt; vbNullString <span class="hljs-keyword">Then</span>
     FirstColumnTable = WS.ListObjects(TableName).ListColumns(<span class="hljs-number">1</span>).Range.Column
     ColNumberTable = ColNumber - FirstColumnTable + <span class="hljs-number">1</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span> 

    <span class="hljs-keyword">If</span> TableName = vbNullString <span class="hljs-keyword">Then</span>
    LastRow = WS.Cells(WS.Rows.Count, ColNumber).<span class="hljs-keyword">End</span>(xlUp).Row
    <span class="hljs-keyword">Else</span>
    LastRow = WS.ListObjects(TableName).ListColumns(ColNumberTable).Range.Find( _
               What:=<span class="hljs-string">"*"</span>, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    MyLastRow = LastRow
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
    
</code></pre>
<blockquote>
<pre class="lang-vb s-code-block"><code class="hljs language-vbnet">    <span class="hljs-comment">''Get Table Name by Cell Range</span>
    <span class="hljs-keyword">Function</span> GetTableName(RefrenceRange <span class="hljs-keyword">As</span> Range) <span class="hljs-keyword">As</span> <span class="hljs-type">String</span>
        <span class="hljs-keyword">If</span> RefrenceRange.ListObject <span class="hljs-built_in">Is</span> <span class="hljs-literal">Nothing</span> <span class="hljs-keyword">Then</span>
            GetTableName = vbNullString
        <span class="hljs-keyword">Else</span>
            GetTableName = RefrenceRange.ListObject.Name
        <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
</code></pre>
</blockquote>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;NOTE\u0026lt;/strong\u0026gt;: I intend to make this a \u0026quot;one stop post\u0026quot; where you can use the \u0026lt;code\u0026gt;Correct\u0026lt;/code\u0026gt; way to find the last row. This will also cover the best practices to follow when finding the last row. And hence I will keep on updating it whenever I come across a new scenario/information.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;Unreliable ways of finding the last row\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Some of the most common ways of finding last row which are highly unreliable and hence should never be used.\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;UsedRange\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;xlDown\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;CountA\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; should \u0026lt;strong\u0026gt;NEVER\u0026lt;/strong\u0026gt; be used to find the last cell which has data. It is highly unreliable. Try this experiment.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Type something in cell \u0026lt;code\u0026gt;A5\u0026lt;/code\u0026gt;. Now when you calculate the last row with any of the methods given below, it will give you 5. Now color the cell \u0026lt;code\u0026gt;A10\u0026lt;/code\u0026gt; red. If you now use the any of the below code, you will still get 5. If you use \u0026lt;code\u0026gt;Usedrange.Rows.Count\u0026lt;/code\u0026gt; what do you get? It won\u0026apos;t be 5.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Here is a scenario to show how \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; works.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/3TqSI.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;xlDown\u0026lt;/code\u0026gt; is equally unreliable. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Consider this code\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;lastrow = Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlDown).Row\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;What would happen if there was only one cell (\u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt;) which had data? You will end up reaching the last row in the worksheet! It\u0026apos;s like selecting cell \u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt; and then pressing \u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt; key and then pressing \u0026lt;kbd\u0026gt;Down Arrow\u0026lt;/kbd\u0026gt; key. This will also give you unreliable results if there are blank cells in a range.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;CountA\u0026lt;/code\u0026gt; is also unreliable because it will give you incorrect result if there are blank cells in between. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;And hence one should avoid the use of \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;xlDown\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;CountA\u0026lt;/code\u0026gt; to find the last cell.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Find Last Row in a Column\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;To find the last Row in Col E use this\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; Sheets(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sheet1\u0026quot;\u0026lt;/span\u0026gt;)\n    LastRow = .Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;E\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; .Rows.Count).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlUp).Row\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;If you notice that we have a \u0026lt;code\u0026gt;.\u0026lt;/code\u0026gt; before \u0026lt;code\u0026gt;Rows.Count\u0026lt;/code\u0026gt;. We often chose to ignore that. See \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/19985345/vba-excel-compability-mode#comment29753337_19985345\u0026quot;\u0026gt;THIS\u0026lt;/a\u0026gt; question on the possible error that you may get. I always advise using \u0026lt;code\u0026gt;.\u0026lt;/code\u0026gt; before \u0026lt;code\u0026gt;Rows.Count\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;Columns.Count\u0026lt;/code\u0026gt;. That question is a classic scenario where the code will fail because the \u0026lt;code\u0026gt;Rows.Count\u0026lt;/code\u0026gt; returns \u0026lt;code\u0026gt;65536\u0026lt;/code\u0026gt; for Excel 2003 and earlier and \u0026lt;code\u0026gt;1048576\u0026lt;/code\u0026gt; for Excel 2007 and later. Similarly \u0026lt;code\u0026gt;Columns.Count\u0026lt;/code\u0026gt; returns \u0026lt;code\u0026gt;256\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;16384\u0026lt;/code\u0026gt;, respectively. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The above fact that Excel 2007+ has \u0026lt;code\u0026gt;1048576\u0026lt;/code\u0026gt; rows also emphasizes on the fact that we should always declare the variable which will hold the row value as \u0026lt;code\u0026gt;Long\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;Integer\u0026lt;/code\u0026gt; else you will get an \u0026lt;code\u0026gt;Overflow\u0026lt;/code\u0026gt; error.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Note that this approach will skip any hidden rows. Looking back at \u0026lt;a href=\u0026quot;https://i.stack.imgur.com/3TqSI.png\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;my screenshot above for column A\u0026lt;/a\u0026gt;, if row 8 were hidden, this approach would return \u0026lt;code\u0026gt;5\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;8\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Find Last Row in a Sheet\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;To find the \u0026lt;code\u0026gt;Effective\u0026lt;/code\u0026gt; last row in the sheet, use this. Notice the use of \u0026lt;code\u0026gt;Application.WorksheetFunction.CountA(.Cells)\u0026lt;/code\u0026gt;. This is required because if there are no cells with data in the worksheet then \u0026lt;code\u0026gt;.Find\u0026lt;/code\u0026gt; will give you \u0026lt;code\u0026gt;Run Time Error 91: Object Variable or With block variable not set\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; Sheets(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sheet1\u0026quot;\u0026lt;/span\u0026gt;)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; Application.WorksheetFunction.CountA(.Cells) \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        lastrow = .Cells.Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, _\n                      After:=.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).Row\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        lastrow = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;h2\u0026gt;Find Last Row in a Table (ListObject)\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;The same principles apply, for example to get the last row in the third column of a table:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; FindLastRowInExcelTableColAandB()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lastRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ws \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet, tbl \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; ListObject\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = Sheets(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sheet1\u0026quot;\u0026lt;/span\u0026gt;)  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Modify as needed\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Assuming the name of the table is \u0026quot;Table1\u0026quot;, modify as needed\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; tbl = ws.ListObjects(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Table1\u0026quot;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; tbl.ListColumns(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;).Range\n    lastrow = .Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, _\n                After:=.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), _\n                Lookat:=xlPart, _\n                LookIn:=xlFormulas, _\n                SearchOrder:=xlByRows, _\n                SearchDirection:=xlPrevious, _\n                MatchCase:=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).Row\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Note: this answer was motivated by \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/27637752#comment43694683_11169920\u0026quot;\u0026gt;this comment\u0026lt;/a\u0026gt;. The purpose of \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; is different from what is mentioned in the answer above.\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;As to the correct way of finding the last used cell, one has first to decide what is considered \u0026lt;em\u0026gt;used\u0026lt;/em\u0026gt;, and then select a suitable method\u0026lt;/strong\u0026gt;. I conceive at least three meanings:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Used = non-blank, i.e., having \u0026lt;strong\u0026gt;data\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Used = \u0026quot;... in use, meaning the section that contains \u0026lt;strong\u0026gt;data or formatting\u0026lt;/strong\u0026gt;.\u0026quot;\n\u0026lt;a href=\u0026quot;http://support.microsoft.com/kb/244435\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;As per official documentation\u0026lt;/a\u0026gt;, this is the criterion used by Excel at the time of saving. See also \u0026lt;a href=\u0026quot;https://support.office.com/en-sg/article/Locate-and-reset-the-last-cell-on-a-worksheet-c9e468a8-0fc3-4f69-8038-b3c1d86e99e9\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;this official documentation\u0026lt;/a\u0026gt;.\nIf one is not aware of this, the criterion may produce unexpected results, but it may also be intentionally exploited (less often, surely), e.g., to highlight or print specific regions, which may eventually have no data.\nAnd, of course, it is desirable as a criterion for the range to use when saving a workbook, lest losing part of one\u0026apos;s work.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Used = \u0026quot;... in use, meaning the section that contains \u0026lt;strong\u0026gt;data or formatting\u0026lt;/strong\u0026gt;\u0026quot; \u0026lt;strong\u0026gt;or conditional formatting.\u0026lt;/strong\u0026gt;\nSame as 2., but also including cells that are the target for any Conditional Formatting rule.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;How to find the last used cell depends on what \u0026lt;em\u0026gt;you\u0026lt;/em\u0026gt; want (your criterion)\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;For criterion 1, I suggest reading \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/11169920/2707864\u0026quot;\u0026gt;this answer\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;.\nNote that \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; is cited as unreliable. I think that is misleading (i.e., \u0026quot;unfair\u0026quot; to \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt;), as \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; is simply not meant to report the last cell containing data. So it should not be used in this case, as indicated in that answer. See also \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#comment43694683_11169920\u0026quot;\u0026gt;this comment\u0026lt;/a\u0026gt;. \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;For criterion 2, \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; is the most reliable option\u0026lt;/em\u0026gt;, as compared to other options also designed for this use. It even makes it unnecessary to save a workbook to make sure that the last cell is updated.\n\u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt; will go to a wrong cell prior to saving\n(The last cell is not reset until you save the worksheet, from\n\u0026lt;a href=\u0026quot;http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;http://msdn.microsoft.com/en-us/library/aa139976%28v=office.10%29.aspx\u0026lt;/a\u0026gt;.\nIt is an old reference, but in this respect valid).\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;For criterion 3, I do not know any built-in method\u0026lt;/em\u0026gt;.\nCriterion 2 does not account for Conditional Formatting. One may have formatted cells, based on formulas, which are not detected by \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; or \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt;.\nIn the figure, the last cell is B3, since formatting was applied explicitly to it. Cells B6:D7 have a format derived from a Conditional Formatting rule, and this is not detected even by \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt;.\nAccounting for this would require some VBA programming.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/vhayX.jpg\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;hr\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;As to your specific question\u0026lt;/strong\u0026gt;:\n\u0026lt;em\u0026gt;What\u0026apos;s the reason behind this?\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Your code uses the first cell in your range E4:E48 as a trampoline, for \u0026lt;em\u0026gt;jumping\u0026lt;/em\u0026gt; down with \u0026lt;code\u0026gt;End(xlDown)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The \u0026quot;erroneous\u0026quot; output will obtain if there are no \u0026lt;em\u0026gt;non-blank\u0026lt;/em\u0026gt; cells in your range other than perhaps the first. Then, you are \u0026lt;em\u0026gt;leaping in the dark\u0026lt;/em\u0026gt;, i.e., down the worksheet\n(you should note the difference between \u0026lt;em\u0026gt;blank\u0026lt;/em\u0026gt; and \u0026lt;em\u0026gt;empty string\u0026lt;/em\u0026gt;!). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Note that:\u0026lt;/p\u0026gt;\n\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If your range contains non-contiguous non-blank cells, then it will also give a wrong result.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If there is only one non-blank cell, but it is not the first one, your code will still give you the correct result.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I created this one-stop function for \u0026lt;strong\u0026gt;determining the last row, column and cell, be it for data, formatted (grouped/commented/hidden) cells or conditional formatting\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; LastCellMsg()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strResult \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngDataRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngDataCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strDataCell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strDataFormatRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngDataFormatCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strDataFormatCell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; oFormatCond \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; FormatCondition\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngTempRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngTempCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngCFRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngCFCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strCFCell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngOverallRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; lngOverallCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; strOverallCell \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; ActiveSheet\n\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; .ListObjects.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            MsgBox \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Cannot return reliable results, as there is at least one table in the worksheet.\u0026quot;\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Exit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n        strResult = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Workbook name: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; .Parent.Name \u0026amp;amp; vbCrLf\n        strResult = strResult \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sheet name: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; .Name \u0026amp;amp; vbCrLf\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;DATA:\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data row\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; Application.WorksheetFunction.CountA(.Cells) \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            lngDataRow = .Cells.Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, _\n             After:=.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByRows, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).Row\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            lngDataRow = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last data row: \u0026quot; \u0026amp;amp; lngDataRow \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data column\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; Application.WorksheetFunction.CountA(.Cells) \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            lngDataCol = .Cells.Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, _\n             After:=.Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;), _\n             Lookat:=xlPart, _\n             LookIn:=xlFormulas, _\n             SearchOrder:=xlByColumns, _\n             SearchDirection:=xlPrevious, _\n             MatchCase:=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;).Column\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            lngDataCol = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last data column: \u0026quot; \u0026amp;amp; lngDataCol \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data cell\u0026lt;/span\u0026gt;\n        strDataCell = Replace(Cells(lngDataRow, lngDataCol).Address, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;, vbNullString)\n        strResult = strResult \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Last data cell: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; strDataCell \u0026amp;amp; vbCrLf\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;FORMATS:\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data/formatted/grouped/commented/hidden row\u0026lt;/span\u0026gt;\n        strDataFormatRow = StrReverse(Split(StrReverse(.UsedRange.Address), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;)(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last data/formatted row: \u0026quot; \u0026amp;amp; strDataFormatRow \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data/formatted/grouped/commented/hidden column\u0026lt;/span\u0026gt;\n        lngDataFormatCol = Range(StrReverse(Split(StrReverse(.UsedRange.Address), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;)(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)) \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt;).Column\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last data/formatted column: \u0026quot; \u0026amp;amp; lngDataFormatCol \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last data/formatted/grouped/commented/hidden cell\u0026lt;/span\u0026gt;\n        strDataFormatCell = Replace(Cells(strDataFormatRow, lngDataFormatCol).Address, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;, vbNullString)\n        strResult = strResult \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Last data/formatted cell: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; strDataFormatCell \u0026amp;amp; vbCrLf\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;CONDITIONAL FORMATS:\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Each\u0026lt;/span\u0026gt; oFormatCond \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;In\u0026lt;/span\u0026gt; .Cells.FormatConditions\n\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last conditionally-formatted row\u0026lt;/span\u0026gt;\n            lngTempRow = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;CLng\u0026lt;/span\u0026gt;(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;)(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)))\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; lngTempRow \u0026amp;gt; lngCFRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; lngCFRow = lngTempRow\n\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last conditionally-formatted column\u0026lt;/span\u0026gt;\n            lngTempCol = Range(StrReverse(Split(StrReverse(oFormatCond.AppliesTo.Address), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;)(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)) \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1\u0026quot;\u0026lt;/span\u0026gt;).Column\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; lngTempCol \u0026amp;gt; lngCFCol \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; lngCFCol = lngTempCol\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;no results are returned for Conditional Format if there is no such\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; lngCFRow \u0026amp;lt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last cond-formatted row: \u0026quot; \u0026amp;amp; lngCFRow \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last cond-formatted column: \u0026quot; \u0026amp;amp; lngCFCol \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;last conditionally-formatted cell\u0026lt;/span\u0026gt;\n            strCFCell = Replace(Cells(lngCFRow, lngCFCol).Address, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;, vbNullString)\n            strResult = strResult \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Last cond-formatted cell: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; strCFCell \u0026amp;amp; vbCrLf\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;OVERALL:\u0026lt;/span\u0026gt;\n        lngOverallRow = Application.WorksheetFunction.Max(lngDataRow, strDataFormatRow, lngCFRow)\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last overall row: \u0026quot; \u0026amp;amp; lngOverallRow \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n        lngOverallCol = Application.WorksheetFunction.Max(lngDataCol, lngDataFormatCol, lngCFCol)\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;strResult = strResult \u0026amp;amp; \u0026quot;Last overall column: \u0026quot; \u0026amp;amp; lngOverallCol \u0026amp;amp; vbCrLf\u0026lt;/span\u0026gt;\n        strOverallCell = Replace(.Cells(lngOverallRow, lngOverallCol).Address, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;, vbNullString)\n        strResult = strResult \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Last overall cell: \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; strOverallCell \u0026amp;amp; vbCrLf\n\n        MsgBox strResult\n        Debug.Print strResult\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Results look like this:\u0026lt;br\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/4UaTd.jpg\u0026quot; alt=\u0026quot;determine last cell\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;For more detailed results, some lines in the code can be uncommented:\u0026lt;br\u0026gt;\n\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/iqXQ0.jpg\u0026quot; alt=\u0026quot;last column, row\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;One limitation exists - if there are tables in the sheet, results can become unreliable, so I decided to avoid running the code in this case:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; .ListObjects.Count \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    MsgBox \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Cannot return reliable results, as there is at least one table in the worksheet.\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Exit\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One important note to keep in mind when using the solution ...\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;LastRow = ws.Cells.Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, After:=ws.range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a1\u0026quot;\u0026lt;/span\u0026gt;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;... is to ensure that your \u0026lt;code\u0026gt;LastRow\u0026lt;/code\u0026gt; variable is of \u0026lt;code\u0026gt;Long\u0026lt;/code\u0026gt; type:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; LastRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Otherwise you will end up getting OVERFLOW errors in certain situations in .XLSX workbooks\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is my encapsulated function that I drop in to various code uses.\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; FindLastRow(ws \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; --------------------------------------------------------------------------------\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Find the last used Row on a Worksheet\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; --------------------------------------------------------------------------------\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; WorksheetFunction.CountA(ws.Cells) \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos; Search for any entry, by searching backwards by Rows.\u0026lt;/span\u0026gt;\n        FindLastRow = ws.Cells.Find(What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, After:=ws.range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a1\u0026quot;\u0026lt;/span\u0026gt;), SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Since the original question is about \u0026lt;em\u0026gt;problems\u0026lt;/em\u0026gt; with finding the last cell, \u0026lt;strong\u0026gt;in this answer I will list the various ways you can get unexpected results\u0026lt;/strong\u0026gt;; see \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/49971492/1026\u0026quot;\u0026gt;my answer to \u0026lt;em\u0026gt;\u0026quot;How can I find last row that contains data in the Excel sheet with a macro?\u0026quot;\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt; for my take on solving this.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I\u0026apos;ll start by expanding on \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752\u0026quot;\u0026gt;the answer by sancho.s\u0026lt;/a\u0026gt; and \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba#comment73816621_27637752\u0026quot;\u0026gt;the comment by GlennFromIowa\u0026lt;/a\u0026gt;, adding even more detail:\u0026lt;/p\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;[...] one has first to decide what is considered used. I see at least 6 meanings. Cell has:\u0026lt;/p\u0026gt;\n  \n  \u0026lt;ul\u0026gt;\n  \u0026lt;li\u0026gt;1) data, i.e., a formula, possibly resulting in a blank value;\u0026lt;/li\u0026gt;\n  \u0026lt;li\u0026gt;2) a value, i.e., a non-blank formula or constant;\u0026lt;/li\u0026gt;\n  \u0026lt;li\u0026gt;3) formatting;\u0026lt;/li\u0026gt;\n  \u0026lt;li\u0026gt;4) conditional formatting;\u0026lt;/li\u0026gt;\n  \u0026lt;li\u0026gt;5) a shape (including Comment) overlapping the cell;\u0026lt;/li\u0026gt;\n  \u0026lt;li\u0026gt;6) involvement in a Table (List Object).\u0026lt;/li\u0026gt;\n  \u0026lt;/ul\u0026gt;\n  \n  \u0026lt;p\u0026gt;Which combination do you want to test for? Some (such as Tables) may be more difficult to test for, and some may be rare (such as a shape outside of data range),  but others may vary based on the situation (e.g., formulas with blank values).\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\n\u0026lt;p\u0026gt;Other things you might want to consider:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;A) Can there be \u0026lt;em\u0026gt;hidden rows\u0026lt;/em\u0026gt; (e.g. autofilter), \u0026lt;em\u0026gt;blank cells\u0026lt;/em\u0026gt; or blank rows?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;B) What kind of performance is acceptable?\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;C) Can the VBA macro affect the workbook or the application settings in any way?\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;With that in mind, let\u0026apos;s see \u0026lt;strong\u0026gt;how the common ways of getting the \u0026quot;last cell\u0026quot; can produce unexpected results:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;The \u0026lt;code\u0026gt;.End(xlDown)\u0026lt;/code\u0026gt; code from the question will break most easily (e.g. with \u0026lt;strong\u0026gt;a single non-empty cell\u0026lt;/strong\u0026gt; or when there are \u0026lt;strong\u0026gt;blank cells in between\u0026lt;/strong\u0026gt;) for the reasons explained in \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\u0026quot;\u0026gt;the answer by Siddharth Rout\u0026lt;/a\u0026gt; here (search for \u0026lt;em\u0026gt;\u0026quot;xlDown is equally unreliable.\u0026quot;\u0026lt;/em\u0026gt;) \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Any solution based on \u0026lt;code\u0026gt;Count\u0026lt;/code\u0026gt;ing (\u0026lt;code\u0026gt;CountA\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Cells*.Count\u0026lt;/code\u0026gt;) or \u0026lt;code\u0026gt;.CurrentRegion\u0026lt;/code\u0026gt; will also break in presence of blank cells or rows \u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;A solution involving \u0026lt;code\u0026gt;.End(xlUp)\u0026lt;/code\u0026gt; to search backwards from the end of a column will, just as CTRL+UP, look for \u0026lt;strong\u0026gt;data\u0026lt;/strong\u0026gt; (formulas producing a blank value are considered \u0026quot;data\u0026quot;) in \u0026lt;strong\u0026gt;visible rows\u0026lt;/strong\u0026gt; (so using it with autofilter enabled might produce incorrect results ). \u0026lt;p\u0026gt;You have to take care to avoid the standard pitfalls (for details I\u0026apos;ll again refer to \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\u0026quot;\u0026gt;the answer by Siddharth Rout\u0026lt;/a\u0026gt; here, look for the \u0026lt;em\u0026gt;\u0026quot;Find Last Row in a Column\u0026quot;\u0026lt;/em\u0026gt; section), such as hard-coding the last row (\u0026lt;code\u0026gt;Range(\u0026quot;A65536\u0026quot;).End(xlUp)\u0026lt;/code\u0026gt;) instead of relying on \u0026lt;code\u0026gt;sht.Rows.Count\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;.SpecialCells(xlLastCell)\u0026lt;/code\u0026gt; is equivalent to CTRL+END, returning the bottom-most and right-most cell of the \u0026quot;used range\u0026quot;, so all caveats that apply to relying on the \u0026quot;used range\u0026quot;, apply to this method as well. In addition, the \u0026quot;used range\u0026quot; is only reset when saving the workbook and when accessing \u0026lt;code\u0026gt;worksheet.UsedRange\u0026lt;/code\u0026gt;, so \u0026lt;code\u0026gt;xlLastCell\u0026lt;/code\u0026gt; might produce stale results with unsaved modifications (e.g. after some rows were deleted). See the \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/29899739/1026\u0026quot;\u0026gt;nearby answer by dotNET\u0026lt;/a\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;sht.UsedRange\u0026lt;/code\u0026gt; (described in detail in \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/27637752#27637752\u0026quot;\u0026gt;the answer by sancho.s\u0026lt;/a\u0026gt; here) considers \u0026lt;strong\u0026gt;both data and formatting\u0026lt;/strong\u0026gt; (though not conditional formatting) and \u0026lt;strong\u0026gt;resets the \u0026quot;used range\u0026quot; of the worksheet\u0026lt;/strong\u0026gt;, which may or may not be what you want.\u0026lt;p\u0026gt;Note that a common mistake is to use \u0026lt;code\u0026gt;.UsedRange.Rows.Count\u0026lt;/code\u0026gt;, which returns the \u0026lt;em\u0026gt;number of rows\u0026lt;/em\u0026gt; in the used range, not the \u0026lt;em\u0026gt;last row number\u0026lt;/em\u0026gt; (they will be different if the first few rows are blank), for details see \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/35975280/1026\u0026quot;\u0026gt;newguy\u0026apos;s answer to \u0026lt;em\u0026gt;How can I find last row that contains data in the Excel sheet with a macro?\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;.Find\u0026lt;/code\u0026gt; allows you to find the last row with any data (including formulas) or a non-blank value \u0026lt;strong\u0026gt;in any column\u0026lt;/strong\u0026gt;. You can choose whether you\u0026apos;re interested in formulas or values, but the catch is that it \u0026lt;strong\u0026gt;resets the defaults in the Excel\u0026apos;s Find dialog\u0026lt;/strong\u0026gt; , which can be highly confusing to your users. It also needs to be used carefully, see \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba/11169920#11169920\u0026quot;\u0026gt;the answer by Siddharth Rout\u0026lt;/a\u0026gt; here (section \u0026lt;em\u0026gt;\u0026quot;Find Last Row in a Sheet\u0026quot;\u0026lt;/em\u0026gt;)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;More explicit solutions that check individual \u0026lt;code\u0026gt;Cells\u0026lt;/code\u0026gt;\u0026apos; in a loop are generally slower than re-using an Excel function (although can still be performant), but let you specify exactly what you want to find. See \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/49971492/1026\u0026quot;\u0026gt;my solution\u0026lt;/a\u0026gt; based on \u0026lt;code\u0026gt;UsedRange\u0026lt;/code\u0026gt; and VBA arrays to find the last cell with data in the given column -- it handles hidden rows, filters, blanks, does not modify the Find defaults and is quite performant.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;Whatever solution you pick, be careful\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;to use \u0026lt;code\u0026gt;Long\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;Integer\u0026lt;/code\u0026gt; to store the row numbers (to avoid getting \u0026lt;code\u0026gt;Overflow\u0026lt;/code\u0026gt; with more than 65k rows) and\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;to always specify the worksheet you\u0026apos;re working with (i.e. \u0026lt;code\u0026gt;Dim ws As Worksheet ... ws.Range(...)\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;Range(...)\u0026lt;/code\u0026gt;)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;when using \u0026lt;code\u0026gt;.Value\u0026lt;/code\u0026gt; (which is a \u0026lt;code\u0026gt;Variant\u0026lt;/code\u0026gt;) avoid implicit casts like \u0026lt;code\u0026gt;.Value \u0026amp;lt;\u0026amp;gt; \u0026quot;\u0026quot;\u0026lt;/code\u0026gt; as they will fail if the cell contains an error value.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I would add to the answer given by Siddarth Rout to say that the CountA call can be skipped by having Find return a Range object, instead of a row number, and then test the returned Range object to see if it is Nothing (blank worksheet). \u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Also, I would have my version of any LastRow procedure return a zero for a blank worksheet, then I can know it is blank.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I wonder that nobody has mentioned this, But the easiest way of getting the last used cell is:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; GetLastCell(sh \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; Worksheet) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n    GetLastCell = sh.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).SpecialCells(xlLastCell)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;This essentially returns the same cell that you get by \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt; after selecting Cell \u0026lt;strong\u0026gt;\u0026lt;code\u0026gt;A1\u0026lt;/code\u0026gt;\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;A word of caution: Excel keeps track of the most bottom-right cell that was ever used in a worksheet. So if for example you enter something in \u0026lt;strong\u0026gt;B3\u0026lt;/strong\u0026gt; and something else in \u0026lt;strong\u0026gt;H8\u0026lt;/strong\u0026gt; and then later on delete the contents of \u0026lt;strong\u0026gt;H8\u0026lt;/strong\u0026gt;, pressing \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt; will still take you to \u0026lt;strong\u0026gt;H8\u0026lt;/strong\u0026gt; cell. The above function will have the same behavior.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h1\u0026gt;Updated at End of 2021\u0026lt;/h1\u0026gt;\n\u0026lt;p\u0026gt;With Excel\u0026apos;s new \u0026lt;a href=\u0026quot;https://support.microsoft.com/en-us/office/tips-for-improving-excel-s-performance-a8294ac5-652d-47f2-8e89-1c3ce2c09439\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;calculation engine and array functionality\u0026lt;/a\u0026gt;, and \u0026lt;a href=\u0026quot;https://support.microsoft.com/en-us/office/filter-function-f4f7cb66-82eb-4767-8f7c-4877ad80c759\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Filter Function\u0026lt;/a\u0026gt;, I believe this topic should now be far less contested and that the below options offer the best mix of speed, reliability, and simplicity (which has proven difficult to balance in the past as the numerous posts here illustrate).\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Also, I\u0026apos;m defining \u0026lt;code\u0026gt;last used\u0026lt;/code\u0026gt; as \u0026lt;em\u0026gt;NOT blank\u0026lt;/em\u0026gt; as defined by the \u0026lt;a href=\u0026quot;https://support.microsoft.com/en-us/office/is-functions-0f2d7971-6019-40a0-a171-f2d869135665\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;isBlank\u0026lt;/a\u0026gt; function.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;Excel Formula\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;First, note that the Filter Function makes it much simpler to get a last cell using the below formulas for a specific row or column (in these case \u0026lt;code\u0026gt;Column A\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Row 1\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;=MAX(FILTER(ROW(A:A),\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt;(ISBLANK(A:A))))\n=MAX(FILTER(COLUMN(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;NOT\u0026lt;/span\u0026gt;(ISBLANK(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;:\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))))\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;VBA Function For Last Row Specific Range\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Using the above function we can convert it into a VBA function, yet make it even faster by limiting the range, while expanding its capabilities by doing multiple columns (thanks to \u0026lt;a href=\u0026quot;https://stackoverflow.com/users/445425/chris-neilsen\u0026quot;\u0026gt;Chris Neilsen\u0026lt;/a\u0026gt; for immediate feedback tweeking/suggestions). I also found massive speed improvement by scoping each column to only be a range with a row HIGHER than the previous last row.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; FindLastRowInRange(someColumns \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Const\u0026lt;/span\u0026gt; zFx = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;=MAX(FILTER(ROW(????),NOT(ISBLANK(????)),0))\u0026quot;\u0026lt;/span\u0026gt;\n   \n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; tRng \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range, i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;, tRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;, pRng \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt; someColumns.Worksheet\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; tRng = Intersect(someColumns.EntireColumn, .UsedRange)\n      \n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;For\u0026lt;/span\u0026gt; i = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;To\u0026lt;/span\u0026gt; tRng.Columns.Count\n         \n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; pRng = Intersect(tRng.Columns(i), _\n         Range(.Rows(FindLastRowInRange + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;), .Rows(.Rows.Count)))\n         \n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Not\u0026lt;/span\u0026gt; pRng \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            tRow = .Evaluate(Replace(zFx, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;????\u0026quot;\u0026lt;/span\u0026gt;, _\n               pRng.Address, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;))\n         \n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; tRow \u0026amp;gt; FindLastRowInRange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt; _\n               FindLastRowInRange = tRow\n            \n         \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Next\u0026lt;/span\u0026gt; i\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;With\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;VBA Function For Last Row In Worksheet\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;To consider the entire worksheet (all columns), I would recommend using a different VBA formula that references the prior one, but is a \u0026lt;a href=\u0026quot;https://docs.microsoft.com/en-us/office/vba/api/excel.application.volatile\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Volatile Function\u0026lt;/a\u0026gt;. This ensures that the formula updates with \u0026lt;em\u0026gt;any\u0026lt;/em\u0026gt; changes to a worksheet. Obviously, one could combine these two formulas, but I prefer to limit the usage of volatile functions.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; FindLastRowInSheet(anywhereInSheet \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n      Application.Volatile\n      FindLastRowInSheet = FindLastRowInRange(anywhereInSheet.Worksheet.UsedRange)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;Advantages Compared To Other Options\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Allows for some or ALL rows/columns in worksheet without changing approach.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;No possibility of missing hidden rows as is a risk with \u0026lt;code\u0026gt;xlup\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Ignores formatted/usedrange issues.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Does not interfere with user\u0026apos;s \u0026lt;code\u0026gt;Find\u0026lt;/code\u0026gt; settings.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Uses worksheet functionality which is faster than VBA calcs.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;No counting cells (performance hog).\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Hopefully this ends the debate, but if anyone finds weaknesses in this please share.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sub\u0026lt;/span\u0026gt; last_filled_cell()\nmsgbox range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A65536\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;(xlup).row\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;Here, \u0026lt;kbd\u0026gt;A65536\u0026lt;/kbd\u0026gt; is the last cell in the Column A this code was tested on excel 2003.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;However this question is seeking to find the last row using VBA, I think it would be good to include an array formula for worksheet function  as this gets visited frequently:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;{=ADDRESS(MATCH(INDEX(D:D,MAX(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IF\u0026lt;/span\u0026gt;(D:D\u0026amp;lt;\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;,ROW(D:D)-ROW(D1)+\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)),\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),D:D,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;),COLUMN(D:D))}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;You need to enter the formula without brackets and then hit \u0026lt;kbd\u0026gt;Shift\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;Ctrl\u0026lt;/kbd\u0026gt; + \u0026lt;kbd\u0026gt;Enter\u0026lt;/kbd\u0026gt; to make it an array formula.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This will give you address of last used cell in the column D.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Thanks to \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba/43857774#comment104400383_43857774\u0026quot;\u0026gt;pgsystemtester\u0026lt;/a\u0026gt;, this will give you the row number of last used cell:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;{=MATCH(INDEX(D:D,MAX(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;IF\u0026lt;/span\u0026gt;(D:D\u0026amp;lt;\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;,ROW(D:D)-ROW(D1)+\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;)),\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;),D:D,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I was looking for a way to mimic the \u0026lt;kbd\u0026gt;CTRL\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;Shift\u0026lt;/kbd\u0026gt;+\u0026lt;kbd\u0026gt;End\u0026lt;/kbd\u0026gt;, so dotNET solution is great, except with my Excel 2010 I need to add a \u0026lt;code\u0026gt;set\u0026lt;/code\u0026gt; if I want to avoid an error:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; GetLastCell(sh \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; GetLastCell = sh.Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).SpecialCells(xlLastCell)\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;and how to check this for yourself:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; test()\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ws \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet, r \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = ActiveWorkbook.Sheets(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Sheet1\u0026quot;\u0026lt;/span\u0026gt;)\n  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; r = GetLastCell(ws)\n  MsgBox r.Column \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;-\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; r.Row\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; lastRow()\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n        i = Cells(Rows.Count, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlUp).Row\n            MsgBox i\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sub\u0026lt;/span\u0026gt; LastRow()\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;Paste \u0026amp;amp; for better understanding of the working use F8 Key to run the code .\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;dim\u0026lt;/span\u0026gt; WS \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; worksheet\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;dim\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;long\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;set\u0026lt;/span\u0026gt; ws = thisworkbook(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SheetName\u0026quot;\u0026lt;/span\u0026gt;)\n\nws.activate\n\nws.range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a1\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n\nws.range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;a1048576\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n\nactivecell.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;end\u0026lt;/span\u0026gt;(xlup).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;select\u0026lt;/span\u0026gt;\n\ni= activecell.row\n\nmsgbox \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;My Last Row Is \u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; i\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For the last 3+ years these are the functions that I am using for finding last row and last column per defined column(for row) and row(for column):\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Last Column:\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; lastCol(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; wsName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; rowToCheck \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ws  \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; wsName = vbNullString \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = ActiveSheet\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = Worksheets(wsName)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n    lastCol = ws.Cells(rowToCheck, ws.Columns.Count).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlToLeft).Column\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;h2\u0026gt;Last Row:\u0026lt;/h2\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; lastRow(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; wsName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; columnToCheck \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ws \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; wsName = vbNullString \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = ActiveSheet\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = Worksheets(wsName)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n    lastRow = ws.Cells(ws.Rows.Count, columnToCheck).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlUp).Row\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;For the case of the OP, this is the way to get the last row in column \u0026lt;code\u0026gt;E\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;Debug.Print lastRow(columnToCheck:=Range(\u0026quot;E4:E48\u0026quot;).Column)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;h2\u0026gt;Last Row, counting empty rows with data:\u0026lt;/h2\u0026gt;\n\n\u0026lt;p\u0026gt;Here we may use the \u0026lt;a href=\u0026quot;https://www.vitoshacademy.com/last-used-row-last-used-column-in-excel-with-formula-without-vba/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;well-known Excel formulas\u0026lt;/a\u0026gt;, which give us the last row of a worksheet in Excel, without involving VBA - \u0026lt;code\u0026gt;=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(A:A))),ROW(A:A)),0)\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;In order to put this in VBA and not to write anything in Excel, using the parameters for the latter functions, something like this could be in mind:\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; LastRowWithHidden(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; wsName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Optional\u0026lt;/span\u0026gt; columnToCheck \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ws \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; wsName = vbNullString \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = ActiveSheet\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; ws = Worksheets(wsName)\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; letters \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    letters = ColLettersGenerator(columnToCheck)\n    LastRowWithHidden = ws.Evaluate(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;=IFERROR(LOOKUP(2,1/(NOT(ISBLANK(\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; letters \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;))),ROW(\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; letters \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot; )),0)\u0026quot;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; ColLettersGenerator(col \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; result \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Variant\n    result = Split(Cells(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, col).Address(\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;), \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;$\u0026quot;\u0026lt;/span\u0026gt;)\n    ColLettersGenerator = result(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;) \u0026amp;amp; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;:\u0026quot;\u0026lt;/span\u0026gt; \u0026amp;amp; result(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;h2 id=\u0026quot;last-row-in-a-regular-range-or-a-table-listobject\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;Last Row in a regular range or a Table (ListObject)\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Finding the last row requires using different methods if the range is a regular range or table (List Object).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Finding the last row in tables requires specifying additional parameters (table name , the column relative position to the first tables column).\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;I created this universal function for last row, regardless of range type. Just give it any cell reference whatsoever and it will return the last row.\nNo hassle having to knew range characteristics, especially if your ranges are some times a regular range and sometimes a ListObject.\nUsing a regular range method on a table might return wrong results.\nSure you can plan ahead of time and use the right method each time, but why bother if you can utilizes a universal function ?\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt; RunMyLastRow()\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; Result \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\nResult = MyLastRow(Worksheets(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;A1\u0026quot;\u0026lt;/span\u0026gt;))\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Sub\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; MyLastRow(RefrenceRange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; WS \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Worksheet\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; TableName \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ColNumber \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; LastRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; FirstColumnTable \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; ColNumberTable \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Set\u0026lt;/span\u0026gt; WS = RefrenceRange.Worksheet\n    TableName = GetTableName(RefrenceRange)\n    ColNumber = RefrenceRange.Column\n    \n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;\u0026apos;If the table (ListObject) does not start in column \u0026quot;A\u0026quot; we need to calculate the \u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;\u0026apos;first Column table and how many Columns from its beginning the Column is located.\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; TableName \u0026amp;lt;\u0026amp;gt; vbNullString \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n     FirstColumnTable = WS.ListObjects(TableName).ListColumns(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;).Range.Column\n     ColNumberTable = ColNumber - FirstColumnTable + \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; \n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; TableName = vbNullString \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n    LastRow = WS.Cells(WS.Rows.Count, ColNumber).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlUp).Row\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n    LastRow = WS.ListObjects(TableName).ListColumns(ColNumberTable).Range.Find( _\n               What:=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;*\u0026quot;\u0026lt;/span\u0026gt;, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    MyLastRow = LastRow\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n    \n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;\u0026apos;\u0026apos;Get Table Name by Cell Range\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt; GetTableName(RefrenceRange \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; Range) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt; RefrenceRange.ListObject \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;Nothing\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Then\u0026lt;/span\u0026gt;\n            GetTableName = vbNullString\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Else\u0026lt;/span\u0026gt;\n            GetTableName = RefrenceRange.ListObject.Name\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;If\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Function\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    "],"id":95,"title":"Error in finding last used cell in Excel with VBA","content":"\n                \n\u0026lt;p\u0026gt;When I want to find the last used cell value, I use:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-vb s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-vbnet\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;Dim\u0026lt;/span\u0026gt; LastRow \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;As\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Long\u0026lt;/span\u0026gt;\n\nLastRow = Range(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;E4:E48\u0026quot;\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;End\u0026lt;/span\u0026gt;(xlDown).Row\n\nDebug.Print LastRow\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I\u0026apos;m getting the wrong output when I put a single element into a cell. But when I put more than one value into the cell, the output is correct.\nWhat\u0026apos;s the reason behind this?\u0026lt;/p\u0026gt;\n    ","slug":"error-in-finding-last-used-cell-in-excel-with-vba-1657384584748","postType":"QUESTION","createdAt":"2022-07-09T16:36:24.000Z","updatedAt":"2022-07-09T16:36:24.000Z","tags":[{"id":350,"name":"excel-formula","slug":"excel-formula","createdAt":"2022-07-09T16:36:24.000Z","updatedAt":"2022-07-09T16:36:24.000Z","Questions_Tags":{"questionId":95,"tagId":350}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"error-in-finding-last-used-cell-in-excel-with-vba-1657384584748"},"buildId":"d4czOeg3MGPNUI9SipfjN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>