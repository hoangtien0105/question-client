<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/2eccd4d47c856f2b.css" as="style"/><link rel="stylesheet" href="/_next/static/css/2eccd4d47c856f2b.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-301f760ac8107464.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/8pZkyd0U8-Y2Qf3QK9j7l/_buildManifest.js" defer=""></script><script src="/_next/static/8pZkyd0U8-Y2Qf3QK9j7l/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="https://flowbite.com/docs/images/logo.svg" class="mr-3 h-6 sm:h-9" alt="Flowbite Logo"/><span class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Hunter</span></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259">Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/filtering">filtering</a></div></div><div class="question-content mt-5">
                
<p>I want to filter my dataframe with an <code>or</code> condition to keep rows with a particular column's values that are outside the range <code>[-0.25, 0.25]</code>. I tried:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) <span class="hljs-keyword">or</span> (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]
</code></pre>
<p>But I get the error:</p>
<blockquote>
<p>Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</p>
</blockquote>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The <code>or</code> and <code>and</code> python statements require <code>truth</code>-values. For <code>pandas</code>, these are considered ambiguous so you should use "bitwise" <code>|</code> (or) or <code>&amp;</code> (and) operations:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]
</code></pre>
<p>These are overloaded for these kinds of data structures to yield the element-wise <code>or</code> or <code>and</code>.</p>
<hr>
<p>Just to add some more explanation to this statement:</p>
<p>The exception is thrown when you want to get the <code>bool</code> of a <code>pandas.Series</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
<span class="hljs-meta">&gt;&gt;&gt; </span>x = pd.Series([<span class="hljs-number">1</span>])
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-built_in">bool</span>(x)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
</code></pre>
<p>What you hit was a place where the operator <strong>implicitly</strong> converted the operands to <code>bool</code> (you used <code>or</code> but it also happens for <code>and</code>, <code>if</code> and <code>while</code>):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>x <span class="hljs-keyword">or</span> x
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span>x <span class="hljs-keyword">and</span> x
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">if</span> x:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'fun'</span>)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
<span class="hljs-meta">&gt;&gt;&gt; </span><span class="hljs-keyword">while</span> x:
<span class="hljs-meta">... </span>    <span class="hljs-built_in">print</span>(<span class="hljs-string">'fun'</span>)
ValueError: The truth value of a Series <span class="hljs-keyword">is</span> ambiguous. Use a.empty, a.<span class="hljs-built_in">bool</span>(), a.item(), a.<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> a.<span class="hljs-built_in">all</span>().
</code></pre>
<p>Besides these 4 statements there are several python functions that hide some <code>bool</code> calls (like <code>any</code>, <code>all</code>, <code>filter</code>, ...) these are normally not problematic with <code>pandas.Series</code> but for completeness I wanted to mention these.</p>
<hr>
<p>In your case, the exception isn't really helpful, because it doesn't mention the <strong>right alternatives</strong>. For <code>and</code> and <code>or</code>, if you want element-wise comparisons, you can use:</p>
<ul>
<li><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_or.html" rel="noreferrer"><code>numpy.logical_or</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; <span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
  &gt;&gt;&gt; np.logical_or(x, y)
</code></pre>
<p>or simply the <code>|</code> operator:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x | y
</code></pre>
</li>
<li><p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_and.html" rel="noreferrer"><code>numpy.logical_and</code></a>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; np.logical_and(x, y)
</code></pre>
<p>or simply the <code>&amp;</code> operator:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x &amp; y
</code></pre>
</li>
</ul>
<p>If you're using the operators, then be sure to set your parentheses correctly because of <a href="https://docs.python.org/reference/expressions.html#operator-precedence" rel="noreferrer">operator precedence</a>.</p>
<p>There are <a href="https://docs.scipy.org/doc/numpy/reference/routines.logic.html" rel="noreferrer">several logical numpy functions</a> which <em>should</em> work on <code>pandas.Series</code>.</p>
<hr>
<p>The alternatives mentioned in the Exception are more suited if you encountered it when doing <code>if</code> or <code>while</code>. I'll shortly explain each of these:</p>
<ul>
<li><p>If you want to check if your Series is <strong>empty</strong>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([])
  &gt;&gt;&gt; x.empty
  <span class="hljs-literal">True</span>
  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">1</span>])
  &gt;&gt;&gt; x.empty
  <span class="hljs-literal">False</span>
</code></pre>
<p>Python normally interprets the <code>len</code>gth of containers (like <code>list</code>, <code>tuple</code>, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: <code>if x.size</code> or <code>if not x.empty</code> instead of <code>if x</code>.</p>
</li>
<li><p>If your <code>Series</code> contains <strong>one and only one</strong> boolean value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">100</span>])
  &gt;&gt;&gt; (x &gt; <span class="hljs-number">50</span>).<span class="hljs-built_in">bool</span>()
  <span class="hljs-literal">True</span>
  &gt;&gt;&gt; (x &lt; <span class="hljs-number">50</span>).<span class="hljs-built_in">bool</span>()
  <span class="hljs-literal">False</span>
</code></pre>
</li>
<li><p>If you want to check the <strong>first and only item</strong> of your Series (like <code>.bool()</code> but works even for not boolean contents):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">100</span>])
  &gt;&gt;&gt; x.item()
  <span class="hljs-number">100</span>
</code></pre>
</li>
<li><p>If you want to check if <strong>all</strong> or <strong>any</strong> item is not-zero, not-empty or not-False:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">  &gt;&gt;&gt; x = pd.Series([<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>])
  &gt;&gt;&gt; x.<span class="hljs-built_in">all</span>()   <span class="hljs-comment"># because one element is zero</span>
  <span class="hljs-literal">False</span>
  &gt;&gt;&gt; x.<span class="hljs-built_in">any</span>()   <span class="hljs-comment"># because one (or more) elements are non-zero</span>
  <span class="hljs-literal">True</span>
</code></pre>
</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Well pandas use bitwise <code>&amp;</code> <code>|</code> and each condition should be wrapped in a <code>()</code></p>
<p>For example following works</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">data_query = data[(data[<span class="hljs-string">'year'</span>] &gt;= <span class="hljs-number">2005</span>) &amp; (data[<span class="hljs-string">'year'</span>] &lt;= <span class="hljs-number">2010</span>)]
</code></pre>
<p>But the same query without proper brackets does not</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">data_query = data[(data[<span class="hljs-string">'year'</span>] &gt;= <span class="hljs-number">2005</span> &amp; data[<span class="hljs-string">'year'</span>] &lt;= <span class="hljs-number">2010</span>)]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For boolean logic, use <code>&amp;</code> and <code>|</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">np.random.seed(<span class="hljs-number">0</span>)
df = pd.DataFrame(np.random.randn(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABC'</span>))

<span class="hljs-meta">&gt;&gt;&gt; </span>df
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">2</span>  <span class="hljs-number">0.950088</span> -<span class="hljs-number">0.151357</span> -<span class="hljs-number">0.103219</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>

<span class="hljs-meta">&gt;&gt;&gt; </span>df.loc[(df.C &gt; <span class="hljs-number">0.25</span>) | (df.C &lt; -<span class="hljs-number">0.25</span>)]
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>
</code></pre>
<p>To see what is happening, you get a column of booleans for each comparison, e.g.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df.C &gt; <span class="hljs-number">0.25</span>
<span class="hljs-number">0</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">1</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">2</span>    <span class="hljs-literal">False</span>
<span class="hljs-number">3</span>     <span class="hljs-literal">True</span>
<span class="hljs-number">4</span>     <span class="hljs-literal">True</span>
Name: C, dtype: <span class="hljs-built_in">bool</span>
</code></pre>
<p>When you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using <code>and</code> or <code>or</code> treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Any value in either column is True?</span>
(df.C &gt; <span class="hljs-number">0.25</span>).<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> (df.C &lt; -<span class="hljs-number">0.25</span>).<span class="hljs-built_in">any</span>()
<span class="hljs-literal">True</span>

<span class="hljs-comment"># All values in either column is True?</span>
(df.C &gt; <span class="hljs-number">0.25</span>).<span class="hljs-built_in">all</span>() <span class="hljs-keyword">or</span> (df.C &lt; -<span class="hljs-number">0.25</span>).<span class="hljs-built_in">all</span>()
<span class="hljs-literal">False</span>
</code></pre>
<p>One convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-meta">&gt;&gt;&gt; </span>df[[<span class="hljs-built_in">any</span>([a, b]) <span class="hljs-keyword">for</span> a, b <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(df.C &gt; <span class="hljs-number">0.25</span>, df.C &lt; -<span class="hljs-number">0.25</span>)]]
          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.443863</span>
</code></pre>
<p>For more details, refer to <a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing" rel="noreferrer">Boolean Indexing</a> in the docs.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Or, alternatively, you could use Operator module. More detailed information is here <a href="https://docs.python.org/2/library/operator.html" rel="noreferrer">Python docs</a></p>

<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> operator
<span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd
np.random.seed(<span class="hljs-number">0</span>)
df = pd.DataFrame(np.random.randn(<span class="hljs-number">5</span>,<span class="hljs-number">3</span>), columns=<span class="hljs-built_in">list</span>(<span class="hljs-string">'ABC'</span>))
df.loc[operator.or_(df.C &gt; <span class="hljs-number">0.25</span>, df.C &lt; -<span class="hljs-number">0.25</span>)]

          A         B         C
<span class="hljs-number">0</span>  <span class="hljs-number">1.764052</span>  <span class="hljs-number">0.400157</span>  <span class="hljs-number">0.978738</span>
<span class="hljs-number">1</span>  <span class="hljs-number">2.240893</span>  <span class="hljs-number">1.867558</span> -<span class="hljs-number">0.977278</span>
<span class="hljs-number">3</span>  <span class="hljs-number">0.410599</span>  <span class="hljs-number">0.144044</span>  <span class="hljs-number">1.454274</span>
<span class="hljs-number">4</span>  <span class="hljs-number">0.761038</span>  <span class="hljs-number">0.121675</span>  <span class="hljs-number">0.4438</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><a href="https://stackoverflow.com/a/36922103/1878788">This excellent answer</a> explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>query</code></a> method:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df.query(<span class="hljs-string">"(col &gt; 0.25) or (col &lt; -0.25)"</span>)
</code></pre>
<p>See also <a href="http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query" rel="nofollow noreferrer">http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query</a>.</p>
<p>(Some tests with a dataframe I'm currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 µs)</p>
<p><strong>A piece of warning</strong>: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named <code>WT_38hph_IP_2</code>, <code>WT_38hph_input_2</code> and <code>log2(WT_38hph_IP_2/WT_38hph_input_2)</code> and wanted to perform the following query: <code>"(log2(WT_38hph_IP_2/WT_38hph_input_2) &gt; 1) and (WT_38hph_IP_2 &gt; 20)"</code></p>
<p>I obtained the following exception cascade:</p>
<ul>
<li><code>KeyError: 'log2'</code></li>
<li><code>UndefinedVariableError: name 'log2' is not defined</code></li>
<li><code>ValueError: "log2" is not a supported function</code></li>
</ul>
<p>I guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.</p>
<p>A possible workaround is proposed <a href="https://stackoverflow.com/a/40083013/1878788">here</a>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:</p>
<p><strong>Condition 1: Python Operator Precedence</strong></p>
<p>There is a paragraph of <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing" rel="nofollow noreferrer">Boolean indexing | Indexing and selecting data  pandas documentation</a> explains this</p>
<blockquote>
<p>Another common operation is the use of boolean vectors to filter the data. The operators are: <code>|</code> for <code>or</code>, <code>&amp;</code> for <code>and</code>, and <code>~</code> for <code>not</code>. These <strong>must</strong> be grouped by using <strong>parentheses</strong>.</p>
<p>By default Python will evaluate an expression such as <code>df['A'] &gt; 2 &amp; df['B'] &lt; 3</code> as <code>df['A'] &gt; (2 &amp; df['B']) &lt; 3</code>, while the desired evaluation order is <code>(df['A'] &gt; 2) &amp; (df['B'] &lt; 3)</code>.</p>
</blockquote>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span> | df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>

<span class="hljs-comment"># Right</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)
</code></pre>
<p>There are some possible ways to get rid off the parentheses, I will cover this later.</p>
<hr>
<p><strong>Condition 2: Improper Operator/Statement</strong></p>
<p>As is explained in previous quotation, you need use <code>|</code> for <code>or</code>, <code>&amp;</code> for <code>and</code>, and <code>~</code> for <code>not</code></p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) <span class="hljs-keyword">or</span> (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)

<span class="hljs-comment"># Right</span>
(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)
</code></pre>
<hr>
<p>Another possible situation is that you are using a boolean Series in <code>if</code> statement.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Wrong</span>
<span class="hljs-keyword">if</span> pd.Series([<span class="hljs-literal">True</span>, <span class="hljs-literal">False</span>]):
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>It's clear that Python <code>if</code> statement accepts boolean like expression rather than Pandas Series. You should use <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html" rel="nofollow noreferrer"><code>pandas.Series.any</code></a> or methods listed in the error message to convert the Series to a value according to your need.</p>
<p>For example:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-comment"># Right</span>
<span class="hljs-keyword">if</span> df[<span class="hljs-string">'col'</span>].eq(<span class="hljs-number">0</span>).<span class="hljs-built_in">all</span>():
    <span class="hljs-comment"># If you want all column values equal to zero</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'do something'</span>)

<span class="hljs-comment"># Right</span>
<span class="hljs-keyword">if</span> df[<span class="hljs-string">'col'</span>].eq(<span class="hljs-number">0</span>).<span class="hljs-built_in">any</span>():
    <span class="hljs-comment"># If you want at least one column value equal to zero</span>
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'do something'</span>)
</code></pre>
<hr>
<p>Let's talk about ways to escape the parentheses in the first situation.</p>
<ol>
<li><strong>Use Pandas mathematical functions</strong></li>
</ol>
<p>Pandas has defined a lot of mathematical functions including comparison as follows:</p>
<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.lt.html" rel="nofollow noreferrer"><code>pandas.Series.lt()</code></a> for <em>less than</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.gt.html" rel="nofollow noreferrer"><code>pandas.Series.gt()</code></a> for <em>greater than</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.le.html" rel="nofollow noreferrer"><code>pandas.Series.le()</code></a> for <em>less and equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.ge.html" rel="nofollow noreferrer"><code>pandas.Series.ge()</code></a> for <em>greater and equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.ne.html" rel="nofollow noreferrer"><code>pandas.Series.ne()</code></a> for <em>not equal</em>;</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.eq.html" rel="nofollow noreferrer"><code>pandas.Series.eq()</code></a> for <em>equal</em>;</li>
</ul>
<p>As a result, you can use</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df[<span class="hljs-string">'col'</span>].lt(-<span class="hljs-number">0.25</span>) | df[<span class="hljs-string">'col'</span>].gt(<span class="hljs-number">0.25</span>)]
</code></pre>
<ol start="2">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html" rel="nofollow noreferrer"><code>pandas.Series.between()</code></a></strong></li>
</ol>
<p>If you want to select rows in between two values, you can use <code>pandas.Series.between</code></p>
<ul>
<li><code>df['col].between(left, right)</code> is equal to <br>
<code>(left &lt;= df['col']) &amp; (df['col'] &lt;= right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='left)</code> is equal to <br>
<code>(left &lt;= df['col']) &amp; (df['col'] &lt; right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='right')</code> is equal to <br>
<code>(left &lt; df['col']) &amp; (df['col'] &lt;= right)</code>;</li>
<li><code>df['col].between(left, right, inclusive='neither')</code> is equal to <br>
<code>(left &lt; df['col']) &amp; (df['col'] &lt; right)</code>;</li>
</ul>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &gt; -<span class="hljs-number">0.25</span>) &amp; (df[<span class="hljs-string">'col'</span>] &lt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df[<span class="hljs-string">'col'</span>].between(-<span class="hljs-number">0.25</span>, <span class="hljs-number">0.25</span>, inclusive=<span class="hljs-string">'neither'</span>)]
</code></pre>
<ol start="3">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html" rel="nofollow noreferrer"><code>pandas.DataFrame.query()</code></a></strong></li>
</ol>
<p>Document referenced before has a chapter <a href="https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method" rel="nofollow noreferrer">The <code>query()</code> Method</a> explains this well.</p>
<p><code>pandas.DataFrame.query()</code> can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(<code>&amp;</code> and <code>|</code>) and their boolean cousins(<code>and</code> and <code>or</code>). Moreover, you can omit the parentheses, but I don't recommend for readable reason.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df.query(<span class="hljs-string">'col &lt; -0.25 or col &gt; 0.25'</span>)
</code></pre>
<ol start="4">
<li><strong>Use <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html" rel="nofollow noreferrer"><code>pandas.DataFrame.eval()</code></a></strong></li>
</ol>
<p><code>pandas.DataFrame.eval()</code> evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with <code>pandas.DataFrame.query()</code>.</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df = df[(df[<span class="hljs-string">'col'</span>] &lt; -<span class="hljs-number">0.25</span>) | (df[<span class="hljs-string">'col'</span>] &gt; <span class="hljs-number">0.25</span>)]

<span class="hljs-comment"># is equal to</span>

df = df[df.<span class="hljs-built_in">eval</span>(<span class="hljs-string">'col &lt; -0.25 or col &gt; 0.25'</span>)]
</code></pre>
<p><code>pandas.DataFrame.query()</code> and <code>pandas.DataFrame.eval()</code> can do more things than I describe here, you are recommended to read their documentation and have fun with them.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you have more than one value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'col'</span>].<span class="hljs-built_in">all</span>()
</code></pre>
<p>If its only a single value:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[<span class="hljs-string">'col'</span>].item()
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I was getting error in this command:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">if</span> df != <span class="hljs-string">''</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
<p>But it worked when I changed it to this:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">if</span> df <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-string">''</span>:
    <span class="hljs-keyword">pass</span>
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You need to use bitwise operators <code>|</code> instead of <code>or</code> and <code>&amp;</code> instead of <code>and</code> in pandas, you can't simply use the bool statements from python.<br>
<br>
For much complex filtering create a <code>mask</code> and apply the mask on the dataframe.<br>
Put all your query in the mask and apply it.<br>
Suppose,</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">mask = (df[<span class="hljs-string">"col1"</span>]&gt;=df[<span class="hljs-string">"col2"</span>]) &amp; (stock[<span class="hljs-string">"col1"</span>]&lt;=df[<span class="hljs-string">"col2"</span>])
df_new = df[mask]
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I'll try to give the benchmark of the three most common way (also mentioned above):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> repeat

setup = <span class="hljs-string">"""
import numpy as np;
import random;
x = np.linspace(0,100);
lb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()
"""</span>
stmts = <span class="hljs-string">'x[(x &gt; lb) * (x &lt;= ub)]'</span>, <span class="hljs-string">'x[(x &gt; lb) &amp; (x &lt;= ub)]'</span>, <span class="hljs-string">'x[np.logical_and(x &gt; lb, x &lt;= ub)]'</span>

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-keyword">for</span> stmt <span class="hljs-keyword">in</span> stmts:
        t = <span class="hljs-built_in">min</span>(repeat(stmt, setup, number=<span class="hljs-number">100_000</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'%.4f'</span> % t, stmt)
    <span class="hljs-built_in">print</span>()
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0.4808</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4726</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.4904</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.4725</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4806</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.5002</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.4781</span> x[(x &gt; lb) * (x &lt;= ub)]
<span class="hljs-number">0.4336</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.4974</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]
</code></pre>
<p>But, <code>*</code> is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">from</span> timeit <span class="hljs-keyword">import</span> repeat

setup = <span class="hljs-string">"""
import numpy as np;
import random;
import pandas as pd;
x = pd.DataFrame(np.linspace(0,100));
lb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()
"""</span>
stmts = <span class="hljs-string">'x[(x &gt; lb) &amp; (x &lt;= ub)]'</span>, <span class="hljs-string">'x[np.logical_and(x &gt; lb, x &lt;= ub)]'</span>

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    <span class="hljs-keyword">for</span> stmt <span class="hljs-keyword">in</span> stmts:
        t = <span class="hljs-built_in">min</span>(repeat(stmt, setup, number=<span class="hljs-number">100</span>))
        <span class="hljs-built_in">print</span>(<span class="hljs-string">'%.4f'</span> % t, stmt)
    <span class="hljs-built_in">print</span>()
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">0.1964</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1992</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.2018</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1838</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-number">0.1871</span> x[(x &gt; lb) &amp; (x &lt;= ub)]
<span class="hljs-number">0.1883</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]
</code></pre>
<p>Note: adding one line of code <code>x = x.to_numpy()</code> will need about 20 µs.</p>
<p>For those who prefer <code>%timeit</code>:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
<span class="hljs-keyword">import</span> random
lb, ub = np.sort([random.random() * <span class="hljs-number">100</span>, random.random() * <span class="hljs-number">100</span>]).tolist()
lb, ub
x = pd.DataFrame(np.linspace(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>))

<span class="hljs-keyword">def</span> <span class="hljs-title function_">asterik</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[(x &gt; lb) * (x &lt;= ub)]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">and_symbol</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[(x &gt; lb) &amp; (x &lt;= ub)]

<span class="hljs-keyword">def</span> <span class="hljs-title function_">numpy_logical</span>(<span class="hljs-params">x</span>):
    x = x.to_numpy()
    <span class="hljs-keyword">return</span> x[np.logical_and(x &gt; lb, x &lt;= ub)]

<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">3</span>):
    %timeit asterik(x)
    %timeit and_symbol(x)
    %timeit numpy_logical(x)
    <span class="hljs-built_in">print</span>(<span class="hljs-string">'\n'</span>)
</code></pre>
<p>result:</p>
<pre class="lang-py s-code-block"><code class="hljs language-python"><span class="hljs-number">23</span> µs ± <span class="hljs-number">3.62</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
<span class="hljs-number">35.6</span> µs ± <span class="hljs-number">9.53</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">31.3</span> µs ± <span class="hljs-number">8.9</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)


<span class="hljs-number">21.4</span> µs ± <span class="hljs-number">3.35</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
<span class="hljs-number">21.9</span> µs ± <span class="hljs-number">1.02</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">21.7</span> µs ± <span class="hljs-number">500</span> ns per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)


<span class="hljs-number">25.1</span> µs ± <span class="hljs-number">3.71</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">36.8</span> µs ± <span class="hljs-number">18.3</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">100000</span> loops each)
<span class="hljs-number">28.2</span> µs ± <span class="hljs-number">5.97</span> µs per loop (mean ± std. dev. of <span class="hljs-number">7</span> runs, <span class="hljs-number">10000</span> loops each)
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I encountered the same error and got stalled with a pyspark dataframe for few days, <strong><em>I was able to resolve it successfully by filling na values with 0</em></strong> since I was comparing integer values from 2 fields.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>One minor thing, which wasted my time.</p>
<p>Put the conditions(if comparing using " = ", " != ") in parenthesis, failing to do so also raises this exception.
This will work</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[(some condition) conditional operator (some conditions)]
</code></pre>
<p>This will not</p>
<pre class="lang-py s-code-block"><code class="hljs language-python">df[some condition conditional-operator some condition]
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;The \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; python statements require \u0026lt;code\u0026gt;truth\u0026lt;/code\u0026gt;-values. For \u0026lt;code\u0026gt;pandas\u0026lt;/code\u0026gt;, these are considered ambiguous so you should use \u0026quot;bitwise\u0026quot; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; (or) or \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; (and) operations:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;These are overloaded for these kinds of data structures to yield the element-wise \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Just to add some more explanation to this statement:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The exception is thrown when you want to get the \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; of a \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(x)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;What you hit was a place where the operator \u0026lt;strong\u0026gt;implicitly\u0026lt;/strong\u0026gt; converted the operands to \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; (you used \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; but it also happens for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;x \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;and\u0026lt;/span\u0026gt; x\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;while\u0026lt;/span\u0026gt; x:\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;... \u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;fun\u0026apos;\u0026lt;/span\u0026gt;)\nValueError: The truth value of a Series \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; ambiguous. Use a.empty, a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;(), a.item(), a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; a.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;().\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Besides these 4 statements there are several python functions that hide some \u0026lt;code\u0026gt;bool\u0026lt;/code\u0026gt; calls (like \u0026lt;code\u0026gt;any\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;all\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;filter\u0026lt;/code\u0026gt;, ...) these are normally not problematic with \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt; but for completeness I wanted to mention these.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;In your case, the exception isn\u0026apos;t really helpful, because it doesn\u0026apos;t mention the \u0026lt;strong\u0026gt;right alternatives\u0026lt;/strong\u0026gt;. For \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, if you want element-wise comparisons, you can use:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_or.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_or\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_or(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x | y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/generated/numpy.logical_and.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;numpy.logical_and\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; np.logical_and(x, y)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;or simply the \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; operator:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x \u0026amp;amp; y\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;If you\u0026apos;re using the operators, then be sure to set your parentheses correctly because of \u0026lt;a href=\u0026quot;https://docs.python.org/reference/expressions.html#operator-precedence\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;operator precedence\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There are \u0026lt;a href=\u0026quot;https://docs.scipy.org/doc/numpy/reference/routines.logic.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;several logical numpy functions\u0026lt;/a\u0026gt; which \u0026lt;em\u0026gt;should\u0026lt;/em\u0026gt; work on \u0026lt;code\u0026gt;pandas.Series\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;The alternatives mentioned in the Exception are more suited if you encountered it when doing \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;while\u0026lt;/code\u0026gt;. I\u0026apos;ll shortly explain each of these:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if your Series is \u0026lt;strong\u0026gt;empty\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.empty\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Python normally interprets the \u0026lt;code\u0026gt;len\u0026lt;/code\u0026gt;gth of containers (like \u0026lt;code\u0026gt;list\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;tuple\u0026lt;/code\u0026gt;, ...) as truth-value if it has no explicit boolean interpretation. So if you want the python-like check, you could do: \u0026lt;code\u0026gt;if x.size\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;if not x.empty\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;if x\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If your \u0026lt;code\u0026gt;Series\u0026lt;/code\u0026gt; contains \u0026lt;strong\u0026gt;one and only one\u0026lt;/strong\u0026gt; boolean value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; (x \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;50\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;()\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check the \u0026lt;strong\u0026gt;first and only item\u0026lt;/strong\u0026gt; of your Series (like \u0026lt;code\u0026gt;.bool()\u0026lt;/code\u0026gt; but works even for not boolean contents):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.item()\n  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you want to check if \u0026lt;strong\u0026gt;all\u0026lt;/strong\u0026gt; or \u0026lt;strong\u0026gt;any\u0026lt;/strong\u0026gt; item is not-zero, not-empty or not-False:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x = pd.Series([\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;])\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one element is zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n  \u0026amp;gt;\u0026amp;gt;\u0026amp;gt; x.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()   \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# because one (or more) elements are non-zero\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Well pandas use bitwise \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; and each condition should be wrapped in a \u0026lt;code\u0026gt;()\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example following works\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt;) \u0026amp;amp; (data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But the same query without proper brackets does not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;data_query = data[(data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2005\u0026lt;/span\u0026gt; \u0026amp;amp; data[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;year\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt;= \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2010\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For boolean logic, use \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;np.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.950088\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.151357\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.103219\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df.loc[(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To see what is happening, you get a column of booleans for each comparison, e.g.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2\u0026lt;/span\u0026gt;    \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;     \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\nName: C, dtype: \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;bool\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;When you have multiple criteria, you will get multiple columns returned.  This is why the join logic is ambiguous.  Using \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; treats each column separately, so you first need to reduce that column to a single boolean value.  For example, to see if any value or all values in each of the columns is True.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Any value in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# All values in either column is True?\u0026lt;/span\u0026gt;\n(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;() \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;One convoluted way to achieve the same thing is to zip all of these columns together, and perform the appropriate logic.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;\u0026amp;gt;\u0026amp;gt;\u0026amp;gt; \u0026lt;/span\u0026gt;df[[\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;([a, b]) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; a, b \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;zip\u0026lt;/span\u0026gt;(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]]\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.443863\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;For more details, refer to \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Boolean Indexing\u0026lt;/a\u0026gt; in the docs.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Or, alternatively, you could use Operator module. More detailed information is here \u0026lt;a href=\u0026quot;https://docs.python.org/2/library/operator.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Python docs\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; operator\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; pandas \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; pd\nnp.random.seed(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;)\ndf = pd.DataFrame(np.random.randn(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;), columns=\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;list\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;ABC\u0026apos;\u0026lt;/span\u0026gt;))\ndf.loc[operator.or_(df.C \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, df.C \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n          A         B         C\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.764052\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.400157\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.978738\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;2.240893\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.867558\u0026lt;/span\u0026gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.977278\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.410599\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.144044\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.454274\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;4\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.761038\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.121675\u0026lt;/span\u0026gt;  \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4438\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;https://stackoverflow.com/a/36922103/1878788\u0026quot;\u0026gt;This excellent answer\u0026lt;/a\u0026gt; explains very well what is happening and provides a solution. I would like to add another solution that might be suitable in similar cases: using the \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;query\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; method:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;(col \u0026amp;gt; 0.25) or (col \u0026amp;lt; -0.25)\u0026quot;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;See also \u0026lt;a href=\u0026quot;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;http://pandas.pydata.org/pandas-docs/stable/indexing.html#indexing-query\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;(Some tests with a dataframe I\u0026apos;m currently working with suggest that this method is a bit slower than using the bitwise operators on series of booleans: 2 ms vs. 870 µs)\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;A piece of warning\u0026lt;/strong\u0026gt;: At least one situation where this is not straightforward is when column names happen to be python expressions. I had columns named \u0026lt;code\u0026gt;WT_38hph_IP_2\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;WT_38hph_input_2\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;log2(WT_38hph_IP_2/WT_38hph_input_2)\u0026lt;/code\u0026gt; and wanted to perform the following query: \u0026lt;code\u0026gt;\u0026quot;(log2(WT_38hph_IP_2/WT_38hph_input_2) \u0026amp;gt; 1) and (WT_38hph_IP_2 \u0026amp;gt; 20)\u0026quot;\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I obtained the following exception cascade:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;KeyError: \u0026apos;log2\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;UndefinedVariableError: name \u0026apos;log2\u0026apos; is not defined\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;ValueError: \u0026quot;log2\u0026quot; is not a supported function\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;I guess this happened because the query parser was trying to make something from the first two columns instead of identifying the expression with the name of the third column.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A possible workaround is proposed \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40083013/1878788\u0026quot;\u0026gt;here\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;This is quite a common question for beginners when making multiple conditions in Pandas. Generally speaking, there are two possible conditions causing this error:\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 1: Python Operator Precedence\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;There is a paragraph of \u0026lt;a href=\u0026quot;https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#boolean-indexing\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Boolean indexing | Indexing and selecting data  pandas documentation\u0026lt;/a\u0026gt; explains this\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Another common operation is the use of boolean vectors to filter the data. The operators are: \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;. These \u0026lt;strong\u0026gt;must\u0026lt;/strong\u0026gt; be grouped by using \u0026lt;strong\u0026gt;parentheses\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By default Python will evaluate an expression such as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2 \u0026amp;amp; df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3\u0026lt;/code\u0026gt; as \u0026lt;code\u0026gt;df[\u0026apos;A\u0026apos;] \u0026amp;gt; (2 \u0026amp;amp; df[\u0026apos;B\u0026apos;]) \u0026amp;lt; 3\u0026lt;/code\u0026gt;, while the desired evaluation order is \u0026lt;code\u0026gt;(df[\u0026apos;A\u0026apos;] \u0026amp;gt; 2) \u0026amp;amp; (df[\u0026apos;B\u0026apos;] \u0026amp;lt; 3)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\ndf[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt; | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;There are some possible ways to get rid off the parentheses, I will cover this later.\u0026lt;/p\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Condition 2: Improper Operator/Statement\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As is explained in previous quotation, you need use \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;, \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt;, and \u0026lt;code\u0026gt;~\u0026lt;/code\u0026gt; for \u0026lt;code\u0026gt;not\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Another possible situation is that you are using a boolean Series in \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Wrong\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; pd.Series([\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;True\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;False\u0026lt;/span\u0026gt;]):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;It\u0026apos;s clear that Python \u0026lt;code\u0026gt;if\u0026lt;/code\u0026gt; statement accepts boolean like expression rather than Pandas Series. You should use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.any.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.any\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; or methods listed in the error message to convert the Series to a value according to your need.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want all column values equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# Right\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].eq(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;any\u0026lt;/span\u0026gt;():\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# If you want at least one column value equal to zero\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;do something\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;Let\u0026apos;s talk about ways to escape the parentheses in the first situation.\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use Pandas mathematical functions\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Pandas has defined a lot of mathematical functions including comparison as follows:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.lt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.lt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.gt.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.gt()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater than\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.le.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.le()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;less and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ge.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ge()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;greater and equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.ne.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.ne()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;not equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.eq.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.eq()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; for \u0026lt;em\u0026gt;equal\u0026lt;/em\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;As a result, you can use\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].lt(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].gt(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.Series.between.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.Series.between()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;If you want to select rows in between two values, you can use \u0026lt;code\u0026gt;pandas.Series.between\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;left)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt;= df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;right\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt;= right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;df[\u0026apos;col].between(left, right, inclusive=\u0026apos;neither\u0026apos;)\u0026lt;/code\u0026gt; is equal to \u0026lt;br\u0026gt;\n\u0026lt;code\u0026gt;(left \u0026amp;lt; df[\u0026apos;col\u0026apos;]) \u0026amp;amp; (df[\u0026apos;col\u0026apos;] \u0026amp;lt; right)\u0026lt;/code\u0026gt;;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026amp;amp; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].between(-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;, inclusive=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;neither\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.query.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;Document referenced before has a chapter \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/user_guide/indexing.html#the-query-method\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;The \u0026lt;code\u0026gt;query()\u0026lt;/code\u0026gt; Method\u0026lt;/a\u0026gt; explains this well.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; can help you select a DataFrame with a condition string. Within the query string, you can use both bitwise operators(\u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt;) and their boolean cousins(\u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt;). Moreover, you can omit the parentheses, but I don\u0026apos;t recommend for readable reason.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df.query(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;ol start=\u0026quot;4\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;strong\u0026gt;Use \u0026lt;a href=\u0026quot;https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.eval.html\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;\u0026lt;/strong\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; evaluates a string describing operations on DataFrame columns. Thus, we can use this method to build our multiple condition. The syntax is same with \u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) | (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;# is equal to\u0026lt;/span\u0026gt;\n\ndf = df[df.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;eval\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col \u0026amp;lt; -0.25 or col \u0026amp;gt; 0.25\u0026apos;\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;pandas.DataFrame.query()\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;pandas.DataFrame.eval()\u0026lt;/code\u0026gt; can do more things than I describe here, you are recommended to read their documentation and have fun with them.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you have more than one value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;all\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If its only a single value:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;].item()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I was getting error in this command:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df != \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But it worked when I changed it to this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; df \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;is\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;not\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\u0026apos;\u0026lt;/span\u0026gt;:\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;pass\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You need to use bitwise operators \u0026lt;code\u0026gt;|\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; and \u0026lt;code\u0026gt;\u0026amp;amp;\u0026lt;/code\u0026gt; instead of \u0026lt;code\u0026gt;and\u0026lt;/code\u0026gt; in pandas, you can\u0026apos;t simply use the bool statements from python.\u0026lt;br\u0026gt;\n\u0026lt;br\u0026gt;\nFor much complex filtering create a \u0026lt;code\u0026gt;mask\u0026lt;/code\u0026gt; and apply the mask on the dataframe.\u0026lt;br\u0026gt;\nPut all your query in the mask and apply it.\u0026lt;br\u0026gt;\nSuppose,\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;mask = (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;gt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;]) \u0026amp;amp; (stock[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col1\u0026quot;\u0026lt;/span\u0026gt;]\u0026amp;lt;=df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;col2\u0026quot;\u0026lt;/span\u0026gt;])\ndf_new = df[mask]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;ll try to give the benchmark of the three most common way (also mentioned above):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nx = np.linspace(0,100);\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100_000\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4808\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4726\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4904\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4725\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4806\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.5002\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4781\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4336\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.4974\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But, \u0026lt;code\u0026gt;*\u0026lt;/code\u0026gt; is not supported in Panda Series, and NumPy Array is faster than pandas data frame (arround 1000 times slower, see number):\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;from\u0026lt;/span\u0026gt; timeit \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; repeat\n\nsetup = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;\u0026quot;\u0026quot;\nimport numpy as np;\nimport random;\nimport pandas as pd;\nx = pd.DataFrame(np.linspace(0,100));\nlb, ub = np.sort([random.random() * 100, random.random() * 100]).tolist()\n\u0026quot;\u0026quot;\u0026quot;\u0026lt;/span\u0026gt;\nstmts = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\u0026apos;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; _ \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; stmt \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; stmts:\n        t = \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;min\u0026lt;/span\u0026gt;(repeat(stmt, setup, number=\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;%.4f\u0026apos;\u0026lt;/span\u0026gt; % t, stmt)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;()\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1964\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1992\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.2018\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1838\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1871\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.1883\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Note: adding one line of code \u0026lt;code\u0026gt;x = x.to_numpy()\u0026lt;/code\u0026gt; will need about 20 µs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For those who prefer \u0026lt;code\u0026gt;%timeit\u0026lt;/code\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; numpy \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;as\u0026lt;/span\u0026gt; np\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;import\u0026lt;/span\u0026gt; random\nlb, ub = np.sort([random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;, random.random() * \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;]).tolist()\nlb, ub\nx = pd.DataFrame(np.linspace(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;))\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;asterik\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) * (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;and_symbol\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[(x \u0026amp;gt; lb) \u0026amp;amp; (x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;def\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;numpy_logical\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt;):\n    x = x.to_numpy()\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; x[np.logical_and(x \u0026amp;gt; lb, x \u0026amp;lt;= ub)]\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;for\u0026lt;/span\u0026gt; i \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;in\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;range\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3\u0026lt;/span\u0026gt;):\n    %timeit asterik(x)\n    %timeit and_symbol(x)\n    %timeit numpy_logical(x)\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;print\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;\\n\u0026apos;\u0026lt;/span\u0026gt;)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;result:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;23\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.62\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;35.6\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;9.53\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;31.3\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8.9\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.4\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.35\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.9\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1.02\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;21.7\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt; ns per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\n\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;25.1\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;3.71\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;36.8\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;18.3\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;28.2\u0026lt;/span\u0026gt; µs ± \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;5.97\u0026lt;/span\u0026gt; µs per loop (mean ± std. dev. of \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;7\u0026lt;/span\u0026gt; runs, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;10000\u0026lt;/span\u0026gt; loops each)\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I encountered the same error and got stalled with a pyspark dataframe for few days, \u0026lt;strong\u0026gt;\u0026lt;em\u0026gt;I was able to resolve it successfully by filling na values with 0\u0026lt;/em\u0026gt;\u0026lt;/strong\u0026gt; since I was comparing integer values from 2 fields.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;One minor thing, which wasted my time.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Put the conditions(if comparing using \u0026quot; = \u0026quot;, \u0026quot; != \u0026quot;) in parenthesis, failing to do so also raises this exception.\nThis will work\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[(some condition) conditional operator (some conditions)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This will not\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df[some condition conditional-operator some condition]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":353,"title":"Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()","content":"\n                \n\u0026lt;p\u0026gt;I want to filter my dataframe with an \u0026lt;code\u0026gt;or\u0026lt;/code\u0026gt; condition to keep rows with a particular column\u0026apos;s values that are outside the range \u0026lt;code\u0026gt;[-0.25, 0.25]\u0026lt;/code\u0026gt;. I tried:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-py s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-python\u0026quot;\u0026gt;df = df[(df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;lt; -\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;) \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;or\u0026lt;/span\u0026gt; (df[\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;col\u0026apos;\u0026lt;/span\u0026gt;] \u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0.25\u0026lt;/span\u0026gt;)]\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;But I get the error:\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259","postType":"QUESTION","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","tags":[{"id":1981,"name":"filtering","slug":"filtering","createdAt":"2022-07-09T17:28:44.000Z","updatedAt":"2022-07-09T17:28:44.000Z","Questions_Tags":{"questionId":353,"tagId":1981}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"truth-value-of-a-series-is-ambiguous.-use-a.empty-a.bool()-a.item()-a.any()-or-a.all()-1657387724259"},"buildId":"8pZkyd0U8-Y2Qf3QK9j7l","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>