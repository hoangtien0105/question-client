<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/9fb80f4eb9e2d3c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9fb80f4eb9e2d3c9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-20edbe0b078add93.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/613-1e0aa2b2023820bb.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/471-84c36aa98dd4107c.js" defer=""></script><script src="/_next/static/chunks/81-bf26e92d2540e305.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-76d2c3e2d98bb08b.js" defer=""></script><script src="/_next/static/9SrIo1zGFc3tF1E8on9-4/_buildManifest.js" defer=""></script><script src="/_next/static/9SrIo1zGFc3tF1E8on9-4/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.eZIPKL code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-c4b0431a-0"]{content:"eZIPKL,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo.svg" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/how-to-manage-startactivityforresult-on-android-1657387967393#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-c4b0431a-0 eZIPKL flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/how-to-manage-startactivityforresult-on-android-1657387967393">How to manage startActivityForResult on Android</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/startactivityforresult">startactivityforresult</a></div></div><div class="question-content mt-5">
                
<p>In my activity, I'm calling a second activity from the main activity by <code>startActivityForResult</code>. In my second activity, there are some methods that finish this activity (maybe without a result), however, just one of them returns a result.</p>
<p>For example, from the main activity, I call a second one. In this activity, I'm checking some features of a handset, such as does it have a camera. If it doesn't have then I'll close this activity. Also, during the preparation of <code>MediaRecorder</code> or <code>MediaPlayer</code> if a problem happens then I'll close this activity.</p>
<p>If its device has a camera and recording is done completely, then after recording a video if a user clicks on the done button then I'll send the result (address of the recorded video) back to the main activity.</p>
<p>How do I check the result from the main activity?</p>
    </div></div></div><div class="sc-c4b0431a-2 cRqwQe"><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>From your <code>FirstActivity</code>, call the <code>SecondActivity</code> using the <code>startActivityForResult()</code> method.</p>
<p>For example:</p>
<pre class="default s-code-block"><code class="hljs language-csharp"><span class="hljs-built_in">int</span> LAUNCH_SECOND_ACTIVITY = <span class="hljs-number">1</span>
Intent i = <span class="hljs-keyword">new</span> Intent(<span class="hljs-keyword">this</span>, SecondActivity.<span class="hljs-keyword">class</span>);
startActivityForResult(i, LAUNCH_SECOND_ACTIVITY);
</code></pre>
<p>In your <code>SecondActivity</code>, set the data which you want to return back to <code>FirstActivity</code>. If you don't want to return back, don't set any.</p>
<p>For example: In <code>SecondActivity</code> if you want to send back data:</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Intent</span> <span class="hljs-variable">returnIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();
returnIntent.putExtra(<span class="hljs-string">"result"</span>,result);
setResult(Activity.RESULT_OK,returnIntent);
finish();
</code></pre>
<p>If you don't want to return data:</p>
<pre class="default s-code-block"><code class="hljs language-lisp">Intent returnIntent = new Intent()<span class="hljs-comment">;</span>
setResult(<span class="hljs-name">Activity</span>.RESULT_CANCELED, returnIntent)<span class="hljs-comment">;</span>
finish()<span class="hljs-comment">;</span>
</code></pre>
<p>Now in your <code>FirstActivity</code> class, write the following code for the <code>onActivityResult()</code> method.</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

    <span class="hljs-keyword">if</span> (requestCode == LAUNCH_SECOND_ACTIVITY) {
        <span class="hljs-keyword">if</span>(resultCode == Activity.RESULT_OK){
            String result=data.getStringExtra(<span class="hljs-string">"result"</span>);
        }
        <span class="hljs-keyword">if</span> (resultCode == Activity.RESULT_CANCELED) {
            <span class="hljs-comment">// Write your code if there's no result</span>
        }
    }
} <span class="hljs-comment">//onActivityResult</span>
</code></pre>
<p>To implement passing data between two activities in a much better way in Kotlin, please go through <em>'<a href="https://proandroiddev.com/is-onactivityresult-deprecated-in-activity-results-api-lets-deep-dive-into-it-302d5cf6edd" rel="noreferrer">A better way to pass data between Activities</a>'</em>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p>How to check the result from the main activity?</p>
</blockquote>
<p>You need to override <a href="http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29" rel="nofollow noreferrer"><code>Activity.onActivityResult()</code></a> and then check its parameters:</p>
<ul>
<li><code>requestCode</code> identifies which app returned these results. This is defined by you when you call <code>startActivityForResult()</code>.</li>
<li><code>resultCode</code> informs you whether this app succeeded, failed, or something different</li>
<li><code>data</code> holds any information returned by this app. This may be <code>null</code>.</li>
</ul>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Example</strong></p>

<p>To see the entire process in context, here is a supplemental answer. See <a href="https://stackoverflow.com/a/40969871/3681880">my fuller answer</a> for more explanation.</p>

<p><img src="https://i.stack.imgur.com/Tyhf8.png" alt="enter image description here"></p>

<p><em>MainActivity.java</em></p>

<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MainActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AppCompatActivity</span> {

    <span class="hljs-comment">// Add a different request code for every activity you are starting from here</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">SECOND_ACTIVITY_REQUEST_CODE</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
        <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    <span class="hljs-comment">// "Go to Second Activity" button click</span>
    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onButtonClick</span><span class="hljs-params">(View view)</span> {

        <span class="hljs-comment">// Start the SecondActivity</span>
        <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-built_in">this</span>, SecondActivity.class);
        startActivityForResult(intent, SECOND_ACTIVITY_REQUEST_CODE);
    }

    <span class="hljs-comment">// This method is called when the second activity finishes</span>
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
        <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

        <span class="hljs-comment">// check that it is the SecondActivity with an OK result</span>
        <span class="hljs-keyword">if</span> (requestCode == SECOND_ACTIVITY_REQUEST_CODE) {
            <span class="hljs-keyword">if</span> (resultCode == RESULT_OK) { <span class="hljs-comment">// Activity.RESULT_OK</span>

                <span class="hljs-comment">// get String data from Intent</span>
                <span class="hljs-type">String</span> <span class="hljs-variable">returnString</span> <span class="hljs-operator">=</span> data.getStringExtra(<span class="hljs-string">"keyName"</span>);

                <span class="hljs-comment">// set text view with string</span>
                <span class="hljs-type">TextView</span> <span class="hljs-variable">textView</span> <span class="hljs-operator">=</span> (TextView) findViewById(R.id.textView);
                textView.setText(returnString);
            }
        }
    }
}
</code></pre>

<p><em>SecondActivity.java</em></p>

<pre class="default s-code-block"><code class="hljs language-scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">SecondActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span> </span>{

    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">protected</span> void onCreate(<span class="hljs-type">Bundle</span> savedInstanceState) {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState);
        setContentView(<span class="hljs-type">R</span>.layout.activity_second);
    }

    <span class="hljs-comment">// "Send text back" button click</span>
    public void onButtonClick(<span class="hljs-type">View</span> view) {

        <span class="hljs-comment">// get the text from the EditText</span>
        <span class="hljs-type">EditText</span> editText = (<span class="hljs-type">EditText</span>) findViewById(<span class="hljs-type">R</span>.id.editText);
        <span class="hljs-type">String</span> stringToPassBack = editText.getText().toString();

        <span class="hljs-comment">// put the String to pass back into an Intent and close this activity</span>
        <span class="hljs-type">Intent</span> intent = <span class="hljs-keyword">new</span> <span class="hljs-type">Intent</span>();
        intent.putExtra(<span class="hljs-string">"keyName"</span>, stringToPassBack);
        setResult(<span class="hljs-type">RESULT_OK</span>, intent);
        finish();
    }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Complementing <a href="https://stackoverflow.com/questions/10407159/how-to-manage-startactivityforresult-on-android/10407371#10407371">the answer from Nishant</a>, the best way to return the activity result is:</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-type">Intent</span> <span class="hljs-variable">returnIntent</span> <span class="hljs-operator">=</span> getIntent();
returnIntent.putExtra(<span class="hljs-string">"result"</span>,result);
setResult(RESULT_OK,returnIntent);
finish();
</code></pre>
<p>I was having a problem with</p>
<pre class="default s-code-block"><code class="hljs language-scss">new <span class="hljs-built_in">Intent</span>();
</code></pre>
<p>Then I found out that the correct way is using</p>
<pre class="default s-code-block"><code class="hljs language-scss"><span class="hljs-built_in">getIntent</span>();
</code></pre>
<p>to get the current intent.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h3>startActivityForResult:  Deprecated in Android X</h3>
<p>For the <em>new</em> way we have <code>registerForActivityResult</code>.</p>
<p><strong>In Java :</strong></p>
<pre class="default s-code-block"><code class="hljs language-java"> <span class="hljs-comment">// You need to create a launcher variable inside onAttach or onCreate or global, i.e, before the activity is displayed</span>
 ActivityResultLauncher&lt;Intent&gt; launchSomeActivity = registerForActivityResult(
     <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActivityResultContracts</span>.StartActivityForResult(),
     <span class="hljs-keyword">new</span> <span class="hljs-title class_">ActivityResultCallback</span>&lt;ActivityResult&gt;() {
              <span class="hljs-meta">@Override</span>
              <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(ActivityResult result)</span> {
                   <span class="hljs-keyword">if</span> (result.getResultCode() == Activity.RESULT_OK) {
                         <span class="hljs-type">Intent</span> <span class="hljs-variable">data</span> <span class="hljs-operator">=</span> result.getData();
                         <span class="hljs-comment">// your operation....</span>
                    }
               }
      });

      <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">openYourActivity</span><span class="hljs-params">()</span> {
            <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-built_in">this</span>, SomeActivity.class);
            launchSomeActivity.launch(intent);
      }
</code></pre>
<p><strong>In Kotlin :</strong></p>
<pre class="default s-code-block"><code class="hljs language-kotlin"><span class="hljs-keyword">var</span> resultLauncher = registerForActivityResult(StartActivityForResult()) { result -&gt;
    <span class="hljs-keyword">if</span> (result.resultCode == Activity.RESULT_OK) {
        <span class="hljs-keyword">val</span> <span class="hljs-keyword">data</span>: Intent? = result.<span class="hljs-keyword">data</span>
        <span class="hljs-comment">// your operation...</span>
    }
}

<span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">openYourActivity</span><span class="hljs-params">()</span></span> {
    <span class="hljs-keyword">val</span> intent = Intent(<span class="hljs-keyword">this</span>, SomeActivity::<span class="hljs-keyword">class</span>.java)
    resultLauncher.launch(intent)
}
</code></pre>
<h3>Advantage:</h3>
<ol>
<li>The new way is reduce complexity which we faced when we call the activity from a fragment or from another activity</li>
<li>Easily ask for any permission and get callback</li>
</ol>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>For those who have problem with <a href="https://stackoverflow.com/questions/10564474/wrong-requestcode-in-onactivityresult">wrong requestCode in onActivityResult</a></p>

<p>If you are calling <code>startActivityForResult()</code> from your <code>Fragment</code>, the requestCode is changed by the Activity that owns the Fragment.</p>

<p>If you want to get the correct resultCode in your activity try this:</p>

<p>Change:</p>

<p><code>startActivityForResult(intent, 1);</code> To:</p>

<p><code>getActivity().startActivityForResult(intent, 1);</code></p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<h2>The ActivityResultRegistry is the recommended approach</h2>
<p><code>ComponentActivity</code> now provides an <code>ActivityResultRegistry</code> that lets you handle the <code>startActivityForResult()</code>+<code>onActivityResult()</code> as well as <code>requestPermissions()</code>+<code>onRequestPermissionsResult()</code> flows without overriding methods in your <code>Activity</code> or <code>Fragment</code>, brings increased type safety via <code>ActivityResultContract</code>, and provides hooks for testing these flows.</p>
<p>It is strongly recommended to use the Activity Result APIs introduced in Android&nbsp;10 Activity 1.2.0-alpha02 and Fragment 1.3.0-alpha02.</p>
<p>Add this to your <code>build.gradle</code></p>
<pre class="default s-code-block"><code class="hljs language-kotlin">def activity_version = <span class="hljs-string">"1.2.0-beta01"</span>

<span class="hljs-comment">// Java language implementation</span>
implementation <span class="hljs-string">"androidx.activity:activity:<span class="hljs-variable">$activity_version</span>"</span>
<span class="hljs-comment">// Kotlin</span>
implementation <span class="hljs-string">"androidx.activity:activity-ktx:<span class="hljs-variable">$activity_version</span>"</span>
</code></pre>
<h2>How to use the pre-built contract</h2>
<p>This new API has the following pre-built functionalities</p>
<ol>
<li>TakeVideo</li>
<li>PickContact</li>
<li>GetContent</li>
<li>GetContents</li>
<li>OpenDocument</li>
<li>OpenDocuments</li>
<li>OpenDocumentTree</li>
<li>CreateDocument</li>
<li>Dial</li>
<li>TakePicture</li>
<li>RequestPermission</li>
<li>RequestPermissions</li>
</ol>
<p><strong>An example that uses the takePicture contract:</strong></p>
<pre class="default s-code-block"><code class="hljs language-kotlin"><span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> takePicture = prepareCall(ActivityResultContracts.TakePicture()) { bitmap: Bitmap? -&gt;
    <span class="hljs-comment">// Do something with the Bitmap, if present</span>
}

<span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
    <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
    setContentView(R.layout.activity_main)

    button.setOnClickListener { takePicture() }
}
</code></pre>
<p>So whats going on here? Lets break it down slightly. <code>takePicture</code> is just a callback which returns a nullable Bitmap - whether or not its null depends on whether or not the <code>onActivityResult</code> process was successful. <code>prepareCall</code> then registers this call into a new feature on <code>ComponentActivity</code> called the <code>ActivityResultRegistry</code> - well come back to this later. <code>ActivityResultContracts.TakePicture()</code> is one of the built-in helpers which Google have created for us, and finally invoking <code>takePicture</code> actually triggers the Intent in the same way that you would previously with <code>Activity.startActivityForResult(intent, REQUEST_CODE)</code>.</p>
<h2>How to write a custom contract</h2>
<p>A simple contract that takes an Int as an <em>input</em> and returns a string that the requested Activity returns in the result Intent.</p>
<pre class="default s-code-block"><code class="hljs language-kotlin"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyContract</span> : <span class="hljs-type">ActivityResultContract</span>&lt;<span class="hljs-type">Int, String</span>&gt;</span>() {

    <span class="hljs-keyword">companion</span> <span class="hljs-keyword">object</span> {
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> ACTION = <span class="hljs-string">"com.myapp.action.MY_ACTION"</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> INPUT_INT = <span class="hljs-string">"input_int"</span>
        <span class="hljs-keyword">const</span> <span class="hljs-keyword">val</span> OUTPUT_STRING = <span class="hljs-string">"output_string"</span>
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">createIntent</span><span class="hljs-params">(input: <span class="hljs-type">Int</span>)</span></span>: Intent {
        <span class="hljs-keyword">return</span> Intent(ACTION)
            .apply { putExtra(INPUT_INT, input) }
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">parseResult</span><span class="hljs-params">(resultCode: <span class="hljs-type">Int</span>, intent: <span class="hljs-type">Intent</span>?)</span></span>: String? {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">when</span> (resultCode) {
            Activity.RESULT_OK -&gt; intent?.getStringExtra(OUTPUT_STRING)
            <span class="hljs-keyword">else</span> -&gt; <span class="hljs-literal">null</span>
        }
    }
}

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyActivity</span> : <span class="hljs-type">AppCompatActivity</span></span>() {

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">val</span> myActionCall = prepareCall(MyContract()) { result -&gt;
        Log.i(<span class="hljs-string">"MyActivity"</span>, <span class="hljs-string">"Obtained result: <span class="hljs-variable">$result</span>"</span>)
    }

    <span class="hljs-keyword">override</span> <span class="hljs-function"><span class="hljs-keyword">fun</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(savedInstanceState: <span class="hljs-type">Bundle</span>?)</span></span> {
        <span class="hljs-keyword">super</span>.onCreate(savedInstanceState)
        ...
        button.setOnClickListener {
            myActionCall(<span class="hljs-number">500</span>)
        }
    }
}
</code></pre>
<p>Check <a href="https://developer.android.com/training/basics/intents/result" rel="nofollow noreferrer">this official documentation</a> for more information.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you want to update the user interface with the activity result, you can't to use <code>this.runOnUiThread(new Runnable() {}</code>. Doing this, the UI won't refresh with the new value. Instead, you can do this:</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

    <span class="hljs-keyword">if</span> (resultCode == RESULT_CANCELED) {
        <span class="hljs-keyword">return</span>;
    }

    global_lat = data.getDoubleExtra(<span class="hljs-string">"LATITUDE"</span>, <span class="hljs-number">0</span>);
    global_lng = data.getDoubleExtra(<span class="hljs-string">"LONGITUDE"</span>, <span class="hljs-number">0</span>);
    new_latlng = <span class="hljs-literal">true</span>;
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onResume</span><span class="hljs-params">()</span> {
    <span class="hljs-built_in">super</span>.onResume();

    <span class="hljs-keyword">if</span>(new_latlng)
    {
        PhysicalTagProperties.<span class="hljs-built_in">this</span>.setLocation(global_lat, global_lng);
        new_latlng=<span class="hljs-literal">false</span>;
    }
}
</code></pre>
<p>This seems silly, but it works pretty well.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I will post the new "way" with <a href="https://developer.android.com/jetpack/androidx" rel="nofollow noreferrer">Android X</a> in a short answer (because in some case you does not need custom registry or contract). If you want more information, see:  <em><a href="https://developer.android.com/training/basics/intents/result" rel="nofollow noreferrer">Getting a result from an activity</a></em></p>
<p><strong>Important</strong>: there is actually a bug with the backward compatibility of Android X so you have to add <code>fragment_version</code> in your Gradle file. <strong>Otherwise you will get an exception "New result API error : Can only use lower 16 bits for requestCode"</strong>.</p>
<pre class="default s-code-block"><code class="hljs language-kotlin">dependencies {

    def activity_version = <span class="hljs-string">"1.2.0-beta01"</span>
    <span class="hljs-comment">// Java language implementation</span>
    implementation <span class="hljs-string">"androidx.activity:activity:<span class="hljs-variable">$activity_version</span>"</span>
    <span class="hljs-comment">// Kotlin</span>
    implementation <span class="hljs-string">"androidx.activity:activity-ktx:<span class="hljs-variable">$activity_version</span>"</span>

    def fragment_version = <span class="hljs-string">"1.3.0-beta02"</span>
    <span class="hljs-comment">// Java language implementation</span>
    implementation <span class="hljs-string">"androidx.fragment:fragment:<span class="hljs-variable">$fragment_version</span>"</span>
    <span class="hljs-comment">// Kotlin</span>
    implementation <span class="hljs-string">"androidx.fragment:fragment-ktx:<span class="hljs-variable">$fragment_version</span>"</span>
    <span class="hljs-comment">// Testing Fragments in Isolation</span>
    debugImplementation <span class="hljs-string">"androidx.fragment:fragment-testing:<span class="hljs-variable">$fragment_version</span>"</span>
}
</code></pre>
<p>Now you just have to add this member variable of your activity. This use a predefined registry and generic contract.</p>
<pre class="default s-code-block"><code class="hljs language-scala">public <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AppCompatActivity</span></span>{

   ...

    <span class="hljs-comment">/**
     * Activity callback API.
     */</span>
    <span class="hljs-comment">// https://developer.android.com/training/basics/intents/result</span>
    <span class="hljs-keyword">private</span> <span class="hljs-type">ActivityResultLauncher</span>&lt;<span class="hljs-type">Intent</span>&gt; mStartForResult = registerForActivityResult(<span class="hljs-keyword">new</span> <span class="hljs-type">ActivityResultContracts</span>.<span class="hljs-type">StartActivityForResult</span>(),

            <span class="hljs-keyword">new</span> <span class="hljs-type">ActivityResultCallback</span>&lt;<span class="hljs-type">ActivityResult</span>&gt;() {

                <span class="hljs-meta">@Override</span>
                public void onActivityResult(<span class="hljs-type">ActivityResult</span> result) {
                    switch (result.getResultCode()) {
                        <span class="hljs-keyword">case</span> <span class="hljs-type">Activity</span>.<span class="hljs-type">RESULT_OK</span>:
                            <span class="hljs-type">Intent</span> intent = result.getData();
                            <span class="hljs-comment">// Handle the Intent</span>
                            <span class="hljs-type">Toast</span>.makeText(<span class="hljs-type">MyActivity</span>.<span class="hljs-keyword">this</span>, <span class="hljs-string">"Activity returned ok"</span>, <span class="hljs-type">Toast</span>.<span class="hljs-type">LENGTH_SHORT</span>).show();
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-type">Activity</span>.<span class="hljs-type">RESULT_CANCELED</span>:
                            <span class="hljs-type">Toast</span>.makeText(<span class="hljs-type">MyActivity</span>.<span class="hljs-keyword">this</span>, <span class="hljs-string">"Activity canceled"</span>, <span class="hljs-type">Toast</span>.<span class="hljs-type">LENGTH_SHORT</span>).show();
                            <span class="hljs-keyword">break</span>;
                    }
                }
            });
</code></pre>
<p>Before new API you had :</p>
<pre class="default s-code-block"><code class="hljs language-java">btn.setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() {

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> {
                <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(MyActivity .<span class="hljs-built_in">this</span>, EditActivity.class);
                startActivityForResult(intent, Constants.INTENT_EDIT_REQUEST_CODE);
            }
        });
</code></pre>
<p><strong>You may notice that the request code is now generated (and hold) by the Google framework.</strong>
Your code becomes:</p>
<pre class="default s-code-block"><code class="hljs language-java"> btn.setOnClickListener(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.OnClickListener() {

                <span class="hljs-meta">@Override</span>
                <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onClick</span><span class="hljs-params">(View v)</span> {
                    <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(MyActivity .<span class="hljs-built_in">this</span>, EditActivity.class);
                    mStartForResult.launch(intent);
                }
            });
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>First you use <code>startActivityForResult()</code> with parameters in the first <code>Activity</code> and if you want to send data from the second <code>Activity</code> to first <code>Activity</code> then pass the value using <code>Intent</code> with the <code>setResult()</code> method and get that data inside the <code>onActivityResult()</code> method in the first <code>Activity</code>.</p>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>It is a very common problem on Android</p>
<p><strong>It can be broken down into three pieces</strong></p>
<ol>
<li>Start Activity B (happens in Activity A)</li>
<li>Set requested data  (happens in activity B)</li>
<li>Receive requested data (happens in activity A)</li>
</ol>
<blockquote>
<ol>
<li>startActivity B</li>
</ol>
</blockquote>
<pre class="default s-code-block"><code class="hljs language-csharp">Intent i = <span class="hljs-keyword">new</span> Intent(A.<span class="hljs-keyword">this</span>, B.<span class="hljs-keyword">class</span>);
startActivity(i);
</code></pre>
<blockquote>
<ol start="2">
<li>Set requested data</li>
</ol>
</blockquote>
<p>In this part, you decide whether you want to send data back or not when a particular event occurs.</p>
<p>E.g.: In activity B there is an EditText and two buttons b1, b2.
Clicking on Button b1 sends data back to activity A.
Clicking on Button b2 does not send any data.</p>
<p><strong>Sending data</strong></p>
<pre class="default s-code-block"><code class="hljs language-java">b1......clickListener
{
    <span class="hljs-type">Intent</span> <span class="hljs-variable">resultIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>();
    resultIntent.putExtra(<span class="hljs-string">"Your_key"</span>, <span class="hljs-string">"Your_value"</span>);
    setResult(RES_CODE_A, resultIntent);
    finish();
}
</code></pre>
<p><strong>Not sending data</strong></p>
<pre class="default s-code-block"><code class="hljs language-scss">b2.....<span class="hljs-selector-class">.clickListener</span>
{
   <span class="hljs-built_in">setResult</span>(RES_CODE_B, new Intent());
   <span class="hljs-built_in">finish</span>();
}
</code></pre>
<p><strong>The user clicks the back button</strong></p>
<p>By default, the result is set with Activity.RESULT_CANCEL response code</p>
<blockquote>
<ol start="3">
<li>Retrieve result</li>
</ol>
</blockquote>
<p>For that override onActivityResult method</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

    <span class="hljs-keyword">if</span> (resultCode == RES_CODE_A) {

       <span class="hljs-comment">// b1 was clicked</span>
       <span class="hljs-type">String</span> <span class="hljs-variable">x</span> <span class="hljs-operator">=</span> data.getStringExtra(<span class="hljs-string">"RES_CODE_A"</span>);

    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(resultCode == RES_CODE_B){

       <span class="hljs-comment">// b2 was clicked</span>
    }
    <span class="hljs-keyword">else</span>{
       <span class="hljs-comment">// The back button was clicked</span>
    }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In <strong>Kotlin</strong></p>
<p>Suppose A &amp; B are activities the navigation is from A -&gt; B
We need the result back from A &lt;- B</p>
<p>in <strong>A</strong></p>
<pre class="default s-code-block"><code class="hljs language-typescript">    <span class="hljs-comment">// calling the Activity B</span>
    resultLauncher.<span class="hljs-title function_">launch</span>(<span class="hljs-title class_">Intent</span>(requireContext(), <span class="hljs-attr">B</span>::<span class="hljs-keyword">class</span>.<span class="hljs-property">java</span>))

    <span class="hljs-comment">// we get data in here from B</span>
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">var</span> resultLauncher =
    <span class="hljs-title function_">registerForActivityResult</span>(<span class="hljs-params">ActivityResultContracts.StartActivityForResult()</span>) { result -&gt;
        when (result.<span class="hljs-property">resultCode</span>) {
            <span class="hljs-title class_">Activity</span>.<span class="hljs-property">RESULT_OK</span> -&gt; {
                result.<span class="hljs-property">data</span>?.<span class="hljs-title function_">getStringExtra</span>(<span class="hljs-string">"VALUE"</span>)?.<span class="hljs-property">let</span> {
                    <span class="hljs-comment">// data received here</span>
                }
            }
            <span class="hljs-title class_">Activity</span>.<span class="hljs-property">RESULT_CANCELED</span> -&gt; {
                <span class="hljs-comment">// cancel or failure</span>
            }
        }
    }
</code></pre>
<p>In <strong>B</strong></p>
<pre class="default s-code-block"><code class="hljs language-scss">    <span class="hljs-comment">// Sending result value back to A</span>
    if (success) {
       <span class="hljs-built_in">setResult</span>(RESULT_OK, Intent()<span class="hljs-selector-class">.putExtra</span>("VALUE", value))
    } else {
       <span class="hljs-built_in">setResult</span>(RESULT_CANCELED)
    }
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In your Main Activity</p>
<pre class="default s-code-block"><code class="hljs language-typescript"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onCreate</span>(<span class="hljs-params">Bundle savedInstanceState</span>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onCreate</span>(savedInstanceState);
    <span class="hljs-title function_">setContentView</span>(R.<span class="hljs-property">layout</span>.<span class="hljs-property">activity_main</span>);

    <span class="hljs-title function_">findViewById</span>(R.<span class="hljs-property">id</span>.<span class="hljs-property">takeCam</span>).<span class="hljs-title function_">setOnClickListener</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.<span class="hljs-title class_">OnClickListener</span>() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onClick</span>(<span class="hljs-params">View view</span>) {
            <span class="hljs-title class_">Intent</span> intent=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-title function_">getApplicationContext</span>(),<span class="hljs-title class_">TakePhotoActivity</span>.<span class="hljs-property">class</span>);
            intent.<span class="hljs-title function_">putExtra</span>(<span class="hljs-string">"Mode"</span>,<span class="hljs-string">"Take"</span>);
            <span class="hljs-title function_">startActivity</span>(intent);
        }
    });
    <span class="hljs-title function_">findViewById</span>(R.<span class="hljs-property">id</span>.<span class="hljs-property">selectGal</span>).<span class="hljs-title function_">setOnClickListener</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">View</span>.<span class="hljs-title class_">OnClickListener</span>() {
        <span class="hljs-meta">@Override</span>
        <span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onClick</span>(<span class="hljs-params">View view</span>) {
            <span class="hljs-title class_">Intent</span> intent=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(<span class="hljs-title function_">getApplicationContext</span>(),<span class="hljs-title class_">TakePhotoActivity</span>.<span class="hljs-property">class</span>);
            intent.<span class="hljs-title function_">putExtra</span>(<span class="hljs-string">"Mode"</span>,<span class="hljs-string">"Gallery"</span>);
            <span class="hljs-title function_">startActivity</span>(intent);
        }
    });
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-built_in">void</span> <span class="hljs-title function_">onActivityResult</span>(<span class="hljs-params">int requestCode, int resultCode, Intent data</span>) {
    <span class="hljs-variable language_">super</span>.<span class="hljs-title function_">onActivityResult</span>(requestCode, resultCode, data);

}
</code></pre>
<p>In Second Activity to Display</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">CAMERA_REQUEST</span> <span class="hljs-operator">=</span> <span class="hljs-number">1888</span>;
<span class="hljs-keyword">private</span> ImageView imageView;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">MY_CAMERA_PERMISSION_CODE</span> <span class="hljs-operator">=</span> <span class="hljs-number">100</span>;
<span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">int</span> <span class="hljs-variable">PICK_PHOTO_FOR_AVATAR</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> {
    <span class="hljs-built_in">super</span>.onCreate(savedInstanceState);
    setContentView(R.layout.activity_take_photo);

    imageView=findViewById(R.id.imageView);

    <span class="hljs-keyword">if</span>(getIntent().getStringExtra(<span class="hljs-string">"Mode"</span>).equals(<span class="hljs-string">"Gallery"</span>))
    {
        pickImage();
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.M) {
            <span class="hljs-keyword">if</span> (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) {
                requestPermissions(<span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]{Manifest.permission.CAMERA}, MY_CAMERA_PERMISSION_CODE);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-type">Intent</span> <span class="hljs-variable">cameraIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(MediaStore.ACTION_IMAGE_CAPTURE);
                startActivityForResult(cameraIntent, CAMERA_REQUEST);
            }
        }
    }
}
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">pickImage</span><span class="hljs-params">()</span> {
    <span class="hljs-type">Intent</span> <span class="hljs-variable">intent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(Intent.ACTION_PICK);
    intent.setType(<span class="hljs-string">"image/*"</span>);
    startActivityForResult(intent, PICK_PHOTO_FOR_AVATAR);
}
<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onRequestPermissionsResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-meta">@NonNull</span> String[] permissions, <span class="hljs-meta">@NonNull</span> <span class="hljs-type">int</span>[] grantResults)</span>
{
    <span class="hljs-built_in">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);
    <span class="hljs-keyword">if</span> (requestCode == MY_CAMERA_PERMISSION_CODE)
    {
        <span class="hljs-keyword">if</span> (grantResults[<span class="hljs-number">0</span>] == PackageManager.PERMISSION_GRANTED)
        {
            <span class="hljs-type">Intent</span> <span class="hljs-variable">cameraIntent</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Intent</span>(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
            startActivityForResult(cameraIntent, CAMERA_REQUEST);
        }
        <span class="hljs-keyword">else</span>
        {
            Toast.makeText(<span class="hljs-built_in">this</span>, <span class="hljs-string">"Camera Permission Denied.."</span>, Toast.LENGTH_LONG).show();
        }
    }
}

<span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);
    <span class="hljs-keyword">if</span> (requestCode == CAMERA_REQUEST &amp;&amp; resultCode == Activity.RESULT_OK) {
        <span class="hljs-type">Bitmap</span> <span class="hljs-variable">photo</span> <span class="hljs-operator">=</span> (Bitmap) data.getExtras().get(<span class="hljs-string">"data"</span>);
        imageView.setImageBitmap(photo);
    }
        <span class="hljs-keyword">if</span> (requestCode == PICK_PHOTO_FOR_AVATAR &amp;&amp; resultCode == Activity.RESULT_OK) {
            <span class="hljs-keyword">if</span> (data == <span class="hljs-literal">null</span>) {
                Log.d(<span class="hljs-string">"ABC"</span>,<span class="hljs-string">"No Such Image Selected"</span>);
                <span class="hljs-keyword">return</span>;
            }
            <span class="hljs-keyword">try</span> {
                Uri selectedData=data.getData();
                Log.d(<span class="hljs-string">"ABC"</span>,<span class="hljs-string">"Image Pick-Up"</span>);
                imageView.setImageURI(selectedData);
                <span class="hljs-type">InputStream</span> <span class="hljs-variable">inputStream</span> <span class="hljs-operator">=</span> getApplicationContext().getContentResolver().openInputStream(selectedData);
                <span class="hljs-type">Bitmap</span> <span class="hljs-variable">bitmap</span> <span class="hljs-operator">=</span> BitmapFactory.decodeStream(inputStream);
                Bitmap bmp=MediaStore.Images.Media.getBitmap(getContentResolver(),selectedData);
            } <span class="hljs-keyword">catch</span> (FileNotFoundException e) {
                e.printStackTrace();
            } <span class="hljs-keyword">catch</span>(IOException e){

            }
    }
}
</code></pre>
    </div></div></div></div><div class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 14</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>You need to override Activity.onActivityResult():</p>
<pre class="default s-code-block"><code class="hljs language-java"><span class="hljs-meta">@Override</span>
<span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">onActivityResult</span><span class="hljs-params">(<span class="hljs-type">int</span> requestCode, <span class="hljs-type">int</span> resultCode, Intent data)</span> {
    <span class="hljs-built_in">super</span>.onActivityResult(requestCode, resultCode, data);

    <span class="hljs-keyword">if</span> (resultCode == RESULT_CODE_ONE) {

       <span class="hljs-type">String</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> data.getStringExtra(<span class="hljs-string">"RESULT_CODE_ONE"</span>);

    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(resultCode == RESULT_CODE_TWO){

       <span class="hljs-comment">// b was clicked</span>
    }
    <span class="hljs-keyword">else</span>{

    }
}
</code></pre>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;From your \u0026lt;code\u0026gt;FirstActivity\u0026lt;/code\u0026gt;, call the \u0026lt;code\u0026gt;SecondActivity\u0026lt;/code\u0026gt; using the \u0026lt;code\u0026gt;startActivityForResult()\u0026lt;/code\u0026gt; method.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; LAUNCH_SECOND_ACTIVITY = \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1\u0026lt;/span\u0026gt;\nIntent i = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Intent(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, SecondActivity.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;);\nstartActivityForResult(i, LAUNCH_SECOND_ACTIVITY);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In your \u0026lt;code\u0026gt;SecondActivity\u0026lt;/code\u0026gt;, set the data which you want to return back to \u0026lt;code\u0026gt;FirstActivity\u0026lt;/code\u0026gt;. If you don\u0026apos;t want to return back, don\u0026apos;t set any.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example: In \u0026lt;code\u0026gt;SecondActivity\u0026lt;/code\u0026gt; if you want to send back data:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;returnIntent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;();\nreturnIntent.putExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;result\u0026quot;\u0026lt;/span\u0026gt;,result);\nsetResult(Activity.RESULT_OK,returnIntent);\nfinish();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;If you don\u0026apos;t want to return data:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-lisp\u0026quot;\u0026gt;Intent returnIntent = new Intent()\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;;\u0026lt;/span\u0026gt;\nsetResult(\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;Activity\u0026lt;/span\u0026gt;.RESULT_CANCELED, returnIntent)\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;;\u0026lt;/span\u0026gt;\nfinish()\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now in your \u0026lt;code\u0026gt;FirstActivity\u0026lt;/code\u0026gt; class, write the following code for the \u0026lt;code\u0026gt;onActivityResult()\u0026lt;/code\u0026gt; method.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (requestCode == LAUNCH_SECOND_ACTIVITY) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(resultCode == Activity.RESULT_OK){\n            String result=data.getStringExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;result\u0026quot;\u0026lt;/span\u0026gt;);\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (resultCode == Activity.RESULT_CANCELED) {\n            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Write your code if there\u0026apos;s no result\u0026lt;/span\u0026gt;\n        }\n    }\n} \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;//onActivityResult\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;To implement passing data between two activities in a much better way in Kotlin, please go through \u0026lt;em\u0026gt;\u0026apos;\u0026lt;a href=\u0026quot;https://proandroiddev.com/is-onactivityresult-deprecated-in-activity-results-api-lets-deep-dive-into-it-302d5cf6edd\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;A better way to pass data between Activities\u0026lt;/a\u0026gt;\u0026apos;\u0026lt;/em\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;How to check the result from the main activity?\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;You need to override \u0026lt;a href=\u0026quot;http://developer.android.com/reference/android/app/Activity.html#onActivityResult%28int,%20int,%20android.content.Intent%29\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;Activity.onActivityResult()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; and then check its parameters:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;requestCode\u0026lt;/code\u0026gt; identifies which app returned these results. This is defined by you when you call \u0026lt;code\u0026gt;startActivityForResult()\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;resultCode\u0026lt;/code\u0026gt; informs you whether this app succeeded, failed, or something different\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;code\u0026gt;data\u0026lt;/code\u0026gt; holds any information returned by this app. This may be \u0026lt;code\u0026gt;null\u0026lt;/code\u0026gt;.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Example\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;To see the entire process in context, here is a supplemental answer. See \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/40969871/3681880\u0026quot;\u0026gt;my fuller answer\u0026lt;/a\u0026gt; for more explanation.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;img src=\u0026quot;https://i.stack.imgur.com/Tyhf8.png\u0026quot; alt=\u0026quot;enter image description here\u0026quot;\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;MainActivity.java\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;MainActivity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extends\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;AppCompatActivity\u0026lt;/span\u0026gt; {\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Add a different request code for every activity you are starting from here\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;SECOND_ACTIVITY_REQUEST_CODE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\n    \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Bundle savedInstanceState)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026quot;Go to Second Activity\u0026quot; button click\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onButtonClick\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(View view)\u0026lt;/span\u0026gt; {\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Start the SecondActivity\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, SecondActivity.class);\n        startActivityForResult(intent, SECOND_ACTIVITY_REQUEST_CODE);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This method is called when the second activity finishes\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// check that it is the SecondActivity with an OK result\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (requestCode == SECOND_ACTIVITY_REQUEST_CODE) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (resultCode == RESULT_OK) { \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Activity.RESULT_OK\u0026lt;/span\u0026gt;\n\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// get String data from Intent\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;returnString\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data.getStringExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;keyName\u0026quot;\u0026lt;/span\u0026gt;);\n\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// set text view with string\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;TextView\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;textView\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (TextView) findViewById(R.id.textView);\n                textView.setText(returnString);\n            }\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;em\u0026gt;SecondActivity.java\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scala\u0026quot;\u0026gt;public \u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;SecondActivity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extends\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;AppCompatActivity\u0026lt;/span\u0026gt; \u0026lt;/span\u0026gt;{\n\n    \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; void onCreate(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bundle\u0026lt;/span\u0026gt; savedInstanceState) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onCreate(savedInstanceState);\n        setContentView(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;R\u0026lt;/span\u0026gt;.layout.activity_second);\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// \u0026quot;Send text back\u0026quot; button click\u0026lt;/span\u0026gt;\n    public void onButtonClick(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;View\u0026lt;/span\u0026gt; view) {\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// get the text from the EditText\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;EditText\u0026lt;/span\u0026gt; editText = (\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;EditText\u0026lt;/span\u0026gt;) findViewById(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;R\u0026lt;/span\u0026gt;.id.editText);\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; stringToPassBack = editText.getText().toString();\n\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// put the String to pass back into an Intent and close this activity\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; intent = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;();\n        intent.putExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;keyName\u0026quot;\u0026lt;/span\u0026gt;, stringToPassBack);\n        setResult(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;RESULT_OK\u0026lt;/span\u0026gt;, intent);\n        finish();\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Complementing \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/10407159/how-to-manage-startactivityforresult-on-android/10407371#10407371\u0026quot;\u0026gt;the answer from Nishant\u0026lt;/a\u0026gt;, the best way to return the activity result is:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;returnIntent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; getIntent();\nreturnIntent.putExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;result\u0026quot;\u0026lt;/span\u0026gt;,result);\nsetResult(RESULT_OK,returnIntent);\nfinish();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;I was having a problem with\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scss\u0026quot;\u0026gt;new \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Then I found out that the correct way is using\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scss\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;getIntent\u0026lt;/span\u0026gt;();\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;to get the current intent.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h3\u0026gt;startActivityForResult:  Deprecated in Android X\u0026lt;/h3\u0026gt;\n\u0026lt;p\u0026gt;For the \u0026lt;em\u0026gt;new\u0026lt;/em\u0026gt; way we have \u0026lt;code\u0026gt;registerForActivityResult\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;In Java :\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// You need to create a launcher variable inside onAttach or onCreate or global, i.e, before the activity is displayed\u0026lt;/span\u0026gt;\n ActivityResultLauncher\u0026amp;lt;Intent\u0026amp;gt; launchSomeActivity = registerForActivityResult(\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ActivityResultContracts\u0026lt;/span\u0026gt;.StartActivityForResult(),\n     \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;ActivityResultCallback\u0026lt;/span\u0026gt;\u0026amp;lt;ActivityResult\u0026amp;gt;() {\n              \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n              \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(ActivityResult result)\u0026lt;/span\u0026gt; {\n                   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (result.getResultCode() == Activity.RESULT_OK) {\n                         \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; result.getData();\n                         \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// your operation....\u0026lt;/span\u0026gt;\n                    }\n               }\n      });\n\n      \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;openYourActivity\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, SomeActivity.class);\n            launchSomeActivity.launch(intent);\n      }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;In Kotlin :\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resultLauncher = registerForActivityResult(StartActivityForResult()) { result -\u0026amp;gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (result.resultCode == Activity.RESULT_OK) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;: Intent? = result.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// your operation...\u0026lt;/span\u0026gt;\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fun\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;openYourActivity\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; intent = Intent(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, SomeActivity::\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;.java)\n    resultLauncher.launch(intent)\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h3\u0026gt;Advantage:\u0026lt;/h3\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;The new way is reduce complexity which we faced when we call the activity from a fragment or from another activity\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Easily ask for any permission and get callback\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n    ","\n\u0026lt;p\u0026gt;For those who have problem with \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/10564474/wrong-requestcode-in-onactivityresult\u0026quot;\u0026gt;wrong requestCode in onActivityResult\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you are calling \u0026lt;code\u0026gt;startActivityForResult()\u0026lt;/code\u0026gt; from your \u0026lt;code\u0026gt;Fragment\u0026lt;/code\u0026gt;, the requestCode is changed by the Activity that owns the Fragment.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;If you want to get the correct resultCode in your activity try this:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Change:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;startActivityForResult(intent, 1);\u0026lt;/code\u0026gt; To:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;getActivity().startActivityForResult(intent, 1);\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;h2\u0026gt;The ActivityResultRegistry is the recommended approach\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;code\u0026gt;ComponentActivity\u0026lt;/code\u0026gt; now provides an \u0026lt;code\u0026gt;ActivityResultRegistry\u0026lt;/code\u0026gt; that lets you handle the \u0026lt;code\u0026gt;startActivityForResult()\u0026lt;/code\u0026gt;+\u0026lt;code\u0026gt;onActivityResult()\u0026lt;/code\u0026gt; as well as \u0026lt;code\u0026gt;requestPermissions()\u0026lt;/code\u0026gt;+\u0026lt;code\u0026gt;onRequestPermissionsResult()\u0026lt;/code\u0026gt; flows without overriding methods in your \u0026lt;code\u0026gt;Activity\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;Fragment\u0026lt;/code\u0026gt;, brings increased type safety via \u0026lt;code\u0026gt;ActivityResultContract\u0026lt;/code\u0026gt;, and provides hooks for testing these flows.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;It is strongly recommended to use the Activity Result APIs introduced in Android\u0026amp;nbsp;10 Activity 1.2.0-alpha02 and Fragment 1.3.0-alpha02.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Add this to your \u0026lt;code\u0026gt;build.gradle\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;def activity_version = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1.2.0-beta01\u0026quot;\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Java language implementation\u0026lt;/span\u0026gt;\nimplementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.activity:activity:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$activity_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Kotlin\u0026lt;/span\u0026gt;\nimplementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.activity:activity-ktx:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$activity_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;h2\u0026gt;How to use the pre-built contract\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;This new API has the following pre-built functionalities\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;TakeVideo\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;PickContact\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;GetContent\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;GetContents\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;OpenDocument\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;OpenDocuments\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;OpenDocumentTree\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;CreateDocument\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Dial\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;TakePicture\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;RequestPermission\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;RequestPermissions\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;An example that uses the takePicture contract:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; takePicture = prepareCall(ActivityResultContracts.TakePicture()) { bitmap: Bitmap? -\u0026amp;gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Do something with the Bitmap, if present\u0026lt;/span\u0026gt;\n}\n\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;override\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fun\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(savedInstanceState: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bundle\u0026lt;/span\u0026gt;?)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onCreate(savedInstanceState)\n    setContentView(R.layout.activity_main)\n\n    button.setOnClickListener { takePicture() }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;So whats going on here? Lets break it down slightly. \u0026lt;code\u0026gt;takePicture\u0026lt;/code\u0026gt; is just a callback which returns a nullable Bitmap - whether or not its null depends on whether or not the \u0026lt;code\u0026gt;onActivityResult\u0026lt;/code\u0026gt; process was successful. \u0026lt;code\u0026gt;prepareCall\u0026lt;/code\u0026gt; then registers this call into a new feature on \u0026lt;code\u0026gt;ComponentActivity\u0026lt;/code\u0026gt; called the \u0026lt;code\u0026gt;ActivityResultRegistry\u0026lt;/code\u0026gt; - well come back to this later. \u0026lt;code\u0026gt;ActivityResultContracts.TakePicture()\u0026lt;/code\u0026gt; is one of the built-in helpers which Google have created for us, and finally invoking \u0026lt;code\u0026gt;takePicture\u0026lt;/code\u0026gt; actually triggers the Intent in the same way that you would previously with \u0026lt;code\u0026gt;Activity.startActivityForResult(intent, REQUEST_CODE)\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;How to write a custom contract\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;A simple contract that takes an Int as an \u0026lt;em\u0026gt;input\u0026lt;/em\u0026gt; and returns a string that the requested Activity returns in the result Intent.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyContract\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResultContract\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int, String\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;() {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;companion\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;object\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; ACTION = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;com.myapp.action.MY_ACTION\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; INPUT_INT = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;input_int\u0026quot;\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;const\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; OUTPUT_STRING = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;output_string\u0026quot;\u0026lt;/span\u0026gt;\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;override\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fun\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;createIntent\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(input: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;: Intent {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; Intent(ACTION)\n            .apply { putExtra(INPUT_INT, input) }\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;override\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fun\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;parseResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(resultCode: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Int\u0026lt;/span\u0026gt;, intent: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;?)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;: String? {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;when\u0026lt;/span\u0026gt; (resultCode) {\n            Activity.RESULT_OK -\u0026amp;gt; intent?.getStringExtra(OUTPUT_STRING)\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; -\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;\n        }\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyActivity\u0026lt;/span\u0026gt; : \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;AppCompatActivity\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;() {\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;val\u0026lt;/span\u0026gt; myActionCall = prepareCall(MyContract()) { result -\u0026amp;gt;\n        Log.i(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;MyActivity\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Obtained result: \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$result\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;)\n    }\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;override\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-function\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;fun\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(savedInstanceState: \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bundle\u0026lt;/span\u0026gt;?)\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onCreate(savedInstanceState)\n        ...\n        button.setOnClickListener {\n            myActionCall(\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;500\u0026lt;/span\u0026gt;)\n        }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Check \u0026lt;a href=\u0026quot;https://developer.android.com/training/basics/intents/result\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;this official documentation\u0026lt;/a\u0026gt; for more information.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you want to update the user interface with the activity result, you can\u0026apos;t to use \u0026lt;code\u0026gt;this.runOnUiThread(new Runnable() {}\u0026lt;/code\u0026gt;. Doing this, the UI won\u0026apos;t refresh with the new value. Instead, you can do this:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (resultCode == RESULT_CANCELED) {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n    }\n\n    global_lat = data.getDoubleExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;LATITUDE\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    global_lng = data.getDoubleExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;LONGITUDE\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;);\n    new_latlng = \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;true\u0026lt;/span\u0026gt;;\n}\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onResume\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onResume();\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(new_latlng)\n    {\n        PhysicalTagProperties.\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;.setLocation(global_lat, global_lng);\n        new_latlng=\u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;false\u0026lt;/span\u0026gt;;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;This seems silly, but it works pretty well.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I will post the new \u0026quot;way\u0026quot; with \u0026lt;a href=\u0026quot;https://developer.android.com/jetpack/androidx\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Android X\u0026lt;/a\u0026gt; in a short answer (because in some case you does not need custom registry or contract). If you want more information, see:  \u0026lt;em\u0026gt;\u0026lt;a href=\u0026quot;https://developer.android.com/training/basics/intents/result\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Getting a result from an activity\u0026lt;/a\u0026gt;\u0026lt;/em\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Important\u0026lt;/strong\u0026gt;: there is actually a bug with the backward compatibility of Android X so you have to add \u0026lt;code\u0026gt;fragment_version\u0026lt;/code\u0026gt; in your Gradle file. \u0026lt;strong\u0026gt;Otherwise you will get an exception \u0026quot;New result API error : Can only use lower 16 bits for requestCode\u0026quot;\u0026lt;/strong\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-kotlin\u0026quot;\u0026gt;dependencies {\n\n    def activity_version = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1.2.0-beta01\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Java language implementation\u0026lt;/span\u0026gt;\n    implementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.activity:activity:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$activity_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Kotlin\u0026lt;/span\u0026gt;\n    implementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.activity:activity-ktx:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$activity_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n\n    def fragment_version = \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;1.3.0-beta02\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Java language implementation\u0026lt;/span\u0026gt;\n    implementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.fragment:fragment:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$fragment_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Kotlin\u0026lt;/span\u0026gt;\n    implementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.fragment:fragment-ktx:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$fragment_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Testing Fragments in Isolation\u0026lt;/span\u0026gt;\n    debugImplementation \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;androidx.fragment:fragment-testing:\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$fragment_version\u0026lt;/span\u0026gt;\u0026quot;\u0026lt;/span\u0026gt;\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Now you just have to add this member variable of your activity. This use a predefined registry and generic contract.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scala\u0026quot;\u0026gt;public \u0026lt;span class=\u0026quot;hljs-class\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;MyActivity\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;extends\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title\u0026quot;\u0026gt;AppCompatActivity\u0026lt;/span\u0026gt;\u0026lt;/span\u0026gt;{\n\n   ...\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;/**\n     * Activity callback API.\n     */\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// https://developer.android.com/training/basics/intents/result\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResultLauncher\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;\u0026amp;gt; mStartForResult = registerForActivityResult(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResultContracts\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;StartActivityForResult\u0026lt;/span\u0026gt;(),\n\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResultCallback\u0026lt;/span\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResult\u0026lt;/span\u0026gt;\u0026amp;gt;() {\n\n                \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n                public void onActivityResult(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;ActivityResult\u0026lt;/span\u0026gt; result) {\n                    switch (result.getResultCode()) {\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Activity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;RESULT_OK\u0026lt;/span\u0026gt;:\n                            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; intent = result.getData();\n                            \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Handle the Intent\u0026lt;/span\u0026gt;\n                            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Toast\u0026lt;/span\u0026gt;.makeText(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MyActivity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Activity returned ok\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Toast\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;LENGTH_SHORT\u0026lt;/span\u0026gt;).show();\n                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n                        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;case\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Activity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;RESULT_CANCELED\u0026lt;/span\u0026gt;:\n                            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Toast\u0026lt;/span\u0026gt;.makeText(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;MyActivity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Activity canceled\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Toast\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;LENGTH_SHORT\u0026lt;/span\u0026gt;).show();\n                            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;break\u0026lt;/span\u0026gt;;\n                    }\n                }\n            });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Before new API you had :\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;btn.setOnClickListener(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;View\u0026lt;/span\u0026gt;.OnClickListener() {\n\n            \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onClick\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(View v)\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(MyActivity .\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, EditActivity.class);\n                startActivityForResult(intent, Constants.INTENT_EDIT_REQUEST_CODE);\n            }\n        });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;You may notice that the request code is now generated (and hold) by the Google framework.\u0026lt;/strong\u0026gt;\nYour code becomes:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt; btn.setOnClickListener(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;View\u0026lt;/span\u0026gt;.OnClickListener() {\n\n                \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onClick\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(View v)\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(MyActivity .\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, EditActivity.class);\n                    mStartForResult.launch(intent);\n                }\n            });\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;First you use \u0026lt;code\u0026gt;startActivityForResult()\u0026lt;/code\u0026gt; with parameters in the first \u0026lt;code\u0026gt;Activity\u0026lt;/code\u0026gt; and if you want to send data from the second \u0026lt;code\u0026gt;Activity\u0026lt;/code\u0026gt; to first \u0026lt;code\u0026gt;Activity\u0026lt;/code\u0026gt; then pass the value using \u0026lt;code\u0026gt;Intent\u0026lt;/code\u0026gt; with the \u0026lt;code\u0026gt;setResult()\u0026lt;/code\u0026gt; method and get that data inside the \u0026lt;code\u0026gt;onActivityResult()\u0026lt;/code\u0026gt; method in the first \u0026lt;code\u0026gt;Activity\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;It is a very common problem on Android\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;It can be broken down into three pieces\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;Start Activity B (happens in Activity A)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Set requested data  (happens in activity B)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Receive requested data (happens in activity A)\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;ol\u0026gt;\n\u0026lt;li\u0026gt;startActivity B\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-csharp\u0026quot;\u0026gt;Intent i = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; Intent(A.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, B.\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;);\nstartActivity(i);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;ol start=\u0026quot;2\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;Set requested data\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;In this part, you decide whether you want to send data back or not when a particular event occurs.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;E.g.: In activity B there is an EditText and two buttons b1, b2.\nClicking on Button b1 sends data back to activity A.\nClicking on Button b2 does not send any data.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Sending data\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;b1......clickListener\n{\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;resultIntent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;();\n    resultIntent.putExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Your_key\u0026quot;\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Your_value\u0026quot;\u0026lt;/span\u0026gt;);\n    setResult(RES_CODE_A, resultIntent);\n    finish();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Not sending data\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scss\u0026quot;\u0026gt;b2.....\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.clickListener\u0026lt;/span\u0026gt;\n{\n   \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setResult\u0026lt;/span\u0026gt;(RES_CODE_B, new Intent());\n   \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;finish\u0026lt;/span\u0026gt;();\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;The user clicks the back button\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;By default, the result is set with Activity.RESULT_CANCEL response code\u0026lt;/p\u0026gt;\n\u0026lt;blockquote\u0026gt;\n\u0026lt;ol start=\u0026quot;3\u0026quot;\u0026gt;\n\u0026lt;li\u0026gt;Retrieve result\u0026lt;/li\u0026gt;\n\u0026lt;/ol\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;p\u0026gt;For that override onActivityResult method\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (resultCode == RES_CODE_A) {\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// b1 was clicked\u0026lt;/span\u0026gt;\n       \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;x\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data.getStringExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;RES_CODE_A\u0026quot;\u0026lt;/span\u0026gt;);\n\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(resultCode == RES_CODE_B){\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// b2 was clicked\u0026lt;/span\u0026gt;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;{\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The back button was clicked\u0026lt;/span\u0026gt;\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In \u0026lt;strong\u0026gt;Kotlin\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Suppose A \u0026amp;amp; B are activities the navigation is from A -\u0026amp;gt; B\nWe need the result back from A \u0026amp;lt;- B\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;in \u0026lt;strong\u0026gt;A\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-typescript\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// calling the Activity B\u0026lt;/span\u0026gt;\n    resultLauncher.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;launch\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(requireContext(), \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;B\u0026lt;/span\u0026gt;::\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;java\u0026lt;/span\u0026gt;))\n\n    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// we get data in here from B\u0026lt;/span\u0026gt;\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;var\u0026lt;/span\u0026gt; resultLauncher =\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;registerForActivityResult\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;ActivityResultContracts.StartActivityForResult()\u0026lt;/span\u0026gt;) { result -\u0026amp;gt;\n        when (result.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;resultCode\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Activity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;RESULT_OK\u0026lt;/span\u0026gt; -\u0026amp;gt; {\n                result.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;data\u0026lt;/span\u0026gt;?.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getStringExtra\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;VALUE\u0026quot;\u0026lt;/span\u0026gt;)?.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;let\u0026lt;/span\u0026gt; {\n                    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// data received here\u0026lt;/span\u0026gt;\n                }\n            }\n            \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Activity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;RESULT_CANCELED\u0026lt;/span\u0026gt; -\u0026amp;gt; {\n                \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// cancel or failure\u0026lt;/span\u0026gt;\n            }\n        }\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In \u0026lt;strong\u0026gt;B\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scss\u0026quot;\u0026gt;    \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Sending result value back to A\u0026lt;/span\u0026gt;\n    if (success) {\n       \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setResult\u0026lt;/span\u0026gt;(RESULT_OK, Intent()\u0026lt;span class=\u0026quot;hljs-selector-class\u0026quot;\u0026gt;.putExtra\u0026lt;/span\u0026gt;(\u0026quot;VALUE\u0026quot;, value))\n    } else {\n       \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;setResult\u0026lt;/span\u0026gt;(RESULT_CANCELED)\n    }\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In your Main Activity\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-typescript\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;Bundle savedInstanceState\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;(savedInstanceState);\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;setContentView\u0026lt;/span\u0026gt;(R.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;layout\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;activity_main\u0026lt;/span\u0026gt;);\n\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;findViewById\u0026lt;/span\u0026gt;(R.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;takeCam\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;setOnClickListener\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;View\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;OnClickListener\u0026lt;/span\u0026gt;() {\n        \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onClick\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;View view\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; intent=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getApplicationContext\u0026lt;/span\u0026gt;(),\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;TakePhotoActivity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;);\n            intent.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;putExtra\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Take\u0026quot;\u0026lt;/span\u0026gt;);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;startActivity\u0026lt;/span\u0026gt;(intent);\n        }\n    });\n    \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;findViewById\u0026lt;/span\u0026gt;(R.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;id\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;selectGal\u0026lt;/span\u0026gt;).\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;setOnClickListener\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;View\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;OnClickListener\u0026lt;/span\u0026gt;() {\n        \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onClick\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;View view\u0026lt;/span\u0026gt;) {\n            \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; intent=\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;getApplicationContext\u0026lt;/span\u0026gt;(),\u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;TakePhotoActivity\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-property\u0026quot;\u0026gt;class\u0026lt;/span\u0026gt;);\n            intent.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;putExtra\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Gallery\u0026quot;\u0026lt;/span\u0026gt;);\n            \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;startActivity\u0026lt;/span\u0026gt;(intent);\n        }\n    });\n}\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;int requestCode, int resultCode, Intent data\u0026lt;/span\u0026gt;) {\n    \u0026lt;span class=\u0026quot;hljs-variable language_\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.\u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;(requestCode, resultCode, data);\n\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;In Second Activity to Display\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;CAMERA_REQUEST\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;1888\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; ImageView imageView;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;MY_CAMERA_PERMISSION_CODE\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;100\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;private\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;static\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;final\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;PICK_PHOTO_FOR_AVATAR\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;;\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onCreate\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(Bundle savedInstanceState)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onCreate(savedInstanceState);\n    setContentView(R.layout.activity_take_photo);\n\n    imageView=findViewById(R.id.imageView);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(getIntent().getStringExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Mode\u0026quot;\u0026lt;/span\u0026gt;).equals(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Gallery\u0026quot;\u0026lt;/span\u0026gt;))\n    {\n        pickImage();\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (Build.VERSION.SDK_INT \u0026amp;gt;= Build.VERSION_CODES.M) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (checkSelfPermission(Manifest.permission.CAMERA) != PackageManager.PERMISSION_GRANTED) {\n                requestPermissions(\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt;[]{Manifest.permission.CAMERA}, MY_CAMERA_PERMISSION_CODE);\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;cameraIntent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(MediaStore.ACTION_IMAGE_CAPTURE);\n                startActivityForResult(cameraIntent, CAMERA_REQUEST);\n            }\n        }\n    }\n}\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;pickImage\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;()\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(Intent.ACTION_PICK);\n    intent.setType(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;image/*\u0026quot;\u0026lt;/span\u0026gt;);\n    startActivityForResult(intent, PICK_PHOTO_FOR_AVATAR);\n}\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;public\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onRequestPermissionsResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@NonNull\u0026lt;/span\u0026gt; String[] permissions, \u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@NonNull\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt;[] grantResults)\u0026lt;/span\u0026gt;\n{\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onRequestPermissionsResult(requestCode, permissions, grantResults);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (requestCode == MY_CAMERA_PERMISSION_CODE)\n    {\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (grantResults[\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;0\u0026lt;/span\u0026gt;] == PackageManager.PERMISSION_GRANTED)\n        {\n            \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;cameraIntent\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title class_\u0026quot;\u0026gt;Intent\u0026lt;/span\u0026gt;(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);\n            startActivityForResult(cameraIntent, CAMERA_REQUEST);\n        }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;\n        {\n            Toast.makeText(\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;this\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Camera Permission Denied..\u0026quot;\u0026lt;/span\u0026gt;, Toast.LENGTH_LONG).show();\n        }\n    }\n}\n\n\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (requestCode == CAMERA_REQUEST \u0026amp;amp;\u0026amp;amp; resultCode == Activity.RESULT_OK) {\n        \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bitmap\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;photo\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; (Bitmap) data.getExtras().get(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;data\u0026quot;\u0026lt;/span\u0026gt;);\n        imageView.setImageBitmap(photo);\n    }\n        \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (requestCode == PICK_PHOTO_FOR_AVATAR \u0026amp;amp;\u0026amp;amp; resultCode == Activity.RESULT_OK) {\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (data == \u0026lt;span class=\u0026quot;hljs-literal\u0026quot;\u0026gt;null\u0026lt;/span\u0026gt;) {\n                Log.d(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ABC\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;No Such Image Selected\u0026quot;\u0026lt;/span\u0026gt;);\n                \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;return\u0026lt;/span\u0026gt;;\n            }\n            \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;try\u0026lt;/span\u0026gt; {\n                Uri selectedData=data.getData();\n                Log.d(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;ABC\u0026quot;\u0026lt;/span\u0026gt;,\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Image Pick-Up\u0026quot;\u0026lt;/span\u0026gt;);\n                imageView.setImageURI(selectedData);\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;InputStream\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;inputStream\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; getApplicationContext().getContentResolver().openInputStream(selectedData);\n                \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;Bitmap\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;bitmap\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; BitmapFactory.decodeStream(inputStream);\n                Bitmap bmp=MediaStore.Images.Media.getBitmap(getContentResolver(),selectedData);\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt; (FileNotFoundException e) {\n                e.printStackTrace();\n            } \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;catch\u0026lt;/span\u0026gt;(IOException e){\n\n            }\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;You need to override Activity.onActivityResult():\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-java\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-meta\u0026quot;\u0026gt;@Override\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;protected\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;void\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_\u0026quot;\u0026gt;onActivityResult\u0026lt;/span\u0026gt;\u0026lt;span class=\u0026quot;hljs-params\u0026quot;\u0026gt;(\u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; requestCode, \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;int\u0026lt;/span\u0026gt; resultCode, Intent data)\u0026lt;/span\u0026gt; {\n    \u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;super\u0026lt;/span\u0026gt;.onActivityResult(requestCode, resultCode, data);\n\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (resultCode == RESULT_CODE_ONE) {\n\n       \u0026lt;span class=\u0026quot;hljs-type\u0026quot;\u0026gt;String\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;a\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-operator\u0026quot;\u0026gt;=\u0026lt;/span\u0026gt; data.getStringExtra(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;RESULT_CODE_ONE\u0026quot;\u0026lt;/span\u0026gt;);\n\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt;(resultCode == RESULT_CODE_TWO){\n\n       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// b was clicked\u0026lt;/span\u0026gt;\n    }\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt;{\n\n    }\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    "],"id":433,"title":"How to manage startActivityForResult on Android","content":"\n                \n\u0026lt;p\u0026gt;In my activity, I\u0026apos;m calling a second activity from the main activity by \u0026lt;code\u0026gt;startActivityForResult\u0026lt;/code\u0026gt;. In my second activity, there are some methods that finish this activity (maybe without a result), however, just one of them returns a result.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;For example, from the main activity, I call a second one. In this activity, I\u0026apos;m checking some features of a handset, such as does it have a camera. If it doesn\u0026apos;t have then I\u0026apos;ll close this activity. Also, during the preparation of \u0026lt;code\u0026gt;MediaRecorder\u0026lt;/code\u0026gt; or \u0026lt;code\u0026gt;MediaPlayer\u0026lt;/code\u0026gt; if a problem happens then I\u0026apos;ll close this activity.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;If its device has a camera and recording is done completely, then after recording a video if a user clicks on the done button then I\u0026apos;ll send the result (address of the recorded video) back to the main activity.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;How do I check the result from the main activity?\u0026lt;/p\u0026gt;\n    ","slug":"how-to-manage-startactivityforresult-on-android-1657387967393","postType":"QUESTION","createdAt":"2022-07-09T17:32:47.000Z","updatedAt":"2022-07-09T17:32:47.000Z","tags":[{"id":2267,"name":"startactivityforresult","slug":"startactivityforresult","createdAt":"2022-07-09T17:32:47.000Z","updatedAt":"2022-07-09T17:32:47.000Z","Questions_Tags":{"questionId":433,"tagId":2267}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"how-to-manage-startactivityforresult-on-android-1657387967393"},"buildId":"9SrIo1zGFc3tF1E8on9-4","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>