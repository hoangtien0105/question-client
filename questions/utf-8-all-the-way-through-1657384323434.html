<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:site" content="@solutionschecker.com"/><meta name="twitter:creator" content="@solutionschecker.com"/><meta property="og:url" content="https://solutionschecker.com"/><meta property="og:type" content="website"/><meta property="og:image" content="https://solutionschecker.com/solutions-checker-banner.png"/><meta property="og:image:alt" content="Find solution for coding, HTML, CSS, JAVASCRIPT, MYSQL, PHP, PYTHON,... quickly. - solutionschecker.com"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Organization","logo":"/logo.svg","url":"https://solutionschecker.com"}</script><title>UTF-8 all the way through | Solutions Checker</title><meta name="robots" content="index,follow"/><meta name="description" content="
I&#x27;m setting up a new server and want to support UTF-8 fully in my web application. I have tried this in the past on existing servers and always seem to end up having to fall back to ISO-8859-1.

Where exactly do I need to set the encoding/charsets? I&#x27;m aware that I need to configure Apache, MySQL, and PHP to do this — is there some standard checklist I can follow, or perhaps troubleshoot where the mismatches occur?

This is for a new Linux server, running MySQL 5, PHP, 5 and Apache 2.
    "/><meta property="og:title" content="UTF-8 all the way through | Solutions Checker"/><meta property="og:description" content="
I&#x27;m setting up a new server and want to support UTF-8 fully in my web application. I have tried this in the past on existing servers and always seem to end up having to fall back to ISO-8859-1.

Where exactly do I need to set the encoding/charsets? I&#x27;m aware that I need to configure Apache, MySQL, and PHP to do this — is there some standard checklist I can follow, or perhaps troubleshoot where the mismatches occur?

This is for a new Linux server, running MySQL 5, PHP, 5 and Apache 2.
    "/><script type="application/ld+json">{"@context":"https://schema.org","@type":"QAPage","mainEntity":{"name":"UTF-8 all the way through","text":"\nI&apos;m setting up a new server and want to support UTF-8 fully in my web application. I have tried this in the past on existing servers and always seem to end up having to fall back to ISO-8859-1.\n\nWhere exactly do I need to set the encoding/charsets? I&apos;m aware that I need to configure Apache, MySQL, and PHP to do this — is there some standard checklist I can follow, or perhaps troubleshoot where the mismatches occur?\n\nThis is for a new Linux server, running MySQL 5, PHP, 5 and Apache 2.\n    ","answerCount":13,"upVoteCount":500,"suggestedAnswer":[{"text":"Data Storage:\n\nSpecify the utf8mb4 character set on all tables and text columns in your database.  This makes MySQL physically store and retrieve values encoded natively in UTF-8.  Note that MySQL will implicitly use utf8mb4 encoding if a utf8mb4_* collation is specified (without any explicit character set).\n\nIn older versions of MySQL (&lt; 5.5.3), you&apos;ll unfortunately be forced to use simply utf8, which only supports a subset of Unicode characters.  I wish I were kidding.\n\n\nData Access:\n\nIn your application code (e.g. PHP), in whatever DB access method you use, you&apos;ll need to set the connection charset to utf8mb4.  This way, MySQL does no conversion from its native UTF-8 when it hands data off to your application and vice versa.\n\nSome drivers provide their own mechanism for configuring the connection character set, which both updates its own internal state and informs MySQL of the encoding to be used on the connectionthis is usually the preferred approach.   In PHP:\n\nIf you&apos;re using the PDO abstraction layer with PHP  5.3.6, you can specify charset in the DSN:\n $dbh = new PDO(&apos;mysql:charset=utf8mb4&apos;);\n\n\nIf you&apos;re using mysqli, you can call set_charset():\n  $mysqli-&gt;set_charset(&apos;utf8mb4&apos;);       // object oriented style\n  mysqli_set_charset($link, &apos;utf8mb4&apos;);  // procedural style\n\n\nIf you&apos;re stuck with plain mysql but happen to be running PHP  5.2.3, you can call mysql_set_charset.\n\n\n\nIf the driver does not provide its own mechanism for setting the connection character set, you may have to issue a query to tell MySQL how your application expects data on the connection to be encoded: SET NAMES &apos;utf8mb4&apos;.\n\nThe same consideration regarding utf8mb4/utf8 applies as above.\n\n\nOutput:\n\nUTF-8 should be set in the HTTP header, such as Content-Type: text/html; charset=utf-8. You can achieve that either by setting default_charset in php.ini (preferred), or manually using header() function.\nIf your application transmits text to other systems, they will also need to be informed of the character encoding.  With web applications, the browser must be informed of the encoding in which data is sent (through HTTP response headers or HTML metadata).\nWhen encoding the output using json_encode(), add JSON_UNESCAPED_UNICODE as a second parameter.\n\nInput:\n\nBrowsers will submit data in the character set specified for the document, hence nothing particular has to be done on the input.\nIn case you have doubts about request encoding (in case it could be tampered with), you may verify every received string as being valid UTF-8 before you try to store it or use it anywhere.  PHP&apos;s mb_check_encoding() does the trick, but you have to use it religiously.  There&apos;s really no way around this, as malicious clients can submit data in whatever encoding they want, and I haven&apos;t found a trick to get PHP to do this for you reliably.\n\nOther Code Considerations:\n\nObviously enough, all files you&apos;ll be serving (PHP, HTML, JavaScript, etc.) should be encoded in valid UTF-8.\n\nYou need to make sure that every time you process a UTF-8 string, you do so safely.  This is, unfortunately, the hard part.  You&apos;ll probably want to make extensive use of PHP&apos;s mbstring extension.\n\nPHP&apos;s built-in string operations are not by default UTF-8 safe.  There are some things you can safely do with normal PHP string operations (like concatenation), but for most things you should use the equivalent mbstring function.\n\nTo know what you&apos;re doing (read: not mess it up), you really need to know UTF-8 and how it works on the lowest possible level.  Check out any of the links from utf8.com for some good resources to learn everything you need to know.\n\n\n    ","url":"/questions/[slug]#solution1","@type":"Answer","upvoteCount":0},{"text":"I&apos;d like to add one thing to chazomaticus&apos; excellent answer:\n\nDon&apos;t forget the META tag either (like this, or the HTML4 or XHTML version of it):\n\n&lt;meta charset=&quot;utf-8&quot;&gt;\n\n\nThat seems trivial, but IE7 has given me problems with that before.\n\nI was doing everything right; the database, database connection and Content-Type HTTP header were all set to UTF-8, and it worked fine in all other browsers, but Internet Explorer still insisted on using the &quot;Western European&quot; encoding.\n\nIt turned out the page was missing the META tag. Adding that solved the problem.\n\nEdit:\n\nThe W3C actually has a rather large section dedicated to I18N. They have a number of articles related to this issue  describing the HTTP, (X)HTML and CSS side of things:\n\n\nFAQ: Changing (X)HTML page encoding to UTF-8\nDeclaring character encodings in HTML\nTutorial: Character sets &amp; encodings in XHTML, HTML and CSS\nSetting the HTTP charset parameter\n\n\nThey recommend using both the HTTP header and HTML meta tag (or XML declaration in case of XHTML served as XML).\n    ","url":"/questions/[slug]#solution2","@type":"Answer","upvoteCount":0},{"text":"In addition to setting default_charset in php.ini, you can send the correct charset using header() from within your code, before any output:\nheader(&apos;Content-Type: text/html; charset=utf-8&apos;);\n\nWorking with Unicode in PHP is easy as long as you realize that most of the string functions don&apos;t work with Unicode, and some might mangle strings completely. PHP considers &quot;characters&quot; to be 1 byte long. Sometimes this is okay (for example, explode() only looks for a byte sequence and uses it as a separator -- so it doesn&apos;t matter what actual characters you look for). But other times, when the function is actually designed to work on characters, PHP has no idea that your text has multi-byte characters that are found with Unicode.\nA good library to check into is phputf8. This rewrites all of the &quot;bad&quot; functions so you can safely work on UTF8 strings. There are extensions like the mb_string extension that try to do this for you, too, but I prefer using the library because it&apos;s more portable (but I write mass-market products, so that&apos;s important for me). But phputf8 can use mb_string behind the scenes, anyway, to increase performance.\n    ","url":"/questions/[slug]#solution3","@type":"Answer","upvoteCount":0},{"text":"\nWarning: This answer applies to PHP 5.3.5 and lower. Do not use it for PHP version 5.3.6 (released in March 2011) or later.\nCompare with Palec&apos;s answer to PDO + MySQL and broken UTF-8 encoding.\n\n\nI found an issue with someone using PDO and the answer was to use this for the PDO connection string:\n$pdo = new PDO(\n    &apos;mysql:host=mysql.example.com;dbname=example_db&apos;,\n    &quot;username&quot;,\n    &quot;password&quot;,\n    array(PDO::MYSQL_ATTR_INIT_COMMAND =&gt; &quot;SET NAMES utf8&quot;));\n\n    ","url":"/questions/[slug]#solution4","@type":"Answer","upvoteCount":0},{"text":"In my case, I was using mb_split, which uses regular expressions.  Therefore I also had to manually make sure the regular expression  encoding was UTF-8 by doing mb_regex_encoding(&apos;UTF-8&apos;);\nAs a side note, I also discovered by running mb_internal_encoding() that the internal encoding wasn&apos;t UTF-8, and I changed that by running mb_internal_encoding(&quot;UTF-8&quot;);.\n    ","url":"/questions/[slug]#solution5","@type":"Answer","upvoteCount":0},{"text":"First of all, if you are in PHP before 5.3 then no. You&apos;ve got a ton of problems to tackle.\nI am surprised that none has mentioned the intl library, the one that has good support for Unicode, graphemes, string operations, localisation and many more, see below.\nI will quote some information about Unicode support in PHP by Elizabeth Smith&apos;s slides at PHPBenelux&apos;14\nINTL\nGood:\n\nWrapper around ICU library\nStandardised locales, set locale per script\nNumber formatting\nCurrency formatting\nMessage formatting (replaces gettext)\nCalendars, dates, time zone and time\nTransliterator\nSpoofchecker\nResource bundles\nConvertors\nIDN support\nGraphemes\nCollation\nIterators\n\nBad:\n\nDoes not support zend_multibyte\nDoes not support HTTP input output conversion\nDoes not support function overloading\n\nmb_string\n\nEnables zend_multibyte support\nSupports transparent HTTP in/out encoding\nProvides some wrappers for functionality such as strtoupper\n\nICONV\n\nPrimary for charset conversion\nOutput buffer handler\nmime encoding functionality\nconversion\nsome string helpers (len, substr, strpos, strrpos)\nStream Filter stream_filter_append($fp, &apos;convert.iconv.ISO-2022-JP/EUC-JP&apos;)\n\nDATABASES\n\nMySQL: Charset and collation on tables and on the connection (not the collation). Also, don&apos;t use mysql - mysqli or PDO\npostgresql: pg_set_client_encoding\nsqlite(3): Make sure it was compiled with Unicode and intl support\n\nSome other gotchas\n\nYou cannot use Unicode filenames with PHP and windows unless you use a 3rd part extension.\nSend everything in ASCII if you are using exec, proc_open and other command line calls\nPlain text is not plain text, files have encodings\nYou can convert files on the fly with the iconv filter\n\n    ","url":"/questions/[slug]#solution6","@type":"Answer","upvoteCount":0},{"text":"The only thing I would add to these amazing answers is to emphasize on saving your files in UTF-8 encoding, I have noticed that browsers accept this property over setting UTF-8 as your code encoding. Any decent text editor will show you this. For example, Notepad++ has a menu option for file encoding, and it shows you the current encoding and enables you to change it. For all my PHP files I use UTF-8 without a BOM.\nSometime ago I had someone ask me to add UTF-8 support for a PHP and MySQL application designed by someone else. I noticed that all files were encoded in ANSI, so I had to use iconv to convert all files, change the database tables to use the UTF-8 character set and utf8_general_ci collate, add &apos;SET NAMES utf8&apos; to the database abstraction layer after the connection (if using 5.3.6 or earlier. Otherwise, you have to use charset=utf8 in the connection string) and change string functions to use the PHP multibyte string functions equivalent.\n    ","url":"/questions/[slug]#solution7","@type":"Answer","upvoteCount":0},{"text":"I recently discovered that using strtolower() can cause issues where the data is truncated after a special character.\n\nThe solution was to use \n\nmb_strtolower($string, &apos;UTF-8&apos;);\n\n\n\n  mb_ uses MultiByte. It supports more characters but in general is a little slower.\n\n    ","url":"/questions/[slug]#solution8","@type":"Answer","upvoteCount":0},{"text":"In PHP, you&apos;ll need to either use the multibyte functions, or turn on mbstring.func_overload. That way things like strlen will work if you have characters that take more than one byte.\n\nYou&apos;ll also need to identify the character set of your responses. You can either use AddDefaultCharset, as above, or write PHP code that returns the header. (Or you can add a META tag to your HTML documents.)\n    ","url":"/questions/[slug]#solution9","@type":"Answer","upvoteCount":0},{"text":"I have just gone through the same issue and found a good solution at PHP manuals.\nI changed all my files&apos; encoding to UTF8 and then the default encoding on my connection. This solved all the problems.\nif (!$mysqli-&gt;set_charset(&quot;utf8&quot;)) {\n    printf(&quot;Error loading character set utf8: %s\\n&quot;, $mysqli-&gt;error);\n} else {\n   printf(&quot;Current character set: %s\\n&quot;, $mysqli-&gt;character_set_name());\n}\n\nView Source\n    ","url":"/questions/[slug]#solution10","@type":"Answer","upvoteCount":0},{"text":"Unicode support in PHP is still a huge mess. While it&apos;s capable of converting an ISO 8859 string (which it uses internally) to UTF-8, it lacks the capability to work with Unicode strings natively, which means all the string processing functions will mangle and corrupt your strings.\nSo you have to either use a separate library for proper UTF-8 support, or rewrite all the string handling functions yourself.\nThe easy part is just specifying the charset in HTTP headers and in the database and such, but none of that matters if your PHP code doesn&apos;t output valid UTF-8. That&apos;s the hard part, and PHP gives you virtually no help there. (I think PHP 6 is supposed to fix the worst of this, but that&apos;s still a while away.)\n    ","url":"/questions/[slug]#solution11","@type":"Answer","upvoteCount":0},{"text":"If you want a MySQL server to decide the character set, and not PHP as a client (old behaviour; preferred, in my opinion), try adding skip-character-set-client-handshake to your my.cnf, under [mysqld], and restart mysql.\nThis may cause trouble in case you&apos;re using anything other than UTF-8.\n    ","url":"/questions/[slug]#solution12","@type":"Answer","upvoteCount":0},{"text":"The top answer is excellent. Here is what I had to on a regular Debian, PHP, and MySQL setup:\n// Storage\n// Debian. Apparently already UTF-8\n\n// Retrieval\n// The MySQL database was stored in UTF-8,\n// but apparently PHP was requesting ISO 8859-1. This worked:\n// ***notice &quot;utf8&quot;, without dash, this is a MySQL encoding***\nmysql_set_charset(&apos;utf8&apos;);\n\n// Delivery\n// File *php.ini* did not have a default charset,\n// (it was commented out, shared host) and\n// no HTTP encoding was specified in the Apache headers.\n// This made Apache send out a UTF-8 header\n// (and perhaps made PHP actually send out UTF-8)\n// ***notice &quot;utf-8&quot;, with dash, this is a php encoding***\nini_set(&apos;default_charset&apos;,&apos;utf-8&apos;);\n\n// Submission\n// This worked in all major browsers once Apache\n// was sending out the UTF-8 header. I didnt add\n// the accept-charset attribute.\n\n// Processing\n// Changed a few commands in PHP, like substr(),\n// to mb_substr()\n\nThat was all!\n    ","url":"/questions/[slug]#solution13","@type":"Answer","upvoteCount":0}],"@type":"Question"}}</script><meta name="next-head-count" content="16"/><link rel="preload" href="/_next/static/css/9fb80f4eb9e2d3c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9fb80f4eb9e2d3c9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-0d1b80a048d4787e.js"></script><script src="/_next/static/chunks/webpack-cb7634a8b6194820.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-25e5079ab4bd6ecd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-88567075f6bc9c6b.js" defer=""></script><script src="/_next/static/chunks/29107295-fbcfe2172188e46f.js" defer=""></script><script src="/_next/static/chunks/532-fec3344a80918110.js" defer=""></script><script src="/_next/static/chunks/495-bb1d5b202c02d7f2.js" defer=""></script><script src="/_next/static/chunks/817-363561828babdd16.js" defer=""></script><script src="/_next/static/chunks/81-2e45c38dc6fe8298.js" defer=""></script><script src="/_next/static/chunks/pages/questions/%5Bslug%5D-16d8c84aea765d4e.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_buildManifest.js" defer=""></script><script src="/_next/static/d4czOeg3MGPNUI9SipfjN/_ssgManifest.js" defer=""></script><style data-styled="" data-styled-version="5.3.5">.dlbxiY code{padding:5px;color:hsl(210deg 8% 15%);background-color:hsl(210deg 8% 90%);border-radius:3px;}/*!sc*/
data-styled.g5[id="sc-344134f6-0"]{content:"dlbxiY,"}/*!sc*/
</style></head><body><div id="__next"><div class="sc-9099c029-0 cIPEih"><header><nav class="bg-white border-gray-200 px-4 lg:px-6 py-2.5 dark:bg-gray-800"><div class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl"><a class="flex items-center" href="/"><img src="/logo-second.png" class="mr-3 h-6 sm:h-9" alt="Solution Checker Logo"/><h4 class="self-center text-xl font-semibold whitespace-nowrap dark:text-white">Solution Checker</h4></a><div class="flex items-center lg:order-2"><button data-collapse-toggle="mobile-menu-2" type="button" class="inline-flex items-center p-2 ml-1 text-sm text-gray-500 rounded-lg lg:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="mobile-menu-2" aria-expanded="false"><span class="sr-only">Open main menu</span><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg><svg class="hidden w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><div class="hidden justify-between items-center w-full lg:flex lg:w-auto lg:order-1" id="mobile-menu-2"><ul class="flex flex-col mt-4 font-medium lg:flex-row lg:space-x-8 lg:mt-0"><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" aria-current="page" href="/">Home</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions?tab=news">Questions</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/post?tab=news">Post</a></li><li><a class="block py-2 pr-4 pl-3 text-gray-700 border-b border-gray-100 hover:bg-gray-50 lg:hover:bg-transparent lg:border-0 lg:hover:text-blue-700 lg:p-0 dark:text-gray-400 lg:dark:hover:text-white dark:hover:bg-gray-700 dark:hover:text-white lg:dark:hover:bg-transparent dark:border-gray-700" href="/questions/utf-8-all-the-way-through-1657384323434#">Coding</a></li></ul></div></div></nav></header><div class="main-content"><div class="sc-c5440139-0 figLul question my-5"><div class="sc-344134f6-0 dlbxiY flex question-header items-center justify-center"><div class="rounded-xl border p-5 shadow-md w-9/12 bg-white"><div class="flex w-full items-center justify-between border-b pb-3"><div class="flex items-center space-x-3"><div class="text-lg font-bold text-slate-700"><a href="/questions/utf-8-all-the-way-through-1657384323434">UTF-8 all the way through</a></div></div><div class="flex flex-wrap h-auto justify-end items-center space-x-8"><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/linux">linux</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/apache">apache</a><a class="rounded-2xl border bg-neutral-100 px-3 py-1 text-sm font-semibold" href="/questions/tag/utf-8">utf-8</a></div></div><div class="question-content mt-5">
                
<p>
I'm setting up a new server and want to support UTF-8 fully in my web application. I have tried this in the past on existing servers and always seem to end up having to fall back to ISO-8859-1.</p>

<p>Where exactly do I need to set the encoding/charsets? I'm aware that I need to configure Apache, MySQL, and PHP to do this — is there some standard checklist I can follow, or perhaps troubleshoot where the mismatches occur?</p>

<p>This is for a new Linux server, running MySQL 5, PHP, 5 and Apache 2.</p>
    </div></div></div><div class="sc-344134f6-2 EUowZ"><div id="solution1" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 1</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p><strong>Data Storage</strong>:</p>
<ul>
<li><p>Specify the <code>utf8mb4</code> character set on all tables and text columns in your database.  This makes MySQL physically store and retrieve values encoded natively in UTF-8.  Note that MySQL will implicitly use <code>utf8mb4</code> encoding if a <code>utf8mb4_*</code> collation is specified (without any explicit character set).</p>
</li>
<li><p>In older versions of MySQL (&lt; 5.5.3), you'll unfortunately be forced to use simply <code>utf8</code>, which only supports a subset of Unicode characters.  I wish I were kidding.</p>
</li>
</ul>
<p><strong>Data Access</strong>:</p>
<ul>
<li><p>In your application code (e.g. PHP), in whatever DB access method you use, you'll need to set the connection charset to <code>utf8mb4</code>.  This way, MySQL does no conversion from its native UTF-8 when it hands data off to your application and vice versa.</p>
</li>
<li><p>Some drivers provide their own mechanism for configuring the connection character set, which both updates its own internal state and informs MySQL of the encoding to be used on the connectionthis is usually the preferred approach.   In PHP:</p>
<ul>
<li><p>If you're using the <a href="http://www.php.net/manual/en/book.pdo.php" rel="noreferrer">PDO</a> abstraction layer with PHP  5.3.6, you can specify <code>charset</code> in the <a href="http://php.net/manual/en/ref.pdo-mysql.connection.php" rel="noreferrer">DSN</a>:</p>
<pre class="default s-code-block"><code class="hljs language-php"> <span class="hljs-variable">$dbh</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(<span class="hljs-string">'mysql:charset=utf8mb4'</span>);
</code></pre>
</li>
<li><p>If you're using <a href="http://www.php.net/manual/en/book.mysqli.php" rel="noreferrer">mysqli</a>, you can call <a href="http://php.net/manual/en/mysqli.set-charset.php" rel="noreferrer"><code>set_charset()</code></a>:</p>
<pre class="default s-code-block"><code class="hljs language-php">  <span class="hljs-variable">$mysqli</span>-&gt;<span class="hljs-title function_ invoke__">set_charset</span>(<span class="hljs-string">'utf8mb4'</span>);       <span class="hljs-comment">// object oriented style</span>
  <span class="hljs-title function_ invoke__">mysqli_set_charset</span>(<span class="hljs-variable">$link</span>, <span class="hljs-string">'utf8mb4'</span>);  <span class="hljs-comment">// procedural style</span>
</code></pre>
</li>
<li><p>If you're stuck with plain <a href="http://php.net/manual/en/book.mysql.php" rel="noreferrer">mysql</a> but happen to be running PHP  5.2.3, you can call <a href="http://php.net/manual/en/function.mysql-set-charset.php" rel="noreferrer"><code>mysql_set_charset</code></a>.</p>
</li>
</ul>
</li>
<li><p>If the driver does not provide its own mechanism for setting the connection character set, you may have to issue a query to tell MySQL how your application expects data on the connection to be encoded: <a href="http://dev.mysql.com/doc/en/charset-connection.html" rel="noreferrer"><code>SET NAMES 'utf8mb4'</code></a>.</p>
</li>
<li><p>The same consideration regarding <code>utf8mb4</code>/<code>utf8</code> applies as above.</p>
</li>
</ul>
<p><strong>Output</strong>:</p>
<ul>
<li>UTF-8 should be set in the HTTP header, such as <code>Content-Type: text/html; charset=utf-8</code>. You can achieve that either by setting <a href="http://www.php.net/manual/en/ini.core.php#ini.default-charset" rel="noreferrer"><code>default_charset</code></a> in php.ini (preferred), or manually using <code>header()</code> function.</li>
<li>If your application transmits text to other systems, they will also need to be informed of the character encoding.  With web applications, the browser must be informed of the encoding in which data is sent (through HTTP response headers or <a href="https://stackoverflow.com/q/4696499">HTML metadata</a>).</li>
<li>When encoding the output using <code>json_encode()</code>, add <code>JSON_UNESCAPED_UNICODE</code> as a second parameter.</li>
</ul>
<p><strong>Input</strong>:</p>
<ul>
<li>Browsers will submit data in the character set specified for the document, hence nothing particular has to be done on the input.</li>
<li>In case you have doubts about request encoding (in case it could be tampered with), you may verify every received string as being valid UTF-8 before you try to store it or use it anywhere.  PHP's <a href="http://php.net/manual/en/function.mb-check-encoding.php" rel="noreferrer"><code>mb_check_encoding()</code></a> does the trick, but you have to use it religiously.  There's really no way around this, as malicious clients can submit data in whatever encoding they want, and I haven't found a trick to get PHP to do this for you reliably.</li>
</ul>
<p><strong>Other Code Considerations</strong>:</p>
<ul>
<li><p>Obviously enough, all files you'll be serving (PHP, HTML, JavaScript, etc.) should be encoded in valid UTF-8.</p>
</li>
<li><p>You need to make sure that every time you process a UTF-8 string, you do so safely.  This is, unfortunately, the hard part.  You'll probably want to make extensive use of PHP's <a href="http://www.php.net/manual/en/book.mbstring.php" rel="noreferrer"><code>mbstring</code></a> extension.</p>
</li>
<li><p><strong>PHP's built-in string operations are <em>not</em> by default UTF-8 safe.</strong>  There are some things you can safely do with normal PHP string operations (like concatenation), but for most things you should use the equivalent <code>mbstring</code> function.</p>
</li>
<li><p>To know what you're doing (read: not mess it up), you really need to know UTF-8 and how it works on the lowest possible level.  Check out any of the links from <a href="http://www.utf8.com/" rel="noreferrer">utf8.com</a> for some good resources to learn everything you need to know.</p>
</li>
</ul>
    </div></div></div></div><div id="solution2" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 2</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I'd like to add one thing to <a href="https://stackoverflow.com/questions/279170/utf-8-all-the-way-through#279279">chazomaticus' excellent answer</a>:</p>

<p>Don't forget the META tag either (like this, or <a href="http://www.w3.org/International/questions/qa-html-encoding-declarations#quicklookup" rel="noreferrer">the HTML4 or XHTML version of it</a>):</p>

<pre class="default s-code-block"><code class="hljs language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"utf-8"</span>&gt;</span>
</code></pre>

<p>That seems trivial, but IE7 has given me problems with that before.</p>

<p>I was doing everything right; the database, database connection and Content-Type HTTP header were all set to UTF-8, and it worked fine in all other browsers, but Internet Explorer still insisted on using the "Western European" encoding.</p>

<p>It turned out the page was missing the META tag. Adding that solved the problem.</p>

<p><strong>Edit:</strong></p>

<p>The W3C actually has a rather large <a href="http://www.w3.org/International/" rel="noreferrer">section dedicated to I18N</a>. They have a number of articles related to this issue  describing the HTTP, (X)HTML and CSS side of things:</p>

<ul>
<li><a href="http://www.w3.org/International/questions/qa-changing-encoding" rel="noreferrer">FAQ: Changing (X)HTML page encoding to UTF-8</a></li>
<li><a href="http://www.w3.org/International/questions/qa-html-encoding-declarations" rel="noreferrer">Declaring character encodings in HTML</a></li>
<li><a href="http://www.w3.org/International/tutorials/tutorial-char-enc/" rel="noreferrer">Tutorial: Character sets &amp; encodings in XHTML, HTML and CSS</a></li>
<li><a href="http://www.w3.org/International/O-HTTP-charset" rel="noreferrer">Setting the HTTP charset parameter</a></li>
</ul>

<p>They recommend using both the HTTP header and HTML meta tag (or XML declaration in case of XHTML served as XML).</p>
    </div></div></div></div><div id="solution3" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 3</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In addition to setting <code>default_charset</code> in php.ini, you can send the correct charset using <code>header()</code> from within your code, before any output:</p>
<pre class="lang-php s-code-block"><code class="hljs language-php"><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">'Content-Type: text/html; charset=utf-8'</span>);
</code></pre>
<p>Working with Unicode in PHP is easy as long as you realize that most of the <strong>string functions don't work with Unicode, and some might mangle strings completely</strong>. PHP considers "characters" to be 1 byte long. Sometimes this is okay (for example, <a href="https://www.php.net/manual/en/function.explode.php" rel="nofollow noreferrer">explode()</a> only looks for a byte sequence and uses it as a separator -- so it doesn't matter what actual characters you look for). But other times, when the function is actually designed to work on <em>characters</em>, PHP has no idea that your text has multi-byte characters that are found with Unicode.</p>
<p>A good library to check into is <a href="http://phputf8.sourceforge.net/" rel="nofollow noreferrer">phputf8</a>. This rewrites all of the "bad" functions so you can safely work on UTF8 strings. There are extensions like the <a href="https://www.php.net/manual/en/book.mbstring.php" rel="nofollow noreferrer">mb_string</a> extension that try to do this for you, too, but I prefer using the library because it's more portable (but I write mass-market products, so that's important for me). But phputf8 can use mb_string behind the scenes, anyway, to increase performance.</p>
    </div></div></div></div><div id="solution4" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 4</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<blockquote>
<p><strong>Warning:</strong> This answer applies to PHP 5.3.5 and lower. Do not use it for PHP version 5.3.6 (released in March 2011) or later.</p>
<p>Compare with <a href="https://stackoverflow.com/a/21373793/367456">Palec's answer to <em>PDO + MySQL and broken UTF-8 encoding</em></a>.</p>
</blockquote>
<hr>
<p>I found an issue with someone using <a href="https://en.wikipedia.org/wiki/PHP#Development_and_community" rel="nofollow noreferrer">PDO</a> and the answer was to use this for the PDO connection string:</p>
<pre class="default s-code-block"><code class="hljs language-php"><span class="hljs-variable">$pdo</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">PDO</span>(
    <span class="hljs-string">'mysql:host=mysql.example.com;dbname=example_db'</span>,
    <span class="hljs-string">"username"</span>,
    <span class="hljs-string">"password"</span>,
    <span class="hljs-keyword">array</span>(PDO::<span class="hljs-variable constant_">MYSQL_ATTR_INIT_COMMAND</span> =&gt; <span class="hljs-string">"SET NAMES utf8"</span>));
</code></pre>
    </div></div></div></div><div id="solution5" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 5</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In my case, I was using <code>mb_split</code>, which uses regular expressions.  Therefore I also had to manually make sure the regular expression  encoding was UTF-8 by doing <code>mb_regex_encoding('UTF-8');</code></p>
<p>As a side note, I also discovered by running <code>mb_internal_encoding()</code> that the internal encoding wasn't UTF-8, and I changed that by running <code>mb_internal_encoding("UTF-8");</code>.</p>
    </div></div></div></div><div id="solution6" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 6</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>First of all, if you are in PHP before 5.3 then no. You've got a ton of problems to tackle.</p>
<p>I am surprised that none has mentioned the <a href="http://php.net/intl" rel="nofollow noreferrer"><strong>intl</strong></a> library, the one that has good support for <strong>Unicode</strong>, <strong>graphemes</strong>, <strong>string operations</strong>, <strong>localisation</strong> and many more, see below.</p>
<p>I will quote some information about Unicode support in PHP by <strong>Elizabeth Smith's</strong> <a href="http://www.slideshare.net/auroraeosrose/using-unicode-with-php" rel="nofollow noreferrer">slides</a> at <strong>PHPBenelux'14</strong></p>
<h2><strong>INTL</strong></h2>
<p>Good:</p>
<ul>
<li>Wrapper around ICU library</li>
<li>Standardised locales, set locale per script</li>
<li>Number formatting</li>
<li>Currency formatting</li>
<li>Message formatting (replaces gettext)</li>
<li>Calendars, dates, time zone and time</li>
<li>Transliterator</li>
<li>Spoofchecker</li>
<li>Resource bundles</li>
<li>Convertors</li>
<li>IDN support</li>
<li>Graphemes</li>
<li>Collation</li>
<li>Iterators</li>
</ul>
<p>Bad:</p>
<ul>
<li>Does not support zend_multibyte</li>
<li>Does not support HTTP input output conversion</li>
<li>Does not support function overloading</li>
</ul>
<h2><strong>mb_string</strong></h2>
<ul>
<li>Enables zend_multibyte support</li>
<li>Supports transparent HTTP in/out encoding</li>
<li>Provides some wrappers for functionality such as strtoupper</li>
</ul>
<h2><strong>ICONV</strong></h2>
<ul>
<li>Primary for charset conversion</li>
<li>Output buffer handler</li>
<li>mime encoding functionality</li>
<li>conversion</li>
<li>some string helpers (len, substr, strpos, strrpos)</li>
<li>Stream Filter <code>stream_filter_append($fp, 'convert.iconv.ISO-2022-JP/EUC-JP')</code></li>
</ul>
<h2><strong>DATABASES</strong></h2>
<ul>
<li>MySQL: Charset and collation on tables and on the connection (not the collation). Also, don't use mysql - mysqli or PDO</li>
<li>postgresql: pg_set_client_encoding</li>
<li>sqlite(3): Make sure it was compiled with Unicode and intl support</li>
</ul>
<h2><strong>Some other gotchas</strong></h2>
<ul>
<li>You cannot use Unicode filenames with PHP and windows unless you use a 3rd part extension.</li>
<li>Send everything in ASCII if you are using exec, proc_open and other command line calls</li>
<li>Plain text is not plain text, files have encodings</li>
<li>You can convert files on the fly with the iconv filter</li>
</ul>
    </div></div></div></div><div id="solution7" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 7</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The only thing I would add to these amazing answers is to emphasize on saving your files in UTF-8 encoding, I have noticed that browsers accept this property over setting UTF-8 as your code encoding. Any decent text editor will show you this. For example, <a href="https://en.wikipedia.org/wiki/Notepad%2B%2B" rel="nofollow noreferrer">Notepad++</a> has a menu option for file encoding, and it shows you the current encoding and enables you to change it. For all my PHP files I use UTF-8 without a <a href="https://en.wikipedia.org/wiki/Byte_order_mark" rel="nofollow noreferrer">BOM</a>.</p>
<p>Sometime ago I had someone ask me to add UTF-8 support for a PHP and MySQL application designed by someone else. I noticed that all files were encoded in ANSI, so I had to use <a href="https://en.wikipedia.org/wiki/Iconv" rel="nofollow noreferrer">iconv</a> to convert all files, change the database tables to use the UTF-8 character set and <em>utf8_general_ci</em> collate, add 'SET NAMES utf8' to the database abstraction layer after the connection (if using 5.3.6 or earlier. Otherwise, you have to use charset=utf8 in the connection string) and change string functions to use the PHP multibyte string functions equivalent.</p>
    </div></div></div></div><div id="solution8" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 8</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I recently discovered that using <code>strtolower()</code> can cause issues where the data is truncated after a special character.</p>

<p>The solution was to use </p>

<pre class="default s-code-block"><code class="hljs language-bash">mb_strtolower(<span class="hljs-variable">$string</span>, <span class="hljs-string">'UTF-8'</span>);
</code></pre>

<blockquote>
  <p>mb_ uses MultiByte. It supports more characters but in general is a little slower.</p>
</blockquote>
    </div></div></div></div><div id="solution9" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 9</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>In PHP, you'll need to either use the <a href="http://us2.php.net/manual/en/ref.mbstring.php" rel="noreferrer">multibyte functions</a>, or turn on <a href="http://us2.php.net/manual/en/mbstring.configuration.php" rel="noreferrer">mbstring.func_overload</a>. That way things like strlen will work if you have characters that take more than one byte.</p>

<p>You'll also need to identify the character set of your responses. You can either use AddDefaultCharset, as above, or write PHP code that returns the header. (Or you can add a META tag to your HTML documents.)</p>
    </div></div></div></div><div id="solution10" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 10</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>I have just gone through the same issue and found a good solution at PHP manuals.</p>
<p>I changed all my files' encoding to UTF8 and then the default encoding on my connection. This solved all the problems.</p>
<pre class="default s-code-block"><code class="hljs language-perl"><span class="hljs-keyword">if</span> (!$mysqli-&gt;set_charset(<span class="hljs-string">"utf8"</span>)) {
    <span class="hljs-keyword">printf</span>(<span class="hljs-string">"Error loading character set utf8: %s\n"</span>, $mysqli-&gt;error);
} <span class="hljs-keyword">else</span> {
   <span class="hljs-keyword">printf</span>(<span class="hljs-string">"Current character set: %s\n"</span>, $mysqli-&gt;character_set_name());
}
</code></pre>
<p><a href="http://php.net/manual/en/mysqli.set-charset.php" rel="nofollow noreferrer">View Source</a></p>
    </div></div></div></div><div id="solution11" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 11</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>Unicode support in PHP is still a huge mess. While it's capable of converting an <a href="https://en.wikipedia.org/wiki/ISO/IEC_8859-1" rel="nofollow noreferrer">ISO&nbsp;8859</a> string (which it uses internally) to UTF-8, it lacks the capability to work with Unicode strings natively, which means all the string processing functions will mangle and corrupt your strings.</p>
<p>So you have to either use a separate library for proper UTF-8 support, or rewrite all the string handling functions yourself.</p>
<p>The easy part is just specifying the charset in HTTP headers and in the database and such, but none of that matters if your PHP code doesn't output valid UTF-8. That's the hard part, and PHP gives you virtually no help there. (I think PHP&nbsp;6 is supposed to fix the worst of this, but that's still a while away.)</p>
    </div></div></div></div><div id="solution12" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 12</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>If you want a MySQL server to decide the character set, and not PHP as a client (old behaviour; preferred, in my opinion), try adding <code>skip-character-set-client-handshake</code> to your <code>my.cnf</code>, under <code>[mysqld]</code>, and restart <code>mysql</code>.</p>
<p>This may cause trouble in case you're using anything other than UTF-8.</p>
    </div></div></div></div><div id="solution13" class="flex mt-5 answer items-center justify-center py-5"><div class="rounded-xl border p-10 shadow-md w-9/12 bg-white"><h4 class="text-4xl font-semibold mb-5">Solution 13</h4><div class=" items-center justify-between"><div class=" space-x-4 md:space-x-8">
<p>The top answer is excellent. Here is what I had to on a regular <a href="https://en.wikipedia.org/wiki/Debian" rel="nofollow noreferrer">Debian</a>, PHP, and <a href="https://en.wikipedia.org/wiki/MySQL" rel="nofollow noreferrer">MySQL</a> setup:</p>
<pre class="default s-code-block"><code class="hljs language-scss"><span class="hljs-comment">// Storage</span>
<span class="hljs-comment">// Debian. Apparently already UTF-8</span>

<span class="hljs-comment">// Retrieval</span>
<span class="hljs-comment">// The MySQL database was stored in UTF-8,</span>
<span class="hljs-comment">// but apparently PHP was requesting ISO 8859-1. This worked:</span>
<span class="hljs-comment">// ***notice "utf8", without dash, this is a MySQL encoding***</span>
<span class="hljs-built_in">mysql_set_charset</span>('utf8');

<span class="hljs-comment">// Delivery</span>
<span class="hljs-comment">// File *php.ini* did not have a default charset,</span>
<span class="hljs-comment">// (it was commented out, shared host) and</span>
<span class="hljs-comment">// no HTTP encoding was specified in the Apache headers.</span>
<span class="hljs-comment">// This made Apache send out a UTF-8 header</span>
<span class="hljs-comment">// (and perhaps made PHP actually send out UTF-8)</span>
<span class="hljs-comment">// ***notice "utf-8", with dash, this is a php encoding***</span>
<span class="hljs-built_in">ini_set</span>('default_charset','utf-<span class="hljs-number">8</span>');

<span class="hljs-comment">// Submission</span>
<span class="hljs-comment">// This worked in all major browsers once Apache</span>
<span class="hljs-comment">// was sending out the UTF-8 header. I didnt add</span>
<span class="hljs-comment">// the accept-charset attribute.</span>

<span class="hljs-comment">// Processing</span>
<span class="hljs-comment">// Changed a few commands in PHP, like substr(),</span>
<span class="hljs-comment">// to mb_substr()</span>
</code></pre>
<p>That was all!</p>
    </div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"data":{"answer":["\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Data Storage\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Specify the \u0026lt;code\u0026gt;utf8mb4\u0026lt;/code\u0026gt; character set on all tables and text columns in your database.  This makes MySQL physically store and retrieve values encoded natively in UTF-8.  Note that MySQL will implicitly use \u0026lt;code\u0026gt;utf8mb4\u0026lt;/code\u0026gt; encoding if a \u0026lt;code\u0026gt;utf8mb4_*\u0026lt;/code\u0026gt; collation is specified (without any explicit character set).\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In older versions of MySQL (\u0026amp;lt; 5.5.3), you\u0026apos;ll unfortunately be forced to use simply \u0026lt;code\u0026gt;utf8\u0026lt;/code\u0026gt;, which only supports a subset of Unicode characters.  I wish I were kidding.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Data Access\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;In your application code (e.g. PHP), in whatever DB access method you use, you\u0026apos;ll need to set the connection charset to \u0026lt;code\u0026gt;utf8mb4\u0026lt;/code\u0026gt;.  This way, MySQL does no conversion from its native UTF-8 when it hands data off to your application and vice versa.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Some drivers provide their own mechanism for configuring the connection character set, which both updates its own internal state and informs MySQL of the encoding to be used on the connectionthis is usually the preferred approach.   In PHP:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you\u0026apos;re using the \u0026lt;a href=\u0026quot;http://www.php.net/manual/en/book.pdo.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;PDO\u0026lt;/a\u0026gt; abstraction layer with PHP  5.3.6, you can specify \u0026lt;code\u0026gt;charset\u0026lt;/code\u0026gt; in the \u0026lt;a href=\u0026quot;http://php.net/manual/en/ref.pdo-mysql.connection.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;DSN\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt; \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$dbh\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;PDO\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mysql:charset=utf8mb4\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you\u0026apos;re using \u0026lt;a href=\u0026quot;http://www.php.net/manual/en/book.mysqli.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;mysqli\u0026lt;/a\u0026gt;, you can call \u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.set-charset.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;set_charset()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;  \u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$mysqli\u0026lt;/span\u0026gt;-\u0026amp;gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;set_charset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;utf8mb4\u0026apos;\u0026lt;/span\u0026gt;);       \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// object oriented style\u0026lt;/span\u0026gt;\n  \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;mysqli_set_charset\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$link\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;utf8mb4\u0026apos;\u0026lt;/span\u0026gt;);  \u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// procedural style\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If you\u0026apos;re stuck with plain \u0026lt;a href=\u0026quot;http://php.net/manual/en/book.mysql.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;mysql\u0026lt;/a\u0026gt; but happen to be running PHP  5.2.3, you can call \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.mysql-set-charset.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;mysql_set_charset\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;If the driver does not provide its own mechanism for setting the connection character set, you may have to issue a query to tell MySQL how your application expects data on the connection to be encoded: \u0026lt;a href=\u0026quot;http://dev.mysql.com/doc/en/charset-connection.html\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;SET NAMES \u0026apos;utf8mb4\u0026apos;\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;The same consideration regarding \u0026lt;code\u0026gt;utf8mb4\u0026lt;/code\u0026gt;/\u0026lt;code\u0026gt;utf8\u0026lt;/code\u0026gt; applies as above.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Output\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;UTF-8 should be set in the HTTP header, such as \u0026lt;code\u0026gt;Content-Type: text/html; charset=utf-8\u0026lt;/code\u0026gt;. You can achieve that either by setting \u0026lt;a href=\u0026quot;http://www.php.net/manual/en/ini.core.php#ini.default-charset\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;default_charset\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; in php.ini (preferred), or manually using \u0026lt;code\u0026gt;header()\u0026lt;/code\u0026gt; function.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;If your application transmits text to other systems, they will also need to be informed of the character encoding.  With web applications, the browser must be informed of the encoding in which data is sent (through HTTP response headers or \u0026lt;a href=\u0026quot;https://stackoverflow.com/q/4696499\u0026quot;\u0026gt;HTML metadata\u0026lt;/a\u0026gt;).\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;When encoding the output using \u0026lt;code\u0026gt;json_encode()\u0026lt;/code\u0026gt;, add \u0026lt;code\u0026gt;JSON_UNESCAPED_UNICODE\u0026lt;/code\u0026gt; as a second parameter.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Input\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Browsers will submit data in the character set specified for the document, hence nothing particular has to be done on the input.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;In case you have doubts about request encoding (in case it could be tampered with), you may verify every received string as being valid UTF-8 before you try to store it or use it anywhere.  PHP\u0026apos;s \u0026lt;a href=\u0026quot;http://php.net/manual/en/function.mb-check-encoding.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;mb_check_encoding()\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; does the trick, but you have to use it religiously.  There\u0026apos;s really no way around this, as malicious clients can submit data in whatever encoding they want, and I haven\u0026apos;t found a trick to get PHP to do this for you reliably.\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Other Code Considerations\u0026lt;/strong\u0026gt;:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;Obviously enough, all files you\u0026apos;ll be serving (PHP, HTML, JavaScript, etc.) should be encoded in valid UTF-8.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;You need to make sure that every time you process a UTF-8 string, you do so safely.  This is, unfortunately, the hard part.  You\u0026apos;ll probably want to make extensive use of PHP\u0026apos;s \u0026lt;a href=\u0026quot;http://www.php.net/manual/en/book.mbstring.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;\u0026lt;code\u0026gt;mbstring\u0026lt;/code\u0026gt;\u0026lt;/a\u0026gt; extension.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;PHP\u0026apos;s built-in string operations are \u0026lt;em\u0026gt;not\u0026lt;/em\u0026gt; by default UTF-8 safe.\u0026lt;/strong\u0026gt;  There are some things you can safely do with normal PHP string operations (like concatenation), but for most things you should use the equivalent \u0026lt;code\u0026gt;mbstring\u0026lt;/code\u0026gt; function.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;p\u0026gt;To know what you\u0026apos;re doing (read: not mess it up), you really need to know UTF-8 and how it works on the lowest possible level.  Check out any of the links from \u0026lt;a href=\u0026quot;http://www.utf8.com/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;utf8.com\u0026lt;/a\u0026gt; for some good resources to learn everything you need to know.\u0026lt;/p\u0026gt;\n\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I\u0026apos;d like to add one thing to \u0026lt;a href=\u0026quot;https://stackoverflow.com/questions/279170/utf-8-all-the-way-through#279279\u0026quot;\u0026gt;chazomaticus\u0026apos; excellent answer\u0026lt;/a\u0026gt;:\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Don\u0026apos;t forget the META tag either (like this, or \u0026lt;a href=\u0026quot;http://www.w3.org/International/questions/qa-html-encoding-declarations#quicklookup\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;the HTML4 or XHTML version of it\u0026lt;/a\u0026gt;):\u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-xml\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-tag\u0026quot;\u0026gt;\u0026amp;lt;\u0026lt;span class=\u0026quot;hljs-name\u0026quot;\u0026gt;meta\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-attr\u0026quot;\u0026gt;charset\u0026lt;/span\u0026gt;=\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;utf-8\u0026quot;\u0026lt;/span\u0026gt;\u0026amp;gt;\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;p\u0026gt;That seems trivial, but IE7 has given me problems with that before.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;I was doing everything right; the database, database connection and Content-Type HTTP header were all set to UTF-8, and it worked fine in all other browsers, but Internet Explorer still insisted on using the \u0026quot;Western European\u0026quot; encoding.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;It turned out the page was missing the META tag. Adding that solved the problem.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Edit:\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The W3C actually has a rather large \u0026lt;a href=\u0026quot;http://www.w3.org/International/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;section dedicated to I18N\u0026lt;/a\u0026gt;. They have a number of articles related to this issue  describing the HTTP, (X)HTML and CSS side of things:\u0026lt;/p\u0026gt;\n\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.w3.org/International/questions/qa-changing-encoding\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;FAQ: Changing (X)HTML page encoding to UTF-8\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.w3.org/International/questions/qa-html-encoding-declarations\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Declaring character encodings in HTML\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.w3.org/International/tutorials/tutorial-char-enc/\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Tutorial: Character sets \u0026amp;amp; encodings in XHTML, HTML and CSS\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;\u0026lt;a href=\u0026quot;http://www.w3.org/International/O-HTTP-charset\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;Setting the HTTP charset parameter\u0026lt;/a\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\n\u0026lt;p\u0026gt;They recommend using both the HTTP header and HTML meta tag (or XML declaration in case of XHTML served as XML).\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In addition to setting \u0026lt;code\u0026gt;default_charset\u0026lt;/code\u0026gt; in php.ini, you can send the correct charset using \u0026lt;code\u0026gt;header()\u0026lt;/code\u0026gt; from within your code, before any output:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;lang-php s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;header\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;Content-Type: text/html; charset=utf-8\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;Working with Unicode in PHP is easy as long as you realize that most of the \u0026lt;strong\u0026gt;string functions don\u0026apos;t work with Unicode, and some might mangle strings completely\u0026lt;/strong\u0026gt;. PHP considers \u0026quot;characters\u0026quot; to be 1 byte long. Sometimes this is okay (for example, \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/function.explode.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;explode()\u0026lt;/a\u0026gt; only looks for a byte sequence and uses it as a separator -- so it doesn\u0026apos;t matter what actual characters you look for). But other times, when the function is actually designed to work on \u0026lt;em\u0026gt;characters\u0026lt;/em\u0026gt;, PHP has no idea that your text has multi-byte characters that are found with Unicode.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;A good library to check into is \u0026lt;a href=\u0026quot;http://phputf8.sourceforge.net/\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;phputf8\u0026lt;/a\u0026gt;. This rewrites all of the \u0026quot;bad\u0026quot; functions so you can safely work on UTF8 strings. There are extensions like the \u0026lt;a href=\u0026quot;https://www.php.net/manual/en/book.mbstring.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;mb_string\u0026lt;/a\u0026gt; extension that try to do this for you, too, but I prefer using the library because it\u0026apos;s more portable (but I write mass-market products, so that\u0026apos;s important for me). But phputf8 can use mb_string behind the scenes, anyway, to increase performance.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;blockquote\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;strong\u0026gt;Warning:\u0026lt;/strong\u0026gt; This answer applies to PHP 5.3.5 and lower. Do not use it for PHP version 5.3.6 (released in March 2011) or later.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Compare with \u0026lt;a href=\u0026quot;https://stackoverflow.com/a/21373793/367456\u0026quot;\u0026gt;Palec\u0026apos;s answer to \u0026lt;em\u0026gt;PDO + MySQL and broken UTF-8 encoding\u0026lt;/em\u0026gt;\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n\u0026lt;hr\u0026gt;\n\u0026lt;p\u0026gt;I found an issue with someone using \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/PHP#Development_and_community\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;PDO\u0026lt;/a\u0026gt; and the answer was to use this for the PDO connection string:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-php\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$pdo\u0026lt;/span\u0026gt; = \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;new\u0026lt;/span\u0026gt; \u0026lt;span class=\u0026quot;hljs-title function_ invoke__\u0026quot;\u0026gt;PDO\u0026lt;/span\u0026gt;(\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;mysql:host=mysql.example.com;dbname=example_db\u0026apos;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;username\u0026quot;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;password\u0026quot;\u0026lt;/span\u0026gt;,\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;array\u0026lt;/span\u0026gt;(PDO::\u0026lt;span class=\u0026quot;hljs-variable constant_\u0026quot;\u0026gt;MYSQL_ATTR_INIT_COMMAND\u0026lt;/span\u0026gt; =\u0026amp;gt; \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;SET NAMES utf8\u0026quot;\u0026lt;/span\u0026gt;));\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In my case, I was using \u0026lt;code\u0026gt;mb_split\u0026lt;/code\u0026gt;, which uses regular expressions.  Therefore I also had to manually make sure the regular expression  encoding was UTF-8 by doing \u0026lt;code\u0026gt;mb_regex_encoding(\u0026apos;UTF-8\u0026apos;);\u0026lt;/code\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;As a side note, I also discovered by running \u0026lt;code\u0026gt;mb_internal_encoding()\u0026lt;/code\u0026gt; that the internal encoding wasn\u0026apos;t UTF-8, and I changed that by running \u0026lt;code\u0026gt;mb_internal_encoding(\u0026quot;UTF-8\u0026quot;);\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;First of all, if you are in PHP before 5.3 then no. You\u0026apos;ve got a ton of problems to tackle.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I am surprised that none has mentioned the \u0026lt;a href=\u0026quot;http://php.net/intl\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;\u0026lt;strong\u0026gt;intl\u0026lt;/strong\u0026gt;\u0026lt;/a\u0026gt; library, the one that has good support for \u0026lt;strong\u0026gt;Unicode\u0026lt;/strong\u0026gt;, \u0026lt;strong\u0026gt;graphemes\u0026lt;/strong\u0026gt;, \u0026lt;strong\u0026gt;string operations\u0026lt;/strong\u0026gt;, \u0026lt;strong\u0026gt;localisation\u0026lt;/strong\u0026gt; and many more, see below.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I will quote some information about Unicode support in PHP by \u0026lt;strong\u0026gt;Elizabeth Smith\u0026apos;s\u0026lt;/strong\u0026gt; \u0026lt;a href=\u0026quot;http://www.slideshare.net/auroraeosrose/using-unicode-with-php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;slides\u0026lt;/a\u0026gt; at \u0026lt;strong\u0026gt;PHPBenelux\u0026apos;14\u0026lt;/strong\u0026gt;\u0026lt;/p\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;INTL\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;p\u0026gt;Good:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Wrapper around ICU library\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Standardised locales, set locale per script\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Number formatting\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Currency formatting\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Message formatting (replaces gettext)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Calendars, dates, time zone and time\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Transliterator\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Spoofchecker\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Resource bundles\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Convertors\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;IDN support\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Graphemes\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Collation\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Iterators\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;p\u0026gt;Bad:\u0026lt;/p\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Does not support zend_multibyte\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Does not support HTTP input output conversion\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Does not support function overloading\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;mb_string\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Enables zend_multibyte support\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Supports transparent HTTP in/out encoding\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Provides some wrappers for functionality such as strtoupper\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;ICONV\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;Primary for charset conversion\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Output buffer handler\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;mime encoding functionality\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;conversion\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;some string helpers (len, substr, strpos, strrpos)\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Stream Filter \u0026lt;code\u0026gt;stream_filter_append($fp, \u0026apos;convert.iconv.ISO-2022-JP/EUC-JP\u0026apos;)\u0026lt;/code\u0026gt;\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;DATABASES\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;MySQL: Charset and collation on tables and on the connection (not the collation). Also, don\u0026apos;t use mysql - mysqli or PDO\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;postgresql: pg_set_client_encoding\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;sqlite(3): Make sure it was compiled with Unicode and intl support\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n\u0026lt;h2\u0026gt;\u0026lt;strong\u0026gt;Some other gotchas\u0026lt;/strong\u0026gt;\u0026lt;/h2\u0026gt;\n\u0026lt;ul\u0026gt;\n\u0026lt;li\u0026gt;You cannot use Unicode filenames with PHP and windows unless you use a 3rd part extension.\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Send everything in ASCII if you are using exec, proc_open and other command line calls\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;Plain text is not plain text, files have encodings\u0026lt;/li\u0026gt;\n\u0026lt;li\u0026gt;You can convert files on the fly with the iconv filter\u0026lt;/li\u0026gt;\n\u0026lt;/ul\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The only thing I would add to these amazing answers is to emphasize on saving your files in UTF-8 encoding, I have noticed that browsers accept this property over setting UTF-8 as your code encoding. Any decent text editor will show you this. For example, \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Notepad%2B%2B\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Notepad++\u0026lt;/a\u0026gt; has a menu option for file encoding, and it shows you the current encoding and enables you to change it. For all my PHP files I use UTF-8 without a \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Byte_order_mark\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;BOM\u0026lt;/a\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;Sometime ago I had someone ask me to add UTF-8 support for a PHP and MySQL application designed by someone else. I noticed that all files were encoded in ANSI, so I had to use \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Iconv\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;iconv\u0026lt;/a\u0026gt; to convert all files, change the database tables to use the UTF-8 character set and \u0026lt;em\u0026gt;utf8_general_ci\u0026lt;/em\u0026gt; collate, add \u0026apos;SET NAMES utf8\u0026apos; to the database abstraction layer after the connection (if using 5.3.6 or earlier. Otherwise, you have to use charset=utf8 in the connection string) and change string functions to use the PHP multibyte string functions equivalent.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I recently discovered that using \u0026lt;code\u0026gt;strtolower()\u0026lt;/code\u0026gt; can cause issues where the data is truncated after a special character.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;The solution was to use \u0026lt;/p\u0026gt;\n\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-bash\u0026quot;\u0026gt;mb_strtolower(\u0026lt;span class=\u0026quot;hljs-variable\u0026quot;\u0026gt;$string\u0026lt;/span\u0026gt;, \u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026apos;UTF-8\u0026apos;\u0026lt;/span\u0026gt;);\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\n\u0026lt;blockquote\u0026gt;\n  \u0026lt;p\u0026gt;mb_ uses MultiByte. It supports more characters but in general is a little slower.\u0026lt;/p\u0026gt;\n\u0026lt;/blockquote\u0026gt;\n    ","\n\u0026lt;p\u0026gt;In PHP, you\u0026apos;ll need to either use the \u0026lt;a href=\u0026quot;http://us2.php.net/manual/en/ref.mbstring.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;multibyte functions\u0026lt;/a\u0026gt;, or turn on \u0026lt;a href=\u0026quot;http://us2.php.net/manual/en/mbstring.configuration.php\u0026quot; rel=\u0026quot;noreferrer\u0026quot;\u0026gt;mbstring.func_overload\u0026lt;/a\u0026gt;. That way things like strlen will work if you have characters that take more than one byte.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;You\u0026apos;ll also need to identify the character set of your responses. You can either use AddDefaultCharset, as above, or write PHP code that returns the header. (Or you can add a META tag to your HTML documents.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;I have just gone through the same issue and found a good solution at PHP manuals.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;I changed all my files\u0026apos; encoding to UTF8 and then the default encoding on my connection. This solved all the problems.\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-perl\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;if\u0026lt;/span\u0026gt; (!$mysqli-\u0026amp;gt;set_charset(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;utf8\u0026quot;\u0026lt;/span\u0026gt;)) {\n    \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Error loading character set utf8: %s\\n\u0026quot;\u0026lt;/span\u0026gt;, $mysqli-\u0026amp;gt;error);\n} \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;else\u0026lt;/span\u0026gt; {\n   \u0026lt;span class=\u0026quot;hljs-keyword\u0026quot;\u0026gt;printf\u0026lt;/span\u0026gt;(\u0026lt;span class=\u0026quot;hljs-string\u0026quot;\u0026gt;\u0026quot;Current character set: %s\\n\u0026quot;\u0026lt;/span\u0026gt;, $mysqli-\u0026amp;gt;character_set_name());\n}\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;\u0026lt;a href=\u0026quot;http://php.net/manual/en/mysqli.set-charset.php\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;View Source\u0026lt;/a\u0026gt;\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;Unicode support in PHP is still a huge mess. While it\u0026apos;s capable of converting an \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/ISO/IEC_8859-1\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;ISO\u0026amp;nbsp;8859\u0026lt;/a\u0026gt; string (which it uses internally) to UTF-8, it lacks the capability to work with Unicode strings natively, which means all the string processing functions will mangle and corrupt your strings.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;So you have to either use a separate library for proper UTF-8 support, or rewrite all the string handling functions yourself.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;The easy part is just specifying the charset in HTTP headers and in the database and such, but none of that matters if your PHP code doesn\u0026apos;t output valid UTF-8. That\u0026apos;s the hard part, and PHP gives you virtually no help there. (I think PHP\u0026amp;nbsp;6 is supposed to fix the worst of this, but that\u0026apos;s still a while away.)\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;If you want a MySQL server to decide the character set, and not PHP as a client (old behaviour; preferred, in my opinion), try adding \u0026lt;code\u0026gt;skip-character-set-client-handshake\u0026lt;/code\u0026gt; to your \u0026lt;code\u0026gt;my.cnf\u0026lt;/code\u0026gt;, under \u0026lt;code\u0026gt;[mysqld]\u0026lt;/code\u0026gt;, and restart \u0026lt;code\u0026gt;mysql\u0026lt;/code\u0026gt;.\u0026lt;/p\u0026gt;\n\u0026lt;p\u0026gt;This may cause trouble in case you\u0026apos;re using anything other than UTF-8.\u0026lt;/p\u0026gt;\n    ","\n\u0026lt;p\u0026gt;The top answer is excellent. Here is what I had to on a regular \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/Debian\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;Debian\u0026lt;/a\u0026gt;, PHP, and \u0026lt;a href=\u0026quot;https://en.wikipedia.org/wiki/MySQL\u0026quot; rel=\u0026quot;nofollow noreferrer\u0026quot;\u0026gt;MySQL\u0026lt;/a\u0026gt; setup:\u0026lt;/p\u0026gt;\n\u0026lt;pre class=\u0026quot;default s-code-block\u0026quot;\u0026gt;\u0026lt;code class=\u0026quot;hljs language-scss\u0026quot;\u0026gt;\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Storage\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Debian. Apparently already UTF-8\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Retrieval\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// The MySQL database was stored in UTF-8,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// but apparently PHP was requesting ISO 8859-1. This worked:\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ***notice \u0026quot;utf8\u0026quot;, without dash, this is a MySQL encoding***\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;mysql_set_charset\u0026lt;/span\u0026gt;(\u0026apos;utf8\u0026apos;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Delivery\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// File *php.ini* did not have a default charset,\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// (it was commented out, shared host) and\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// no HTTP encoding was specified in the Apache headers.\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This made Apache send out a UTF-8 header\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// (and perhaps made PHP actually send out UTF-8)\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// ***notice \u0026quot;utf-8\u0026quot;, with dash, this is a php encoding***\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-built_in\u0026quot;\u0026gt;ini_set\u0026lt;/span\u0026gt;(\u0026apos;default_charset\u0026apos;,\u0026apos;utf-\u0026lt;span class=\u0026quot;hljs-number\u0026quot;\u0026gt;8\u0026lt;/span\u0026gt;\u0026apos;);\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Submission\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// This worked in all major browsers once Apache\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// was sending out the UTF-8 header. I didnt add\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// the accept-charset attribute.\u0026lt;/span\u0026gt;\n\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Processing\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// Changed a few commands in PHP, like substr(),\u0026lt;/span\u0026gt;\n\u0026lt;span class=\u0026quot;hljs-comment\u0026quot;\u0026gt;// to mb_substr()\u0026lt;/span\u0026gt;\n\u0026lt;/code\u0026gt;\u0026lt;/pre\u0026gt;\n\u0026lt;p\u0026gt;That was all!\u0026lt;/p\u0026gt;\n    "],"id":27,"title":"UTF-8 all the way through","content":"\n                \n\u0026lt;p\u0026gt;\nI\u0026apos;m setting up a new server and want to support UTF-8 fully in my web application. I have tried this in the past on existing servers and always seem to end up having to fall back to ISO-8859-1.\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;Where exactly do I need to set the encoding/charsets? I\u0026apos;m aware that I need to configure Apache, MySQL, and PHP to do this — is there some standard checklist I can follow, or perhaps troubleshoot where the mismatches occur?\u0026lt;/p\u0026gt;\n\n\u0026lt;p\u0026gt;This is for a new Linux server, running MySQL 5, PHP, 5 and Apache 2.\u0026lt;/p\u0026gt;\n    ","slug":"utf-8-all-the-way-through-1657384323434","postType":"QUESTION","createdAt":"2022-07-09T16:32:03.000Z","updatedAt":"2022-07-09T16:32:03.000Z","tags":[{"id":89,"name":"linux","slug":"linux","createdAt":"2022-07-09T16:32:03.000Z","updatedAt":"2022-07-09T16:32:03.000Z","Questions_Tags":{"questionId":27,"tagId":89}},{"id":90,"name":"apache","slug":"apache","createdAt":"2022-07-09T16:32:03.000Z","updatedAt":"2022-07-09T16:32:03.000Z","Questions_Tags":{"questionId":27,"tagId":90}},{"id":91,"name":"utf-8","slug":"utf-8","createdAt":"2022-07-09T16:32:03.000Z","updatedAt":"2022-07-09T16:32:03.000Z","Questions_Tags":{"questionId":27,"tagId":91}}]}},"__N_SSG":true},"page":"/questions/[slug]","query":{"slug":"utf-8-all-the-way-through-1657384323434"},"buildId":"d4czOeg3MGPNUI9SipfjN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>